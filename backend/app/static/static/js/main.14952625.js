/*! For license information please see main.14952625.js.LICENSE.txt */
(()=>{var g={579:(g,e,t)=>{"use strict";g.exports=t(1153)},1153:(g,e,t)=>{"use strict";var I=t(5043),n=Symbol.for("react.element"),C=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,a=I.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function i(g,e,t){var I,C={},i=null,r=null;for(I in void 0!==t&&(i=""+t),void 0!==e.key&&(i=""+e.key),void 0!==e.ref&&(r=e.ref),e)l.call(e,I)&&!o.hasOwnProperty(I)&&(C[I]=e[I]);if(g&&g.defaultProps)for(I in e=g.defaultProps)void 0===C[I]&&(C[I]=e[I]);return{$$typeof:n,type:g,key:i,ref:r,props:C,_owner:a.current}}e.Fragment=C,e.jsx=i,e.jsxs=i},2730:(g,e,t)=>{"use strict";var I=t(5043),n=t(8853);function C(g){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+g,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+g+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l=new Set,a={};function o(g,e){i(g,e),i(g+"Capture",e)}function i(g,e){for(a[g]=e,g=0;g<e.length;g++)l.add(e[g])}var r=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),c=Object.prototype.hasOwnProperty,s=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,A={},d={};function u(g,e,t,I,n,C,l){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=I,this.attributeNamespace=n,this.mustUseProperty=t,this.propertyName=g,this.type=e,this.sanitizeURL=C,this.removeEmptyString=l}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(g){m[g]=new u(g,0,!1,g,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(g){var e=g[0];m[e]=new u(e,1,!1,g[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(g){m[g]=new u(g,2,!1,g.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(g){m[g]=new u(g,2,!1,g,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(g){m[g]=new u(g,3,!1,g.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(g){m[g]=new u(g,3,!0,g,null,!1,!1)})),["capture","download"].forEach((function(g){m[g]=new u(g,4,!1,g,null,!1,!1)})),["cols","rows","size","span"].forEach((function(g){m[g]=new u(g,6,!1,g,null,!1,!1)})),["rowSpan","start"].forEach((function(g){m[g]=new u(g,5,!1,g.toLowerCase(),null,!1,!1)}));var h=/[\-:]([a-z])/g;function b(g){return g[1].toUpperCase()}function Z(g,e,t,I){var n=m.hasOwnProperty(e)?m[e]:null;(null!==n?0!==n.type:I||!(2<e.length)||"o"!==e[0]&&"O"!==e[0]||"n"!==e[1]&&"N"!==e[1])&&(function(g,e,t,I){if(null===e||"undefined"===typeof e||function(g,e,t,I){if(null!==t&&0===t.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!I&&(null!==t?!t.acceptsBooleans:"data-"!==(g=g.toLowerCase().slice(0,5))&&"aria-"!==g);default:return!1}}(g,e,t,I))return!0;if(I)return!1;if(null!==t)switch(t.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,t,n,I)&&(t=null),I||null===n?function(g){return!!c.call(d,g)||!c.call(A,g)&&(s.test(g)?d[g]=!0:(A[g]=!0,!1))}(e)&&(null===t?g.removeAttribute(e):g.setAttribute(e,""+t)):n.mustUseProperty?g[n.propertyName]=null===t?3!==n.type&&"":t:(e=n.attributeName,I=n.attributeNamespace,null===t?g.removeAttribute(e):(t=3===(n=n.type)||4===n&&!0===t?"":""+t,I?g.setAttributeNS(I,e,t):g.setAttribute(e,t))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(g){var e=g.replace(h,b);m[e]=new u(e,1,!1,g,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(g){var e=g.replace(h,b);m[e]=new u(e,1,!1,g,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(g){var e=g.replace(h,b);m[e]=new u(e,1,!1,g,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(g){m[g]=new u(g,1,!1,g.toLowerCase(),null,!1,!1)})),m.xlinkHref=new u("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(g){m[g]=new u(g,1,!1,g.toLowerCase(),null,!0,!0)}));var p=I.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,G=Symbol.for("react.element"),y=Symbol.for("react.portal"),B=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),W=Symbol.for("react.provider"),V=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),X=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),J=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var Y=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var w=Symbol.iterator;function N(g){return null===g||"object"!==typeof g?null:"function"===typeof(g=w&&g[w]||g["@@iterator"])?g:null}var H,F=Object.assign;function K(g){if(void 0===H)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);H=e&&e[1]||""}return"\n"+H+g}var x=!1;function L(g,e){if(!g||x)return"";x=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(i){var I=i}Reflect.construct(g,[],e)}else{try{e.call()}catch(i){I=i}g.call(e.prototype)}else{try{throw Error()}catch(i){I=i}g()}}catch(i){if(i&&I&&"string"===typeof i.stack){for(var n=i.stack.split("\n"),C=I.stack.split("\n"),l=n.length-1,a=C.length-1;1<=l&&0<=a&&n[l]!==C[a];)a--;for(;1<=l&&0<=a;l--,a--)if(n[l]!==C[a]){if(1!==l||1!==a)do{if(l--,0>--a||n[l]!==C[a]){var o="\n"+n[l].replace(" at new "," at ");return g.displayName&&o.includes("<anonymous>")&&(o=o.replace("<anonymous>",g.displayName)),o}}while(1<=l&&0<=a);break}}}finally{x=!1,Error.prepareStackTrace=t}return(g=g?g.displayName||g.name:"")?K(g):""}function z(g){switch(g.tag){case 5:return K(g.type);case 16:return K("Lazy");case 13:return K("Suspense");case 19:return K("SuspenseList");case 0:case 2:case 15:return g=L(g.type,!1);case 11:return g=L(g.type.render,!1);case 1:return g=L(g.type,!0);default:return""}}function E(g){if(null==g)return null;if("function"===typeof g)return g.displayName||g.name||null;if("string"===typeof g)return g;switch(g){case B:return"Fragment";case y:return"Portal";case f:return"Profiler";case S:return"StrictMode";case R:return"Suspense";case X:return"SuspenseList"}if("object"===typeof g)switch(g.$$typeof){case V:return(g.displayName||"Context")+".Consumer";case W:return(g._context.displayName||"Context")+".Provider";case v:var e=g.render;return(g=g.displayName)||(g=""!==(g=e.displayName||e.name||"")?"ForwardRef("+g+")":"ForwardRef"),g;case k:return null!==(e=g.displayName||null)?e:E(g.type)||"Memo";case J:e=g._payload,g=g._init;try{return E(g(e))}catch(t){}}return null}function M(g){var e=g.type;switch(g.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return g=(g=e.render).displayName||g.name||"",e.displayName||(""!==g?"ForwardRef("+g+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return E(e);case 8:return e===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e}return null}function U(g){switch(typeof g){case"boolean":case"number":case"string":case"undefined":case"object":return g;default:return""}}function j(g){var e=g.type;return(g=g.nodeName)&&"input"===g.toLowerCase()&&("checkbox"===e||"radio"===e)}function Q(g){g._valueTracker||(g._valueTracker=function(g){var e=j(g)?"checked":"value",t=Object.getOwnPropertyDescriptor(g.constructor.prototype,e),I=""+g[e];if(!g.hasOwnProperty(e)&&"undefined"!==typeof t&&"function"===typeof t.get&&"function"===typeof t.set){var n=t.get,C=t.set;return Object.defineProperty(g,e,{configurable:!0,get:function(){return n.call(this)},set:function(g){I=""+g,C.call(this,g)}}),Object.defineProperty(g,e,{enumerable:t.enumerable}),{getValue:function(){return I},setValue:function(g){I=""+g},stopTracking:function(){g._valueTracker=null,delete g[e]}}}}(g))}function D(g){if(!g)return!1;var e=g._valueTracker;if(!e)return!0;var t=e.getValue(),I="";return g&&(I=j(g)?g.checked?"true":"false":g.value),(g=I)!==t&&(e.setValue(g),!0)}function T(g){if("undefined"===typeof(g=g||("undefined"!==typeof document?document:void 0)))return null;try{return g.activeElement||g.body}catch(e){return g.body}}function P(g,e){var t=e.checked;return F({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=t?t:g._wrapperState.initialChecked})}function O(g,e){var t=null==e.defaultValue?"":e.defaultValue,I=null!=e.checked?e.checked:e.defaultChecked;t=U(null!=e.value?e.value:t),g._wrapperState={initialChecked:I,initialValue:t,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function q(g,e){null!=(e=e.checked)&&Z(g,"checked",e,!1)}function _(g,e){q(g,e);var t=U(e.value),I=e.type;if(null!=t)"number"===I?(0===t&&""===g.value||g.value!=t)&&(g.value=""+t):g.value!==""+t&&(g.value=""+t);else if("submit"===I||"reset"===I)return void g.removeAttribute("value");e.hasOwnProperty("value")?gg(g,e.type,t):e.hasOwnProperty("defaultValue")&&gg(g,e.type,U(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(g.defaultChecked=!!e.defaultChecked)}function $(g,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var I=e.type;if(!("submit"!==I&&"reset"!==I||void 0!==e.value&&null!==e.value))return;e=""+g._wrapperState.initialValue,t||e===g.value||(g.value=e),g.defaultValue=e}""!==(t=g.name)&&(g.name=""),g.defaultChecked=!!g._wrapperState.initialChecked,""!==t&&(g.name=t)}function gg(g,e,t){"number"===e&&T(g.ownerDocument)===g||(null==t?g.defaultValue=""+g._wrapperState.initialValue:g.defaultValue!==""+t&&(g.defaultValue=""+t))}var eg=Array.isArray;function tg(g,e,t,I){if(g=g.options,e){e={};for(var n=0;n<t.length;n++)e["$"+t[n]]=!0;for(t=0;t<g.length;t++)n=e.hasOwnProperty("$"+g[t].value),g[t].selected!==n&&(g[t].selected=n),n&&I&&(g[t].defaultSelected=!0)}else{for(t=""+U(t),e=null,n=0;n<g.length;n++){if(g[n].value===t)return g[n].selected=!0,void(I&&(g[n].defaultSelected=!0));null!==e||g[n].disabled||(e=g[n])}null!==e&&(e.selected=!0)}}function Ig(g,e){if(null!=e.dangerouslySetInnerHTML)throw Error(C(91));return F({},e,{value:void 0,defaultValue:void 0,children:""+g._wrapperState.initialValue})}function ng(g,e){var t=e.value;if(null==t){if(t=e.children,e=e.defaultValue,null!=t){if(null!=e)throw Error(C(92));if(eg(t)){if(1<t.length)throw Error(C(93));t=t[0]}e=t}null==e&&(e=""),t=e}g._wrapperState={initialValue:U(t)}}function Cg(g,e){var t=U(e.value),I=U(e.defaultValue);null!=t&&((t=""+t)!==g.value&&(g.value=t),null==e.defaultValue&&g.defaultValue!==t&&(g.defaultValue=t)),null!=I&&(g.defaultValue=""+I)}function lg(g){var e=g.textContent;e===g._wrapperState.initialValue&&""!==e&&null!==e&&(g.value=e)}function ag(g){switch(g){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function og(g,e){return null==g||"http://www.w3.org/1999/xhtml"===g?ag(e):"http://www.w3.org/2000/svg"===g&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":g}var ig,rg,cg=(rg=function(g,e){if("http://www.w3.org/2000/svg"!==g.namespaceURI||"innerHTML"in g)g.innerHTML=e;else{for((ig=ig||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ig.firstChild;g.firstChild;)g.removeChild(g.firstChild);for(;e.firstChild;)g.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(g,e,t,I){MSApp.execUnsafeLocalFunction((function(){return rg(g,e)}))}:rg);function sg(g,e){if(e){var t=g.firstChild;if(t&&t===g.lastChild&&3===t.nodeType)return void(t.nodeValue=e)}g.textContent=e}var Ag={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dg=["Webkit","ms","Moz","O"];function ug(g,e,t){return null==e||"boolean"===typeof e||""===e?"":t||"number"!==typeof e||0===e||Ag.hasOwnProperty(g)&&Ag[g]?(""+e).trim():e+"px"}function mg(g,e){for(var t in g=g.style,e)if(e.hasOwnProperty(t)){var I=0===t.indexOf("--"),n=ug(t,e[t],I);"float"===t&&(t="cssFloat"),I?g.setProperty(t,n):g[t]=n}}Object.keys(Ag).forEach((function(g){dg.forEach((function(e){e=e+g.charAt(0).toUpperCase()+g.substring(1),Ag[e]=Ag[g]}))}));var hg=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function bg(g,e){if(e){if(hg[g]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(C(137,g));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(C(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(C(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(C(62))}}function Zg(g,e){if(-1===g.indexOf("-"))return"string"===typeof e.is;switch(g){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pg=null;function Gg(g){return(g=g.target||g.srcElement||window).correspondingUseElement&&(g=g.correspondingUseElement),3===g.nodeType?g.parentNode:g}var yg=null,Bg=null,Sg=null;function fg(g){if(g=Zn(g)){if("function"!==typeof yg)throw Error(C(280));var e=g.stateNode;e&&(e=Gn(e),yg(g.stateNode,g.type,e))}}function Wg(g){Bg?Sg?Sg.push(g):Sg=[g]:Bg=g}function Vg(){if(Bg){var g=Bg,e=Sg;if(Sg=Bg=null,fg(g),e)for(g=0;g<e.length;g++)fg(e[g])}}function vg(g,e){return g(e)}function Rg(){}var Xg=!1;function kg(g,e,t){if(Xg)return g(e,t);Xg=!0;try{return vg(g,e,t)}finally{Xg=!1,(null!==Bg||null!==Sg)&&(Rg(),Vg())}}function Jg(g,e){var t=g.stateNode;if(null===t)return null;var I=Gn(t);if(null===I)return null;t=I[e];g:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(I=!I.disabled)||(I=!("button"===(g=g.type)||"input"===g||"select"===g||"textarea"===g)),g=!I;break g;default:g=!1}if(g)return null;if(t&&"function"!==typeof t)throw Error(C(231,e,typeof t));return t}var Yg=!1;if(r)try{var wg={};Object.defineProperty(wg,"passive",{get:function(){Yg=!0}}),window.addEventListener("test",wg,wg),window.removeEventListener("test",wg,wg)}catch(rg){Yg=!1}function Ng(g,e,t,I,n,C,l,a,o){var i=Array.prototype.slice.call(arguments,3);try{e.apply(t,i)}catch(r){this.onError(r)}}var Hg=!1,Fg=null,Kg=!1,xg=null,Lg={onError:function(g){Hg=!0,Fg=g}};function zg(g,e,t,I,n,C,l,a,o){Hg=!1,Fg=null,Ng.apply(Lg,arguments)}function Eg(g){var e=g,t=g;if(g.alternate)for(;e.return;)e=e.return;else{g=e;do{0!==(4098&(e=g).flags)&&(t=e.return),g=e.return}while(g)}return 3===e.tag?t:null}function Mg(g){if(13===g.tag){var e=g.memoizedState;if(null===e&&(null!==(g=g.alternate)&&(e=g.memoizedState)),null!==e)return e.dehydrated}return null}function Ug(g){if(Eg(g)!==g)throw Error(C(188))}function jg(g){return null!==(g=function(g){var e=g.alternate;if(!e){if(null===(e=Eg(g)))throw Error(C(188));return e!==g?null:g}for(var t=g,I=e;;){var n=t.return;if(null===n)break;var l=n.alternate;if(null===l){if(null!==(I=n.return)){t=I;continue}break}if(n.child===l.child){for(l=n.child;l;){if(l===t)return Ug(n),g;if(l===I)return Ug(n),e;l=l.sibling}throw Error(C(188))}if(t.return!==I.return)t=n,I=l;else{for(var a=!1,o=n.child;o;){if(o===t){a=!0,t=n,I=l;break}if(o===I){a=!0,I=n,t=l;break}o=o.sibling}if(!a){for(o=l.child;o;){if(o===t){a=!0,t=l,I=n;break}if(o===I){a=!0,I=l,t=n;break}o=o.sibling}if(!a)throw Error(C(189))}}if(t.alternate!==I)throw Error(C(190))}if(3!==t.tag)throw Error(C(188));return t.stateNode.current===t?g:e}(g))?Qg(g):null}function Qg(g){if(5===g.tag||6===g.tag)return g;for(g=g.child;null!==g;){var e=Qg(g);if(null!==e)return e;g=g.sibling}return null}var Dg=n.unstable_scheduleCallback,Tg=n.unstable_cancelCallback,Pg=n.unstable_shouldYield,Og=n.unstable_requestPaint,qg=n.unstable_now,_g=n.unstable_getCurrentPriorityLevel,$g=n.unstable_ImmediatePriority,ge=n.unstable_UserBlockingPriority,ee=n.unstable_NormalPriority,te=n.unstable_LowPriority,Ie=n.unstable_IdlePriority,ne=null,Ce=null;var le=Math.clz32?Math.clz32:function(g){return g>>>=0,0===g?32:31-(ae(g)/oe|0)|0},ae=Math.log,oe=Math.LN2;var ie=64,re=4194304;function ce(g){switch(g&-g){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&g;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&g;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return g}}function se(g,e){var t=g.pendingLanes;if(0===t)return 0;var I=0,n=g.suspendedLanes,C=g.pingedLanes,l=268435455&t;if(0!==l){var a=l&~n;0!==a?I=ce(a):0!==(C&=l)&&(I=ce(C))}else 0!==(l=t&~n)?I=ce(l):0!==C&&(I=ce(C));if(0===I)return 0;if(0!==e&&e!==I&&0===(e&n)&&((n=I&-I)>=(C=e&-e)||16===n&&0!==(4194240&C)))return e;if(0!==(4&I)&&(I|=16&t),0!==(e=g.entangledLanes))for(g=g.entanglements,e&=I;0<e;)n=1<<(t=31-le(e)),I|=g[t],e&=~n;return I}function Ae(g,e){switch(g){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function de(g){return 0!==(g=-1073741825&g.pendingLanes)?g:1073741824&g?1073741824:0}function ue(){var g=ie;return 0===(4194240&(ie<<=1))&&(ie=64),g}function me(g){for(var e=[],t=0;31>t;t++)e.push(g);return e}function he(g,e,t){g.pendingLanes|=e,536870912!==e&&(g.suspendedLanes=0,g.pingedLanes=0),(g=g.eventTimes)[e=31-le(e)]=t}function be(g,e){var t=g.entangledLanes|=e;for(g=g.entanglements;t;){var I=31-le(t),n=1<<I;n&e|g[I]&e&&(g[I]|=e),t&=~n}}var Ze=0;function pe(g){return 1<(g&=-g)?4<g?0!==(268435455&g)?16:536870912:4:1}var Ge,ye,Be,Se,fe,We=!1,Ve=[],ve=null,Re=null,Xe=null,ke=new Map,Je=new Map,Ye=[],we="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ne(g,e){switch(g){case"focusin":case"focusout":ve=null;break;case"dragenter":case"dragleave":Re=null;break;case"mouseover":case"mouseout":Xe=null;break;case"pointerover":case"pointerout":ke.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Je.delete(e.pointerId)}}function He(g,e,t,I,n,C){return null===g||g.nativeEvent!==C?(g={blockedOn:e,domEventName:t,eventSystemFlags:I,nativeEvent:C,targetContainers:[n]},null!==e&&(null!==(e=Zn(e))&&ye(e)),g):(g.eventSystemFlags|=I,e=g.targetContainers,null!==n&&-1===e.indexOf(n)&&e.push(n),g)}function Fe(g){var e=bn(g.target);if(null!==e){var t=Eg(e);if(null!==t)if(13===(e=t.tag)){if(null!==(e=Mg(t)))return g.blockedOn=e,void fe(g.priority,(function(){Be(t)}))}else if(3===e&&t.stateNode.current.memoizedState.isDehydrated)return void(g.blockedOn=3===t.tag?t.stateNode.containerInfo:null)}g.blockedOn=null}function Ke(g){if(null!==g.blockedOn)return!1;for(var e=g.targetContainers;0<e.length;){var t=Pe(g.domEventName,g.eventSystemFlags,e[0],g.nativeEvent);if(null!==t)return null!==(e=Zn(t))&&ye(e),g.blockedOn=t,!1;var I=new(t=g.nativeEvent).constructor(t.type,t);pg=I,t.target.dispatchEvent(I),pg=null,e.shift()}return!0}function xe(g,e,t){Ke(g)&&t.delete(e)}function Le(){We=!1,null!==ve&&Ke(ve)&&(ve=null),null!==Re&&Ke(Re)&&(Re=null),null!==Xe&&Ke(Xe)&&(Xe=null),ke.forEach(xe),Je.forEach(xe)}function ze(g,e){g.blockedOn===e&&(g.blockedOn=null,We||(We=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Le)))}function Ee(g){function e(e){return ze(e,g)}if(0<Ve.length){ze(Ve[0],g);for(var t=1;t<Ve.length;t++){var I=Ve[t];I.blockedOn===g&&(I.blockedOn=null)}}for(null!==ve&&ze(ve,g),null!==Re&&ze(Re,g),null!==Xe&&ze(Xe,g),ke.forEach(e),Je.forEach(e),t=0;t<Ye.length;t++)(I=Ye[t]).blockedOn===g&&(I.blockedOn=null);for(;0<Ye.length&&null===(t=Ye[0]).blockedOn;)Fe(t),null===t.blockedOn&&Ye.shift()}var Me=p.ReactCurrentBatchConfig,Ue=!0;function je(g,e,t,I){var n=Ze,C=Me.transition;Me.transition=null;try{Ze=1,De(g,e,t,I)}finally{Ze=n,Me.transition=C}}function Qe(g,e,t,I){var n=Ze,C=Me.transition;Me.transition=null;try{Ze=4,De(g,e,t,I)}finally{Ze=n,Me.transition=C}}function De(g,e,t,I){if(Ue){var n=Pe(g,e,t,I);if(null===n)MI(g,e,I,Te,t),Ne(g,I);else if(function(g,e,t,I,n){switch(e){case"focusin":return ve=He(ve,g,e,t,I,n),!0;case"dragenter":return Re=He(Re,g,e,t,I,n),!0;case"mouseover":return Xe=He(Xe,g,e,t,I,n),!0;case"pointerover":var C=n.pointerId;return ke.set(C,He(ke.get(C)||null,g,e,t,I,n)),!0;case"gotpointercapture":return C=n.pointerId,Je.set(C,He(Je.get(C)||null,g,e,t,I,n)),!0}return!1}(n,g,e,t,I))I.stopPropagation();else if(Ne(g,I),4&e&&-1<we.indexOf(g)){for(;null!==n;){var C=Zn(n);if(null!==C&&Ge(C),null===(C=Pe(g,e,t,I))&&MI(g,e,I,Te,t),C===n)break;n=C}null!==n&&I.stopPropagation()}else MI(g,e,I,null,t)}}var Te=null;function Pe(g,e,t,I){if(Te=null,null!==(g=bn(g=Gg(I))))if(null===(e=Eg(g)))g=null;else if(13===(t=e.tag)){if(null!==(g=Mg(e)))return g;g=null}else if(3===t){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;g=null}else e!==g&&(g=null);return Te=g,null}function Oe(g){switch(g){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_g()){case $g:return 1;case ge:return 4;case ee:case te:return 16;case Ie:return 536870912;default:return 16}default:return 16}}var qe=null,_e=null,$e=null;function gt(){if($e)return $e;var g,e,t=_e,I=t.length,n="value"in qe?qe.value:qe.textContent,C=n.length;for(g=0;g<I&&t[g]===n[g];g++);var l=I-g;for(e=1;e<=l&&t[I-e]===n[C-e];e++);return $e=n.slice(g,1<e?1-e:void 0)}function et(g){var e=g.keyCode;return"charCode"in g?0===(g=g.charCode)&&13===e&&(g=13):g=e,10===g&&(g=13),32<=g||13===g?g:0}function tt(){return!0}function It(){return!1}function nt(g){function e(e,t,I,n,C){for(var l in this._reactName=e,this._targetInst=I,this.type=t,this.nativeEvent=n,this.target=C,this.currentTarget=null,g)g.hasOwnProperty(l)&&(e=g[l],this[l]=e?e(n):n[l]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?tt:It,this.isPropagationStopped=It,this}return F(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():"unknown"!==typeof g.returnValue&&(g.returnValue=!1),this.isDefaultPrevented=tt)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():"unknown"!==typeof g.cancelBubble&&(g.cancelBubble=!0),this.isPropagationStopped=tt)},persist:function(){},isPersistent:tt}),e}var Ct,lt,at,ot={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(g){return g.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},it=nt(ot),rt=F({},ot,{view:0,detail:0}),ct=nt(rt),st=F({},rt,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:St,button:0,buttons:0,relatedTarget:function(g){return void 0===g.relatedTarget?g.fromElement===g.srcElement?g.toElement:g.fromElement:g.relatedTarget},movementX:function(g){return"movementX"in g?g.movementX:(g!==at&&(at&&"mousemove"===g.type?(Ct=g.screenX-at.screenX,lt=g.screenY-at.screenY):lt=Ct=0,at=g),Ct)},movementY:function(g){return"movementY"in g?g.movementY:lt}}),At=nt(st),dt=nt(F({},st,{dataTransfer:0})),ut=nt(F({},rt,{relatedTarget:0})),mt=nt(F({},ot,{animationName:0,elapsedTime:0,pseudoElement:0})),ht=F({},ot,{clipboardData:function(g){return"clipboardData"in g?g.clipboardData:window.clipboardData}}),bt=nt(ht),Zt=nt(F({},ot,{data:0})),pt={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Gt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Bt(g){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(g):!!(g=yt[g])&&!!e[g]}function St(){return Bt}var ft=F({},rt,{key:function(g){if(g.key){var e=pt[g.key]||g.key;if("Unidentified"!==e)return e}return"keypress"===g.type?13===(g=et(g))?"Enter":String.fromCharCode(g):"keydown"===g.type||"keyup"===g.type?Gt[g.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:St,charCode:function(g){return"keypress"===g.type?et(g):0},keyCode:function(g){return"keydown"===g.type||"keyup"===g.type?g.keyCode:0},which:function(g){return"keypress"===g.type?et(g):"keydown"===g.type||"keyup"===g.type?g.keyCode:0}}),Wt=nt(ft),Vt=nt(F({},st,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),vt=nt(F({},rt,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:St})),Rt=nt(F({},ot,{propertyName:0,elapsedTime:0,pseudoElement:0})),Xt=F({},st,{deltaX:function(g){return"deltaX"in g?g.deltaX:"wheelDeltaX"in g?-g.wheelDeltaX:0},deltaY:function(g){return"deltaY"in g?g.deltaY:"wheelDeltaY"in g?-g.wheelDeltaY:"wheelDelta"in g?-g.wheelDelta:0},deltaZ:0,deltaMode:0}),kt=nt(Xt),Jt=[9,13,27,32],Yt=r&&"CompositionEvent"in window,wt=null;r&&"documentMode"in document&&(wt=document.documentMode);var Nt=r&&"TextEvent"in window&&!wt,Ht=r&&(!Yt||wt&&8<wt&&11>=wt),Ft=String.fromCharCode(32),Kt=!1;function xt(g,e){switch(g){case"keyup":return-1!==Jt.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Lt(g){return"object"===typeof(g=g.detail)&&"data"in g?g.data:null}var zt=!1;var Et={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mt(g){var e=g&&g.nodeName&&g.nodeName.toLowerCase();return"input"===e?!!Et[g.type]:"textarea"===e}function Ut(g,e,t,I){Wg(I),0<(e=jI(e,"onChange")).length&&(t=new it("onChange","change",null,t,I),g.push({event:t,listeners:e}))}var jt=null,Qt=null;function Dt(g){FI(g,0)}function Tt(g){if(D(pn(g)))return g}function Pt(g,e){if("change"===g)return e}var Ot=!1;if(r){var qt;if(r){var _t="oninput"in document;if(!_t){var $t=document.createElement("div");$t.setAttribute("oninput","return;"),_t="function"===typeof $t.oninput}qt=_t}else qt=!1;Ot=qt&&(!document.documentMode||9<document.documentMode)}function gI(){jt&&(jt.detachEvent("onpropertychange",eI),Qt=jt=null)}function eI(g){if("value"===g.propertyName&&Tt(Qt)){var e=[];Ut(e,Qt,g,Gg(g)),kg(Dt,e)}}function tI(g,e,t){"focusin"===g?(gI(),Qt=t,(jt=e).attachEvent("onpropertychange",eI)):"focusout"===g&&gI()}function II(g){if("selectionchange"===g||"keyup"===g||"keydown"===g)return Tt(Qt)}function nI(g,e){if("click"===g)return Tt(e)}function CI(g,e){if("input"===g||"change"===g)return Tt(e)}var lI="function"===typeof Object.is?Object.is:function(g,e){return g===e&&(0!==g||1/g===1/e)||g!==g&&e!==e};function aI(g,e){if(lI(g,e))return!0;if("object"!==typeof g||null===g||"object"!==typeof e||null===e)return!1;var t=Object.keys(g),I=Object.keys(e);if(t.length!==I.length)return!1;for(I=0;I<t.length;I++){var n=t[I];if(!c.call(e,n)||!lI(g[n],e[n]))return!1}return!0}function oI(g){for(;g&&g.firstChild;)g=g.firstChild;return g}function iI(g,e){var t,I=oI(g);for(g=0;I;){if(3===I.nodeType){if(t=g+I.textContent.length,g<=e&&t>=e)return{node:I,offset:e-g};g=t}g:{for(;I;){if(I.nextSibling){I=I.nextSibling;break g}I=I.parentNode}I=void 0}I=oI(I)}}function rI(g,e){return!(!g||!e)&&(g===e||(!g||3!==g.nodeType)&&(e&&3===e.nodeType?rI(g,e.parentNode):"contains"in g?g.contains(e):!!g.compareDocumentPosition&&!!(16&g.compareDocumentPosition(e))))}function cI(){for(var g=window,e=T();e instanceof g.HTMLIFrameElement;){try{var t="string"===typeof e.contentWindow.location.href}catch(I){t=!1}if(!t)break;e=T((g=e.contentWindow).document)}return e}function sI(g){var e=g&&g.nodeName&&g.nodeName.toLowerCase();return e&&("input"===e&&("text"===g.type||"search"===g.type||"tel"===g.type||"url"===g.type||"password"===g.type)||"textarea"===e||"true"===g.contentEditable)}function AI(g){var e=cI(),t=g.focusedElem,I=g.selectionRange;if(e!==t&&t&&t.ownerDocument&&rI(t.ownerDocument.documentElement,t)){if(null!==I&&sI(t))if(e=I.start,void 0===(g=I.end)&&(g=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(g,t.value.length);else if((g=(e=t.ownerDocument||document)&&e.defaultView||window).getSelection){g=g.getSelection();var n=t.textContent.length,C=Math.min(I.start,n);I=void 0===I.end?C:Math.min(I.end,n),!g.extend&&C>I&&(n=I,I=C,C=n),n=iI(t,C);var l=iI(t,I);n&&l&&(1!==g.rangeCount||g.anchorNode!==n.node||g.anchorOffset!==n.offset||g.focusNode!==l.node||g.focusOffset!==l.offset)&&((e=e.createRange()).setStart(n.node,n.offset),g.removeAllRanges(),C>I?(g.addRange(e),g.extend(l.node,l.offset)):(e.setEnd(l.node,l.offset),g.addRange(e)))}for(e=[],g=t;g=g.parentNode;)1===g.nodeType&&e.push({element:g,left:g.scrollLeft,top:g.scrollTop});for("function"===typeof t.focus&&t.focus(),t=0;t<e.length;t++)(g=e[t]).element.scrollLeft=g.left,g.element.scrollTop=g.top}}var dI=r&&"documentMode"in document&&11>=document.documentMode,uI=null,mI=null,hI=null,bI=!1;function ZI(g,e,t){var I=t.window===t?t.document:9===t.nodeType?t:t.ownerDocument;bI||null==uI||uI!==T(I)||("selectionStart"in(I=uI)&&sI(I)?I={start:I.selectionStart,end:I.selectionEnd}:I={anchorNode:(I=(I.ownerDocument&&I.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:I.anchorOffset,focusNode:I.focusNode,focusOffset:I.focusOffset},hI&&aI(hI,I)||(hI=I,0<(I=jI(mI,"onSelect")).length&&(e=new it("onSelect","select",null,e,t),g.push({event:e,listeners:I}),e.target=uI)))}function pI(g,e){var t={};return t[g.toLowerCase()]=e.toLowerCase(),t["Webkit"+g]="webkit"+e,t["Moz"+g]="moz"+e,t}var GI={animationend:pI("Animation","AnimationEnd"),animationiteration:pI("Animation","AnimationIteration"),animationstart:pI("Animation","AnimationStart"),transitionend:pI("Transition","TransitionEnd")},yI={},BI={};function SI(g){if(yI[g])return yI[g];if(!GI[g])return g;var e,t=GI[g];for(e in t)if(t.hasOwnProperty(e)&&e in BI)return yI[g]=t[e];return g}r&&(BI=document.createElement("div").style,"AnimationEvent"in window||(delete GI.animationend.animation,delete GI.animationiteration.animation,delete GI.animationstart.animation),"TransitionEvent"in window||delete GI.transitionend.transition);var fI=SI("animationend"),WI=SI("animationiteration"),VI=SI("animationstart"),vI=SI("transitionend"),RI=new Map,XI="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function kI(g,e){RI.set(g,e),o(e,[g])}for(var JI=0;JI<XI.length;JI++){var YI=XI[JI];kI(YI.toLowerCase(),"on"+(YI[0].toUpperCase()+YI.slice(1)))}kI(fI,"onAnimationEnd"),kI(WI,"onAnimationIteration"),kI(VI,"onAnimationStart"),kI("dblclick","onDoubleClick"),kI("focusin","onFocus"),kI("focusout","onBlur"),kI(vI,"onTransitionEnd"),i("onMouseEnter",["mouseout","mouseover"]),i("onMouseLeave",["mouseout","mouseover"]),i("onPointerEnter",["pointerout","pointerover"]),i("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wI="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),NI=new Set("cancel close invalid load scroll toggle".split(" ").concat(wI));function HI(g,e,t){var I=g.type||"unknown-event";g.currentTarget=t,function(g,e,t,I,n,l,a,o,i){if(zg.apply(this,arguments),Hg){if(!Hg)throw Error(C(198));var r=Fg;Hg=!1,Fg=null,Kg||(Kg=!0,xg=r)}}(I,e,void 0,g),g.currentTarget=null}function FI(g,e){e=0!==(4&e);for(var t=0;t<g.length;t++){var I=g[t],n=I.event;I=I.listeners;g:{var C=void 0;if(e)for(var l=I.length-1;0<=l;l--){var a=I[l],o=a.instance,i=a.currentTarget;if(a=a.listener,o!==C&&n.isPropagationStopped())break g;HI(n,a,i),C=o}else for(l=0;l<I.length;l++){if(o=(a=I[l]).instance,i=a.currentTarget,a=a.listener,o!==C&&n.isPropagationStopped())break g;HI(n,a,i),C=o}}}if(Kg)throw g=xg,Kg=!1,xg=null,g}function KI(g,e){var t=e[un];void 0===t&&(t=e[un]=new Set);var I=g+"__bubble";t.has(I)||(EI(e,g,2,!1),t.add(I))}function xI(g,e,t){var I=0;e&&(I|=4),EI(t,g,I,e)}var LI="_reactListening"+Math.random().toString(36).slice(2);function zI(g){if(!g[LI]){g[LI]=!0,l.forEach((function(e){"selectionchange"!==e&&(NI.has(e)||xI(e,!1,g),xI(e,!0,g))}));var e=9===g.nodeType?g:g.ownerDocument;null===e||e[LI]||(e[LI]=!0,xI("selectionchange",!1,e))}}function EI(g,e,t,I){switch(Oe(e)){case 1:var n=je;break;case 4:n=Qe;break;default:n=De}t=n.bind(null,e,t,g),n=void 0,!Yg||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(n=!0),I?void 0!==n?g.addEventListener(e,t,{capture:!0,passive:n}):g.addEventListener(e,t,!0):void 0!==n?g.addEventListener(e,t,{passive:n}):g.addEventListener(e,t,!1)}function MI(g,e,t,I,n){var C=I;if(0===(1&e)&&0===(2&e)&&null!==I)g:for(;;){if(null===I)return;var l=I.tag;if(3===l||4===l){var a=I.stateNode.containerInfo;if(a===n||8===a.nodeType&&a.parentNode===n)break;if(4===l)for(l=I.return;null!==l;){var o=l.tag;if((3===o||4===o)&&((o=l.stateNode.containerInfo)===n||8===o.nodeType&&o.parentNode===n))return;l=l.return}for(;null!==a;){if(null===(l=bn(a)))return;if(5===(o=l.tag)||6===o){I=C=l;continue g}a=a.parentNode}}I=I.return}kg((function(){var I=C,n=Gg(t),l=[];g:{var a=RI.get(g);if(void 0!==a){var o=it,i=g;switch(g){case"keypress":if(0===et(t))break g;case"keydown":case"keyup":o=Wt;break;case"focusin":i="focus",o=ut;break;case"focusout":i="blur",o=ut;break;case"beforeblur":case"afterblur":o=ut;break;case"click":if(2===t.button)break g;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":o=At;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":o=dt;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":o=vt;break;case fI:case WI:case VI:o=mt;break;case vI:o=Rt;break;case"scroll":o=ct;break;case"wheel":o=kt;break;case"copy":case"cut":case"paste":o=bt;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":o=Vt}var r=0!==(4&e),c=!r&&"scroll"===g,s=r?null!==a?a+"Capture":null:a;r=[];for(var A,d=I;null!==d;){var u=(A=d).stateNode;if(5===A.tag&&null!==u&&(A=u,null!==s&&(null!=(u=Jg(d,s))&&r.push(UI(d,u,A)))),c)break;d=d.return}0<r.length&&(a=new o(a,i,null,t,n),l.push({event:a,listeners:r}))}}if(0===(7&e)){if(o="mouseout"===g||"pointerout"===g,(!(a="mouseover"===g||"pointerover"===g)||t===pg||!(i=t.relatedTarget||t.fromElement)||!bn(i)&&!i[dn])&&(o||a)&&(a=n.window===n?n:(a=n.ownerDocument)?a.defaultView||a.parentWindow:window,o?(o=I,null!==(i=(i=t.relatedTarget||t.toElement)?bn(i):null)&&(i!==(c=Eg(i))||5!==i.tag&&6!==i.tag)&&(i=null)):(o=null,i=I),o!==i)){if(r=At,u="onMouseLeave",s="onMouseEnter",d="mouse","pointerout"!==g&&"pointerover"!==g||(r=Vt,u="onPointerLeave",s="onPointerEnter",d="pointer"),c=null==o?a:pn(o),A=null==i?a:pn(i),(a=new r(u,d+"leave",o,t,n)).target=c,a.relatedTarget=A,u=null,bn(n)===I&&((r=new r(s,d+"enter",i,t,n)).target=A,r.relatedTarget=c,u=r),c=u,o&&i)g:{for(s=i,d=0,A=r=o;A;A=QI(A))d++;for(A=0,u=s;u;u=QI(u))A++;for(;0<d-A;)r=QI(r),d--;for(;0<A-d;)s=QI(s),A--;for(;d--;){if(r===s||null!==s&&r===s.alternate)break g;r=QI(r),s=QI(s)}r=null}else r=null;null!==o&&DI(l,a,o,r,!1),null!==i&&null!==c&&DI(l,c,i,r,!0)}if("select"===(o=(a=I?pn(I):window).nodeName&&a.nodeName.toLowerCase())||"input"===o&&"file"===a.type)var m=Pt;else if(Mt(a))if(Ot)m=CI;else{m=II;var h=tI}else(o=a.nodeName)&&"input"===o.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=nI);switch(m&&(m=m(g,I))?Ut(l,m,t,n):(h&&h(g,a,I),"focusout"===g&&(h=a._wrapperState)&&h.controlled&&"number"===a.type&&gg(a,"number",a.value)),h=I?pn(I):window,g){case"focusin":(Mt(h)||"true"===h.contentEditable)&&(uI=h,mI=I,hI=null);break;case"focusout":hI=mI=uI=null;break;case"mousedown":bI=!0;break;case"contextmenu":case"mouseup":case"dragend":bI=!1,ZI(l,t,n);break;case"selectionchange":if(dI)break;case"keydown":case"keyup":ZI(l,t,n)}var b;if(Yt)g:{switch(g){case"compositionstart":var Z="onCompositionStart";break g;case"compositionend":Z="onCompositionEnd";break g;case"compositionupdate":Z="onCompositionUpdate";break g}Z=void 0}else zt?xt(g,t)&&(Z="onCompositionEnd"):"keydown"===g&&229===t.keyCode&&(Z="onCompositionStart");Z&&(Ht&&"ko"!==t.locale&&(zt||"onCompositionStart"!==Z?"onCompositionEnd"===Z&&zt&&(b=gt()):(_e="value"in(qe=n)?qe.value:qe.textContent,zt=!0)),0<(h=jI(I,Z)).length&&(Z=new Zt(Z,g,null,t,n),l.push({event:Z,listeners:h}),b?Z.data=b:null!==(b=Lt(t))&&(Z.data=b))),(b=Nt?function(g,e){switch(g){case"compositionend":return Lt(e);case"keypress":return 32!==e.which?null:(Kt=!0,Ft);case"textInput":return(g=e.data)===Ft&&Kt?null:g;default:return null}}(g,t):function(g,e){if(zt)return"compositionend"===g||!Yt&&xt(g,e)?(g=gt(),$e=_e=qe=null,zt=!1,g):null;switch(g){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Ht&&"ko"!==e.locale?null:e.data}}(g,t))&&(0<(I=jI(I,"onBeforeInput")).length&&(n=new Zt("onBeforeInput","beforeinput",null,t,n),l.push({event:n,listeners:I}),n.data=b))}FI(l,e)}))}function UI(g,e,t){return{instance:g,listener:e,currentTarget:t}}function jI(g,e){for(var t=e+"Capture",I=[];null!==g;){var n=g,C=n.stateNode;5===n.tag&&null!==C&&(n=C,null!=(C=Jg(g,t))&&I.unshift(UI(g,C,n)),null!=(C=Jg(g,e))&&I.push(UI(g,C,n))),g=g.return}return I}function QI(g){if(null===g)return null;do{g=g.return}while(g&&5!==g.tag);return g||null}function DI(g,e,t,I,n){for(var C=e._reactName,l=[];null!==t&&t!==I;){var a=t,o=a.alternate,i=a.stateNode;if(null!==o&&o===I)break;5===a.tag&&null!==i&&(a=i,n?null!=(o=Jg(t,C))&&l.unshift(UI(t,o,a)):n||null!=(o=Jg(t,C))&&l.push(UI(t,o,a))),t=t.return}0!==l.length&&g.push({event:e,listeners:l})}var TI=/\r\n?/g,PI=/\u0000|\uFFFD/g;function OI(g){return("string"===typeof g?g:""+g).replace(TI,"\n").replace(PI,"")}function qI(g,e,t){if(e=OI(e),OI(g)!==e&&t)throw Error(C(425))}function _I(){}var $I=null,gn=null;function en(g,e){return"textarea"===g||"noscript"===g||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var tn="function"===typeof setTimeout?setTimeout:void 0,In="function"===typeof clearTimeout?clearTimeout:void 0,nn="function"===typeof Promise?Promise:void 0,Cn="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof nn?function(g){return nn.resolve(null).then(g).catch(ln)}:tn;function ln(g){setTimeout((function(){throw g}))}function an(g,e){var t=e,I=0;do{var n=t.nextSibling;if(g.removeChild(t),n&&8===n.nodeType)if("/$"===(t=n.data)){if(0===I)return g.removeChild(n),void Ee(e);I--}else"$"!==t&&"$?"!==t&&"$!"!==t||I++;t=n}while(t);Ee(e)}function on(g){for(;null!=g;g=g.nextSibling){var e=g.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=g.data)||"$!"===e||"$?"===e)break;if("/$"===e)return null}}return g}function rn(g){g=g.previousSibling;for(var e=0;g;){if(8===g.nodeType){var t=g.data;if("$"===t||"$!"===t||"$?"===t){if(0===e)return g;e--}else"/$"===t&&e++}g=g.previousSibling}return null}var cn=Math.random().toString(36).slice(2),sn="__reactFiber$"+cn,An="__reactProps$"+cn,dn="__reactContainer$"+cn,un="__reactEvents$"+cn,mn="__reactListeners$"+cn,hn="__reactHandles$"+cn;function bn(g){var e=g[sn];if(e)return e;for(var t=g.parentNode;t;){if(e=t[dn]||t[sn]){if(t=e.alternate,null!==e.child||null!==t&&null!==t.child)for(g=rn(g);null!==g;){if(t=g[sn])return t;g=rn(g)}return e}t=(g=t).parentNode}return null}function Zn(g){return!(g=g[sn]||g[dn])||5!==g.tag&&6!==g.tag&&13!==g.tag&&3!==g.tag?null:g}function pn(g){if(5===g.tag||6===g.tag)return g.stateNode;throw Error(C(33))}function Gn(g){return g[An]||null}var yn=[],Bn=-1;function Sn(g){return{current:g}}function fn(g){0>Bn||(g.current=yn[Bn],yn[Bn]=null,Bn--)}function Wn(g,e){Bn++,yn[Bn]=g.current,g.current=e}var Vn={},vn=Sn(Vn),Rn=Sn(!1),Xn=Vn;function kn(g,e){var t=g.type.contextTypes;if(!t)return Vn;var I=g.stateNode;if(I&&I.__reactInternalMemoizedUnmaskedChildContext===e)return I.__reactInternalMemoizedMaskedChildContext;var n,C={};for(n in t)C[n]=e[n];return I&&((g=g.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,g.__reactInternalMemoizedMaskedChildContext=C),C}function Jn(g){return null!==(g=g.childContextTypes)&&void 0!==g}function Yn(){fn(Rn),fn(vn)}function wn(g,e,t){if(vn.current!==Vn)throw Error(C(168));Wn(vn,e),Wn(Rn,t)}function Nn(g,e,t){var I=g.stateNode;if(e=e.childContextTypes,"function"!==typeof I.getChildContext)return t;for(var n in I=I.getChildContext())if(!(n in e))throw Error(C(108,M(g)||"Unknown",n));return F({},t,I)}function Hn(g){return g=(g=g.stateNode)&&g.__reactInternalMemoizedMergedChildContext||Vn,Xn=vn.current,Wn(vn,g),Wn(Rn,Rn.current),!0}function Fn(g,e,t){var I=g.stateNode;if(!I)throw Error(C(169));t?(g=Nn(g,e,Xn),I.__reactInternalMemoizedMergedChildContext=g,fn(Rn),fn(vn),Wn(vn,g)):fn(Rn),Wn(Rn,t)}var Kn=null,xn=!1,Ln=!1;function zn(g){null===Kn?Kn=[g]:Kn.push(g)}function En(){if(!Ln&&null!==Kn){Ln=!0;var g=0,e=Ze;try{var t=Kn;for(Ze=1;g<t.length;g++){var I=t[g];do{I=I(!0)}while(null!==I)}Kn=null,xn=!1}catch(n){throw null!==Kn&&(Kn=Kn.slice(g+1)),Dg($g,En),n}finally{Ze=e,Ln=!1}}return null}var Mn=[],Un=0,jn=null,Qn=0,Dn=[],Tn=0,Pn=null,On=1,qn="";function _n(g,e){Mn[Un++]=Qn,Mn[Un++]=jn,jn=g,Qn=e}function $n(g,e,t){Dn[Tn++]=On,Dn[Tn++]=qn,Dn[Tn++]=Pn,Pn=g;var I=On;g=qn;var n=32-le(I)-1;I&=~(1<<n),t+=1;var C=32-le(e)+n;if(30<C){var l=n-n%5;C=(I&(1<<l)-1).toString(32),I>>=l,n-=l,On=1<<32-le(e)+n|t<<n|I,qn=C+g}else On=1<<C|t<<n|I,qn=g}function gC(g){null!==g.return&&(_n(g,1),$n(g,1,0))}function eC(g){for(;g===jn;)jn=Mn[--Un],Mn[Un]=null,Qn=Mn[--Un],Mn[Un]=null;for(;g===Pn;)Pn=Dn[--Tn],Dn[Tn]=null,qn=Dn[--Tn],Dn[Tn]=null,On=Dn[--Tn],Dn[Tn]=null}var tC=null,IC=null,nC=!1,CC=null;function lC(g,e){var t=ki(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=g,null===(e=g.deletions)?(g.deletions=[t],g.flags|=16):e.push(t)}function aC(g,e){switch(g.tag){case 5:var t=g.type;return null!==(e=1!==e.nodeType||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(g.stateNode=e,tC=g,IC=on(e.firstChild),!0);case 6:return null!==(e=""===g.pendingProps||3!==e.nodeType?null:e)&&(g.stateNode=e,tC=g,IC=null,!0);case 13:return null!==(e=8!==e.nodeType?null:e)&&(t=null!==Pn?{id:On,overflow:qn}:null,g.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},(t=ki(18,null,null,0)).stateNode=e,t.return=g,g.child=t,tC=g,IC=null,!0);default:return!1}}function oC(g){return 0!==(1&g.mode)&&0===(128&g.flags)}function iC(g){if(nC){var e=IC;if(e){var t=e;if(!aC(g,e)){if(oC(g))throw Error(C(418));e=on(t.nextSibling);var I=tC;e&&aC(g,e)?lC(I,t):(g.flags=-4097&g.flags|2,nC=!1,tC=g)}}else{if(oC(g))throw Error(C(418));g.flags=-4097&g.flags|2,nC=!1,tC=g}}}function rC(g){for(g=g.return;null!==g&&5!==g.tag&&3!==g.tag&&13!==g.tag;)g=g.return;tC=g}function cC(g){if(g!==tC)return!1;if(!nC)return rC(g),nC=!0,!1;var e;if((e=3!==g.tag)&&!(e=5!==g.tag)&&(e="head"!==(e=g.type)&&"body"!==e&&!en(g.type,g.memoizedProps)),e&&(e=IC)){if(oC(g))throw sC(),Error(C(418));for(;e;)lC(g,e),e=on(e.nextSibling)}if(rC(g),13===g.tag){if(!(g=null!==(g=g.memoizedState)?g.dehydrated:null))throw Error(C(317));g:{for(g=g.nextSibling,e=0;g;){if(8===g.nodeType){var t=g.data;if("/$"===t){if(0===e){IC=on(g.nextSibling);break g}e--}else"$"!==t&&"$!"!==t&&"$?"!==t||e++}g=g.nextSibling}IC=null}}else IC=tC?on(g.stateNode.nextSibling):null;return!0}function sC(){for(var g=IC;g;)g=on(g.nextSibling)}function AC(){IC=tC=null,nC=!1}function dC(g){null===CC?CC=[g]:CC.push(g)}var uC=p.ReactCurrentBatchConfig;function mC(g,e,t){if(null!==(g=t.ref)&&"function"!==typeof g&&"object"!==typeof g){if(t._owner){if(t=t._owner){if(1!==t.tag)throw Error(C(309));var I=t.stateNode}if(!I)throw Error(C(147,g));var n=I,l=""+g;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===l?e.ref:(e=function(g){var e=n.refs;null===g?delete e[l]:e[l]=g},e._stringRef=l,e)}if("string"!==typeof g)throw Error(C(284));if(!t._owner)throw Error(C(290,g))}return g}function hC(g,e){throw g=Object.prototype.toString.call(e),Error(C(31,"[object Object]"===g?"object with keys {"+Object.keys(e).join(", ")+"}":g))}function bC(g){return(0,g._init)(g._payload)}function ZC(g){function e(e,t){if(g){var I=e.deletions;null===I?(e.deletions=[t],e.flags|=16):I.push(t)}}function t(t,I){if(!g)return null;for(;null!==I;)e(t,I),I=I.sibling;return null}function I(g,e){for(g=new Map;null!==e;)null!==e.key?g.set(e.key,e):g.set(e.index,e),e=e.sibling;return g}function n(g,e){return(g=Yi(g,e)).index=0,g.sibling=null,g}function l(e,t,I){return e.index=I,g?null!==(I=e.alternate)?(I=I.index)<t?(e.flags|=2,t):I:(e.flags|=2,t):(e.flags|=1048576,t)}function a(e){return g&&null===e.alternate&&(e.flags|=2),e}function o(g,e,t,I){return null===e||6!==e.tag?((e=Fi(t,g.mode,I)).return=g,e):((e=n(e,t)).return=g,e)}function i(g,e,t,I){var C=t.type;return C===B?c(g,e,t.props.children,I,t.key):null!==e&&(e.elementType===C||"object"===typeof C&&null!==C&&C.$$typeof===J&&bC(C)===e.type)?((I=n(e,t.props)).ref=mC(g,e,t),I.return=g,I):((I=wi(t.type,t.key,t.props,null,g.mode,I)).ref=mC(g,e,t),I.return=g,I)}function r(g,e,t,I){return null===e||4!==e.tag||e.stateNode.containerInfo!==t.containerInfo||e.stateNode.implementation!==t.implementation?((e=Ki(t,g.mode,I)).return=g,e):((e=n(e,t.children||[])).return=g,e)}function c(g,e,t,I,C){return null===e||7!==e.tag?((e=Ni(t,g.mode,I,C)).return=g,e):((e=n(e,t)).return=g,e)}function s(g,e,t){if("string"===typeof e&&""!==e||"number"===typeof e)return(e=Fi(""+e,g.mode,t)).return=g,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case G:return(t=wi(e.type,e.key,e.props,null,g.mode,t)).ref=mC(g,null,e),t.return=g,t;case y:return(e=Ki(e,g.mode,t)).return=g,e;case J:return s(g,(0,e._init)(e._payload),t)}if(eg(e)||N(e))return(e=Ni(e,g.mode,t,null)).return=g,e;hC(g,e)}return null}function A(g,e,t,I){var n=null!==e?e.key:null;if("string"===typeof t&&""!==t||"number"===typeof t)return null!==n?null:o(g,e,""+t,I);if("object"===typeof t&&null!==t){switch(t.$$typeof){case G:return t.key===n?i(g,e,t,I):null;case y:return t.key===n?r(g,e,t,I):null;case J:return A(g,e,(n=t._init)(t._payload),I)}if(eg(t)||N(t))return null!==n?null:c(g,e,t,I,null);hC(g,t)}return null}function d(g,e,t,I,n){if("string"===typeof I&&""!==I||"number"===typeof I)return o(e,g=g.get(t)||null,""+I,n);if("object"===typeof I&&null!==I){switch(I.$$typeof){case G:return i(e,g=g.get(null===I.key?t:I.key)||null,I,n);case y:return r(e,g=g.get(null===I.key?t:I.key)||null,I,n);case J:return d(g,e,t,(0,I._init)(I._payload),n)}if(eg(I)||N(I))return c(e,g=g.get(t)||null,I,n,null);hC(e,I)}return null}function u(n,C,a,o){for(var i=null,r=null,c=C,u=C=0,m=null;null!==c&&u<a.length;u++){c.index>u?(m=c,c=null):m=c.sibling;var h=A(n,c,a[u],o);if(null===h){null===c&&(c=m);break}g&&c&&null===h.alternate&&e(n,c),C=l(h,C,u),null===r?i=h:r.sibling=h,r=h,c=m}if(u===a.length)return t(n,c),nC&&_n(n,u),i;if(null===c){for(;u<a.length;u++)null!==(c=s(n,a[u],o))&&(C=l(c,C,u),null===r?i=c:r.sibling=c,r=c);return nC&&_n(n,u),i}for(c=I(n,c);u<a.length;u++)null!==(m=d(c,n,u,a[u],o))&&(g&&null!==m.alternate&&c.delete(null===m.key?u:m.key),C=l(m,C,u),null===r?i=m:r.sibling=m,r=m);return g&&c.forEach((function(g){return e(n,g)})),nC&&_n(n,u),i}function m(n,a,o,i){var r=N(o);if("function"!==typeof r)throw Error(C(150));if(null==(o=r.call(o)))throw Error(C(151));for(var c=r=null,u=a,m=a=0,h=null,b=o.next();null!==u&&!b.done;m++,b=o.next()){u.index>m?(h=u,u=null):h=u.sibling;var Z=A(n,u,b.value,i);if(null===Z){null===u&&(u=h);break}g&&u&&null===Z.alternate&&e(n,u),a=l(Z,a,m),null===c?r=Z:c.sibling=Z,c=Z,u=h}if(b.done)return t(n,u),nC&&_n(n,m),r;if(null===u){for(;!b.done;m++,b=o.next())null!==(b=s(n,b.value,i))&&(a=l(b,a,m),null===c?r=b:c.sibling=b,c=b);return nC&&_n(n,m),r}for(u=I(n,u);!b.done;m++,b=o.next())null!==(b=d(u,n,m,b.value,i))&&(g&&null!==b.alternate&&u.delete(null===b.key?m:b.key),a=l(b,a,m),null===c?r=b:c.sibling=b,c=b);return g&&u.forEach((function(g){return e(n,g)})),nC&&_n(n,m),r}return function g(I,C,l,o){if("object"===typeof l&&null!==l&&l.type===B&&null===l.key&&(l=l.props.children),"object"===typeof l&&null!==l){switch(l.$$typeof){case G:g:{for(var i=l.key,r=C;null!==r;){if(r.key===i){if((i=l.type)===B){if(7===r.tag){t(I,r.sibling),(C=n(r,l.props.children)).return=I,I=C;break g}}else if(r.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===J&&bC(i)===r.type){t(I,r.sibling),(C=n(r,l.props)).ref=mC(I,r,l),C.return=I,I=C;break g}t(I,r);break}e(I,r),r=r.sibling}l.type===B?((C=Ni(l.props.children,I.mode,o,l.key)).return=I,I=C):((o=wi(l.type,l.key,l.props,null,I.mode,o)).ref=mC(I,C,l),o.return=I,I=o)}return a(I);case y:g:{for(r=l.key;null!==C;){if(C.key===r){if(4===C.tag&&C.stateNode.containerInfo===l.containerInfo&&C.stateNode.implementation===l.implementation){t(I,C.sibling),(C=n(C,l.children||[])).return=I,I=C;break g}t(I,C);break}e(I,C),C=C.sibling}(C=Ki(l,I.mode,o)).return=I,I=C}return a(I);case J:return g(I,C,(r=l._init)(l._payload),o)}if(eg(l))return u(I,C,l,o);if(N(l))return m(I,C,l,o);hC(I,l)}return"string"===typeof l&&""!==l||"number"===typeof l?(l=""+l,null!==C&&6===C.tag?(t(I,C.sibling),(C=n(C,l)).return=I,I=C):(t(I,C),(C=Fi(l,I.mode,o)).return=I,I=C),a(I)):t(I,C)}}var pC=ZC(!0),GC=ZC(!1),yC=Sn(null),BC=null,SC=null,fC=null;function WC(){fC=SC=BC=null}function VC(g){var e=yC.current;fn(yC),g._currentValue=e}function vC(g,e,t){for(;null!==g;){var I=g.alternate;if((g.childLanes&e)!==e?(g.childLanes|=e,null!==I&&(I.childLanes|=e)):null!==I&&(I.childLanes&e)!==e&&(I.childLanes|=e),g===t)break;g=g.return}}function RC(g,e){BC=g,fC=SC=null,null!==(g=g.dependencies)&&null!==g.firstContext&&(0!==(g.lanes&e)&&(ba=!0),g.firstContext=null)}function XC(g){var e=g._currentValue;if(fC!==g)if(g={context:g,memoizedValue:e,next:null},null===SC){if(null===BC)throw Error(C(308));SC=g,BC.dependencies={lanes:0,firstContext:g}}else SC=SC.next=g;return e}var kC=null;function JC(g){null===kC?kC=[g]:kC.push(g)}function YC(g,e,t,I){var n=e.interleaved;return null===n?(t.next=t,JC(e)):(t.next=n.next,n.next=t),e.interleaved=t,wC(g,I)}function wC(g,e){g.lanes|=e;var t=g.alternate;for(null!==t&&(t.lanes|=e),t=g,g=g.return;null!==g;)g.childLanes|=e,null!==(t=g.alternate)&&(t.childLanes|=e),t=g,g=g.return;return 3===t.tag?t.stateNode:null}var NC=!1;function HC(g){g.updateQueue={baseState:g.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function FC(g,e){g=g.updateQueue,e.updateQueue===g&&(e.updateQueue={baseState:g.baseState,firstBaseUpdate:g.firstBaseUpdate,lastBaseUpdate:g.lastBaseUpdate,shared:g.shared,effects:g.effects})}function KC(g,e){return{eventTime:g,lane:e,tag:0,payload:null,callback:null,next:null}}function xC(g,e,t){var I=g.updateQueue;if(null===I)return null;if(I=I.shared,0!==(2&vo)){var n=I.pending;return null===n?e.next=e:(e.next=n.next,n.next=e),I.pending=e,wC(g,t)}return null===(n=I.interleaved)?(e.next=e,JC(I)):(e.next=n.next,n.next=e),I.interleaved=e,wC(g,t)}function LC(g,e,t){if(null!==(e=e.updateQueue)&&(e=e.shared,0!==(4194240&t))){var I=e.lanes;t|=I&=g.pendingLanes,e.lanes=t,be(g,t)}}function zC(g,e){var t=g.updateQueue,I=g.alternate;if(null!==I&&t===(I=I.updateQueue)){var n=null,C=null;if(null!==(t=t.firstBaseUpdate)){do{var l={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};null===C?n=C=l:C=C.next=l,t=t.next}while(null!==t);null===C?n=C=e:C=C.next=e}else n=C=e;return t={baseState:I.baseState,firstBaseUpdate:n,lastBaseUpdate:C,shared:I.shared,effects:I.effects},void(g.updateQueue=t)}null===(g=t.lastBaseUpdate)?t.firstBaseUpdate=e:g.next=e,t.lastBaseUpdate=e}function EC(g,e,t,I){var n=g.updateQueue;NC=!1;var C=n.firstBaseUpdate,l=n.lastBaseUpdate,a=n.shared.pending;if(null!==a){n.shared.pending=null;var o=a,i=o.next;o.next=null,null===l?C=i:l.next=i,l=o;var r=g.alternate;null!==r&&((a=(r=r.updateQueue).lastBaseUpdate)!==l&&(null===a?r.firstBaseUpdate=i:a.next=i,r.lastBaseUpdate=o))}if(null!==C){var c=n.baseState;for(l=0,r=i=o=null,a=C;;){var s=a.lane,A=a.eventTime;if((I&s)===s){null!==r&&(r=r.next={eventTime:A,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});g:{var d=g,u=a;switch(s=e,A=t,u.tag){case 1:if("function"===typeof(d=u.payload)){c=d.call(A,c,s);break g}c=d;break g;case 3:d.flags=-65537&d.flags|128;case 0:if(null===(s="function"===typeof(d=u.payload)?d.call(A,c,s):d)||void 0===s)break g;c=F({},c,s);break g;case 2:NC=!0}}null!==a.callback&&0!==a.lane&&(g.flags|=64,null===(s=n.effects)?n.effects=[a]:s.push(a))}else A={eventTime:A,lane:s,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===r?(i=r=A,o=c):r=r.next=A,l|=s;if(null===(a=a.next)){if(null===(a=n.shared.pending))break;a=(s=a).next,s.next=null,n.lastBaseUpdate=s,n.shared.pending=null}}if(null===r&&(o=c),n.baseState=o,n.firstBaseUpdate=i,n.lastBaseUpdate=r,null!==(e=n.shared.interleaved)){n=e;do{l|=n.lane,n=n.next}while(n!==e)}else null===C&&(n.shared.lanes=0);Ho|=l,g.lanes=l,g.memoizedState=c}}function MC(g,e,t){if(g=e.effects,e.effects=null,null!==g)for(e=0;e<g.length;e++){var I=g[e],n=I.callback;if(null!==n){if(I.callback=null,I=t,"function"!==typeof n)throw Error(C(191,n));n.call(I)}}}var UC={},jC=Sn(UC),QC=Sn(UC),DC=Sn(UC);function TC(g){if(g===UC)throw Error(C(174));return g}function PC(g,e){switch(Wn(DC,e),Wn(QC,g),Wn(jC,UC),g=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:og(null,"");break;default:e=og(e=(g=8===g?e.parentNode:e).namespaceURI||null,g=g.tagName)}fn(jC),Wn(jC,e)}function OC(){fn(jC),fn(QC),fn(DC)}function qC(g){TC(DC.current);var e=TC(jC.current),t=og(e,g.type);e!==t&&(Wn(QC,g),Wn(jC,t))}function _C(g){QC.current===g&&(fn(jC),fn(QC))}var $C=Sn(0);function gl(g){for(var e=g;null!==e;){if(13===e.tag){var t=e.memoizedState;if(null!==t&&(null===(t=t.dehydrated)||"$?"===t.data||"$!"===t.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(128&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===g)break;for(;null===e.sibling;){if(null===e.return||e.return===g)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var el=[];function tl(){for(var g=0;g<el.length;g++)el[g]._workInProgressVersionPrimary=null;el.length=0}var Il=p.ReactCurrentDispatcher,nl=p.ReactCurrentBatchConfig,Cl=0,ll=null,al=null,ol=null,il=!1,rl=!1,cl=0,sl=0;function Al(){throw Error(C(321))}function dl(g,e){if(null===e)return!1;for(var t=0;t<e.length&&t<g.length;t++)if(!lI(g[t],e[t]))return!1;return!0}function ul(g,e,t,I,n,l){if(Cl=l,ll=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Il.current=null===g||null===g.memoizedState?_l:$l,g=t(I,n),rl){l=0;do{if(rl=!1,cl=0,25<=l)throw Error(C(301));l+=1,ol=al=null,e.updateQueue=null,Il.current=ga,g=t(I,n)}while(rl)}if(Il.current=ql,e=null!==al&&null!==al.next,Cl=0,ol=al=ll=null,il=!1,e)throw Error(C(300));return g}function ml(){var g=0!==cl;return cl=0,g}function hl(){var g={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ol?ll.memoizedState=ol=g:ol=ol.next=g,ol}function bl(){if(null===al){var g=ll.alternate;g=null!==g?g.memoizedState:null}else g=al.next;var e=null===ol?ll.memoizedState:ol.next;if(null!==e)ol=e,al=g;else{if(null===g)throw Error(C(310));g={memoizedState:(al=g).memoizedState,baseState:al.baseState,baseQueue:al.baseQueue,queue:al.queue,next:null},null===ol?ll.memoizedState=ol=g:ol=ol.next=g}return ol}function Zl(g,e){return"function"===typeof e?e(g):e}function pl(g){var e=bl(),t=e.queue;if(null===t)throw Error(C(311));t.lastRenderedReducer=g;var I=al,n=I.baseQueue,l=t.pending;if(null!==l){if(null!==n){var a=n.next;n.next=l.next,l.next=a}I.baseQueue=n=l,t.pending=null}if(null!==n){l=n.next,I=I.baseState;var o=a=null,i=null,r=l;do{var c=r.lane;if((Cl&c)===c)null!==i&&(i=i.next={lane:0,action:r.action,hasEagerState:r.hasEagerState,eagerState:r.eagerState,next:null}),I=r.hasEagerState?r.eagerState:g(I,r.action);else{var s={lane:c,action:r.action,hasEagerState:r.hasEagerState,eagerState:r.eagerState,next:null};null===i?(o=i=s,a=I):i=i.next=s,ll.lanes|=c,Ho|=c}r=r.next}while(null!==r&&r!==l);null===i?a=I:i.next=o,lI(I,e.memoizedState)||(ba=!0),e.memoizedState=I,e.baseState=a,e.baseQueue=i,t.lastRenderedState=I}if(null!==(g=t.interleaved)){n=g;do{l=n.lane,ll.lanes|=l,Ho|=l,n=n.next}while(n!==g)}else null===n&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Gl(g){var e=bl(),t=e.queue;if(null===t)throw Error(C(311));t.lastRenderedReducer=g;var I=t.dispatch,n=t.pending,l=e.memoizedState;if(null!==n){t.pending=null;var a=n=n.next;do{l=g(l,a.action),a=a.next}while(a!==n);lI(l,e.memoizedState)||(ba=!0),e.memoizedState=l,null===e.baseQueue&&(e.baseState=l),t.lastRenderedState=l}return[l,I]}function yl(){}function Bl(g,e){var t=ll,I=bl(),n=e(),l=!lI(I.memoizedState,n);if(l&&(I.memoizedState=n,ba=!0),I=I.queue,Nl(Wl.bind(null,t,I,g),[g]),I.getSnapshot!==e||l||null!==ol&&1&ol.memoizedState.tag){if(t.flags|=2048,Xl(9,fl.bind(null,t,I,n,e),void 0,null),null===Ro)throw Error(C(349));0!==(30&Cl)||Sl(t,e,n)}return n}function Sl(g,e,t){g.flags|=16384,g={getSnapshot:e,value:t},null===(e=ll.updateQueue)?(e={lastEffect:null,stores:null},ll.updateQueue=e,e.stores=[g]):null===(t=e.stores)?e.stores=[g]:t.push(g)}function fl(g,e,t,I){e.value=t,e.getSnapshot=I,Vl(e)&&vl(g)}function Wl(g,e,t){return t((function(){Vl(e)&&vl(g)}))}function Vl(g){var e=g.getSnapshot;g=g.value;try{var t=e();return!lI(g,t)}catch(I){return!0}}function vl(g){var e=wC(g,1);null!==e&&ti(e,g,1,-1)}function Rl(g){var e=hl();return"function"===typeof g&&(g=g()),e.memoizedState=e.baseState=g,g={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zl,lastRenderedState:g},e.queue=g,g=g.dispatch=Dl.bind(null,ll,g),[e.memoizedState,g]}function Xl(g,e,t,I){return g={tag:g,create:e,destroy:t,deps:I,next:null},null===(e=ll.updateQueue)?(e={lastEffect:null,stores:null},ll.updateQueue=e,e.lastEffect=g.next=g):null===(t=e.lastEffect)?e.lastEffect=g.next=g:(I=t.next,t.next=g,g.next=I,e.lastEffect=g),g}function kl(){return bl().memoizedState}function Jl(g,e,t,I){var n=hl();ll.flags|=g,n.memoizedState=Xl(1|e,t,void 0,void 0===I?null:I)}function Yl(g,e,t,I){var n=bl();I=void 0===I?null:I;var C=void 0;if(null!==al){var l=al.memoizedState;if(C=l.destroy,null!==I&&dl(I,l.deps))return void(n.memoizedState=Xl(e,t,C,I))}ll.flags|=g,n.memoizedState=Xl(1|e,t,C,I)}function wl(g,e){return Jl(8390656,8,g,e)}function Nl(g,e){return Yl(2048,8,g,e)}function Hl(g,e){return Yl(4,2,g,e)}function Fl(g,e){return Yl(4,4,g,e)}function Kl(g,e){return"function"===typeof e?(g=g(),e(g),function(){e(null)}):null!==e&&void 0!==e?(g=g(),e.current=g,function(){e.current=null}):void 0}function xl(g,e,t){return t=null!==t&&void 0!==t?t.concat([g]):null,Yl(4,4,Kl.bind(null,e,g),t)}function Ll(){}function zl(g,e){var t=bl();e=void 0===e?null:e;var I=t.memoizedState;return null!==I&&null!==e&&dl(e,I[1])?I[0]:(t.memoizedState=[g,e],g)}function El(g,e){var t=bl();e=void 0===e?null:e;var I=t.memoizedState;return null!==I&&null!==e&&dl(e,I[1])?I[0]:(g=g(),t.memoizedState=[g,e],g)}function Ml(g,e,t){return 0===(21&Cl)?(g.baseState&&(g.baseState=!1,ba=!0),g.memoizedState=t):(lI(t,e)||(t=ue(),ll.lanes|=t,Ho|=t,g.baseState=!0),e)}function Ul(g,e){var t=Ze;Ze=0!==t&&4>t?t:4,g(!0);var I=nl.transition;nl.transition={};try{g(!1),e()}finally{Ze=t,nl.transition=I}}function jl(){return bl().memoizedState}function Ql(g,e,t){var I=ei(g);if(t={lane:I,action:t,hasEagerState:!1,eagerState:null,next:null},Tl(g))Pl(e,t);else if(null!==(t=YC(g,e,t,I))){ti(t,g,I,gi()),Ol(t,e,I)}}function Dl(g,e,t){var I=ei(g),n={lane:I,action:t,hasEagerState:!1,eagerState:null,next:null};if(Tl(g))Pl(e,n);else{var C=g.alternate;if(0===g.lanes&&(null===C||0===C.lanes)&&null!==(C=e.lastRenderedReducer))try{var l=e.lastRenderedState,a=C(l,t);if(n.hasEagerState=!0,n.eagerState=a,lI(a,l)){var o=e.interleaved;return null===o?(n.next=n,JC(e)):(n.next=o.next,o.next=n),void(e.interleaved=n)}}catch(i){}null!==(t=YC(g,e,n,I))&&(ti(t,g,I,n=gi()),Ol(t,e,I))}}function Tl(g){var e=g.alternate;return g===ll||null!==e&&e===ll}function Pl(g,e){rl=il=!0;var t=g.pending;null===t?e.next=e:(e.next=t.next,t.next=e),g.pending=e}function Ol(g,e,t){if(0!==(4194240&t)){var I=e.lanes;t|=I&=g.pendingLanes,e.lanes=t,be(g,t)}}var ql={readContext:XC,useCallback:Al,useContext:Al,useEffect:Al,useImperativeHandle:Al,useInsertionEffect:Al,useLayoutEffect:Al,useMemo:Al,useReducer:Al,useRef:Al,useState:Al,useDebugValue:Al,useDeferredValue:Al,useTransition:Al,useMutableSource:Al,useSyncExternalStore:Al,useId:Al,unstable_isNewReconciler:!1},_l={readContext:XC,useCallback:function(g,e){return hl().memoizedState=[g,void 0===e?null:e],g},useContext:XC,useEffect:wl,useImperativeHandle:function(g,e,t){return t=null!==t&&void 0!==t?t.concat([g]):null,Jl(4194308,4,Kl.bind(null,e,g),t)},useLayoutEffect:function(g,e){return Jl(4194308,4,g,e)},useInsertionEffect:function(g,e){return Jl(4,2,g,e)},useMemo:function(g,e){var t=hl();return e=void 0===e?null:e,g=g(),t.memoizedState=[g,e],g},useReducer:function(g,e,t){var I=hl();return e=void 0!==t?t(e):e,I.memoizedState=I.baseState=e,g={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:g,lastRenderedState:e},I.queue=g,g=g.dispatch=Ql.bind(null,ll,g),[I.memoizedState,g]},useRef:function(g){return g={current:g},hl().memoizedState=g},useState:Rl,useDebugValue:Ll,useDeferredValue:function(g){return hl().memoizedState=g},useTransition:function(){var g=Rl(!1),e=g[0];return g=Ul.bind(null,g[1]),hl().memoizedState=g,[e,g]},useMutableSource:function(){},useSyncExternalStore:function(g,e,t){var I=ll,n=hl();if(nC){if(void 0===t)throw Error(C(407));t=t()}else{if(t=e(),null===Ro)throw Error(C(349));0!==(30&Cl)||Sl(I,e,t)}n.memoizedState=t;var l={value:t,getSnapshot:e};return n.queue=l,wl(Wl.bind(null,I,l,g),[g]),I.flags|=2048,Xl(9,fl.bind(null,I,l,t,e),void 0,null),t},useId:function(){var g=hl(),e=Ro.identifierPrefix;if(nC){var t=qn;e=":"+e+"R"+(t=(On&~(1<<32-le(On)-1)).toString(32)+t),0<(t=cl++)&&(e+="H"+t.toString(32)),e+=":"}else e=":"+e+"r"+(t=sl++).toString(32)+":";return g.memoizedState=e},unstable_isNewReconciler:!1},$l={readContext:XC,useCallback:zl,useContext:XC,useEffect:Nl,useImperativeHandle:xl,useInsertionEffect:Hl,useLayoutEffect:Fl,useMemo:El,useReducer:pl,useRef:kl,useState:function(){return pl(Zl)},useDebugValue:Ll,useDeferredValue:function(g){return Ml(bl(),al.memoizedState,g)},useTransition:function(){return[pl(Zl)[0],bl().memoizedState]},useMutableSource:yl,useSyncExternalStore:Bl,useId:jl,unstable_isNewReconciler:!1},ga={readContext:XC,useCallback:zl,useContext:XC,useEffect:Nl,useImperativeHandle:xl,useInsertionEffect:Hl,useLayoutEffect:Fl,useMemo:El,useReducer:Gl,useRef:kl,useState:function(){return Gl(Zl)},useDebugValue:Ll,useDeferredValue:function(g){var e=bl();return null===al?e.memoizedState=g:Ml(e,al.memoizedState,g)},useTransition:function(){return[Gl(Zl)[0],bl().memoizedState]},useMutableSource:yl,useSyncExternalStore:Bl,useId:jl,unstable_isNewReconciler:!1};function ea(g,e){if(g&&g.defaultProps){for(var t in e=F({},e),g=g.defaultProps)void 0===e[t]&&(e[t]=g[t]);return e}return e}function ta(g,e,t,I){t=null===(t=t(I,e=g.memoizedState))||void 0===t?e:F({},e,t),g.memoizedState=t,0===g.lanes&&(g.updateQueue.baseState=t)}var Ia={isMounted:function(g){return!!(g=g._reactInternals)&&Eg(g)===g},enqueueSetState:function(g,e,t){g=g._reactInternals;var I=gi(),n=ei(g),C=KC(I,n);C.payload=e,void 0!==t&&null!==t&&(C.callback=t),null!==(e=xC(g,C,n))&&(ti(e,g,n,I),LC(e,g,n))},enqueueReplaceState:function(g,e,t){g=g._reactInternals;var I=gi(),n=ei(g),C=KC(I,n);C.tag=1,C.payload=e,void 0!==t&&null!==t&&(C.callback=t),null!==(e=xC(g,C,n))&&(ti(e,g,n,I),LC(e,g,n))},enqueueForceUpdate:function(g,e){g=g._reactInternals;var t=gi(),I=ei(g),n=KC(t,I);n.tag=2,void 0!==e&&null!==e&&(n.callback=e),null!==(e=xC(g,n,I))&&(ti(e,g,I,t),LC(e,g,I))}};function na(g,e,t,I,n,C,l){return"function"===typeof(g=g.stateNode).shouldComponentUpdate?g.shouldComponentUpdate(I,C,l):!e.prototype||!e.prototype.isPureReactComponent||(!aI(t,I)||!aI(n,C))}function Ca(g,e,t){var I=!1,n=Vn,C=e.contextType;return"object"===typeof C&&null!==C?C=XC(C):(n=Jn(e)?Xn:vn.current,C=(I=null!==(I=e.contextTypes)&&void 0!==I)?kn(g,n):Vn),e=new e(t,C),g.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=Ia,g.stateNode=e,e._reactInternals=g,I&&((g=g.stateNode).__reactInternalMemoizedUnmaskedChildContext=n,g.__reactInternalMemoizedMaskedChildContext=C),e}function la(g,e,t,I){g=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(t,I),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(t,I),e.state!==g&&Ia.enqueueReplaceState(e,e.state,null)}function aa(g,e,t,I){var n=g.stateNode;n.props=t,n.state=g.memoizedState,n.refs={},HC(g);var C=e.contextType;"object"===typeof C&&null!==C?n.context=XC(C):(C=Jn(e)?Xn:vn.current,n.context=kn(g,C)),n.state=g.memoizedState,"function"===typeof(C=e.getDerivedStateFromProps)&&(ta(g,e,C,t),n.state=g.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof n.getSnapshotBeforeUpdate||"function"!==typeof n.UNSAFE_componentWillMount&&"function"!==typeof n.componentWillMount||(e=n.state,"function"===typeof n.componentWillMount&&n.componentWillMount(),"function"===typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount(),e!==n.state&&Ia.enqueueReplaceState(n,n.state,null),EC(g,t,n,I),n.state=g.memoizedState),"function"===typeof n.componentDidMount&&(g.flags|=4194308)}function oa(g,e){try{var t="",I=e;do{t+=z(I),I=I.return}while(I);var n=t}catch(C){n="\nError generating stack: "+C.message+"\n"+C.stack}return{value:g,source:e,stack:n,digest:null}}function ia(g,e,t){return{value:g,source:null,stack:null!=t?t:null,digest:null!=e?e:null}}function ra(g,e){try{console.error(e.value)}catch(t){setTimeout((function(){throw t}))}}var ca="function"===typeof WeakMap?WeakMap:Map;function sa(g,e,t){(t=KC(-1,t)).tag=3,t.payload={element:null};var I=e.value;return t.callback=function(){Uo||(Uo=!0,jo=I),ra(0,e)},t}function Aa(g,e,t){(t=KC(-1,t)).tag=3;var I=g.type.getDerivedStateFromError;if("function"===typeof I){var n=e.value;t.payload=function(){return I(n)},t.callback=function(){ra(0,e)}}var C=g.stateNode;return null!==C&&"function"===typeof C.componentDidCatch&&(t.callback=function(){ra(0,e),"function"!==typeof I&&(null===Qo?Qo=new Set([this]):Qo.add(this));var g=e.stack;this.componentDidCatch(e.value,{componentStack:null!==g?g:""})}),t}function da(g,e,t){var I=g.pingCache;if(null===I){I=g.pingCache=new ca;var n=new Set;I.set(e,n)}else void 0===(n=I.get(e))&&(n=new Set,I.set(e,n));n.has(t)||(n.add(t),g=fi.bind(null,g,e,t),e.then(g,g))}function ua(g){do{var e;if((e=13===g.tag)&&(e=null===(e=g.memoizedState)||null!==e.dehydrated),e)return g;g=g.return}while(null!==g);return null}function ma(g,e,t,I,n){return 0===(1&g.mode)?(g===e?g.flags|=65536:(g.flags|=128,t.flags|=131072,t.flags&=-52805,1===t.tag&&(null===t.alternate?t.tag=17:((e=KC(-1,1)).tag=2,xC(t,e,1))),t.lanes|=1),g):(g.flags|=65536,g.lanes=n,g)}var ha=p.ReactCurrentOwner,ba=!1;function Za(g,e,t,I){e.child=null===g?GC(e,null,t,I):pC(e,g.child,t,I)}function pa(g,e,t,I,n){t=t.render;var C=e.ref;return RC(e,n),I=ul(g,e,t,I,C,n),t=ml(),null===g||ba?(nC&&t&&gC(e),e.flags|=1,Za(g,e,I,n),e.child):(e.updateQueue=g.updateQueue,e.flags&=-2053,g.lanes&=~n,Ma(g,e,n))}function Ga(g,e,t,I,n){if(null===g){var C=t.type;return"function"!==typeof C||Ji(C)||void 0!==C.defaultProps||null!==t.compare||void 0!==t.defaultProps?((g=wi(t.type,null,I,e,e.mode,n)).ref=e.ref,g.return=e,e.child=g):(e.tag=15,e.type=C,ya(g,e,C,I,n))}if(C=g.child,0===(g.lanes&n)){var l=C.memoizedProps;if((t=null!==(t=t.compare)?t:aI)(l,I)&&g.ref===e.ref)return Ma(g,e,n)}return e.flags|=1,(g=Yi(C,I)).ref=e.ref,g.return=e,e.child=g}function ya(g,e,t,I,n){if(null!==g){var C=g.memoizedProps;if(aI(C,I)&&g.ref===e.ref){if(ba=!1,e.pendingProps=I=C,0===(g.lanes&n))return e.lanes=g.lanes,Ma(g,e,n);0!==(131072&g.flags)&&(ba=!0)}}return fa(g,e,t,I,n)}function Ba(g,e,t){var I=e.pendingProps,n=I.children,C=null!==g?g.memoizedState:null;if("hidden"===I.mode)if(0===(1&e.mode))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Wn(Yo,Jo),Jo|=t;else{if(0===(1073741824&t))return g=null!==C?C.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:g,cachePool:null,transitions:null},e.updateQueue=null,Wn(Yo,Jo),Jo|=g,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},I=null!==C?C.baseLanes:t,Wn(Yo,Jo),Jo|=I}else null!==C?(I=C.baseLanes|t,e.memoizedState=null):I=t,Wn(Yo,Jo),Jo|=I;return Za(g,e,n,t),e.child}function Sa(g,e){var t=e.ref;(null===g&&null!==t||null!==g&&g.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function fa(g,e,t,I,n){var C=Jn(t)?Xn:vn.current;return C=kn(e,C),RC(e,n),t=ul(g,e,t,I,C,n),I=ml(),null===g||ba?(nC&&I&&gC(e),e.flags|=1,Za(g,e,t,n),e.child):(e.updateQueue=g.updateQueue,e.flags&=-2053,g.lanes&=~n,Ma(g,e,n))}function Wa(g,e,t,I,n){if(Jn(t)){var C=!0;Hn(e)}else C=!1;if(RC(e,n),null===e.stateNode)Ea(g,e),Ca(e,t,I),aa(e,t,I,n),I=!0;else if(null===g){var l=e.stateNode,a=e.memoizedProps;l.props=a;var o=l.context,i=t.contextType;"object"===typeof i&&null!==i?i=XC(i):i=kn(e,i=Jn(t)?Xn:vn.current);var r=t.getDerivedStateFromProps,c="function"===typeof r||"function"===typeof l.getSnapshotBeforeUpdate;c||"function"!==typeof l.UNSAFE_componentWillReceiveProps&&"function"!==typeof l.componentWillReceiveProps||(a!==I||o!==i)&&la(e,l,I,i),NC=!1;var s=e.memoizedState;l.state=s,EC(e,I,l,n),o=e.memoizedState,a!==I||s!==o||Rn.current||NC?("function"===typeof r&&(ta(e,t,r,I),o=e.memoizedState),(a=NC||na(e,t,a,I,s,o,i))?(c||"function"!==typeof l.UNSAFE_componentWillMount&&"function"!==typeof l.componentWillMount||("function"===typeof l.componentWillMount&&l.componentWillMount(),"function"===typeof l.UNSAFE_componentWillMount&&l.UNSAFE_componentWillMount()),"function"===typeof l.componentDidMount&&(e.flags|=4194308)):("function"===typeof l.componentDidMount&&(e.flags|=4194308),e.memoizedProps=I,e.memoizedState=o),l.props=I,l.state=o,l.context=i,I=a):("function"===typeof l.componentDidMount&&(e.flags|=4194308),I=!1)}else{l=e.stateNode,FC(g,e),a=e.memoizedProps,i=e.type===e.elementType?a:ea(e.type,a),l.props=i,c=e.pendingProps,s=l.context,"object"===typeof(o=t.contextType)&&null!==o?o=XC(o):o=kn(e,o=Jn(t)?Xn:vn.current);var A=t.getDerivedStateFromProps;(r="function"===typeof A||"function"===typeof l.getSnapshotBeforeUpdate)||"function"!==typeof l.UNSAFE_componentWillReceiveProps&&"function"!==typeof l.componentWillReceiveProps||(a!==c||s!==o)&&la(e,l,I,o),NC=!1,s=e.memoizedState,l.state=s,EC(e,I,l,n);var d=e.memoizedState;a!==c||s!==d||Rn.current||NC?("function"===typeof A&&(ta(e,t,A,I),d=e.memoizedState),(i=NC||na(e,t,i,I,s,d,o)||!1)?(r||"function"!==typeof l.UNSAFE_componentWillUpdate&&"function"!==typeof l.componentWillUpdate||("function"===typeof l.componentWillUpdate&&l.componentWillUpdate(I,d,o),"function"===typeof l.UNSAFE_componentWillUpdate&&l.UNSAFE_componentWillUpdate(I,d,o)),"function"===typeof l.componentDidUpdate&&(e.flags|=4),"function"===typeof l.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!==typeof l.componentDidUpdate||a===g.memoizedProps&&s===g.memoizedState||(e.flags|=4),"function"!==typeof l.getSnapshotBeforeUpdate||a===g.memoizedProps&&s===g.memoizedState||(e.flags|=1024),e.memoizedProps=I,e.memoizedState=d),l.props=I,l.state=d,l.context=o,I=i):("function"!==typeof l.componentDidUpdate||a===g.memoizedProps&&s===g.memoizedState||(e.flags|=4),"function"!==typeof l.getSnapshotBeforeUpdate||a===g.memoizedProps&&s===g.memoizedState||(e.flags|=1024),I=!1)}return Va(g,e,t,I,C,n)}function Va(g,e,t,I,n,C){Sa(g,e);var l=0!==(128&e.flags);if(!I&&!l)return n&&Fn(e,t,!1),Ma(g,e,C);I=e.stateNode,ha.current=e;var a=l&&"function"!==typeof t.getDerivedStateFromError?null:I.render();return e.flags|=1,null!==g&&l?(e.child=pC(e,g.child,null,C),e.child=pC(e,null,a,C)):Za(g,e,a,C),e.memoizedState=I.state,n&&Fn(e,t,!0),e.child}function va(g){var e=g.stateNode;e.pendingContext?wn(0,e.pendingContext,e.pendingContext!==e.context):e.context&&wn(0,e.context,!1),PC(g,e.containerInfo)}function Ra(g,e,t,I,n){return AC(),dC(n),e.flags|=256,Za(g,e,t,I),e.child}var Xa,ka,Ja,Ya,wa={dehydrated:null,treeContext:null,retryLane:0};function Na(g){return{baseLanes:g,cachePool:null,transitions:null}}function Ha(g,e,t){var I,n=e.pendingProps,l=$C.current,a=!1,o=0!==(128&e.flags);if((I=o)||(I=(null===g||null!==g.memoizedState)&&0!==(2&l)),I?(a=!0,e.flags&=-129):null!==g&&null===g.memoizedState||(l|=1),Wn($C,1&l),null===g)return iC(e),null!==(g=e.memoizedState)&&null!==(g=g.dehydrated)?(0===(1&e.mode)?e.lanes=1:"$!"===g.data?e.lanes=8:e.lanes=1073741824,null):(o=n.children,g=n.fallback,a?(n=e.mode,a=e.child,o={mode:"hidden",children:o},0===(1&n)&&null!==a?(a.childLanes=0,a.pendingProps=o):a=Hi(o,n,0,null),g=Ni(g,n,t,null),a.return=e,g.return=e,a.sibling=g,e.child=a,e.child.memoizedState=Na(t),e.memoizedState=wa,g):Fa(e,o));if(null!==(l=g.memoizedState)&&null!==(I=l.dehydrated))return function(g,e,t,I,n,l,a){if(t)return 256&e.flags?(e.flags&=-257,Ka(g,e,a,I=ia(Error(C(422))))):null!==e.memoizedState?(e.child=g.child,e.flags|=128,null):(l=I.fallback,n=e.mode,I=Hi({mode:"visible",children:I.children},n,0,null),(l=Ni(l,n,a,null)).flags|=2,I.return=e,l.return=e,I.sibling=l,e.child=I,0!==(1&e.mode)&&pC(e,g.child,null,a),e.child.memoizedState=Na(a),e.memoizedState=wa,l);if(0===(1&e.mode))return Ka(g,e,a,null);if("$!"===n.data){if(I=n.nextSibling&&n.nextSibling.dataset)var o=I.dgst;return I=o,Ka(g,e,a,I=ia(l=Error(C(419)),I,void 0))}if(o=0!==(a&g.childLanes),ba||o){if(null!==(I=Ro)){switch(a&-a){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}0!==(n=0!==(n&(I.suspendedLanes|a))?0:n)&&n!==l.retryLane&&(l.retryLane=n,wC(g,n),ti(I,g,n,-1))}return ui(),Ka(g,e,a,I=ia(Error(C(421))))}return"$?"===n.data?(e.flags|=128,e.child=g.child,e=Vi.bind(null,g),n._reactRetry=e,null):(g=l.treeContext,IC=on(n.nextSibling),tC=e,nC=!0,CC=null,null!==g&&(Dn[Tn++]=On,Dn[Tn++]=qn,Dn[Tn++]=Pn,On=g.id,qn=g.overflow,Pn=e),e=Fa(e,I.children),e.flags|=4096,e)}(g,e,o,n,I,l,t);if(a){a=n.fallback,o=e.mode,I=(l=g.child).sibling;var i={mode:"hidden",children:n.children};return 0===(1&o)&&e.child!==l?((n=e.child).childLanes=0,n.pendingProps=i,e.deletions=null):(n=Yi(l,i)).subtreeFlags=14680064&l.subtreeFlags,null!==I?a=Yi(I,a):(a=Ni(a,o,t,null)).flags|=2,a.return=e,n.return=e,n.sibling=a,e.child=n,n=a,a=e.child,o=null===(o=g.child.memoizedState)?Na(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=g.childLanes&~t,e.memoizedState=wa,n}return g=(a=g.child).sibling,n=Yi(a,{mode:"visible",children:n.children}),0===(1&e.mode)&&(n.lanes=t),n.return=e,n.sibling=null,null!==g&&(null===(t=e.deletions)?(e.deletions=[g],e.flags|=16):t.push(g)),e.child=n,e.memoizedState=null,n}function Fa(g,e){return(e=Hi({mode:"visible",children:e},g.mode,0,null)).return=g,g.child=e}function Ka(g,e,t,I){return null!==I&&dC(I),pC(e,g.child,null,t),(g=Fa(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,g}function xa(g,e,t){g.lanes|=e;var I=g.alternate;null!==I&&(I.lanes|=e),vC(g.return,e,t)}function La(g,e,t,I,n){var C=g.memoizedState;null===C?g.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:I,tail:t,tailMode:n}:(C.isBackwards=e,C.rendering=null,C.renderingStartTime=0,C.last=I,C.tail=t,C.tailMode=n)}function za(g,e,t){var I=e.pendingProps,n=I.revealOrder,C=I.tail;if(Za(g,e,I.children,t),0!==(2&(I=$C.current)))I=1&I|2,e.flags|=128;else{if(null!==g&&0!==(128&g.flags))g:for(g=e.child;null!==g;){if(13===g.tag)null!==g.memoizedState&&xa(g,t,e);else if(19===g.tag)xa(g,t,e);else if(null!==g.child){g.child.return=g,g=g.child;continue}if(g===e)break g;for(;null===g.sibling;){if(null===g.return||g.return===e)break g;g=g.return}g.sibling.return=g.return,g=g.sibling}I&=1}if(Wn($C,I),0===(1&e.mode))e.memoizedState=null;else switch(n){case"forwards":for(t=e.child,n=null;null!==t;)null!==(g=t.alternate)&&null===gl(g)&&(n=t),t=t.sibling;null===(t=n)?(n=e.child,e.child=null):(n=t.sibling,t.sibling=null),La(e,!1,n,t,C);break;case"backwards":for(t=null,n=e.child,e.child=null;null!==n;){if(null!==(g=n.alternate)&&null===gl(g)){e.child=n;break}g=n.sibling,n.sibling=t,t=n,n=g}La(e,!0,t,null,C);break;case"together":La(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ea(g,e){0===(1&e.mode)&&null!==g&&(g.alternate=null,e.alternate=null,e.flags|=2)}function Ma(g,e,t){if(null!==g&&(e.dependencies=g.dependencies),Ho|=e.lanes,0===(t&e.childLanes))return null;if(null!==g&&e.child!==g.child)throw Error(C(153));if(null!==e.child){for(t=Yi(g=e.child,g.pendingProps),e.child=t,t.return=e;null!==g.sibling;)g=g.sibling,(t=t.sibling=Yi(g,g.pendingProps)).return=e;t.sibling=null}return e.child}function Ua(g,e){if(!nC)switch(g.tailMode){case"hidden":e=g.tail;for(var t=null;null!==e;)null!==e.alternate&&(t=e),e=e.sibling;null===t?g.tail=null:t.sibling=null;break;case"collapsed":t=g.tail;for(var I=null;null!==t;)null!==t.alternate&&(I=t),t=t.sibling;null===I?e||null===g.tail?g.tail=null:g.tail.sibling=null:I.sibling=null}}function ja(g){var e=null!==g.alternate&&g.alternate.child===g.child,t=0,I=0;if(e)for(var n=g.child;null!==n;)t|=n.lanes|n.childLanes,I|=14680064&n.subtreeFlags,I|=14680064&n.flags,n.return=g,n=n.sibling;else for(n=g.child;null!==n;)t|=n.lanes|n.childLanes,I|=n.subtreeFlags,I|=n.flags,n.return=g,n=n.sibling;return g.subtreeFlags|=I,g.childLanes=t,e}function Qa(g,e,t){var I=e.pendingProps;switch(eC(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ja(e),null;case 1:case 17:return Jn(e.type)&&Yn(),ja(e),null;case 3:return I=e.stateNode,OC(),fn(Rn),fn(vn),tl(),I.pendingContext&&(I.context=I.pendingContext,I.pendingContext=null),null!==g&&null!==g.child||(cC(e)?e.flags|=4:null===g||g.memoizedState.isDehydrated&&0===(256&e.flags)||(e.flags|=1024,null!==CC&&(li(CC),CC=null))),ka(g,e),ja(e),null;case 5:_C(e);var n=TC(DC.current);if(t=e.type,null!==g&&null!=e.stateNode)Ja(g,e,t,I,n),g.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!I){if(null===e.stateNode)throw Error(C(166));return ja(e),null}if(g=TC(jC.current),cC(e)){I=e.stateNode,t=e.type;var l=e.memoizedProps;switch(I[sn]=e,I[An]=l,g=0!==(1&e.mode),t){case"dialog":KI("cancel",I),KI("close",I);break;case"iframe":case"object":case"embed":KI("load",I);break;case"video":case"audio":for(n=0;n<wI.length;n++)KI(wI[n],I);break;case"source":KI("error",I);break;case"img":case"image":case"link":KI("error",I),KI("load",I);break;case"details":KI("toggle",I);break;case"input":O(I,l),KI("invalid",I);break;case"select":I._wrapperState={wasMultiple:!!l.multiple},KI("invalid",I);break;case"textarea":ng(I,l),KI("invalid",I)}for(var o in bg(t,l),n=null,l)if(l.hasOwnProperty(o)){var i=l[o];"children"===o?"string"===typeof i?I.textContent!==i&&(!0!==l.suppressHydrationWarning&&qI(I.textContent,i,g),n=["children",i]):"number"===typeof i&&I.textContent!==""+i&&(!0!==l.suppressHydrationWarning&&qI(I.textContent,i,g),n=["children",""+i]):a.hasOwnProperty(o)&&null!=i&&"onScroll"===o&&KI("scroll",I)}switch(t){case"input":Q(I),$(I,l,!0);break;case"textarea":Q(I),lg(I);break;case"select":case"option":break;default:"function"===typeof l.onClick&&(I.onclick=_I)}I=n,e.updateQueue=I,null!==I&&(e.flags|=4)}else{o=9===n.nodeType?n:n.ownerDocument,"http://www.w3.org/1999/xhtml"===g&&(g=ag(t)),"http://www.w3.org/1999/xhtml"===g?"script"===t?((g=o.createElement("div")).innerHTML="<script><\/script>",g=g.removeChild(g.firstChild)):"string"===typeof I.is?g=o.createElement(t,{is:I.is}):(g=o.createElement(t),"select"===t&&(o=g,I.multiple?o.multiple=!0:I.size&&(o.size=I.size))):g=o.createElementNS(g,t),g[sn]=e,g[An]=I,Xa(g,e,!1,!1),e.stateNode=g;g:{switch(o=Zg(t,I),t){case"dialog":KI("cancel",g),KI("close",g),n=I;break;case"iframe":case"object":case"embed":KI("load",g),n=I;break;case"video":case"audio":for(n=0;n<wI.length;n++)KI(wI[n],g);n=I;break;case"source":KI("error",g),n=I;break;case"img":case"image":case"link":KI("error",g),KI("load",g),n=I;break;case"details":KI("toggle",g),n=I;break;case"input":O(g,I),n=P(g,I),KI("invalid",g);break;case"option":default:n=I;break;case"select":g._wrapperState={wasMultiple:!!I.multiple},n=F({},I,{value:void 0}),KI("invalid",g);break;case"textarea":ng(g,I),n=Ig(g,I),KI("invalid",g)}for(l in bg(t,n),i=n)if(i.hasOwnProperty(l)){var r=i[l];"style"===l?mg(g,r):"dangerouslySetInnerHTML"===l?null!=(r=r?r.__html:void 0)&&cg(g,r):"children"===l?"string"===typeof r?("textarea"!==t||""!==r)&&sg(g,r):"number"===typeof r&&sg(g,""+r):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(a.hasOwnProperty(l)?null!=r&&"onScroll"===l&&KI("scroll",g):null!=r&&Z(g,l,r,o))}switch(t){case"input":Q(g),$(g,I,!1);break;case"textarea":Q(g),lg(g);break;case"option":null!=I.value&&g.setAttribute("value",""+U(I.value));break;case"select":g.multiple=!!I.multiple,null!=(l=I.value)?tg(g,!!I.multiple,l,!1):null!=I.defaultValue&&tg(g,!!I.multiple,I.defaultValue,!0);break;default:"function"===typeof n.onClick&&(g.onclick=_I)}switch(t){case"button":case"input":case"select":case"textarea":I=!!I.autoFocus;break g;case"img":I=!0;break g;default:I=!1}}I&&(e.flags|=4)}null!==e.ref&&(e.flags|=512,e.flags|=2097152)}return ja(e),null;case 6:if(g&&null!=e.stateNode)Ya(g,e,g.memoizedProps,I);else{if("string"!==typeof I&&null===e.stateNode)throw Error(C(166));if(t=TC(DC.current),TC(jC.current),cC(e)){if(I=e.stateNode,t=e.memoizedProps,I[sn]=e,(l=I.nodeValue!==t)&&null!==(g=tC))switch(g.tag){case 3:qI(I.nodeValue,t,0!==(1&g.mode));break;case 5:!0!==g.memoizedProps.suppressHydrationWarning&&qI(I.nodeValue,t,0!==(1&g.mode))}l&&(e.flags|=4)}else(I=(9===t.nodeType?t:t.ownerDocument).createTextNode(I))[sn]=e,e.stateNode=I}return ja(e),null;case 13:if(fn($C),I=e.memoizedState,null===g||null!==g.memoizedState&&null!==g.memoizedState.dehydrated){if(nC&&null!==IC&&0!==(1&e.mode)&&0===(128&e.flags))sC(),AC(),e.flags|=98560,l=!1;else if(l=cC(e),null!==I&&null!==I.dehydrated){if(null===g){if(!l)throw Error(C(318));if(!(l=null!==(l=e.memoizedState)?l.dehydrated:null))throw Error(C(317));l[sn]=e}else AC(),0===(128&e.flags)&&(e.memoizedState=null),e.flags|=4;ja(e),l=!1}else null!==CC&&(li(CC),CC=null),l=!0;if(!l)return 65536&e.flags?e:null}return 0!==(128&e.flags)?(e.lanes=t,e):((I=null!==I)!==(null!==g&&null!==g.memoizedState)&&I&&(e.child.flags|=8192,0!==(1&e.mode)&&(null===g||0!==(1&$C.current)?0===wo&&(wo=3):ui())),null!==e.updateQueue&&(e.flags|=4),ja(e),null);case 4:return OC(),ka(g,e),null===g&&zI(e.stateNode.containerInfo),ja(e),null;case 10:return VC(e.type._context),ja(e),null;case 19:if(fn($C),null===(l=e.memoizedState))return ja(e),null;if(I=0!==(128&e.flags),null===(o=l.rendering))if(I)Ua(l,!1);else{if(0!==wo||null!==g&&0!==(128&g.flags))for(g=e.child;null!==g;){if(null!==(o=gl(g))){for(e.flags|=128,Ua(l,!1),null!==(I=o.updateQueue)&&(e.updateQueue=I,e.flags|=4),e.subtreeFlags=0,I=t,t=e.child;null!==t;)g=I,(l=t).flags&=14680066,null===(o=l.alternate)?(l.childLanes=0,l.lanes=g,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=o.childLanes,l.lanes=o.lanes,l.child=o.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=o.memoizedProps,l.memoizedState=o.memoizedState,l.updateQueue=o.updateQueue,l.type=o.type,g=o.dependencies,l.dependencies=null===g?null:{lanes:g.lanes,firstContext:g.firstContext}),t=t.sibling;return Wn($C,1&$C.current|2),e.child}g=g.sibling}null!==l.tail&&qg()>Eo&&(e.flags|=128,I=!0,Ua(l,!1),e.lanes=4194304)}else{if(!I)if(null!==(g=gl(o))){if(e.flags|=128,I=!0,null!==(t=g.updateQueue)&&(e.updateQueue=t,e.flags|=4),Ua(l,!0),null===l.tail&&"hidden"===l.tailMode&&!o.alternate&&!nC)return ja(e),null}else 2*qg()-l.renderingStartTime>Eo&&1073741824!==t&&(e.flags|=128,I=!0,Ua(l,!1),e.lanes=4194304);l.isBackwards?(o.sibling=e.child,e.child=o):(null!==(t=l.last)?t.sibling=o:e.child=o,l.last=o)}return null!==l.tail?(e=l.tail,l.rendering=e,l.tail=e.sibling,l.renderingStartTime=qg(),e.sibling=null,t=$C.current,Wn($C,I?1&t|2:1&t),e):(ja(e),null);case 22:case 23:return ci(),I=null!==e.memoizedState,null!==g&&null!==g.memoizedState!==I&&(e.flags|=8192),I&&0!==(1&e.mode)?0!==(1073741824&Jo)&&(ja(e),6&e.subtreeFlags&&(e.flags|=8192)):ja(e),null;case 24:case 25:return null}throw Error(C(156,e.tag))}function Da(g,e){switch(eC(e),e.tag){case 1:return Jn(e.type)&&Yn(),65536&(g=e.flags)?(e.flags=-65537&g|128,e):null;case 3:return OC(),fn(Rn),fn(vn),tl(),0!==(65536&(g=e.flags))&&0===(128&g)?(e.flags=-65537&g|128,e):null;case 5:return _C(e),null;case 13:if(fn($C),null!==(g=e.memoizedState)&&null!==g.dehydrated){if(null===e.alternate)throw Error(C(340));AC()}return 65536&(g=e.flags)?(e.flags=-65537&g|128,e):null;case 19:return fn($C),null;case 4:return OC(),null;case 10:return VC(e.type._context),null;case 22:case 23:return ci(),null;default:return null}}Xa=function(g,e){for(var t=e.child;null!==t;){if(5===t.tag||6===t.tag)g.appendChild(t.stateNode);else if(4!==t.tag&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}},ka=function(){},Ja=function(g,e,t,I){var n=g.memoizedProps;if(n!==I){g=e.stateNode,TC(jC.current);var C,l=null;switch(t){case"input":n=P(g,n),I=P(g,I),l=[];break;case"select":n=F({},n,{value:void 0}),I=F({},I,{value:void 0}),l=[];break;case"textarea":n=Ig(g,n),I=Ig(g,I),l=[];break;default:"function"!==typeof n.onClick&&"function"===typeof I.onClick&&(g.onclick=_I)}for(r in bg(t,I),t=null,n)if(!I.hasOwnProperty(r)&&n.hasOwnProperty(r)&&null!=n[r])if("style"===r){var o=n[r];for(C in o)o.hasOwnProperty(C)&&(t||(t={}),t[C]="")}else"dangerouslySetInnerHTML"!==r&&"children"!==r&&"suppressContentEditableWarning"!==r&&"suppressHydrationWarning"!==r&&"autoFocus"!==r&&(a.hasOwnProperty(r)?l||(l=[]):(l=l||[]).push(r,null));for(r in I){var i=I[r];if(o=null!=n?n[r]:void 0,I.hasOwnProperty(r)&&i!==o&&(null!=i||null!=o))if("style"===r)if(o){for(C in o)!o.hasOwnProperty(C)||i&&i.hasOwnProperty(C)||(t||(t={}),t[C]="");for(C in i)i.hasOwnProperty(C)&&o[C]!==i[C]&&(t||(t={}),t[C]=i[C])}else t||(l||(l=[]),l.push(r,t)),t=i;else"dangerouslySetInnerHTML"===r?(i=i?i.__html:void 0,o=o?o.__html:void 0,null!=i&&o!==i&&(l=l||[]).push(r,i)):"children"===r?"string"!==typeof i&&"number"!==typeof i||(l=l||[]).push(r,""+i):"suppressContentEditableWarning"!==r&&"suppressHydrationWarning"!==r&&(a.hasOwnProperty(r)?(null!=i&&"onScroll"===r&&KI("scroll",g),l||o===i||(l=[])):(l=l||[]).push(r,i))}t&&(l=l||[]).push("style",t);var r=l;(e.updateQueue=r)&&(e.flags|=4)}},Ya=function(g,e,t,I){t!==I&&(e.flags|=4)};var Ta=!1,Pa=!1,Oa="function"===typeof WeakSet?WeakSet:Set,qa=null;function _a(g,e){var t=g.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(I){Si(g,e,I)}else t.current=null}function $a(g,e,t){try{t()}catch(I){Si(g,e,I)}}var go=!1;function eo(g,e,t){var I=e.updateQueue;if(null!==(I=null!==I?I.lastEffect:null)){var n=I=I.next;do{if((n.tag&g)===g){var C=n.destroy;n.destroy=void 0,void 0!==C&&$a(e,t,C)}n=n.next}while(n!==I)}}function to(g,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var t=e=e.next;do{if((t.tag&g)===g){var I=t.create;t.destroy=I()}t=t.next}while(t!==e)}}function Io(g){var e=g.ref;if(null!==e){var t=g.stateNode;g.tag,g=t,"function"===typeof e?e(g):e.current=g}}function no(g){var e=g.alternate;null!==e&&(g.alternate=null,no(e)),g.child=null,g.deletions=null,g.sibling=null,5===g.tag&&(null!==(e=g.stateNode)&&(delete e[sn],delete e[An],delete e[un],delete e[mn],delete e[hn])),g.stateNode=null,g.return=null,g.dependencies=null,g.memoizedProps=null,g.memoizedState=null,g.pendingProps=null,g.stateNode=null,g.updateQueue=null}function Co(g){return 5===g.tag||3===g.tag||4===g.tag}function lo(g){g:for(;;){for(;null===g.sibling;){if(null===g.return||Co(g.return))return null;g=g.return}for(g.sibling.return=g.return,g=g.sibling;5!==g.tag&&6!==g.tag&&18!==g.tag;){if(2&g.flags)continue g;if(null===g.child||4===g.tag)continue g;g.child.return=g,g=g.child}if(!(2&g.flags))return g.stateNode}}function ao(g,e,t){var I=g.tag;if(5===I||6===I)g=g.stateNode,e?8===t.nodeType?t.parentNode.insertBefore(g,e):t.insertBefore(g,e):(8===t.nodeType?(e=t.parentNode).insertBefore(g,t):(e=t).appendChild(g),null!==(t=t._reactRootContainer)&&void 0!==t||null!==e.onclick||(e.onclick=_I));else if(4!==I&&null!==(g=g.child))for(ao(g,e,t),g=g.sibling;null!==g;)ao(g,e,t),g=g.sibling}function oo(g,e,t){var I=g.tag;if(5===I||6===I)g=g.stateNode,e?t.insertBefore(g,e):t.appendChild(g);else if(4!==I&&null!==(g=g.child))for(oo(g,e,t),g=g.sibling;null!==g;)oo(g,e,t),g=g.sibling}var io=null,ro=!1;function co(g,e,t){for(t=t.child;null!==t;)so(g,e,t),t=t.sibling}function so(g,e,t){if(Ce&&"function"===typeof Ce.onCommitFiberUnmount)try{Ce.onCommitFiberUnmount(ne,t)}catch(a){}switch(t.tag){case 5:Pa||_a(t,e);case 6:var I=io,n=ro;io=null,co(g,e,t),ro=n,null!==(io=I)&&(ro?(g=io,t=t.stateNode,8===g.nodeType?g.parentNode.removeChild(t):g.removeChild(t)):io.removeChild(t.stateNode));break;case 18:null!==io&&(ro?(g=io,t=t.stateNode,8===g.nodeType?an(g.parentNode,t):1===g.nodeType&&an(g,t),Ee(g)):an(io,t.stateNode));break;case 4:I=io,n=ro,io=t.stateNode.containerInfo,ro=!0,co(g,e,t),io=I,ro=n;break;case 0:case 11:case 14:case 15:if(!Pa&&(null!==(I=t.updateQueue)&&null!==(I=I.lastEffect))){n=I=I.next;do{var C=n,l=C.destroy;C=C.tag,void 0!==l&&(0!==(2&C)||0!==(4&C))&&$a(t,e,l),n=n.next}while(n!==I)}co(g,e,t);break;case 1:if(!Pa&&(_a(t,e),"function"===typeof(I=t.stateNode).componentWillUnmount))try{I.props=t.memoizedProps,I.state=t.memoizedState,I.componentWillUnmount()}catch(a){Si(t,e,a)}co(g,e,t);break;case 21:co(g,e,t);break;case 22:1&t.mode?(Pa=(I=Pa)||null!==t.memoizedState,co(g,e,t),Pa=I):co(g,e,t);break;default:co(g,e,t)}}function Ao(g){var e=g.updateQueue;if(null!==e){g.updateQueue=null;var t=g.stateNode;null===t&&(t=g.stateNode=new Oa),e.forEach((function(e){var I=vi.bind(null,g,e);t.has(e)||(t.add(e),e.then(I,I))}))}}function uo(g,e){var t=e.deletions;if(null!==t)for(var I=0;I<t.length;I++){var n=t[I];try{var l=g,a=e,o=a;g:for(;null!==o;){switch(o.tag){case 5:io=o.stateNode,ro=!1;break g;case 3:case 4:io=o.stateNode.containerInfo,ro=!0;break g}o=o.return}if(null===io)throw Error(C(160));so(l,a,n),io=null,ro=!1;var i=n.alternate;null!==i&&(i.return=null),n.return=null}catch(r){Si(n,e,r)}}if(12854&e.subtreeFlags)for(e=e.child;null!==e;)mo(e,g),e=e.sibling}function mo(g,e){var t=g.alternate,I=g.flags;switch(g.tag){case 0:case 11:case 14:case 15:if(uo(e,g),ho(g),4&I){try{eo(3,g,g.return),to(3,g)}catch(m){Si(g,g.return,m)}try{eo(5,g,g.return)}catch(m){Si(g,g.return,m)}}break;case 1:uo(e,g),ho(g),512&I&&null!==t&&_a(t,t.return);break;case 5:if(uo(e,g),ho(g),512&I&&null!==t&&_a(t,t.return),32&g.flags){var n=g.stateNode;try{sg(n,"")}catch(m){Si(g,g.return,m)}}if(4&I&&null!=(n=g.stateNode)){var l=g.memoizedProps,a=null!==t?t.memoizedProps:l,o=g.type,i=g.updateQueue;if(g.updateQueue=null,null!==i)try{"input"===o&&"radio"===l.type&&null!=l.name&&q(n,l),Zg(o,a);var r=Zg(o,l);for(a=0;a<i.length;a+=2){var c=i[a],s=i[a+1];"style"===c?mg(n,s):"dangerouslySetInnerHTML"===c?cg(n,s):"children"===c?sg(n,s):Z(n,c,s,r)}switch(o){case"input":_(n,l);break;case"textarea":Cg(n,l);break;case"select":var A=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!l.multiple;var d=l.value;null!=d?tg(n,!!l.multiple,d,!1):A!==!!l.multiple&&(null!=l.defaultValue?tg(n,!!l.multiple,l.defaultValue,!0):tg(n,!!l.multiple,l.multiple?[]:"",!1))}n[An]=l}catch(m){Si(g,g.return,m)}}break;case 6:if(uo(e,g),ho(g),4&I){if(null===g.stateNode)throw Error(C(162));n=g.stateNode,l=g.memoizedProps;try{n.nodeValue=l}catch(m){Si(g,g.return,m)}}break;case 3:if(uo(e,g),ho(g),4&I&&null!==t&&t.memoizedState.isDehydrated)try{Ee(e.containerInfo)}catch(m){Si(g,g.return,m)}break;case 4:default:uo(e,g),ho(g);break;case 13:uo(e,g),ho(g),8192&(n=g.child).flags&&(l=null!==n.memoizedState,n.stateNode.isHidden=l,!l||null!==n.alternate&&null!==n.alternate.memoizedState||(zo=qg())),4&I&&Ao(g);break;case 22:if(c=null!==t&&null!==t.memoizedState,1&g.mode?(Pa=(r=Pa)||c,uo(e,g),Pa=r):uo(e,g),ho(g),8192&I){if(r=null!==g.memoizedState,(g.stateNode.isHidden=r)&&!c&&0!==(1&g.mode))for(qa=g,c=g.child;null!==c;){for(s=qa=c;null!==qa;){switch(d=(A=qa).child,A.tag){case 0:case 11:case 14:case 15:eo(4,A,A.return);break;case 1:_a(A,A.return);var u=A.stateNode;if("function"===typeof u.componentWillUnmount){I=A,t=A.return;try{e=I,u.props=e.memoizedProps,u.state=e.memoizedState,u.componentWillUnmount()}catch(m){Si(I,t,m)}}break;case 5:_a(A,A.return);break;case 22:if(null!==A.memoizedState){Go(s);continue}}null!==d?(d.return=A,qa=d):Go(s)}c=c.sibling}g:for(c=null,s=g;;){if(5===s.tag){if(null===c){c=s;try{n=s.stateNode,r?"function"===typeof(l=n.style).setProperty?l.setProperty("display","none","important"):l.display="none":(o=s.stateNode,a=void 0!==(i=s.memoizedProps.style)&&null!==i&&i.hasOwnProperty("display")?i.display:null,o.style.display=ug("display",a))}catch(m){Si(g,g.return,m)}}}else if(6===s.tag){if(null===c)try{s.stateNode.nodeValue=r?"":s.memoizedProps}catch(m){Si(g,g.return,m)}}else if((22!==s.tag&&23!==s.tag||null===s.memoizedState||s===g)&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===g)break g;for(;null===s.sibling;){if(null===s.return||s.return===g)break g;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}}break;case 19:uo(e,g),ho(g),4&I&&Ao(g);case 21:}}function ho(g){var e=g.flags;if(2&e){try{g:{for(var t=g.return;null!==t;){if(Co(t)){var I=t;break g}t=t.return}throw Error(C(160))}switch(I.tag){case 5:var n=I.stateNode;32&I.flags&&(sg(n,""),I.flags&=-33),oo(g,lo(g),n);break;case 3:case 4:var l=I.stateNode.containerInfo;ao(g,lo(g),l);break;default:throw Error(C(161))}}catch(a){Si(g,g.return,a)}g.flags&=-3}4096&e&&(g.flags&=-4097)}function bo(g,e,t){qa=g,Zo(g,e,t)}function Zo(g,e,t){for(var I=0!==(1&g.mode);null!==qa;){var n=qa,C=n.child;if(22===n.tag&&I){var l=null!==n.memoizedState||Ta;if(!l){var a=n.alternate,o=null!==a&&null!==a.memoizedState||Pa;a=Ta;var i=Pa;if(Ta=l,(Pa=o)&&!i)for(qa=n;null!==qa;)o=(l=qa).child,22===l.tag&&null!==l.memoizedState?yo(n):null!==o?(o.return=l,qa=o):yo(n);for(;null!==C;)qa=C,Zo(C,e,t),C=C.sibling;qa=n,Ta=a,Pa=i}po(g)}else 0!==(8772&n.subtreeFlags)&&null!==C?(C.return=n,qa=C):po(g)}}function po(g){for(;null!==qa;){var e=qa;if(0!==(8772&e.flags)){var t=e.alternate;try{if(0!==(8772&e.flags))switch(e.tag){case 0:case 11:case 15:Pa||to(5,e);break;case 1:var I=e.stateNode;if(4&e.flags&&!Pa)if(null===t)I.componentDidMount();else{var n=e.elementType===e.type?t.memoizedProps:ea(e.type,t.memoizedProps);I.componentDidUpdate(n,t.memoizedState,I.__reactInternalSnapshotBeforeUpdate)}var l=e.updateQueue;null!==l&&MC(e,l,I);break;case 3:var a=e.updateQueue;if(null!==a){if(t=null,null!==e.child)switch(e.child.tag){case 5:case 1:t=e.child.stateNode}MC(e,a,t)}break;case 5:var o=e.stateNode;if(null===t&&4&e.flags){t=o;var i=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":i.autoFocus&&t.focus();break;case"img":i.src&&(t.src=i.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===e.memoizedState){var r=e.alternate;if(null!==r){var c=r.memoizedState;if(null!==c){var s=c.dehydrated;null!==s&&Ee(s)}}}break;default:throw Error(C(163))}Pa||512&e.flags&&Io(e)}catch(A){Si(e,e.return,A)}}if(e===g){qa=null;break}if(null!==(t=e.sibling)){t.return=e.return,qa=t;break}qa=e.return}}function Go(g){for(;null!==qa;){var e=qa;if(e===g){qa=null;break}var t=e.sibling;if(null!==t){t.return=e.return,qa=t;break}qa=e.return}}function yo(g){for(;null!==qa;){var e=qa;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{to(4,e)}catch(o){Si(e,t,o)}break;case 1:var I=e.stateNode;if("function"===typeof I.componentDidMount){var n=e.return;try{I.componentDidMount()}catch(o){Si(e,n,o)}}var C=e.return;try{Io(e)}catch(o){Si(e,C,o)}break;case 5:var l=e.return;try{Io(e)}catch(o){Si(e,l,o)}}}catch(o){Si(e,e.return,o)}if(e===g){qa=null;break}var a=e.sibling;if(null!==a){a.return=e.return,qa=a;break}qa=e.return}}var Bo,So=Math.ceil,fo=p.ReactCurrentDispatcher,Wo=p.ReactCurrentOwner,Vo=p.ReactCurrentBatchConfig,vo=0,Ro=null,Xo=null,ko=0,Jo=0,Yo=Sn(0),wo=0,No=null,Ho=0,Fo=0,Ko=0,xo=null,Lo=null,zo=0,Eo=1/0,Mo=null,Uo=!1,jo=null,Qo=null,Do=!1,To=null,Po=0,Oo=0,qo=null,_o=-1,$o=0;function gi(){return 0!==(6&vo)?qg():-1!==_o?_o:_o=qg()}function ei(g){return 0===(1&g.mode)?1:0!==(2&vo)&&0!==ko?ko&-ko:null!==uC.transition?(0===$o&&($o=ue()),$o):0!==(g=Ze)?g:g=void 0===(g=window.event)?16:Oe(g.type)}function ti(g,e,t,I){if(50<Oo)throw Oo=0,qo=null,Error(C(185));he(g,t,I),0!==(2&vo)&&g===Ro||(g===Ro&&(0===(2&vo)&&(Fo|=t),4===wo&&ai(g,ko)),Ii(g,I),1===t&&0===vo&&0===(1&e.mode)&&(Eo=qg()+500,xn&&En()))}function Ii(g,e){var t=g.callbackNode;!function(g,e){for(var t=g.suspendedLanes,I=g.pingedLanes,n=g.expirationTimes,C=g.pendingLanes;0<C;){var l=31-le(C),a=1<<l,o=n[l];-1===o?0!==(a&t)&&0===(a&I)||(n[l]=Ae(a,e)):o<=e&&(g.expiredLanes|=a),C&=~a}}(g,e);var I=se(g,g===Ro?ko:0);if(0===I)null!==t&&Tg(t),g.callbackNode=null,g.callbackPriority=0;else if(e=I&-I,g.callbackPriority!==e){if(null!=t&&Tg(t),1===e)0===g.tag?function(g){xn=!0,zn(g)}(oi.bind(null,g)):zn(oi.bind(null,g)),Cn((function(){0===(6&vo)&&En()})),t=null;else{switch(pe(I)){case 1:t=$g;break;case 4:t=ge;break;case 16:default:t=ee;break;case 536870912:t=Ie}t=Ri(t,ni.bind(null,g))}g.callbackPriority=e,g.callbackNode=t}}function ni(g,e){if(_o=-1,$o=0,0!==(6&vo))throw Error(C(327));var t=g.callbackNode;if(yi()&&g.callbackNode!==t)return null;var I=se(g,g===Ro?ko:0);if(0===I)return null;if(0!==(30&I)||0!==(I&g.expiredLanes)||e)e=mi(g,I);else{e=I;var n=vo;vo|=2;var l=di();for(Ro===g&&ko===e||(Mo=null,Eo=qg()+500,si(g,e));;)try{bi();break}catch(o){Ai(g,o)}WC(),fo.current=l,vo=n,null!==Xo?e=0:(Ro=null,ko=0,e=wo)}if(0!==e){if(2===e&&(0!==(n=de(g))&&(I=n,e=Ci(g,n))),1===e)throw t=No,si(g,0),ai(g,I),Ii(g,qg()),t;if(6===e)ai(g,I);else{if(n=g.current.alternate,0===(30&I)&&!function(g){for(var e=g;;){if(16384&e.flags){var t=e.updateQueue;if(null!==t&&null!==(t=t.stores))for(var I=0;I<t.length;I++){var n=t[I],C=n.getSnapshot;n=n.value;try{if(!lI(C(),n))return!1}catch(a){return!1}}}if(t=e.child,16384&e.subtreeFlags&&null!==t)t.return=e,e=t;else{if(e===g)break;for(;null===e.sibling;){if(null===e.return||e.return===g)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}(n)&&(2===(e=mi(g,I))&&(0!==(l=de(g))&&(I=l,e=Ci(g,l))),1===e))throw t=No,si(g,0),ai(g,I),Ii(g,qg()),t;switch(g.finishedWork=n,g.finishedLanes=I,e){case 0:case 1:throw Error(C(345));case 2:case 5:Gi(g,Lo,Mo);break;case 3:if(ai(g,I),(130023424&I)===I&&10<(e=zo+500-qg())){if(0!==se(g,0))break;if(((n=g.suspendedLanes)&I)!==I){gi(),g.pingedLanes|=g.suspendedLanes&n;break}g.timeoutHandle=tn(Gi.bind(null,g,Lo,Mo),e);break}Gi(g,Lo,Mo);break;case 4:if(ai(g,I),(4194240&I)===I)break;for(e=g.eventTimes,n=-1;0<I;){var a=31-le(I);l=1<<a,(a=e[a])>n&&(n=a),I&=~l}if(I=n,10<(I=(120>(I=qg()-I)?120:480>I?480:1080>I?1080:1920>I?1920:3e3>I?3e3:4320>I?4320:1960*So(I/1960))-I)){g.timeoutHandle=tn(Gi.bind(null,g,Lo,Mo),I);break}Gi(g,Lo,Mo);break;default:throw Error(C(329))}}}return Ii(g,qg()),g.callbackNode===t?ni.bind(null,g):null}function Ci(g,e){var t=xo;return g.current.memoizedState.isDehydrated&&(si(g,e).flags|=256),2!==(g=mi(g,e))&&(e=Lo,Lo=t,null!==e&&li(e)),g}function li(g){null===Lo?Lo=g:Lo.push.apply(Lo,g)}function ai(g,e){for(e&=~Ko,e&=~Fo,g.suspendedLanes|=e,g.pingedLanes&=~e,g=g.expirationTimes;0<e;){var t=31-le(e),I=1<<t;g[t]=-1,e&=~I}}function oi(g){if(0!==(6&vo))throw Error(C(327));yi();var e=se(g,0);if(0===(1&e))return Ii(g,qg()),null;var t=mi(g,e);if(0!==g.tag&&2===t){var I=de(g);0!==I&&(e=I,t=Ci(g,I))}if(1===t)throw t=No,si(g,0),ai(g,e),Ii(g,qg()),t;if(6===t)throw Error(C(345));return g.finishedWork=g.current.alternate,g.finishedLanes=e,Gi(g,Lo,Mo),Ii(g,qg()),null}function ii(g,e){var t=vo;vo|=1;try{return g(e)}finally{0===(vo=t)&&(Eo=qg()+500,xn&&En())}}function ri(g){null!==To&&0===To.tag&&0===(6&vo)&&yi();var e=vo;vo|=1;var t=Vo.transition,I=Ze;try{if(Vo.transition=null,Ze=1,g)return g()}finally{Ze=I,Vo.transition=t,0===(6&(vo=e))&&En()}}function ci(){Jo=Yo.current,fn(Yo)}function si(g,e){g.finishedWork=null,g.finishedLanes=0;var t=g.timeoutHandle;if(-1!==t&&(g.timeoutHandle=-1,In(t)),null!==Xo)for(t=Xo.return;null!==t;){var I=t;switch(eC(I),I.tag){case 1:null!==(I=I.type.childContextTypes)&&void 0!==I&&Yn();break;case 3:OC(),fn(Rn),fn(vn),tl();break;case 5:_C(I);break;case 4:OC();break;case 13:case 19:fn($C);break;case 10:VC(I.type._context);break;case 22:case 23:ci()}t=t.return}if(Ro=g,Xo=g=Yi(g.current,null),ko=Jo=e,wo=0,No=null,Ko=Fo=Ho=0,Lo=xo=null,null!==kC){for(e=0;e<kC.length;e++)if(null!==(I=(t=kC[e]).interleaved)){t.interleaved=null;var n=I.next,C=t.pending;if(null!==C){var l=C.next;C.next=n,I.next=l}t.pending=I}kC=null}return g}function Ai(g,e){for(;;){var t=Xo;try{if(WC(),Il.current=ql,il){for(var I=ll.memoizedState;null!==I;){var n=I.queue;null!==n&&(n.pending=null),I=I.next}il=!1}if(Cl=0,ol=al=ll=null,rl=!1,cl=0,Wo.current=null,null===t||null===t.return){wo=1,No=e,Xo=null;break}g:{var l=g,a=t.return,o=t,i=e;if(e=ko,o.flags|=32768,null!==i&&"object"===typeof i&&"function"===typeof i.then){var r=i,c=o,s=c.tag;if(0===(1&c.mode)&&(0===s||11===s||15===s)){var A=c.alternate;A?(c.updateQueue=A.updateQueue,c.memoizedState=A.memoizedState,c.lanes=A.lanes):(c.updateQueue=null,c.memoizedState=null)}var d=ua(a);if(null!==d){d.flags&=-257,ma(d,a,o,0,e),1&d.mode&&da(l,r,e),i=r;var u=(e=d).updateQueue;if(null===u){var m=new Set;m.add(i),e.updateQueue=m}else u.add(i);break g}if(0===(1&e)){da(l,r,e),ui();break g}i=Error(C(426))}else if(nC&&1&o.mode){var h=ua(a);if(null!==h){0===(65536&h.flags)&&(h.flags|=256),ma(h,a,o,0,e),dC(oa(i,o));break g}}l=i=oa(i,o),4!==wo&&(wo=2),null===xo?xo=[l]:xo.push(l),l=a;do{switch(l.tag){case 3:l.flags|=65536,e&=-e,l.lanes|=e,zC(l,sa(0,i,e));break g;case 1:o=i;var b=l.type,Z=l.stateNode;if(0===(128&l.flags)&&("function"===typeof b.getDerivedStateFromError||null!==Z&&"function"===typeof Z.componentDidCatch&&(null===Qo||!Qo.has(Z)))){l.flags|=65536,e&=-e,l.lanes|=e,zC(l,Aa(l,o,e));break g}}l=l.return}while(null!==l)}pi(t)}catch(p){e=p,Xo===t&&null!==t&&(Xo=t=t.return);continue}break}}function di(){var g=fo.current;return fo.current=ql,null===g?ql:g}function ui(){0!==wo&&3!==wo&&2!==wo||(wo=4),null===Ro||0===(268435455&Ho)&&0===(268435455&Fo)||ai(Ro,ko)}function mi(g,e){var t=vo;vo|=2;var I=di();for(Ro===g&&ko===e||(Mo=null,si(g,e));;)try{hi();break}catch(n){Ai(g,n)}if(WC(),vo=t,fo.current=I,null!==Xo)throw Error(C(261));return Ro=null,ko=0,wo}function hi(){for(;null!==Xo;)Zi(Xo)}function bi(){for(;null!==Xo&&!Pg();)Zi(Xo)}function Zi(g){var e=Bo(g.alternate,g,Jo);g.memoizedProps=g.pendingProps,null===e?pi(g):Xo=e,Wo.current=null}function pi(g){var e=g;do{var t=e.alternate;if(g=e.return,0===(32768&e.flags)){if(null!==(t=Qa(t,e,Jo)))return void(Xo=t)}else{if(null!==(t=Da(t,e)))return t.flags&=32767,void(Xo=t);if(null===g)return wo=6,void(Xo=null);g.flags|=32768,g.subtreeFlags=0,g.deletions=null}if(null!==(e=e.sibling))return void(Xo=e);Xo=e=g}while(null!==e);0===wo&&(wo=5)}function Gi(g,e,t){var I=Ze,n=Vo.transition;try{Vo.transition=null,Ze=1,function(g,e,t,I){do{yi()}while(null!==To);if(0!==(6&vo))throw Error(C(327));t=g.finishedWork;var n=g.finishedLanes;if(null===t)return null;if(g.finishedWork=null,g.finishedLanes=0,t===g.current)throw Error(C(177));g.callbackNode=null,g.callbackPriority=0;var l=t.lanes|t.childLanes;if(function(g,e){var t=g.pendingLanes&~e;g.pendingLanes=e,g.suspendedLanes=0,g.pingedLanes=0,g.expiredLanes&=e,g.mutableReadLanes&=e,g.entangledLanes&=e,e=g.entanglements;var I=g.eventTimes;for(g=g.expirationTimes;0<t;){var n=31-le(t),C=1<<n;e[n]=0,I[n]=-1,g[n]=-1,t&=~C}}(g,l),g===Ro&&(Xo=Ro=null,ko=0),0===(2064&t.subtreeFlags)&&0===(2064&t.flags)||Do||(Do=!0,Ri(ee,(function(){return yi(),null}))),l=0!==(15990&t.flags),0!==(15990&t.subtreeFlags)||l){l=Vo.transition,Vo.transition=null;var a=Ze;Ze=1;var o=vo;vo|=4,Wo.current=null,function(g,e){if($I=Ue,sI(g=cI())){if("selectionStart"in g)var t={start:g.selectionStart,end:g.selectionEnd};else g:{var I=(t=(t=g.ownerDocument)&&t.defaultView||window).getSelection&&t.getSelection();if(I&&0!==I.rangeCount){t=I.anchorNode;var n=I.anchorOffset,l=I.focusNode;I=I.focusOffset;try{t.nodeType,l.nodeType}catch(G){t=null;break g}var a=0,o=-1,i=-1,r=0,c=0,s=g,A=null;e:for(;;){for(var d;s!==t||0!==n&&3!==s.nodeType||(o=a+n),s!==l||0!==I&&3!==s.nodeType||(i=a+I),3===s.nodeType&&(a+=s.nodeValue.length),null!==(d=s.firstChild);)A=s,s=d;for(;;){if(s===g)break e;if(A===t&&++r===n&&(o=a),A===l&&++c===I&&(i=a),null!==(d=s.nextSibling))break;A=(s=A).parentNode}s=d}t=-1===o||-1===i?null:{start:o,end:i}}else t=null}t=t||{start:0,end:0}}else t=null;for(gn={focusedElem:g,selectionRange:t},Ue=!1,qa=e;null!==qa;)if(g=(e=qa).child,0!==(1028&e.subtreeFlags)&&null!==g)g.return=e,qa=g;else for(;null!==qa;){e=qa;try{var u=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==u){var m=u.memoizedProps,h=u.memoizedState,b=e.stateNode,Z=b.getSnapshotBeforeUpdate(e.elementType===e.type?m:ea(e.type,m),h);b.__reactInternalSnapshotBeforeUpdate=Z}break;case 3:var p=e.stateNode.containerInfo;1===p.nodeType?p.textContent="":9===p.nodeType&&p.documentElement&&p.removeChild(p.documentElement);break;default:throw Error(C(163))}}catch(G){Si(e,e.return,G)}if(null!==(g=e.sibling)){g.return=e.return,qa=g;break}qa=e.return}u=go,go=!1}(g,t),mo(t,g),AI(gn),Ue=!!$I,gn=$I=null,g.current=t,bo(t,g,n),Og(),vo=o,Ze=a,Vo.transition=l}else g.current=t;if(Do&&(Do=!1,To=g,Po=n),l=g.pendingLanes,0===l&&(Qo=null),function(g){if(Ce&&"function"===typeof Ce.onCommitFiberRoot)try{Ce.onCommitFiberRoot(ne,g,void 0,128===(128&g.current.flags))}catch(e){}}(t.stateNode),Ii(g,qg()),null!==e)for(I=g.onRecoverableError,t=0;t<e.length;t++)n=e[t],I(n.value,{componentStack:n.stack,digest:n.digest});if(Uo)throw Uo=!1,g=jo,jo=null,g;0!==(1&Po)&&0!==g.tag&&yi(),l=g.pendingLanes,0!==(1&l)?g===qo?Oo++:(Oo=0,qo=g):Oo=0,En()}(g,e,t,I)}finally{Vo.transition=n,Ze=I}return null}function yi(){if(null!==To){var g=pe(Po),e=Vo.transition,t=Ze;try{if(Vo.transition=null,Ze=16>g?16:g,null===To)var I=!1;else{if(g=To,To=null,Po=0,0!==(6&vo))throw Error(C(331));var n=vo;for(vo|=4,qa=g.current;null!==qa;){var l=qa,a=l.child;if(0!==(16&qa.flags)){var o=l.deletions;if(null!==o){for(var i=0;i<o.length;i++){var r=o[i];for(qa=r;null!==qa;){var c=qa;switch(c.tag){case 0:case 11:case 15:eo(8,c,l)}var s=c.child;if(null!==s)s.return=c,qa=s;else for(;null!==qa;){var A=(c=qa).sibling,d=c.return;if(no(c),c===r){qa=null;break}if(null!==A){A.return=d,qa=A;break}qa=d}}}var u=l.alternate;if(null!==u){var m=u.child;if(null!==m){u.child=null;do{var h=m.sibling;m.sibling=null,m=h}while(null!==m)}}qa=l}}if(0!==(2064&l.subtreeFlags)&&null!==a)a.return=l,qa=a;else g:for(;null!==qa;){if(0!==(2048&(l=qa).flags))switch(l.tag){case 0:case 11:case 15:eo(9,l,l.return)}var b=l.sibling;if(null!==b){b.return=l.return,qa=b;break g}qa=l.return}}var Z=g.current;for(qa=Z;null!==qa;){var p=(a=qa).child;if(0!==(2064&a.subtreeFlags)&&null!==p)p.return=a,qa=p;else g:for(a=Z;null!==qa;){if(0!==(2048&(o=qa).flags))try{switch(o.tag){case 0:case 11:case 15:to(9,o)}}catch(y){Si(o,o.return,y)}if(o===a){qa=null;break g}var G=o.sibling;if(null!==G){G.return=o.return,qa=G;break g}qa=o.return}}if(vo=n,En(),Ce&&"function"===typeof Ce.onPostCommitFiberRoot)try{Ce.onPostCommitFiberRoot(ne,g)}catch(y){}I=!0}return I}finally{Ze=t,Vo.transition=e}}return!1}function Bi(g,e,t){g=xC(g,e=sa(0,e=oa(t,e),1),1),e=gi(),null!==g&&(he(g,1,e),Ii(g,e))}function Si(g,e,t){if(3===g.tag)Bi(g,g,t);else for(;null!==e;){if(3===e.tag){Bi(e,g,t);break}if(1===e.tag){var I=e.stateNode;if("function"===typeof e.type.getDerivedStateFromError||"function"===typeof I.componentDidCatch&&(null===Qo||!Qo.has(I))){e=xC(e,g=Aa(e,g=oa(t,g),1),1),g=gi(),null!==e&&(he(e,1,g),Ii(e,g));break}}e=e.return}}function fi(g,e,t){var I=g.pingCache;null!==I&&I.delete(e),e=gi(),g.pingedLanes|=g.suspendedLanes&t,Ro===g&&(ko&t)===t&&(4===wo||3===wo&&(130023424&ko)===ko&&500>qg()-zo?si(g,0):Ko|=t),Ii(g,e)}function Wi(g,e){0===e&&(0===(1&g.mode)?e=1:(e=re,0===(130023424&(re<<=1))&&(re=4194304)));var t=gi();null!==(g=wC(g,e))&&(he(g,e,t),Ii(g,t))}function Vi(g){var e=g.memoizedState,t=0;null!==e&&(t=e.retryLane),Wi(g,t)}function vi(g,e){var t=0;switch(g.tag){case 13:var I=g.stateNode,n=g.memoizedState;null!==n&&(t=n.retryLane);break;case 19:I=g.stateNode;break;default:throw Error(C(314))}null!==I&&I.delete(e),Wi(g,t)}function Ri(g,e){return Dg(g,e)}function Xi(g,e,t,I){this.tag=g,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=I,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ki(g,e,t,I){return new Xi(g,e,t,I)}function Ji(g){return!(!(g=g.prototype)||!g.isReactComponent)}function Yi(g,e){var t=g.alternate;return null===t?((t=ki(g.tag,e,g.key,g.mode)).elementType=g.elementType,t.type=g.type,t.stateNode=g.stateNode,t.alternate=g,g.alternate=t):(t.pendingProps=e,t.type=g.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=14680064&g.flags,t.childLanes=g.childLanes,t.lanes=g.lanes,t.child=g.child,t.memoizedProps=g.memoizedProps,t.memoizedState=g.memoizedState,t.updateQueue=g.updateQueue,e=g.dependencies,t.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=g.sibling,t.index=g.index,t.ref=g.ref,t}function wi(g,e,t,I,n,l){var a=2;if(I=g,"function"===typeof g)Ji(g)&&(a=1);else if("string"===typeof g)a=5;else g:switch(g){case B:return Ni(t.children,n,l,e);case S:a=8,n|=8;break;case f:return(g=ki(12,t,e,2|n)).elementType=f,g.lanes=l,g;case R:return(g=ki(13,t,e,n)).elementType=R,g.lanes=l,g;case X:return(g=ki(19,t,e,n)).elementType=X,g.lanes=l,g;case Y:return Hi(t,n,l,e);default:if("object"===typeof g&&null!==g)switch(g.$$typeof){case W:a=10;break g;case V:a=9;break g;case v:a=11;break g;case k:a=14;break g;case J:a=16,I=null;break g}throw Error(C(130,null==g?g:typeof g,""))}return(e=ki(a,t,e,n)).elementType=g,e.type=I,e.lanes=l,e}function Ni(g,e,t,I){return(g=ki(7,g,I,e)).lanes=t,g}function Hi(g,e,t,I){return(g=ki(22,g,I,e)).elementType=Y,g.lanes=t,g.stateNode={isHidden:!1},g}function Fi(g,e,t){return(g=ki(6,g,null,e)).lanes=t,g}function Ki(g,e,t){return(e=ki(4,null!==g.children?g.children:[],g.key,e)).lanes=t,e.stateNode={containerInfo:g.containerInfo,pendingChildren:null,implementation:g.implementation},e}function xi(g,e,t,I,n){this.tag=e,this.containerInfo=g,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=me(0),this.expirationTimes=me(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=me(0),this.identifierPrefix=I,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function Li(g,e,t,I,n,C,l,a,o){return g=new xi(g,e,t,a,o),1===e?(e=1,!0===C&&(e|=8)):e=0,C=ki(3,null,null,e),g.current=C,C.stateNode=g,C.memoizedState={element:I,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},HC(C),g}function zi(g){if(!g)return Vn;g:{if(Eg(g=g._reactInternals)!==g||1!==g.tag)throw Error(C(170));var e=g;do{switch(e.tag){case 3:e=e.stateNode.context;break g;case 1:if(Jn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break g}}e=e.return}while(null!==e);throw Error(C(171))}if(1===g.tag){var t=g.type;if(Jn(t))return Nn(g,t,e)}return e}function Ei(g,e,t,I,n,C,l,a,o){return(g=Li(t,I,!0,g,0,C,0,a,o)).context=zi(null),t=g.current,(C=KC(I=gi(),n=ei(t))).callback=void 0!==e&&null!==e?e:null,xC(t,C,n),g.current.lanes=n,he(g,n,I),Ii(g,I),g}function Mi(g,e,t,I){var n=e.current,C=gi(),l=ei(n);return t=zi(t),null===e.context?e.context=t:e.pendingContext=t,(e=KC(C,l)).payload={element:g},null!==(I=void 0===I?null:I)&&(e.callback=I),null!==(g=xC(n,e,l))&&(ti(g,n,l,C),LC(g,n,l)),l}function Ui(g){return(g=g.current).child?(g.child.tag,g.child.stateNode):null}function ji(g,e){if(null!==(g=g.memoizedState)&&null!==g.dehydrated){var t=g.retryLane;g.retryLane=0!==t&&t<e?t:e}}function Qi(g,e){ji(g,e),(g=g.alternate)&&ji(g,e)}Bo=function(g,e,t){if(null!==g)if(g.memoizedProps!==e.pendingProps||Rn.current)ba=!0;else{if(0===(g.lanes&t)&&0===(128&e.flags))return ba=!1,function(g,e,t){switch(e.tag){case 3:va(e),AC();break;case 5:qC(e);break;case 1:Jn(e.type)&&Hn(e);break;case 4:PC(e,e.stateNode.containerInfo);break;case 10:var I=e.type._context,n=e.memoizedProps.value;Wn(yC,I._currentValue),I._currentValue=n;break;case 13:if(null!==(I=e.memoizedState))return null!==I.dehydrated?(Wn($C,1&$C.current),e.flags|=128,null):0!==(t&e.child.childLanes)?Ha(g,e,t):(Wn($C,1&$C.current),null!==(g=Ma(g,e,t))?g.sibling:null);Wn($C,1&$C.current);break;case 19:if(I=0!==(t&e.childLanes),0!==(128&g.flags)){if(I)return za(g,e,t);e.flags|=128}if(null!==(n=e.memoizedState)&&(n.rendering=null,n.tail=null,n.lastEffect=null),Wn($C,$C.current),I)break;return null;case 22:case 23:return e.lanes=0,Ba(g,e,t)}return Ma(g,e,t)}(g,e,t);ba=0!==(131072&g.flags)}else ba=!1,nC&&0!==(1048576&e.flags)&&$n(e,Qn,e.index);switch(e.lanes=0,e.tag){case 2:var I=e.type;Ea(g,e),g=e.pendingProps;var n=kn(e,vn.current);RC(e,t),n=ul(null,e,I,g,n,t);var l=ml();return e.flags|=1,"object"===typeof n&&null!==n&&"function"===typeof n.render&&void 0===n.$$typeof?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Jn(I)?(l=!0,Hn(e)):l=!1,e.memoizedState=null!==n.state&&void 0!==n.state?n.state:null,HC(e),n.updater=Ia,e.stateNode=n,n._reactInternals=e,aa(e,I,g,t),e=Va(null,e,I,!0,l,t)):(e.tag=0,nC&&l&&gC(e),Za(null,e,n,t),e=e.child),e;case 16:I=e.elementType;g:{switch(Ea(g,e),g=e.pendingProps,I=(n=I._init)(I._payload),e.type=I,n=e.tag=function(g){if("function"===typeof g)return Ji(g)?1:0;if(void 0!==g&&null!==g){if((g=g.$$typeof)===v)return 11;if(g===k)return 14}return 2}(I),g=ea(I,g),n){case 0:e=fa(null,e,I,g,t);break g;case 1:e=Wa(null,e,I,g,t);break g;case 11:e=pa(null,e,I,g,t);break g;case 14:e=Ga(null,e,I,ea(I.type,g),t);break g}throw Error(C(306,I,""))}return e;case 0:return I=e.type,n=e.pendingProps,fa(g,e,I,n=e.elementType===I?n:ea(I,n),t);case 1:return I=e.type,n=e.pendingProps,Wa(g,e,I,n=e.elementType===I?n:ea(I,n),t);case 3:g:{if(va(e),null===g)throw Error(C(387));I=e.pendingProps,n=(l=e.memoizedState).element,FC(g,e),EC(e,I,null,t);var a=e.memoizedState;if(I=a.element,l.isDehydrated){if(l={element:I,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=l,e.memoizedState=l,256&e.flags){e=Ra(g,e,I,t,n=oa(Error(C(423)),e));break g}if(I!==n){e=Ra(g,e,I,t,n=oa(Error(C(424)),e));break g}for(IC=on(e.stateNode.containerInfo.firstChild),tC=e,nC=!0,CC=null,t=GC(e,null,I,t),e.child=t;t;)t.flags=-3&t.flags|4096,t=t.sibling}else{if(AC(),I===n){e=Ma(g,e,t);break g}Za(g,e,I,t)}e=e.child}return e;case 5:return qC(e),null===g&&iC(e),I=e.type,n=e.pendingProps,l=null!==g?g.memoizedProps:null,a=n.children,en(I,n)?a=null:null!==l&&en(I,l)&&(e.flags|=32),Sa(g,e),Za(g,e,a,t),e.child;case 6:return null===g&&iC(e),null;case 13:return Ha(g,e,t);case 4:return PC(e,e.stateNode.containerInfo),I=e.pendingProps,null===g?e.child=pC(e,null,I,t):Za(g,e,I,t),e.child;case 11:return I=e.type,n=e.pendingProps,pa(g,e,I,n=e.elementType===I?n:ea(I,n),t);case 7:return Za(g,e,e.pendingProps,t),e.child;case 8:case 12:return Za(g,e,e.pendingProps.children,t),e.child;case 10:g:{if(I=e.type._context,n=e.pendingProps,l=e.memoizedProps,a=n.value,Wn(yC,I._currentValue),I._currentValue=a,null!==l)if(lI(l.value,a)){if(l.children===n.children&&!Rn.current){e=Ma(g,e,t);break g}}else for(null!==(l=e.child)&&(l.return=e);null!==l;){var o=l.dependencies;if(null!==o){a=l.child;for(var i=o.firstContext;null!==i;){if(i.context===I){if(1===l.tag){(i=KC(-1,t&-t)).tag=2;var r=l.updateQueue;if(null!==r){var c=(r=r.shared).pending;null===c?i.next=i:(i.next=c.next,c.next=i),r.pending=i}}l.lanes|=t,null!==(i=l.alternate)&&(i.lanes|=t),vC(l.return,t,e),o.lanes|=t;break}i=i.next}}else if(10===l.tag)a=l.type===e.type?null:l.child;else if(18===l.tag){if(null===(a=l.return))throw Error(C(341));a.lanes|=t,null!==(o=a.alternate)&&(o.lanes|=t),vC(a,t,e),a=l.sibling}else a=l.child;if(null!==a)a.return=l;else for(a=l;null!==a;){if(a===e){a=null;break}if(null!==(l=a.sibling)){l.return=a.return,a=l;break}a=a.return}l=a}Za(g,e,n.children,t),e=e.child}return e;case 9:return n=e.type,I=e.pendingProps.children,RC(e,t),I=I(n=XC(n)),e.flags|=1,Za(g,e,I,t),e.child;case 14:return n=ea(I=e.type,e.pendingProps),Ga(g,e,I,n=ea(I.type,n),t);case 15:return ya(g,e,e.type,e.pendingProps,t);case 17:return I=e.type,n=e.pendingProps,n=e.elementType===I?n:ea(I,n),Ea(g,e),e.tag=1,Jn(I)?(g=!0,Hn(e)):g=!1,RC(e,t),Ca(e,I,n),aa(e,I,n,t),Va(null,e,I,!0,g,t);case 19:return za(g,e,t);case 22:return Ba(g,e,t)}throw Error(C(156,e.tag))};var Di="function"===typeof reportError?reportError:function(g){console.error(g)};function Ti(g){this._internalRoot=g}function Pi(g){this._internalRoot=g}function Oi(g){return!(!g||1!==g.nodeType&&9!==g.nodeType&&11!==g.nodeType)}function qi(g){return!(!g||1!==g.nodeType&&9!==g.nodeType&&11!==g.nodeType&&(8!==g.nodeType||" react-mount-point-unstable "!==g.nodeValue))}function _i(){}function $i(g,e,t,I,n){var C=t._reactRootContainer;if(C){var l=C;if("function"===typeof n){var a=n;n=function(){var g=Ui(l);a.call(g)}}Mi(e,l,g,n)}else l=function(g,e,t,I,n){if(n){if("function"===typeof I){var C=I;I=function(){var g=Ui(l);C.call(g)}}var l=Ei(e,I,g,0,null,!1,0,"",_i);return g._reactRootContainer=l,g[dn]=l.current,zI(8===g.nodeType?g.parentNode:g),ri(),l}for(;n=g.lastChild;)g.removeChild(n);if("function"===typeof I){var a=I;I=function(){var g=Ui(o);a.call(g)}}var o=Li(g,0,!1,null,0,!1,0,"",_i);return g._reactRootContainer=o,g[dn]=o.current,zI(8===g.nodeType?g.parentNode:g),ri((function(){Mi(e,o,t,I)})),o}(t,e,g,n,I);return Ui(l)}Pi.prototype.render=Ti.prototype.render=function(g){var e=this._internalRoot;if(null===e)throw Error(C(409));Mi(g,e,null,null)},Pi.prototype.unmount=Ti.prototype.unmount=function(){var g=this._internalRoot;if(null!==g){this._internalRoot=null;var e=g.containerInfo;ri((function(){Mi(null,g,null,null)})),e[dn]=null}},Pi.prototype.unstable_scheduleHydration=function(g){if(g){var e=Se();g={blockedOn:null,target:g,priority:e};for(var t=0;t<Ye.length&&0!==e&&e<Ye[t].priority;t++);Ye.splice(t,0,g),0===t&&Fe(g)}},Ge=function(g){switch(g.tag){case 3:var e=g.stateNode;if(e.current.memoizedState.isDehydrated){var t=ce(e.pendingLanes);0!==t&&(be(e,1|t),Ii(e,qg()),0===(6&vo)&&(Eo=qg()+500,En()))}break;case 13:ri((function(){var e=wC(g,1);if(null!==e){var t=gi();ti(e,g,1,t)}})),Qi(g,1)}},ye=function(g){if(13===g.tag){var e=wC(g,134217728);if(null!==e)ti(e,g,134217728,gi());Qi(g,134217728)}},Be=function(g){if(13===g.tag){var e=ei(g),t=wC(g,e);if(null!==t)ti(t,g,e,gi());Qi(g,e)}},Se=function(){return Ze},fe=function(g,e){var t=Ze;try{return Ze=g,e()}finally{Ze=t}},yg=function(g,e,t){switch(e){case"input":if(_(g,t),e=t.name,"radio"===t.type&&null!=e){for(t=g;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var I=t[e];if(I!==g&&I.form===g.form){var n=Gn(I);if(!n)throw Error(C(90));D(I),_(I,n)}}}break;case"textarea":Cg(g,t);break;case"select":null!=(e=t.value)&&tg(g,!!t.multiple,e,!1)}},vg=ii,Rg=ri;var gr={usingClientEntryPoint:!1,Events:[Zn,pn,Gn,Wg,Vg,ii]},er={findFiberByHostInstance:bn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tr={bundleType:er.bundleType,version:er.version,rendererPackageName:er.rendererPackageName,rendererConfig:er.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:p.ReactCurrentDispatcher,findHostInstanceByFiber:function(g){return null===(g=jg(g))?null:g.stateNode},findFiberByHostInstance:er.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Ir=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ir.isDisabled&&Ir.supportsFiber)try{ne=Ir.inject(tr),Ce=Ir}catch(rg){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gr,e.createPortal=function(g,e){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Oi(e))throw Error(C(200));return function(g,e,t){var I=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:y,key:null==I?null:""+I,children:g,containerInfo:e,implementation:t}}(g,e,null,t)},e.createRoot=function(g,e){if(!Oi(g))throw Error(C(299));var t=!1,I="",n=Di;return null!==e&&void 0!==e&&(!0===e.unstable_strictMode&&(t=!0),void 0!==e.identifierPrefix&&(I=e.identifierPrefix),void 0!==e.onRecoverableError&&(n=e.onRecoverableError)),e=Li(g,1,!1,null,0,t,0,I,n),g[dn]=e.current,zI(8===g.nodeType?g.parentNode:g),new Ti(e)},e.findDOMNode=function(g){if(null==g)return null;if(1===g.nodeType)return g;var e=g._reactInternals;if(void 0===e){if("function"===typeof g.render)throw Error(C(188));throw g=Object.keys(g).join(","),Error(C(268,g))}return g=null===(g=jg(e))?null:g.stateNode},e.flushSync=function(g){return ri(g)},e.hydrate=function(g,e,t){if(!qi(e))throw Error(C(200));return $i(null,g,e,!0,t)},e.hydrateRoot=function(g,e,t){if(!Oi(g))throw Error(C(405));var I=null!=t&&t.hydratedSources||null,n=!1,l="",a=Di;if(null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(l=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),e=Ei(e,null,g,1,null!=t?t:null,n,0,l,a),g[dn]=e.current,zI(g),I)for(g=0;g<I.length;g++)n=(n=(t=I[g])._getVersion)(t._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[t,n]:e.mutableSourceEagerHydrationData.push(t,n);return new Pi(e)},e.render=function(g,e,t){if(!qi(e))throw Error(C(200));return $i(null,g,e,!1,t)},e.unmountComponentAtNode=function(g){if(!qi(g))throw Error(C(40));return!!g._reactRootContainer&&(ri((function(){$i(null,null,g,!1,(function(){g._reactRootContainer=null,g[dn]=null}))})),!0)},e.unstable_batchedUpdates=ii,e.unstable_renderSubtreeIntoContainer=function(g,e,t,I){if(!qi(t))throw Error(C(200));if(null==g||void 0===g._reactInternals)throw Error(C(38));return $i(g,e,t,!1,I)},e.version="18.3.1-next-f1338f8080-20240426"},4202:(g,e)=>{"use strict";var t=Symbol.for("react.element"),I=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),o=Symbol.for("react.context"),i=Symbol.for("react.forward_ref"),r=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),s=Symbol.for("react.lazy"),A=Symbol.iterator;var d={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},u=Object.assign,m={};function h(g,e,t){this.props=g,this.context=e,this.refs=m,this.updater=t||d}function b(){}function Z(g,e,t){this.props=g,this.context=e,this.refs=m,this.updater=t||d}h.prototype.isReactComponent={},h.prototype.setState=function(g,e){if("object"!==typeof g&&"function"!==typeof g&&null!=g)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,g,e,"setState")},h.prototype.forceUpdate=function(g){this.updater.enqueueForceUpdate(this,g,"forceUpdate")},b.prototype=h.prototype;var p=Z.prototype=new b;p.constructor=Z,u(p,h.prototype),p.isPureReactComponent=!0;var G=Array.isArray,y=Object.prototype.hasOwnProperty,B={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function f(g,e,I){var n,C={},l=null,a=null;if(null!=e)for(n in void 0!==e.ref&&(a=e.ref),void 0!==e.key&&(l=""+e.key),e)y.call(e,n)&&!S.hasOwnProperty(n)&&(C[n]=e[n]);var o=arguments.length-2;if(1===o)C.children=I;else if(1<o){for(var i=Array(o),r=0;r<o;r++)i[r]=arguments[r+2];C.children=i}if(g&&g.defaultProps)for(n in o=g.defaultProps)void 0===C[n]&&(C[n]=o[n]);return{$$typeof:t,type:g,key:l,ref:a,props:C,_owner:B.current}}function W(g){return"object"===typeof g&&null!==g&&g.$$typeof===t}var V=/\/+/g;function v(g,e){return"object"===typeof g&&null!==g&&null!=g.key?function(g){var e={"=":"=0",":":"=2"};return"$"+g.replace(/[=:]/g,(function(g){return e[g]}))}(""+g.key):e.toString(36)}function R(g,e,n,C,l){var a=typeof g;"undefined"!==a&&"boolean"!==a||(g=null);var o=!1;if(null===g)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(g.$$typeof){case t:case I:o=!0}}if(o)return l=l(o=g),g=""===C?"."+v(o,0):C,G(l)?(n="",null!=g&&(n=g.replace(V,"$&/")+"/"),R(l,e,n,"",(function(g){return g}))):null!=l&&(W(l)&&(l=function(g,e){return{$$typeof:t,type:g.type,key:e,ref:g.ref,props:g.props,_owner:g._owner}}(l,n+(!l.key||o&&o.key===l.key?"":(""+l.key).replace(V,"$&/")+"/")+g)),e.push(l)),1;if(o=0,C=""===C?".":C+":",G(g))for(var i=0;i<g.length;i++){var r=C+v(a=g[i],i);o+=R(a,e,n,r,l)}else if(r=function(g){return null===g||"object"!==typeof g?null:"function"===typeof(g=A&&g[A]||g["@@iterator"])?g:null}(g),"function"===typeof r)for(g=r.call(g),i=0;!(a=g.next()).done;)o+=R(a=a.value,e,n,r=C+v(a,i++),l);else if("object"===a)throw e=String(g),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(g).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function X(g,e,t){if(null==g)return g;var I=[],n=0;return R(g,I,"","",(function(g){return e.call(t,g,n++)})),I}function k(g){if(-1===g._status){var e=g._result;(e=e()).then((function(e){0!==g._status&&-1!==g._status||(g._status=1,g._result=e)}),(function(e){0!==g._status&&-1!==g._status||(g._status=2,g._result=e)})),-1===g._status&&(g._status=0,g._result=e)}if(1===g._status)return g._result.default;throw g._result}var J={current:null},Y={transition:null},w={ReactCurrentDispatcher:J,ReactCurrentBatchConfig:Y,ReactCurrentOwner:B};function N(){throw Error("act(...) is not supported in production builds of React.")}e.Children={map:X,forEach:function(g,e,t){X(g,(function(){e.apply(this,arguments)}),t)},count:function(g){var e=0;return X(g,(function(){e++})),e},toArray:function(g){return X(g,(function(g){return g}))||[]},only:function(g){if(!W(g))throw Error("React.Children.only expected to receive a single React element child.");return g}},e.Component=h,e.Fragment=n,e.Profiler=l,e.PureComponent=Z,e.StrictMode=C,e.Suspense=r,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=w,e.act=N,e.cloneElement=function(g,e,I){if(null===g||void 0===g)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+g+".");var n=u({},g.props),C=g.key,l=g.ref,a=g._owner;if(null!=e){if(void 0!==e.ref&&(l=e.ref,a=B.current),void 0!==e.key&&(C=""+e.key),g.type&&g.type.defaultProps)var o=g.type.defaultProps;for(i in e)y.call(e,i)&&!S.hasOwnProperty(i)&&(n[i]=void 0===e[i]&&void 0!==o?o[i]:e[i])}var i=arguments.length-2;if(1===i)n.children=I;else if(1<i){o=Array(i);for(var r=0;r<i;r++)o[r]=arguments[r+2];n.children=o}return{$$typeof:t,type:g.type,key:C,ref:l,props:n,_owner:a}},e.createContext=function(g){return(g={$$typeof:o,_currentValue:g,_currentValue2:g,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:g},g.Consumer=g},e.createElement=f,e.createFactory=function(g){var e=f.bind(null,g);return e.type=g,e},e.createRef=function(){return{current:null}},e.forwardRef=function(g){return{$$typeof:i,render:g}},e.isValidElement=W,e.lazy=function(g){return{$$typeof:s,_payload:{_status:-1,_result:g},_init:k}},e.memo=function(g,e){return{$$typeof:c,type:g,compare:void 0===e?null:e}},e.startTransition=function(g){var e=Y.transition;Y.transition={};try{g()}finally{Y.transition=e}},e.unstable_act=N,e.useCallback=function(g,e){return J.current.useCallback(g,e)},e.useContext=function(g){return J.current.useContext(g)},e.useDebugValue=function(){},e.useDeferredValue=function(g){return J.current.useDeferredValue(g)},e.useEffect=function(g,e){return J.current.useEffect(g,e)},e.useId=function(){return J.current.useId()},e.useImperativeHandle=function(g,e,t){return J.current.useImperativeHandle(g,e,t)},e.useInsertionEffect=function(g,e){return J.current.useInsertionEffect(g,e)},e.useLayoutEffect=function(g,e){return J.current.useLayoutEffect(g,e)},e.useMemo=function(g,e){return J.current.useMemo(g,e)},e.useReducer=function(g,e,t){return J.current.useReducer(g,e,t)},e.useRef=function(g){return J.current.useRef(g)},e.useState=function(g){return J.current.useState(g)},e.useSyncExternalStore=function(g,e,t){return J.current.useSyncExternalStore(g,e,t)},e.useTransition=function(){return J.current.useTransition()},e.version="18.3.1"},4391:(g,e,t)=>{"use strict";var I=t(7950);e.createRoot=I.createRoot,e.hydrateRoot=I.hydrateRoot},5043:(g,e,t)=>{"use strict";g.exports=t(4202)},7234:(g,e)=>{"use strict";function t(g,e){var t=g.length;g.push(e);g:for(;0<t;){var I=t-1>>>1,n=g[I];if(!(0<C(n,e)))break g;g[I]=e,g[t]=n,t=I}}function I(g){return 0===g.length?null:g[0]}function n(g){if(0===g.length)return null;var e=g[0],t=g.pop();if(t!==e){g[0]=t;g:for(var I=0,n=g.length,l=n>>>1;I<l;){var a=2*(I+1)-1,o=g[a],i=a+1,r=g[i];if(0>C(o,t))i<n&&0>C(r,o)?(g[I]=r,g[i]=t,I=i):(g[I]=o,g[a]=t,I=a);else{if(!(i<n&&0>C(r,t)))break g;g[I]=r,g[i]=t,I=i}}}return e}function C(g,e){var t=g.sortIndex-e.sortIndex;return 0!==t?t:g.id-e.id}if("object"===typeof performance&&"function"===typeof performance.now){var l=performance;e.unstable_now=function(){return l.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var i=[],r=[],c=1,s=null,A=3,d=!1,u=!1,m=!1,h="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,Z="undefined"!==typeof setImmediate?setImmediate:null;function p(g){for(var e=I(r);null!==e;){if(null===e.callback)n(r);else{if(!(e.startTime<=g))break;n(r),e.sortIndex=e.expirationTime,t(i,e)}e=I(r)}}function G(g){if(m=!1,p(g),!u)if(null!==I(i))u=!0,Y(y);else{var e=I(r);null!==e&&w(G,e.startTime-g)}}function y(g,t){u=!1,m&&(m=!1,b(W),W=-1),d=!0;var C=A;try{for(p(t),s=I(i);null!==s&&(!(s.expirationTime>t)||g&&!R());){var l=s.callback;if("function"===typeof l){s.callback=null,A=s.priorityLevel;var a=l(s.expirationTime<=t);t=e.unstable_now(),"function"===typeof a?s.callback=a:s===I(i)&&n(i),p(t)}else n(i);s=I(i)}if(null!==s)var o=!0;else{var c=I(r);null!==c&&w(G,c.startTime-t),o=!1}return o}finally{s=null,A=C,d=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var B,S=!1,f=null,W=-1,V=5,v=-1;function R(){return!(e.unstable_now()-v<V)}function X(){if(null!==f){var g=e.unstable_now();v=g;var t=!0;try{t=f(!0,g)}finally{t?B():(S=!1,f=null)}}else S=!1}if("function"===typeof Z)B=function(){Z(X)};else if("undefined"!==typeof MessageChannel){var k=new MessageChannel,J=k.port2;k.port1.onmessage=X,B=function(){J.postMessage(null)}}else B=function(){h(X,0)};function Y(g){f=g,S||(S=!0,B())}function w(g,t){W=h((function(){g(e.unstable_now())}),t)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(g){g.callback=null},e.unstable_continueExecution=function(){u||d||(u=!0,Y(y))},e.unstable_forceFrameRate=function(g){0>g||125<g?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<g?Math.floor(1e3/g):5},e.unstable_getCurrentPriorityLevel=function(){return A},e.unstable_getFirstCallbackNode=function(){return I(i)},e.unstable_next=function(g){switch(A){case 1:case 2:case 3:var e=3;break;default:e=A}var t=A;A=e;try{return g()}finally{A=t}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(g,e){switch(g){case 1:case 2:case 3:case 4:case 5:break;default:g=3}var t=A;A=g;try{return e()}finally{A=t}},e.unstable_scheduleCallback=function(g,n,C){var l=e.unstable_now();switch("object"===typeof C&&null!==C?C="number"===typeof(C=C.delay)&&0<C?l+C:l:C=l,g){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return g={id:c++,callback:n,priorityLevel:g,startTime:C,expirationTime:a=C+a,sortIndex:-1},C>l?(g.sortIndex=C,t(r,g),null===I(i)&&g===I(r)&&(m?(b(W),W=-1):m=!0,w(G,C-l))):(g.sortIndex=a,t(i,g),u||d||(u=!0,Y(y))),g},e.unstable_shouldYield=R,e.unstable_wrapCallback=function(g){var e=A;return function(){var t=A;A=e;try{return g.apply(this,arguments)}finally{A=t}}}},7545:(g,e,t)=>{"use strict";function I(g){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"==typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},I(g)}t.d(e,{A:()=>I})},7950:(g,e,t)=>{"use strict";!function g(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g)}catch(e){console.error(e)}}(),g.exports=t(2730)},8853:(g,e,t)=>{"use strict";g.exports=t(7234)},9309:function(g,e,t){g.exports=function(g){"use strict";function e(g){if(g&&g.__esModule)return g;var e=Object.create(null);return g&&Object.keys(g).forEach((function(t){if("default"!==t){var I=Object.getOwnPropertyDescriptor(g,t);Object.defineProperty(e,t,I.get?I:{enumerable:!0,get:function(){return g[t]}})}})),e.default=g,Object.freeze(e)}var t=e(g);function I(){return I=Object.assign?Object.assign.bind():function(g){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var I in t)Object.prototype.hasOwnProperty.call(t,I)&&(g[I]=t[I])}return g},I.apply(this,arguments)}function n(g,e,t){return e in g?Object.defineProperty(g,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):g[e]=t,g}function C(g){if(Array.isArray(g))return g}function l(g,e){var t=null==g?null:"undefined"!==typeof Symbol&&g[Symbol.iterator]||g["@@iterator"];if(null!=t){var I,n,C=[],l=!0,a=!1;try{for(t=t.call(g);!(l=(I=t.next()).done)&&(C.push(I.value),!e||C.length!==e);l=!0);}catch(o){a=!0,n=o}finally{try{l||null==t.return||t.return()}finally{if(a)throw n}}return C}}function a(g,e){(null==e||e>g.length)&&(e=g.length);for(var t=0,I=new Array(e);t<e;t++)I[t]=g[t];return I}function o(g,e){if(g){if("string"===typeof g)return a(g,e);var t=Object.prototype.toString.call(g).slice(8,-1);return"Object"===t&&g.constructor&&(t=g.constructor.name),"Map"===t||"Set"===t?Array.from(g):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?a(g,e):void 0}}function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(g,e){return C(g)||l(g,e)||o(g,e)||i()}function c(g,e){if(null==g)return{};var t,I,n={},C=Object.keys(g);for(I=0;I<C.length;I++)t=C[I],e.indexOf(t)>=0||(n[t]=g[t]);return n}function s(g,e){if(null==g)return{};var t,I,n=c(g,e);if(Object.getOwnPropertySymbols){var C=Object.getOwnPropertySymbols(g);for(I=0;I<C.length;I++)t=C[I],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(g,t)&&(n[t]=g[t])}return n}var A={exports:{}},d={exports:{}},u={},m="function"===typeof Symbol&&Symbol.for,h=m?Symbol.for("react.element"):60103,b=m?Symbol.for("react.portal"):60106,Z=m?Symbol.for("react.fragment"):60107,p=m?Symbol.for("react.strict_mode"):60108,G=m?Symbol.for("react.profiler"):60114,y=m?Symbol.for("react.provider"):60109,B=m?Symbol.for("react.context"):60110,S=m?Symbol.for("react.async_mode"):60111,f=m?Symbol.for("react.concurrent_mode"):60111,W=m?Symbol.for("react.forward_ref"):60112,V=m?Symbol.for("react.suspense"):60113,v=m?Symbol.for("react.suspense_list"):60120,R=m?Symbol.for("react.memo"):60115,X=m?Symbol.for("react.lazy"):60116,k=m?Symbol.for("react.block"):60121,J=m?Symbol.for("react.fundamental"):60117,Y=m?Symbol.for("react.responder"):60118,w=m?Symbol.for("react.scope"):60119;function N(g){if("object"===typeof g&&null!==g){var e=g.$$typeof;switch(e){case h:switch(g=g.type){case S:case f:case Z:case G:case p:case V:return g;default:switch(g=g&&g.$$typeof){case B:case W:case X:case R:case y:return g;default:return e}}case b:return e}}}function H(g){return N(g)===f}u.AsyncMode=S,u.ConcurrentMode=f,u.ContextConsumer=B,u.ContextProvider=y,u.Element=h,u.ForwardRef=W,u.Fragment=Z,u.Lazy=X,u.Memo=R,u.Portal=b,u.Profiler=G,u.StrictMode=p,u.Suspense=V,u.isAsyncMode=function(g){return H(g)||N(g)===S},u.isConcurrentMode=H,u.isContextConsumer=function(g){return N(g)===B},u.isContextProvider=function(g){return N(g)===y},u.isElement=function(g){return"object"===typeof g&&null!==g&&g.$$typeof===h},u.isForwardRef=function(g){return N(g)===W},u.isFragment=function(g){return N(g)===Z},u.isLazy=function(g){return N(g)===X},u.isMemo=function(g){return N(g)===R},u.isPortal=function(g){return N(g)===b},u.isProfiler=function(g){return N(g)===G},u.isStrictMode=function(g){return N(g)===p},u.isSuspense=function(g){return N(g)===V},u.isValidElementType=function(g){return"string"===typeof g||"function"===typeof g||g===Z||g===f||g===G||g===p||g===V||g===v||"object"===typeof g&&null!==g&&(g.$$typeof===X||g.$$typeof===R||g.$$typeof===y||g.$$typeof===B||g.$$typeof===W||g.$$typeof===J||g.$$typeof===Y||g.$$typeof===w||g.$$typeof===k)},u.typeOf=N,d.exports=u;Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;function F(){try{if(!Object.assign)return!1;var g=new String("abc");if(g[5]="de","5"===Object.getOwnPropertyNames(g)[0])return!1;for(var e={},t=0;t<10;t++)e["_"+String.fromCharCode(t)]=t;var I=Object.getOwnPropertyNames(e).map((function(g){return e[g]}));if("0123456789"!==I.join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(g){n[g]=g})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(C){return!1}}F()&&Object.assign;var K="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";function x(g,e,t,I,n){}Function.call.bind(Object.prototype.hasOwnProperty),x.resetWarningCache=function(){},d.exports;var L=K;function z(){}function E(){}E.resetWarningCache=z;var M=function(){function g(g,e,t,I,n,C){if(C!==L){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}function e(){return g}g.isRequired=g;var t={array:g,bigint:g,bool:g,func:g,number:g,object:g,string:g,symbol:g,any:g,arrayOf:e,element:g,elementType:g,instanceOf:e,node:g,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:E,resetWarningCache:z};return t.PropTypes=t,t};A.exports=M();var U=A.exports;function j(g,e){var t=atob(g);if(e){for(var I=new Uint8Array(t.length),n=0,C=t.length;n<C;++n)I[n]=t.charCodeAt(n);return String.fromCharCode.apply(null,new Uint16Array(I.buffer))}return t}function Q(g,e,t){var I=void 0===e?null:e,n=j(g,void 0!==t&&t),C=n.indexOf("\n",10)+1,l=n.substring(C)+(I?"//# sourceMappingURL="+I:""),a=new Blob([l],{type:"application/javascript"});return URL.createObjectURL(a)}function D(g,e,t){var I;return function(n){return I=I||Q(g,e,t),new Worker(I,n)}}var T=D("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewoJJ3VzZSBzdHJpY3QnOwoKCXZhciBjb21tb25qc0dsb2JhbCA9IHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbFRoaXMgOiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHt9OwoKCWZ1bmN0aW9uIGdldEF1Z21lbnRlZE5hbWVzcGFjZShuKSB7CgkJaWYgKG4uX19lc01vZHVsZSkgcmV0dXJuIG47CgkJdmFyIGEgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICdfX2VzTW9kdWxlJywge3ZhbHVlOiB0cnVlfSk7CgkJT2JqZWN0LmtleXMobikuZm9yRWFjaChmdW5jdGlvbiAoaykgewoJCQl2YXIgZCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobiwgayk7CgkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLCBrLCBkLmdldCA/IGQgOiB7CgkJCQllbnVtZXJhYmxlOiB0cnVlLAoJCQkJZ2V0OiBmdW5jdGlvbiAoKSB7CgkJCQkJcmV0dXJuIG5ba107CgkJCQl9CgkJCX0pOwoJCX0pOwoJCXJldHVybiBhOwoJfQoKCXZhciBCaW5hcnlCaXRtYXAkMSA9IHt9OwoKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBFeGNlcHRpb24kMSA9IHt9OwoKCWZ1bmN0aW9uIGZpeFByb3RvKHRhcmdldCwgcHJvdG90eXBlKSB7CgkgIHZhciBzZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZjsKCSAgc2V0UHJvdG90eXBlT2YgPyBzZXRQcm90b3R5cGVPZih0YXJnZXQsIHByb3RvdHlwZSkgOiB0YXJnZXQuX19wcm90b19fID0gcHJvdG90eXBlOwoJfQoJZnVuY3Rpb24gZml4U3RhY2sodGFyZ2V0LCBmbikgewoJICBpZiAoZm4gPT09IHZvaWQgMCkgewoJICAgIGZuID0gdGFyZ2V0LmNvbnN0cnVjdG9yOwoJICB9CgoJICB2YXIgY2FwdHVyZVN0YWNrVHJhY2UgPSBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZTsKCSAgY2FwdHVyZVN0YWNrVHJhY2UgJiYgY2FwdHVyZVN0YWNrVHJhY2UodGFyZ2V0LCBmbik7Cgl9CgoJdmFyIF9fZXh0ZW5kcyRrID0gZnVuY3Rpb24gKCkgewoJICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCB7CgkgICAgICBfX3Byb3RvX186IFtdCgkgICAgfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICBkLl9fcHJvdG9fXyA9IGI7CgkgICAgfSB8fCBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgZm9yICh2YXIgcCBpbiBiKSB7IGlmIChiLmhhc093blByb3BlcnR5KHApKSB7IGRbcF0gPSBiW3BdOyB9IH0KCSAgICB9OwoKCSAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgfTsKCgkgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgoJICAgIGZ1bmN0aW9uIF9fKCkgewoJICAgICAgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7CgkgICAgfQoKCSAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgIH07Cgl9KCk7CgoJdmFyIEN1c3RvbUVycm9yID0gZnVuY3Rpb24gKF9zdXBlcikgewoJICBfX2V4dGVuZHMkayhDdXN0b21FcnJvciwgX3N1cGVyKTsKCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKG1lc3NhZ2UpIHsKCSAgICB2YXIgX25ld1RhcmdldCA9IHRoaXMuY29uc3RydWN0b3I7CgoJICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIG1lc3NhZ2UpIHx8IHRoaXM7CgoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfdGhpcywgJ25hbWUnLCB7CgkgICAgICB2YWx1ZTogX25ld1RhcmdldC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmaXhQcm90byhfdGhpcywgX25ld1RhcmdldC5wcm90b3R5cGUpOwoJICAgIGZpeFN0YWNrKF90aGlzKTsKCSAgICByZXR1cm4gX3RoaXM7CgkgIH0KCgkgIHJldHVybiBDdXN0b21FcnJvcjsKCX0oRXJyb3IpOwoKCXZhciBfX3NwcmVhZEFycmF5cyA9IGZ1bmN0aW9uICgpIHsKCSAgdmFyIGFyZ3VtZW50cyQxID0gYXJndW1lbnRzOwoKCSAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7IHMgKz0gYXJndW1lbnRzJDFbaV0ubGVuZ3RoOyB9CgoJICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspIHsgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspIHsgcltrXSA9IGFbal07IH0gfQoKCSAgcmV0dXJuIHI7Cgl9OwoJZnVuY3Rpb24gY3VzdG9tRXJyb3JGYWN0b3J5KGZuLCBwYXJlbnQpIHsKCSAgaWYgKHBhcmVudCA9PT0gdm9pZCAwKSB7CgkgICAgcGFyZW50ID0gRXJyb3I7CgkgIH0KCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKCkgewoJICAgIHZhciBhcmd1bWVudHMkMSA9IGFyZ3VtZW50czsKCgkgICAgdmFyIGFyZ3MgPSBbXTsKCgkgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzJDFbX2ldOwoJICAgIH0KCgkgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIEN1c3RvbUVycm9yKSkgeyByZXR1cm4gbmV3IChDdXN0b21FcnJvci5iaW5kLmFwcGx5KEN1c3RvbUVycm9yLCBfX3NwcmVhZEFycmF5cyhbdm9pZCAwXSwgYXJncykpKSgpOyB9CgkgICAgcGFyZW50LmFwcGx5KHRoaXMsIGFyZ3MpOwoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnbmFtZScsIHsKCSAgICAgIHZhbHVlOiBmbi5uYW1lIHx8IHBhcmVudC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmbi5hcHBseSh0aGlzLCBhcmdzKTsKCSAgICBmaXhTdGFjayh0aGlzLCBDdXN0b21FcnJvcik7CgkgIH0KCgkgIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhDdXN0b21FcnJvciwgewoJICAgIHByb3RvdHlwZTogewoJICAgICAgdmFsdWU6IE9iamVjdC5jcmVhdGUocGFyZW50LnByb3RvdHlwZSwgewoJICAgICAgICBjb25zdHJ1Y3RvcjogewoJICAgICAgICAgIHZhbHVlOiBDdXN0b21FcnJvciwKCSAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKCSAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICAgICAgfQoJICAgICAgfSkKCSAgICB9CgkgIH0pOwoJfQoKCXZhciBjdXN0b21FcnJvciA9IC8qI19fUFVSRV9fKi9PYmplY3QuZnJlZXplKHsKCQlfX3Byb3RvX186IG51bGwsCgkJQ3VzdG9tRXJyb3I6IEN1c3RvbUVycm9yLAoJCWN1c3RvbUVycm9yRmFjdG9yeTogY3VzdG9tRXJyb3JGYWN0b3J5Cgl9KTsKCgl2YXIgcmVxdWlyZSQkMCA9IC8qQF9fUFVSRV9fKi9nZXRBdWdtZW50ZWROYW1lc3BhY2UoY3VzdG9tRXJyb3IpOwoKCXZhciBfX2V4dGVuZHMkaiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIHRzX2N1c3RvbV9lcnJvcl8xID0gcmVxdWlyZSQkMDsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRqKEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICAvKioKCSAgICAgKiBBbGxvd3MgRXhjZXB0aW9uIHRvIGJlIGNvbnN0cnVjdGVkIGRpcmVjdGx5CgkgICAgICogd2l0aCBzb21lIG1lc3NhZ2UgYW5kIHByb3RvdHlwZSBkZWZpbml0aW9uLgoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEV4Y2VwdGlvbihtZXNzYWdlKSB7CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBFeGNlcHRpb24ucHJvdG90eXBlLmdldEtpbmQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBleCA9IHRoaXMuY29uc3RydWN0b3I7CgkgICAgICAgIHJldHVybiBleC5raW5kOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSXQncyB0eXBlZCBhcyBzdHJpbmcgc28gaXQgY2FuIGJlIGV4dGVuZGVkIGFuZCBvdmVycmlkZW4uCgkgICAgICovCgkgICAgRXhjZXB0aW9uLmtpbmQgPSAnRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRXhjZXB0aW9uOwoJfSh0c19jdXN0b21fZXJyb3JfMS5DdXN0b21FcnJvcikpOwoJRXhjZXB0aW9uJDEuZGVmYXVsdCA9IEV4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSQ5ID0gRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaShJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCkgewoJICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7CgkgICAgfQoJICAgIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0lsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbjsKCX0oRXhjZXB0aW9uXzEkOS5kZWZhdWx0KSk7CglJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMS5kZWZhdWx0ID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJ5Qml0bWFwJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgQmluYXJ5Qml0bWFwID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEJpbmFyeUJpdG1hcChiaW5hcml6ZXIpIHsKCSAgICAgICAgdGhpcy5iaW5hcml6ZXIgPSBiaW5hcml6ZXI7CgkgICAgICAgIGlmIChiaW5hcml6ZXIgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhLmRlZmF1bHQoJ0JpbmFyaXplciBtdXN0IGJlIG5vbi1udWxsLicpOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gVGhlIHdpZHRoIG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIGJpdG1hcC4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29udmVydHMgb25lIHJvdyBvZiBsdW1pbmFuY2UgZGF0YSB0byAxIGJpdCBkYXRhLiBNYXkgYWN0dWFsbHkgZG8gdGhlIGNvbnZlcnNpb24sIG9yIHJldHVybgoJICAgICAqIGNhY2hlZCBkYXRhLiBDYWxsZXJzIHNob3VsZCBhc3N1bWUgdGhpcyBtZXRob2QgaXMgZXhwZW5zaXZlIGFuZCBjYWxsIGl0IGFzIHNlbGRvbSBhcyBwb3NzaWJsZS4KCSAgICAgKiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMUQgYmFyY29kZXMgYW5kIG1heSBjaG9vc2UgdG8gYXBwbHkgc2hhcnBlbmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB5IFRoZSByb3cgdG8gZmV0Y2gsIHdoaWNoIG11c3QgYmUgaW4gWzAsIGJpdG1hcCBoZWlnaHQpCgkgICAgICogQHBhcmFtIHJvdyBBbiBvcHRpb25hbCBwcmVhbGxvY2F0ZWQgYXJyYXkuIElmIG51bGwgb3IgdG9vIHNtYWxsLCBpdCB3aWxsIGJlIGlnbm9yZWQuCgkgICAgICogICAgICAgICAgICBJZiB1c2VkLCB0aGUgQmluYXJpemVyIHdpbGwgY2FsbCBCaXRBcnJheS5jbGVhcigpLiBBbHdheXMgdXNlIHRoZSByZXR1cm5lZCBvYmplY3QuCgkgICAgICogQHJldHVybiBUaGUgYXJyYXkgb2YgYml0cyBmb3IgdGhpcyByb3cgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgcm93IGNhbid0IGJlIGJpbmFyaXplZAoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUuZ2V0QmxhY2tSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEJsYWNrUm93KHksIHJvdyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBhIDJEIGFycmF5IG9mIGx1bWluYW5jZSBkYXRhIHRvIDEgYml0LiBBcyBhYm92ZSwgYXNzdW1lIHRoaXMgbWV0aG9kIGlzIGV4cGVuc2l2ZQoJICAgICAqIGFuZCBkbyBub3QgY2FsbCBpdCByZXBlYXRlZGx5LiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMkQgYmFyY29kZXMgYW5kIG1heSBvcgoJICAgICAqIG1heSBub3QgYXBwbHkgc2hhcnBlbmluZy4gVGhlcmVmb3JlLCBhIHJvdyBmcm9tIHRoaXMgbWF0cml4IG1heSBub3QgYmUgaWRlbnRpY2FsIHRvIG9uZQoJICAgICAqIGZldGNoZWQgdXNpbmcgZ2V0QmxhY2tSb3coKSwgc28gZG9uJ3QgbWl4IGFuZCBtYXRjaCBiZXR3ZWVuIHRoZW0uCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIFRoZSAyRCBhcnJheSBvZiBiaXRzIGZvciB0aGUgaW1hZ2UgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgaW1hZ2UgY2FuJ3QgYmUgYmluYXJpemVkIHRvIG1ha2UgYSBtYXRyaXgKCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEJsYWNrTWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBUaGUgbWF0cml4IGlzIGNyZWF0ZWQgb24gZGVtYW5kIHRoZSBmaXJzdCB0aW1lIGl0IGlzIHJlcXVlc3RlZCwgdGhlbiBjYWNoZWQuIFRoZXJlIGFyZSB0d28KCSAgICAgICAgLy8gcmVhc29ucyBmb3IgdGhpczoKCSAgICAgICAgLy8gMS4gVGhpcyB3b3JrIHdpbGwgbmV2ZXIgYmUgZG9uZSBpZiB0aGUgY2FsbGVyIG9ubHkgaW5zdGFsbHMgMUQgUmVhZGVyIG9iamVjdHMsIG9yIGlmIGEKCSAgICAgICAgLy8gICAgMUQgUmVhZGVyIGZpbmRzIGEgYmFyY29kZSBiZWZvcmUgdGhlIDJEIFJlYWRlcnMgcnVuLgoJICAgICAgICAvLyAyLiBUaGlzIHdvcmsgd2lsbCBvbmx5IGJlIGRvbmUgb25jZSBldmVuIGlmIHRoZSBjYWxsZXIgaW5zdGFsbHMgbXVsdGlwbGUgMkQgUmVhZGVycy4KCSAgICAgICAgaWYgKHRoaXMubWF0cml4ID09PSBudWxsIHx8IHRoaXMubWF0cml4ID09PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gdGhpcy5iaW5hcml6ZXIuZ2V0QmxhY2tNYXRyaXgoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5tYXRyaXg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFdoZXRoZXIgdGhpcyBiaXRtYXAgY2FuIGJlIGNyb3BwZWQuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5pc0Nyb3BTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggY3JvcHBlZCBpbWFnZSBkYXRhLiBJbXBsZW1lbnRhdGlvbnMgbWF5IGtlZXAgYSByZWZlcmVuY2UgdG8gdGhlCgkgICAgICogb3JpZ2luYWwgZGF0YSByYXRoZXIgdGhhbiBhIGNvcHkuIE9ubHkgY2FsbGFibGUgaWYgaXNDcm9wU3VwcG9ydGVkKCkgaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBsZWZ0IFRoZSBsZWZ0IGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0V2lkdGgoKSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB0b3AgY29vcmRpbmF0ZSwgd2hpY2ggbXVzdCBiZSBpbiBbMCxnZXRIZWlnaHQoKSkKCSAgICAgKiBAcGFyYW0gd2lkdGggVGhlIHdpZHRoIG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcGFyYW0gaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIHJlY3RhbmdsZSB0byBjcm9wLgoJICAgICAqIEByZXR1cm4gQSBjcm9wcGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBuZXdTb3VyY2UgPSB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5jcm9wKGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIGJpdG1hcCBzdXBwb3J0cyBjb3VudGVyLWNsb2Nrd2lzZSByb3RhdGlvbi4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmlzUm90YXRlU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkuaXNSb3RhdGVTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpOwoJICAgICAgICByZXR1cm4gbmV3IEJpbmFyeUJpdG1hcCh0aGlzLmJpbmFyaXplci5jcmVhdGVCaW5hcml6ZXIobmV3U291cmNlKSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIHJvdGF0ZWQgaW1hZ2UgZGF0YSBieSA0NSBkZWdyZWVzIGNvdW50ZXJjbG9ja3dpc2UuCgkgICAgICogT25seSBjYWxsYWJsZSBpZiB7QGxpbmsgI2lzUm90YXRlU3VwcG9ydGVkKCl9IGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIEEgcm90YXRlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QmxhY2tNYXRyaXgoKS50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlIC8qOiBOb3RGb3VuZEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICByZXR1cm4gJyc7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaW5hcnlCaXRtYXA7Cgl9KCkpOwoJdmFyIF9kZWZhdWx0JDMgPSBCaW5hcnlCaXRtYXAkMS5kZWZhdWx0ID0gQmluYXJ5Qml0bWFwOwoKCXZhciBIeWJyaWRCaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBCaW5hcml6ZXIkMSA9IHt9OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJpemVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogVGhpcyBjbGFzcyBoaWVyYXJjaHkgcHJvdmlkZXMgYSBzZXQgb2YgbWV0aG9kcyB0byBjb252ZXJ0IGx1bWluYW5jZSBkYXRhIHRvIDEgYml0IGRhdGEuCgkgKiBJdCBhbGxvd3MgdGhlIGFsZ29yaXRobSB0byB2YXJ5IHBvbHltb3JwaGljYWxseSwgZm9yIGV4YW1wbGUgYWxsb3dpbmcgYSB2ZXJ5IGV4cGVuc2l2ZQoJICogdGhyZXNob2xkaW5nIHRlY2huaXF1ZSBmb3Igc2VydmVycyBhbmQgYSBmYXN0IG9uZSBmb3IgbW9iaWxlLiBJdCBhbHNvIHBlcm1pdHMgdGhlIGltcGxlbWVudGF0aW9uCgkgKiB0byB2YXJ5LCBlLmcuIGEgSk5JIHZlcnNpb24gZm9yIEFuZHJvaWQgYW5kIGEgSmF2YSBmYWxsYmFjayB2ZXJzaW9uIGZvciBvdGhlciBwbGF0Zm9ybXMuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpbmFyaXplciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBCaW5hcml6ZXIoc291cmNlKSB7CgkgICAgICAgIHRoaXMuc291cmNlID0gc291cmNlOwoJICAgIH0KCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEx1bWluYW5jZVNvdXJjZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlOwoJICAgIH07CgkgICAgQmluYXJpemVyLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgcmV0dXJuIEJpbmFyaXplcjsKCX0oKSk7CglCaW5hcml6ZXIkMS5kZWZhdWx0ID0gQmluYXJpemVyOwoKCXZhciBCaXRBcnJheSQxID0ge307CgoJdmFyIEFycmF5cyQxID0ge307CgoJdmFyIFN5c3RlbSQxID0ge307CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN5c3RlbSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIFN5c3RlbSgpIHsKCSAgICB9CgkgICAgLy8gcHVibGljIHN0YXRpYyB2b2lkIGFycmF5Y29weShPYmplY3Qgc3JjLCBpbnQgc3JjUG9zLCBPYmplY3QgZGVzdCwgaW50IGRlc3RQb3MsIGludCBsZW5ndGgpCgkgICAgLyoqCgkgICAgICogTWFrZXMgYSBjb3B5IG9mIGEgYXJyYXkuCgkgICAgICovCgkgICAgU3lzdGVtLmFycmF5Y29weSA9IGZ1bmN0aW9uIChzcmMsIHNyY1BvcywgZGVzdCwgZGVzdFBvcywgbGVuZ3RoKSB7CgkgICAgICAgIC8vIFRPRE86IGJldHRlciB1c2Ugc3BsaXQgb3Igc2V0PwoJICAgICAgICB3aGlsZSAobGVuZ3RoLS0pIHsKCSAgICAgICAgICAgIGRlc3RbZGVzdFBvcysrXSA9IHNyY1tzcmNQb3MrK107CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIGN1cnJlbnQgdGltZSBpbiBtaWxsaXNlY29uZHMuCgkgICAgICovCgkgICAgU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gRGF0ZS5ub3coKTsKCSAgICB9OwoJICAgIHJldHVybiBTeXN0ZW07Cgl9KCkpOwoJU3lzdGVtJDEuZGVmYXVsdCA9IFN5c3RlbTsKCgl2YXIgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyRoID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDggPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaChJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbi5raW5kID0gJ0luZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ4LmRlZmF1bHQpKTsKCUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uXzEgPSBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZyhBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uKGluZGV4LCBtZXNzYWdlKSB7CgkgICAgICAgIGlmIChpbmRleCA9PT0gdm9pZCAwKSB7IGluZGV4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5pbmRleCA9IGluZGV4OwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24ua2luZCA9ICdBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb247Cgl9KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KSk7CglBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoKCXZhciBfX3ZhbHVlcyQ3ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5cyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtXzEkNSA9IFN5c3RlbSQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDkgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMSA9IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxOwoJdmFyIEFycmF5cyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBcnJheXMoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQgYXJyYXkKCSAgICAgKiBvZiBpbnRzLgoJICAgICAqCgkgICAgICogQHBhcmFtIGEgdGhlIGFycmF5IHRvIGJlIGZpbGxlZAoJICAgICAqIEBwYXJhbSB2YWwgdGhlIHZhbHVlIHRvIGJlIHN0b3JlZCBpbiBhbGwgZWxlbWVudHMgb2YgdGhlIGFycmF5CgkgICAgICovCgkgICAgQXJyYXlzLmZpbGwgPSBmdW5jdGlvbiAoYSwgdmFsKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhLmxlbmd0aDsgaSA8IGxlbjsgaSsrKQoJICAgICAgICAgICAgYVtpXSA9IHZhbDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQKCSAgICAgKiByYW5nZSBvZiB0aGUgc3BlY2lmaWVkIGFycmF5IG9mIGludHMuICBUaGUgcmFuZ2UgdG8gYmUgZmlsbGVkCgkgICAgICogZXh0ZW5kcyBmcm9tIGluZGV4IHtAY29kZSBmcm9tSW5kZXh9LCBpbmNsdXNpdmUsIHRvIGluZGV4CgkgICAgICoge0Bjb2RlIHRvSW5kZXh9LCBleGNsdXNpdmUuICAoSWYge0Bjb2RlIGZyb21JbmRleD09dG9JbmRleH0sIHRoZQoJICAgICAqIHJhbmdlIHRvIGJlIGZpbGxlZCBpcyBlbXB0eS4pCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYSB0aGUgYXJyYXkgdG8gYmUgZmlsbGVkCgkgICAgICogQHBhcmFtIGZyb21JbmRleCB0aGUgaW5kZXggb2YgdGhlIGZpcnN0IGVsZW1lbnQgKGluY2x1c2l2ZSkgdG8gYmUKCSAgICAgKiAgICAgICAgZmlsbGVkIHdpdGggdGhlIHNwZWNpZmllZCB2YWx1ZQoJICAgICAqIEBwYXJhbSB0b0luZGV4IHRoZSBpbmRleCBvZiB0aGUgbGFzdCBlbGVtZW50IChleGNsdXNpdmUpIHRvIGJlCgkgICAgICogICAgICAgIGZpbGxlZCB3aXRoIHRoZSBzcGVjaWZpZWQgdmFsdWUKCSAgICAgKiBAcGFyYW0gdmFsIHRoZSB2YWx1ZSB0byBiZSBzdG9yZWQgaW4gYWxsIGVsZW1lbnRzIG9mIHRoZSBhcnJheQoJICAgICAqIEB0aHJvd3MgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPiB0b0luZGV4fQoJICAgICAqIEB0aHJvd3MgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPCAwfSBvcgoJICAgICAqICAgICAgICAge0Bjb2RlIHRvSW5kZXggPiBhLmxlbmd0aH0KCSAgICAgKi8KCSAgICBBcnJheXMuZmlsbFdpdGhpbiA9IGZ1bmN0aW9uIChhLCBmcm9tSW5kZXgsIHRvSW5kZXgsIHZhbCkgewoJICAgICAgICBBcnJheXMucmFuZ2VDaGVjayhhLmxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZyb21JbmRleDsgaSA8IHRvSW5kZXg7IGkrKykKCSAgICAgICAgICAgIGFbaV0gPSB2YWw7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDaGVja3MgdGhhdCB7QGNvZGUgZnJvbUluZGV4fSBhbmQge0Bjb2RlIHRvSW5kZXh9IGFyZSBpbgoJICAgICAqIHRoZSByYW5nZSBhbmQgdGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiB0aGV5IGFyZW4ndC4KCSAgICAgKi8KCSAgICBBcnJheXMucmFuZ2VDaGVjayA9IGZ1bmN0aW9uIChhcnJheUxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KSB7CgkgICAgICAgIGlmIChmcm9tSW5kZXggPiB0b0luZGV4KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOS5kZWZhdWx0KCdmcm9tSW5kZXgoJyArIGZyb21JbmRleCArICcpID4gdG9JbmRleCgnICsgdG9JbmRleCArICcpJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGZyb21JbmRleCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KGZyb21JbmRleCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvSW5kZXggPiBhcnJheUxlbmd0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbl8xLmRlZmF1bHQodG9JbmRleCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEFycmF5cy5hc0xpc3QgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBhcmdzID0gW107CgkgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7CgkgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGFyZ3M7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlID0gZnVuY3Rpb24gKHJvd3MsIGNvbHMsIHZhbHVlKSB7CgkgICAgICAgIHZhciBhcnIgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiByb3dzIH0pOwoJICAgICAgICByZXR1cm4gYXJyLm1hcChmdW5jdGlvbiAoeCkgeyByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlSW50MzJBcnJheSA9IGZ1bmN0aW9uIChyb3dzLCBjb2xzLCB2YWx1ZSkgewoJICAgICAgICB2YXIgYXJyID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogcm93cyB9KTsKCSAgICAgICAgcmV0dXJuIGFyci5tYXAoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIEludDMyQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuZXF1YWxzID0gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsKCSAgICAgICAgaWYgKCFmaXJzdCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIGlmICghc2Vjb25kKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKCFmaXJzdC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoIXNlY29uZC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZmlyc3QubGVuZ3RoICE9PSBzZWNvbmQubGVuZ3RoKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gZmlyc3QubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgaWYgKGZpcnN0W2ldICE9PSBzZWNvbmRbaV0pIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICBBcnJheXMuaGFzaENvZGUgPSBmdW5jdGlvbiAoYSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgaWYgKGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSAxOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgYV8xID0gX192YWx1ZXMkNyhhKSwgYV8xXzEgPSBhXzEubmV4dCgpOyAhYV8xXzEuZG9uZTsgYV8xXzEgPSBhXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBhXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAzMSAqIHJlc3VsdCArIGVsZW1lbnQ7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChhXzFfMSAmJiAhYV8xXzEuZG9uZSAmJiAoX2EgPSBhXzEucmV0dXJuKSkgX2EuY2FsbChhXzEpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzEpIHRocm93IGVfMS5lcnJvcjsgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBBcnJheXMuZmlsbFVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAoYSwgdmFsdWUpIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgIT09IGEubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIGFbaV0gPSB2YWx1ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZiA9IGZ1bmN0aW9uIChvcmlnaW5hbCwgbmV3TGVuZ3RoKSB7CgkgICAgICAgIHJldHVybiBvcmlnaW5hbC5zbGljZSgwLCBuZXdMZW5ndGgpOwoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZlVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAob3JpZ2luYWwsIG5ld0xlbmd0aCkgewoJICAgICAgICBpZiAob3JpZ2luYWwubGVuZ3RoIDw9IG5ld0xlbmd0aCkgewoJICAgICAgICAgICAgdmFyIG5ld0FycmF5ID0gbmV3IFVpbnQ4QXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgICAgIG5ld0FycmF5LnNldChvcmlnaW5hbCk7CgkgICAgICAgICAgICByZXR1cm4gbmV3QXJyYXk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG9yaWdpbmFsLnNsaWNlKDAsIG5ld0xlbmd0aCk7CgkgICAgfTsKCSAgICBBcnJheXMuY29weU9mUmFuZ2UgPSBmdW5jdGlvbiAob3JpZ2luYWwsIGZyb20sIHRvKSB7CgkgICAgICAgIHZhciBuZXdMZW5ndGggPSB0byAtIGZyb207CgkgICAgICAgIHZhciBjb3B5ID0gbmV3IEludDMyQXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgU3lzdGVtXzEkNS5kZWZhdWx0LmFycmF5Y29weShvcmlnaW5hbCwgZnJvbSwgY29weSwgMCwgbmV3TGVuZ3RoKTsKCSAgICAgICAgcmV0dXJuIGNvcHk7CgkgICAgfTsKCSAgICAvKgoJICAgICogUmV0dXJucyB0aGUgaW5kZXggb2Ygb2YgdGhlIGVsZW1lbnQgaW4gYSBzb3J0ZWQgYXJyYXkgb3IgKC1uLTEpIHdoZXJlIG4gaXMgdGhlIGluc2VydGlvbiBwb2ludAoJICAgICogZm9yIHRoZSBuZXcgZWxlbWVudC4KCSAgICAqIFBhcmFtZXRlcnM6CgkgICAgKiAgICAgYXIgLSBBIHNvcnRlZCBhcnJheQoJICAgICogICAgIGVsIC0gQW4gZWxlbWVudCB0byBzZWFyY2ggZm9yCgkgICAgKiAgICAgY29tcGFyYXRvciAtIEEgY29tcGFyYXRvciBmdW5jdGlvbi4gVGhlIGZ1bmN0aW9uIHRha2VzIHR3byBhcmd1bWVudHM6IChhLCBiKSBhbmQgcmV0dXJuczoKCSAgICAqICAgICAgICBhIG5lZ2F0aXZlIG51bWJlciAgaWYgYSBpcyBsZXNzIHRoYW4gYjsKCSAgICAqICAgICAgICAwIGlmIGEgaXMgZXF1YWwgdG8gYjsKCSAgICAqICAgICAgICBhIHBvc2l0aXZlIG51bWJlciBvZiBhIGlzIGdyZWF0ZXIgdGhhbiBiLgoJICAgICogVGhlIGFycmF5IG1heSBjb250YWluIGR1cGxpY2F0ZSBlbGVtZW50cy4gSWYgdGhlcmUgYXJlIG1vcmUgdGhhbiBvbmUgZXF1YWwgZWxlbWVudHMgaW4gdGhlIGFycmF5LAoJICAgICogdGhlIHJldHVybmVkIHZhbHVlIGNhbiBiZSB0aGUgaW5kZXggb2YgYW55IG9uZSBvZiB0aGUgZXF1YWwgZWxlbWVudHMuCgkgICAgKgoJICAgICogaHR0cDovL2pzZmlkZGxlLm5ldC9hcnl6aG92L3BrZnN0NTUwLwoJICAgICovCgkgICAgQXJyYXlzLmJpbmFyeVNlYXJjaCA9IGZ1bmN0aW9uIChhciwgZWwsIGNvbXBhcmF0b3IpIHsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY29tcGFyYXRvcikgewoJICAgICAgICAgICAgY29tcGFyYXRvciA9IEFycmF5cy5udW1iZXJDb21wYXJhdG9yOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtID0gMDsKCSAgICAgICAgdmFyIG4gPSBhci5sZW5ndGggLSAxOwoJICAgICAgICB3aGlsZSAobSA8PSBuKSB7CgkgICAgICAgICAgICB2YXIgayA9IChuICsgbSkgPj4gMTsKCSAgICAgICAgICAgIHZhciBjbXAgPSBjb21wYXJhdG9yKGVsLCBhcltrXSk7CgkgICAgICAgICAgICBpZiAoY21wID4gMCkgewoJICAgICAgICAgICAgICAgIG0gPSBrICsgMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKGNtcCA8IDApIHsKCSAgICAgICAgICAgICAgICBuID0gayAtIDE7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gLW0gLSAxOwoJICAgIH07CgkgICAgQXJyYXlzLm51bWJlckNvbXBhcmF0b3IgPSBmdW5jdGlvbiAoYSwgYikgewoJICAgICAgICByZXR1cm4gYSAtIGI7CgkgICAgfTsKCSAgICByZXR1cm4gQXJyYXlzOwoJfSgpKTsKCUFycmF5cyQxLmRlZmF1bHQgPSBBcnJheXM7CgoJdmFyIEludGVnZXIkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnRlZ2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogUG9ueWZpbGwgZm9yIEphdmEncyBJbnRlZ2VyIGNsYXNzLgoJICovCgl2YXIgSW50ZWdlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBJbnRlZ2VyKCkgewoJICAgIH0KCSAgICBJbnRlZ2VyLm51bWJlck9mVHJhaWxpbmdaZXJvcyA9IGZ1bmN0aW9uIChpKSB7CgkgICAgICAgIHZhciB5OwoJICAgICAgICBpZiAoaSA9PT0gMCkKCSAgICAgICAgICAgIHJldHVybiAzMjsKCSAgICAgICAgdmFyIG4gPSAzMTsKCSAgICAgICAgeSA9IGkgPDwgMTY7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDE2OwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgeSA9IGkgPDwgODsKCSAgICAgICAgaWYgKHkgIT09IDApIHsKCSAgICAgICAgICAgIG4gLT0gODsKCSAgICAgICAgICAgIGkgPSB5OwoJICAgICAgICB9CgkgICAgICAgIHkgPSBpIDw8IDQ7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDQ7CgkgICAgICAgICAgICBpID0geTsKCSAgICAgICAgfQoJICAgICAgICB5ID0gaSA8PCAyOwoJICAgICAgICBpZiAoeSAhPT0gMCkgewoJICAgICAgICAgICAgbiAtPSAyOwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG4gLSAoKGkgPDwgMSkgPj4+IDMxKTsKCSAgICB9OwoJICAgIEludGVnZXIubnVtYmVyT2ZMZWFkaW5nWmVyb3MgPSBmdW5jdGlvbiAoaSkgewoJICAgICAgICAvLyBIRCwgRmlndXJlIDUtNgoJICAgICAgICBpZiAoaSA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDMyOwoJICAgICAgICB9CgkgICAgICAgIHZhciBuID0gMTsKCSAgICAgICAgaWYgKGkgPj4+IDE2ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDE2OwoJICAgICAgICAgICAgaSA8PD0gMTY7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGkgPj4+IDI0ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDg7CgkgICAgICAgICAgICBpIDw8PSA4OwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID4+PiAyOCA9PT0gMCkgewoJICAgICAgICAgICAgbiArPSA0OwoJICAgICAgICAgICAgaSA8PD0gNDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaSA+Pj4gMzAgPT09IDApIHsKCSAgICAgICAgICAgIG4gKz0gMjsKCSAgICAgICAgICAgIGkgPDw9IDI7CgkgICAgICAgIH0KCSAgICAgICAgbiAtPSBpID4+PiAzMTsKCSAgICAgICAgcmV0dXJuIG47CgkgICAgfTsKCSAgICBJbnRlZ2VyLnRvSGV4U3RyaW5nID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgcmV0dXJuIGkudG9TdHJpbmcoMTYpOwoJICAgIH07CgkgICAgSW50ZWdlci50b0JpbmFyeVN0cmluZyA9IGZ1bmN0aW9uIChpbnROdW1iZXIpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZyhwYXJzZUludChTdHJpbmcoaW50TnVtYmVyKSwgMikpOwoJICAgIH07CgkgICAgLy8gUmV0dXJucyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4gVGhpcyBmdW5jdGlvbiBpcyBzb21ldGltZXMgcmVmZXJyZWQgdG8gYXMgdGhlIHBvcHVsYXRpb24gY291bnQuCgkgICAgLy8gUmV0dXJuczoKCSAgICAvLyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4KCSAgICBJbnRlZ2VyLmJpdENvdW50ID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgLy8gSEQsIEZpZ3VyZSA1LTIKCSAgICAgICAgaSA9IGkgLSAoKGkgPj4+IDEpICYgMHg1NTU1NTU1NSk7CgkgICAgICAgIGkgPSAoaSAmIDB4MzMzMzMzMzMpICsgKChpID4+PiAyKSAmIDB4MzMzMzMzMzMpOwoJICAgICAgICBpID0gKGkgKyAoaSA+Pj4gNCkpICYgMHgwZjBmMGYwZjsKCSAgICAgICAgaSA9IGkgKyAoaSA+Pj4gOCk7CgkgICAgICAgIGkgPSBpICsgKGkgPj4+IDE2KTsKCSAgICAgICAgcmV0dXJuIGkgJiAweDNmOwoJICAgIH07CgkgICAgSW50ZWdlci50cnVuY0RpdmlzaW9uID0gZnVuY3Rpb24gKGRpdmlkZW5kLCBkaXZpc29yKSB7CgkgICAgICAgIHJldHVybiBNYXRoLnRydW5jKGRpdmlkZW5kIC8gZGl2aXNvcik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBBIHN0cmluZyB0byBhbiBpbnRlZ2VyLgoJICAgICAqIEBwYXJhbSBzIEEgc3RyaW5nIHRvIGNvbnZlcnQgaW50byBhIG51bWJlci4KCSAgICAgKiBAcGFyYW0gcmFkaXggQSB2YWx1ZSBiZXR3ZWVuIDIgYW5kIDM2IHRoYXQgc3BlY2lmaWVzIHRoZSBiYXNlIG9mIHRoZSBudW1iZXIgaW4gbnVtU3RyaW5nLiBJZiB0aGlzIGFyZ3VtZW50IGlzIG5vdCBzdXBwbGllZCwgc3RyaW5ncyB3aXRoIGEgcHJlZml4IG9mICcweCcgYXJlIGNvbnNpZGVyZWQgaGV4YWRlY2ltYWwuIEFsbCBvdGhlciBzdHJpbmdzIGFyZSBjb25zaWRlcmVkIGRlY2ltYWwuCgkgICAgICovCgkgICAgSW50ZWdlci5wYXJzZUludCA9IGZ1bmN0aW9uIChudW0sIHJhZGl4KSB7CgkgICAgICAgIGlmIChyYWRpeCA9PT0gdm9pZCAwKSB7IHJhZGl4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIHJldHVybiBwYXJzZUludChudW0sIHJhZGl4KTsKCSAgICB9OwoJICAgIEludGVnZXIuTUlOX1ZBTFVFXzMyX0JJVFMgPSAtMjE0NzQ4MzY0ODsKCSAgICBJbnRlZ2VyLk1BWF9WQUxVRSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgIHJldHVybiBJbnRlZ2VyOwoJfSgpKTsKCUludGVnZXIkMS5kZWZhdWx0ID0gSW50ZWdlcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdEFycmF5JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDggPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheXNfMSQxID0gQXJyYXlzJDE7Cgl2YXIgSW50ZWdlcl8xJDIgPSBJbnRlZ2VyJDE7Cgl2YXIgU3lzdGVtXzEkNCA9IFN5c3RlbSQxOwoJLyoqCgkgKiA8cD5BIHNpbXBsZSwgZmFzdCBhcnJheSBvZiBiaXRzLCByZXByZXNlbnRlZCBjb21wYWN0bHkgYnkgYW4gYXJyYXkgb2YgaW50cyBpbnRlcm5hbGx5LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgQml0QXJyYXkgLyppbXBsZW1lbnRzIENsb25lYWJsZSovID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcigpIHsKCSAgICAvLyAgIHRoaXMuc2l6ZSA9IDAKCSAgICAvLyAgIHRoaXMuYml0cyA9IG5ldyBJbnQzMkFycmF5KDEpCgkgICAgLy8gfQoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcihzaXplPzogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh1bmRlZmluZWQgPT09IHNpemUpIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gMAoJICAgIC8vICAgfSBlbHNlIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gc2l6ZQoJICAgIC8vICAgfQoJICAgIC8vICAgdGhpcy5iaXRzID0gdGhpcy5tYWtlQXJyYXkoc2l6ZSkKCSAgICAvLyB9CgkgICAgLy8gRm9yIHRlc3Rpbmcgb25seQoJICAgIGZ1bmN0aW9uIEJpdEFycmF5KHNpemUgLyppbnQqLywgYml0cykgewoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBzaXplKSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSAwOwoJICAgICAgICAgICAgdGhpcy5iaXRzID0gbmV3IEludDMyQXJyYXkoMSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSBzaXplOwoJICAgICAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gQml0QXJyYXkubWFrZUFycmF5KHNpemUpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH0KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0U2l6ZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc2l6ZTsKCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXRTaXplSW5CeXRlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoKHRoaXMuc2l6ZSArIDcpIC8gOCk7CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZW5zdXJlQ2FwYWNpdHkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmIChzaXplID4gdGhpcy5iaXRzLmxlbmd0aCAqIDMyKSB7CgkgICAgICAgICAgICB2YXIgbmV3Qml0cyA9IEJpdEFycmF5Lm1ha2VBcnJheShzaXplKTsKCSAgICAgICAgICAgIFN5c3RlbV8xJDQuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5iaXRzLCAwLCBuZXdCaXRzLCAwLCB0aGlzLmJpdHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBpIGJpdCB0byBnZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGJpdCBpIGlzIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiAodGhpcy5iaXRzW01hdGguZmxvb3IoaSAvIDMyKV0gJiAoMSA8PCAoaSAmIDB4MUYpKSkgIT09IDA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHRoaXMuYml0c1tNYXRoLmZsb29yKGkgLyAzMildIHw9IDEgPDwgKGkgJiAweDFGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEZsaXBzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5mbGlwID0gZnVuY3Rpb24gKGkgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSBePSAxIDw8IChpICYgMHgxRik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBmaXJzdCBiaXQgdG8gY2hlY2sKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIGZpcnN0IGJpdCB0aGF0IGlzIHNldCwgc3RhcnRpbmcgZnJvbSB0aGUgZ2l2ZW4gaW5kZXgsIG9yIHNpemUgaWYgbm9uZSBhcmUgc2V0CgkgICAgICogIGF0IG9yIGJleW9uZCB0aGlzIGdpdmVuIGluZGV4CgkgICAgICogQHNlZSAjZ2V0TmV4dFVuc2V0KGludCkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0TmV4dFNldCA9IGZ1bmN0aW9uIChmcm9tIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLnNpemU7CgkgICAgICAgIGlmIChmcm9tID49IHNpemUpIHsKCSAgICAgICAgICAgIHJldHVybiBzaXplOwoJICAgICAgICB9CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IE1hdGguZmxvb3IoZnJvbSAvIDMyKTsKCSAgICAgICAgdmFyIGN1cnJlbnRCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgLy8gbWFzayBvZmYgbGVzc2VyIGJpdHMgZmlyc3QKCSAgICAgICAgY3VycmVudEJpdHMgJj0gfigoMSA8PCAoZnJvbSAmIDB4MUYpKSAtIDEpOwoJICAgICAgICB2YXIgbGVuZ3RoID0gYml0cy5sZW5ndGg7CgkgICAgICAgIHdoaWxlIChjdXJyZW50Qml0cyA9PT0gMCkgewoJICAgICAgICAgICAgaWYgKCsrYml0c09mZnNldCA9PT0gbGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIHNpemU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjdXJyZW50Qml0cyA9IGJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBpbmRleCB0byBzdGFydCBsb29raW5nIGZvciB1bnNldCBiaXQKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgdW5zZXQgYml0LCBvciB7QGNvZGUgc2l6ZX0gaWYgbm9uZSBhcmUgdW5zZXQgdW50aWwgdGhlIGVuZAoJICAgICAqIEBzZWUgI2dldE5leHRTZXQoaW50KQoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXROZXh0VW5zZXQgPSBmdW5jdGlvbiAoZnJvbSAvKmludCovKSB7CgkgICAgICAgIHZhciBzaXplID0gdGhpcy5zaXplOwoJICAgICAgICBpZiAoZnJvbSA+PSBzaXplKSB7CgkgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIGJpdHNPZmZzZXQgPSBNYXRoLmZsb29yKGZyb20gLyAzMik7CgkgICAgICAgIHZhciBjdXJyZW50Qml0cyA9IH5iaXRzW2JpdHNPZmZzZXRdOwoJICAgICAgICAvLyBtYXNrIG9mZiBsZXNzZXIgYml0cyBmaXJzdAoJICAgICAgICBjdXJyZW50Qml0cyAmPSB+KCgxIDw8IChmcm9tICYgMHgxRikpIC0gMSk7CgkgICAgICAgIHZhciBsZW5ndGggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgd2hpbGUgKGN1cnJlbnRCaXRzID09PSAwKSB7CgkgICAgICAgICAgICBpZiAoKytiaXRzT2Zmc2V0ID09PSBsZW5ndGgpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGN1cnJlbnRCaXRzID0gfmJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgYmxvY2sgb2YgMzIgYml0cywgc3RhcnRpbmcgYXQgYml0IGkuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gaSBmaXJzdCBiaXQgdG8gc2V0CgkgICAgICogQHBhcmFtIG5ld0JpdHMgdGhlIG5ldyB2YWx1ZSBvZiB0aGUgbmV4dCAzMiBiaXRzLiBOb3RlIGFnYWluIHRoYXQgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdAoJICAgICAqIGNvcnJlc3BvbmRzIHRvIGJpdCBpLCB0aGUgbmV4dC1sZWFzdC1zaWduaWZpY2FudCB0byBpKzEsIGFuZCBzbyBvbi4KCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0QnVsayA9IGZ1bmN0aW9uIChpIC8qaW50Ki8sIG5ld0JpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgcmFuZ2Ugb2YgYml0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydCBzdGFydCBvZiByYW5nZSwgaW5jbHVzaXZlLgoJICAgICAqIEBwYXJhbSBlbmQgZW5kIG9mIHJhbmdlLCBleGNsdXNpdmUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0UmFuZ2UgPSBmdW5jdGlvbiAoc3RhcnQgLyppbnQqLywgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIGVuZC0tOyAvLyB3aWxsIGJlIGVhc2llciB0byB0cmVhdCB0aGlzIGFzIHRoZSBsYXN0IGFjdHVhbGx5IHNldCBiaXQgLS0gaW5jbHVzaXZlCgkgICAgICAgIHZhciBmaXJzdEludCA9IE1hdGguZmxvb3Ioc3RhcnQgLyAzMik7CgkgICAgICAgIHZhciBsYXN0SW50ID0gTWF0aC5mbG9vcihlbmQgLyAzMik7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICBmb3IgKHZhciBpID0gZmlyc3RJbnQ7IGkgPD0gbGFzdEludDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgZmlyc3RCaXQgPSBpID4gZmlyc3RJbnQgPyAwIDogc3RhcnQgJiAweDFGOwoJICAgICAgICAgICAgdmFyIGxhc3RCaXQgPSBpIDwgbGFzdEludCA/IDMxIDogZW5kICYgMHgxRjsKCSAgICAgICAgICAgIC8vIE9uZXMgZnJvbSBmaXJzdEJpdCB0byBsYXN0Qml0LCBpbmNsdXNpdmUKCSAgICAgICAgICAgIHZhciBtYXNrID0gKDIgPDwgbGFzdEJpdCkgLSAoMSA8PCBmaXJzdEJpdCk7CgkgICAgICAgICAgICBiaXRzW2ldIHw9IG1hc2s7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbWF4ID0gdGhpcy5iaXRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGJpdHNbaV0gPSAwOwoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBFZmZpY2llbnQgbWV0aG9kIHRvIGNoZWNrIGlmIGEgcmFuZ2Ugb2YgYml0cyBpcyBzZXQsIG9yIG5vdCBzZXQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnQgc3RhcnQgb2YgcmFuZ2UsIGluY2x1c2l2ZS4KCSAgICAgKiBAcGFyYW0gZW5kIGVuZCBvZiByYW5nZSwgZXhjbHVzaXZlCgkgICAgICogQHBhcmFtIHZhbHVlIGlmIHRydWUsIGNoZWNrcyB0aGF0IGJpdHMgaW4gcmFuZ2UgYXJlIHNldCwgb3RoZXJ3aXNlIGNoZWNrcyB0aGF0IHRoZXkgYXJlIG5vdCBzZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGFsbCBiaXRzIGFyZSBzZXQgb3Igbm90IHNldCBpbiByYW5nZSwgYWNjb3JkaW5nIHRvIHZhbHVlIGFyZ3VtZW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgZW5kIGlzIGxlc3MgdGhhbiBzdGFydCBvciB0aGUgcmFuZ2UgaXMgbm90IGNvbnRhaW5lZCBpbiB0aGUgYXJyYXkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuaXNSYW5nZSA9IGZ1bmN0aW9uIChzdGFydCAvKmludCovLCBlbmQgLyppbnQqLywgdmFsdWUpIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuIHRydWU7IC8vIGVtcHR5IHJhbmdlIG1hdGNoZXMKCSAgICAgICAgfQoJICAgICAgICBlbmQtLTsgLy8gd2lsbCBiZSBlYXNpZXIgdG8gdHJlYXQgdGhpcyBhcyB0aGUgbGFzdCBhY3R1YWxseSBzZXQgYml0IC0tIGluY2x1c2l2ZQoJICAgICAgICB2YXIgZmlyc3RJbnQgPSBNYXRoLmZsb29yKHN0YXJ0IC8gMzIpOwoJICAgICAgICB2YXIgbGFzdEludCA9IE1hdGguZmxvb3IoZW5kIC8gMzIpOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZpcnN0SW50OyBpIDw9IGxhc3RJbnQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGZpcnN0Qml0ID0gaSA+IGZpcnN0SW50ID8gMCA6IHN0YXJ0ICYgMHgxRjsKCSAgICAgICAgICAgIHZhciBsYXN0Qml0ID0gaSA8IGxhc3RJbnQgPyAzMSA6IGVuZCAmIDB4MUY7CgkgICAgICAgICAgICAvLyBPbmVzIGZyb20gZmlyc3RCaXQgdG8gbGFzdEJpdCwgaW5jbHVzaXZlCgkgICAgICAgICAgICB2YXIgbWFzayA9ICgyIDw8IGxhc3RCaXQpIC0gKDEgPDwgZmlyc3RCaXQpICYgMHhGRkZGRkZGRjsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiAmIDB4RkZGRkZGRkYgYWRkZWQgdG8gZGlzY2FyZCBhbnl0aGluZyBhZnRlciAzMiBiaXRzLCBhcyBFUyBoYXMgNTMgYml0cwoJICAgICAgICAgICAgLy8gUmV0dXJuIGZhbHNlIGlmIHdlJ3JlIGxvb2tpbmcgZm9yIDFzIGFuZCB0aGUgbWFza2VkIGJpdHNbaV0gaXNuJ3QgYWxsIDFzIChpczogdGhhdCwKCSAgICAgICAgICAgIC8vIGVxdWFscyB0aGUgbWFzaywgb3Igd2UncmUgbG9va2luZyBmb3IgMHMgYW5kIHRoZSBtYXNrZWQgcG9ydGlvbiBpcyBub3QgYWxsIDBzCgkgICAgICAgICAgICBpZiAoKGJpdHNbaV0gJiBtYXNrKSAhPT0gKHZhbHVlID8gbWFzayA6IDApKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0cnVlOwoJICAgIH07CgkgICAgQml0QXJyYXkucHJvdG90eXBlLmFwcGVuZEJpdCA9IGZ1bmN0aW9uIChiaXQpIHsKCSAgICAgICAgdGhpcy5lbnN1cmVDYXBhY2l0eSh0aGlzLnNpemUgKyAxKTsKCSAgICAgICAgaWYgKGJpdCkgewoJICAgICAgICAgICAgdGhpcy5iaXRzW01hdGguZmxvb3IodGhpcy5zaXplIC8gMzIpXSB8PSAxIDw8ICh0aGlzLnNpemUgJiAweDFGKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLnNpemUrKzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFwcGVuZHMgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdHMsIGZyb20gdmFsdWUsIGluIG9yZGVyIGZyb20gbW9zdC1zaWduaWZpY2FudCB0bwoJICAgICAqIGxlYXN0LXNpZ25pZmljYW50LiBGb3IgZXhhbXBsZSwgYXBwZW5kaW5nIDYgYml0cyBmcm9tIDB4MDAwMDAxRSB3aWxsIGFwcGVuZCB0aGUgYml0cwoJICAgICAqIDAsIDEsIDEsIDEsIDEsIDAgaW4gdGhhdCBvcmRlci4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB2YWx1ZSB7QGNvZGUgaW50fSBjb250YWluaW5nIGJpdHMgdG8gYXBwZW5kCgkgICAgICogQHBhcmFtIG51bUJpdHMgYml0cyBmcm9tIHZhbHVlIHRvIGFwcGVuZAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5hcHBlbmRCaXRzID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICBpZiAobnVtQml0cyA8IDAgfHwgbnVtQml0cyA+IDMyKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOC5kZWZhdWx0KCdOdW0gYml0cyBtdXN0IGJlIGJldHdlZW4gMCBhbmQgMzInKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmVuc3VyZUNhcGFjaXR5KHRoaXMuc2l6ZSArIG51bUJpdHMpOwoJICAgICAgICAvLyBjb25zdCBhcHBlbmRCaXQgPSB0aGlzLmFwcGVuZEJpdDsKCSAgICAgICAgZm9yICh2YXIgbnVtQml0c0xlZnQgPSBudW1CaXRzOyBudW1CaXRzTGVmdCA+IDA7IG51bUJpdHNMZWZ0LS0pIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KCgodmFsdWUgPj4gKG51bUJpdHNMZWZ0IC0gMSkpICYgMHgwMSkgPT09IDEpOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuYXBwZW5kQml0QXJyYXkgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdmFyIG90aGVyU2l6ZSA9IG90aGVyLnNpemU7CgkgICAgICAgIHRoaXMuZW5zdXJlQ2FwYWNpdHkodGhpcy5zaXplICsgb3RoZXJTaXplKTsKCSAgICAgICAgLy8gY29uc3QgYXBwZW5kQml0ID0gdGhpcy5hcHBlbmRCaXQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3RoZXJTaXplOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KG90aGVyLmdldChpKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKHRoaXMuc2l6ZSAhPT0gb3RoZXIuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDguZGVmYXVsdCgnU2l6ZXMgZG9uXCd0IG1hdGNoJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGJpdHMubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgLy8gVGhlIGxhc3QgaW50IGNvdWxkIGJlIGluY29tcGxldGUgKGkuZS4gbm90IGhhdmUgMzIgYml0cyBpbgoJICAgICAgICAgICAgLy8gaXQpIGJ1dCB0aGVyZSBpcyBubyBwcm9ibGVtIHNpbmNlIDAgWE9SIDAgPT0gMC4KCSAgICAgICAgICAgIGJpdHNbaV0gXj0gb3RoZXIuYml0c1tpXTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0T2Zmc2V0IGZpcnN0IGJpdCB0byBzdGFydCB3cml0aW5nCgkgICAgICogQHBhcmFtIGFycmF5IGFycmF5IHRvIHdyaXRlIGludG8uIEJ5dGVzIGFyZSB3cml0dGVuIG1vc3Qtc2lnbmlmaWNhbnQgYnl0ZSBmaXJzdC4gVGhpcyBpcyB0aGUgb3Bwb3NpdGUKCSAgICAgKiAgb2YgdGhlIGludGVybmFsIHJlcHJlc2VudGF0aW9uLCB3aGljaCBpcyBleHBvc2VkIGJ5IHtAbGluayAjZ2V0Qml0QXJyYXkoKX0KCSAgICAgKiBAcGFyYW0gb2Zmc2V0IHBvc2l0aW9uIGluIGFycmF5IHRvIHN0YXJ0IHdyaXRpbmcKCSAgICAgKiBAcGFyYW0gbnVtQnl0ZXMgaG93IG1hbnkgYnl0ZXMgdG8gd3JpdGUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUudG9CeXRlcyA9IGZ1bmN0aW9uIChiaXRPZmZzZXQgLyppbnQqLywgYXJyYXksIG9mZnNldCAvKmludCovLCBudW1CeXRlcyAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtQnl0ZXM7IGkrKykgewoJICAgICAgICAgICAgdmFyIHRoZUJ5dGUgPSAwOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXQoYml0T2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICB0aGVCeXRlIHw9IDEgPDwgKDcgLSBqKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyBpXSA9IC8qKGJ5dGUpKi8gdGhlQnl0ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB1bmRlcmx5aW5nIGFycmF5IG9mIGludHMuIFRoZSBmaXJzdCBlbGVtZW50IGhvbGRzIHRoZSBmaXJzdCAzMiBiaXRzLCBhbmQgdGhlIGxlYXN0CgkgICAgICogICAgICAgICBzaWduaWZpY2FudCBiaXQgaXMgYml0IDAuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmdldEJpdEFycmF5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV2ZXJzZXMgYWxsIGJpdHMgaW4gdGhlIGFycmF5LgoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5yZXZlcnNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3Qml0cyA9IG5ldyBJbnQzMkFycmF5KHRoaXMuYml0cy5sZW5ndGgpOwoJICAgICAgICAvLyByZXZlcnNlIGFsbCBpbnQncyBmaXJzdAoJICAgICAgICB2YXIgbGVuID0gTWF0aC5mbG9vcigodGhpcy5zaXplIC0gMSkgLyAzMik7CgkgICAgICAgIHZhciBvbGRCaXRzTGVuID0gbGVuICsgMTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2xkQml0c0xlbjsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeCA9IGJpdHNbaV07CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDEpICYgMHg1NTU1NTU1NSkgfCAoKHggJiAweDU1NTU1NTU1KSA8PCAxKTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMikgJiAweDMzMzMzMzMzKSB8ICgoeCAmIDB4MzMzMzMzMzMpIDw8IDIpOwoJICAgICAgICAgICAgeCA9ICgoeCA+PiA0KSAmIDB4MGYwZjBmMGYpIHwgKCh4ICYgMHgwZjBmMGYwZikgPDwgNCk7CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDgpICYgMHgwMGZmMDBmZikgfCAoKHggJiAweDAwZmYwMGZmKSA8PCA4KTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMTYpICYgMHgwMDAwZmZmZikgfCAoKHggJiAweDAwMDBmZmZmKSA8PCAxNik7CgkgICAgICAgICAgICBuZXdCaXRzW2xlbiAtIGldID0gLyooaW50KSovIHg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm93IGNvcnJlY3QgdGhlIGludCdzIGlmIHRoZSBiaXQgc2l6ZSBpc24ndCBhIG11bHRpcGxlIG9mIDMyCgkgICAgICAgIGlmICh0aGlzLnNpemUgIT09IG9sZEJpdHNMZW4gKiAzMikgewoJICAgICAgICAgICAgdmFyIGxlZnRPZmZzZXQgPSBvbGRCaXRzTGVuICogMzIgLSB0aGlzLnNpemU7CgkgICAgICAgICAgICB2YXIgY3VycmVudEludCA9IG5ld0JpdHNbMF0gPj4+IGxlZnRPZmZzZXQ7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IG9sZEJpdHNMZW47IGkrKykgewoJICAgICAgICAgICAgICAgIHZhciBuZXh0SW50ID0gbmV3Qml0c1tpXTsKCSAgICAgICAgICAgICAgICBjdXJyZW50SW50IHw9IG5leHRJbnQgPDwgKDMyIC0gbGVmdE9mZnNldCk7CgkgICAgICAgICAgICAgICAgbmV3Qml0c1tpIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICAgICAgICAgIGN1cnJlbnRJbnQgPSBuZXh0SW50ID4+PiBsZWZ0T2Zmc2V0OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgbmV3Qml0c1tvbGRCaXRzTGVuIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICBCaXRBcnJheS5tYWtlQXJyYXkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW50MzJBcnJheShNYXRoLmZsb29yKChzaXplICsgMzEpIC8gMzIpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdEFycmF5KSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnNpemUgPT09IG90aGVyLnNpemUgJiYgQXJyYXlzXzEkMS5kZWZhdWx0LmVxdWFscyh0aGlzLmJpdHMsIG90aGVyLmJpdHMpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogdGhpcy5zaXplICsgQXJyYXlzXzEkMS5kZWZhdWx0Lmhhc2hDb2RlKHRoaXMuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcmVzdWx0ID0gJyc7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBzaXplID0gdGhpcy5zaXplOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICBpZiAoKGkgJiAweDA3KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnICc7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQgKz0gdGhpcy5nZXQoaSkgPyAnWCcgOiAnLic7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0QXJyYXkodGhpcy5zaXplLCB0aGlzLmJpdHMuc2xpY2UoKSk7CgkgICAgfTsKCSAgICByZXR1cm4gQml0QXJyYXk7Cgl9KCkpOwoJQml0QXJyYXkkMS5kZWZhdWx0ID0gQml0QXJyYXk7CgoJdmFyIEJpdE1hdHJpeCQxID0ge307CgoJdmFyIFN0cmluZ0J1aWxkZXIkMSA9IHt9OwoKCXZhciBTdHJpbmdVdGlscyQxID0ge307CgoJdmFyIERlY29kZUhpbnRUeXBlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERlY29kZUhpbnRUeXBlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIHR5cGUgb2YgaGludCB0aGF0IGEgY2FsbGVyIG1heSBwYXNzIHRvIGEgYmFyY29kZSByZWFkZXIgdG8gaGVscCBpdAoJICogbW9yZSBxdWlja2x5IG9yIGFjY3VyYXRlbHkgZGVjb2RlIGl0LiBJdCBpcyB1cCB0byBpbXBsZW1lbnRhdGlvbnMgdG8gZGVjaWRlIHdoYXQsCgkgKiBpZiBhbnl0aGluZywgdG8gZG8gd2l0aCB0aGUgaW5mb3JtYXRpb24gdGhhdCBpcyBzdXBwbGllZC4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBzZWUgUmVhZGVyI2RlY29kZShCaW5hcnlCaXRtYXAsamF2YS51dGlsLk1hcCkKCSAqLwoJdmFyIERlY29kZUhpbnRUeXBlOwoJKGZ1bmN0aW9uIChEZWNvZGVIaW50VHlwZSkgewoJICAgIC8qKgoJICAgICAqIFVuc3BlY2lmaWVkLCBhcHBsaWNhdGlvbi1zcGVjaWZpYyBoaW50LiBNYXBzIHRvIGFuIHVuc3BlY2lmaWVkIHtAbGluayBPYmplY3R9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJPVEhFUiJdID0gMF0gPSAiT1RIRVIiOyAvKihPYmplY3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJbWFnZSBpcyBhIHB1cmUgbW9ub2Nocm9tZSBpbWFnZSBvZiBhIGJhcmNvZGUuIERvZXNuJ3QgbWF0dGVyIHdoYXQgaXQgbWFwcyB0bzsKCSAgICAgKiB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlBVUkVfQkFSQ09ERSJdID0gMV0gPSAiUFVSRV9CQVJDT0RFIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEltYWdlIGlzIGtub3duIHRvIGJlIG9mIG9uZSBvZiBhIGZldyBwb3NzaWJsZSBmb3JtYXRzLgoJICAgICAqIE1hcHMgdG8gYSB7QGxpbmsgTGlzdH0gb2Yge0BsaW5rIEJhcmNvZGVGb3JtYXR9cy4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiUE9TU0lCTEVfRk9STUFUUyJdID0gMl0gPSAiUE9TU0lCTEVfRk9STUFUUyI7IC8qKExpc3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVuZCBtb3JlIHRpbWUgdG8gdHJ5IHRvIGZpbmQgYSBiYXJjb2RlOyBvcHRpbWl6ZSBmb3IgYWNjdXJhY3ksIG5vdCBzcGVlZC4KCSAgICAgKiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87IHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiVFJZX0hBUkRFUiJdID0gM10gPSAiVFJZX0hBUkRFUiI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVjaWZpZXMgd2hhdCBjaGFyYWN0ZXIgZW5jb2RpbmcgdG8gdXNlIHdoZW4gZGVjb2RpbmcsIHdoZXJlIGFwcGxpY2FibGUgKHR5cGUgU3RyaW5nKQoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJDSEFSQUNURVJfU0VUIl0gPSA0XSA9ICJDSEFSQUNURVJfU0VUIjsgLyooU3RyaW5nLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQWxsb3dlZCBsZW5ndGhzIG9mIGVuY29kZWQgZGF0YSAtLSByZWplY3QgYW55dGhpbmcgZWxzZS4gTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfTEVOR1RIUyJdID0gNV0gPSAiQUxMT1dFRF9MRU5HVEhTIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEFzc3VtZSBDb2RlIDM5IGNvZGVzIGVtcGxveSBhIGNoZWNrIGRpZ2l0LiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87CgkgICAgICogdXNlIHtAbGluayBCb29sZWFuI1RSVUV9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJBU1NVTUVfQ09ERV8zOV9DSEVDS19ESUdJVCJdID0gNl0gPSAiQVNTVU1FX0NPREVfMzlfQ0hFQ0tfRElHSVQiOyAvKihWb2lkLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQXNzdW1lIHRoZSBiYXJjb2RlIGlzIGJlaW5nIHByb2Nlc3NlZCBhcyBhIEdTMSBiYXJjb2RlLCBhbmQgbW9kaWZ5IGJlaGF2aW9yIGFzIG5lZWRlZC4KCSAgICAgKiBGb3IgZXhhbXBsZSB0aGlzIGFmZmVjdHMgRk5DMSBoYW5kbGluZyBmb3IgQ29kZSAxMjggKGFrYSBHUzEtMTI4KS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOwoJICAgICAqIHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiQVNTVU1FX0dTMSJdID0gN10gPSAiQVNTVU1FX0dTMSI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJZiB0cnVlLCByZXR1cm4gdGhlIHN0YXJ0IGFuZCBlbmQgZGlnaXRzIGluIGEgQ29kYWJhciBiYXJjb2RlIGluc3RlYWQgb2Ygc3RyaXBwaW5nIHRoZW0uIFRoZXkKCSAgICAgKiBhcmUgYWxwaGEsIHdoZXJlYXMgdGhlIHJlc3QgYXJlIG51bWVyaWMuIEJ5IGRlZmF1bHQsIHRoZXkgYXJlIHN0cmlwcGVkLCBidXQgdGhpcyBjYXVzZXMgdGhlbQoJICAgICAqIHRvIG5vdCBiZS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOyB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlJFVFVSTl9DT0RBQkFSX1NUQVJUX0VORCJdID0gOF0gPSAiUkVUVVJOX0NPREFCQVJfU1RBUlRfRU5EIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIFRoZSBjYWxsZXIgbmVlZHMgdG8gYmUgbm90aWZpZWQgdmlhIGNhbGxiYWNrIHdoZW4gYSBwb3NzaWJsZSB7QGxpbmsgUmVzdWx0UG9pbnR9CgkgICAgICogaXMgZm91bmQuIE1hcHMgdG8gYSB7QGxpbmsgUmVzdWx0UG9pbnRDYWxsYmFja30uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIk5FRURfUkVTVUxUX1BPSU5UX0NBTExCQUNLIl0gPSA5XSA9ICJORUVEX1JFU1VMVF9QT0lOVF9DQUxMQkFDSyI7IC8qKFJlc3VsdFBvaW50Q2FsbGJhY2suY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBBbGxvd2VkIGV4dGVuc2lvbiBsZW5ndGhzIGZvciBFQU4gb3IgVVBDIGJhcmNvZGVzLiBPdGhlciBmb3JtYXRzIHdpbGwgaWdub3JlIHRoaXMuCgkgICAgICogTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0gb2YgdGhlIGFsbG93ZWQgZXh0ZW5zaW9uIGxlbmd0aHMsIGZvciBleGFtcGxlIFsyXSwgWzVdLCBvciBbMiwgNV0uCgkgICAgICogSWYgaXQgaXMgb3B0aW9uYWwgdG8gaGF2ZSBhbiBleHRlbnNpb24sIGRvIG5vdCBzZXQgdGhpcyBoaW50LiBJZiB0aGlzIGlzIHNldCwKCSAgICAgKiBhbmQgYSBVUEMgb3IgRUFOIGJhcmNvZGUgaXMgZm91bmQgYnV0IGFuIGV4dGVuc2lvbiBpcyBub3QsIHRoZW4gbm8gcmVzdWx0IHdpbGwgYmUgcmV0dXJuZWQKCSAgICAgKiBhdCBhbGwuCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfRUFOX0VYVEVOU0lPTlMiXSA9IDEwXSA9ICJBTExPV0VEX0VBTl9FWFRFTlNJT05TIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8vIEVuZCBvZiBlbnVtZXJhdGlvbiB2YWx1ZXMuCgkgICAgLyoqCgkgICAgICogRGF0YSB0eXBlIHRoZSBoaW50IGlzIGV4cGVjdGluZy4KCSAgICAgKiBBbW9uZyB0aGUgcG9zc2libGUgdmFsdWVzIHRoZSB7QGxpbmsgVm9pZH0gc3RhbmRzIG91dCBhcyBiZWluZyB1c2VkIGZvcgoJICAgICAqIGhpbnRzIHRoYXQgZG8gbm90IGV4cGVjdCBhIHZhbHVlIHRvIGJlIHN1cHBsaWVkIChmbGFnIGhpbnRzKS4gU3VjaCBoaW50cwoJICAgICAqIHdpbGwgcG9zc2libHkgaGF2ZSB0aGVpciB2YWx1ZSBpZ25vcmVkLCBvciByZXBsYWNlZCBieSBhCgkgICAgICoge0BsaW5rIEJvb2xlYW4jVFJVRX0uIEhpbnQgc3VwcGxpZXJzIHNob3VsZCBwcm9iYWJseSB1c2UKCSAgICAgKiB7QGxpbmsgQm9vbGVhbiNUUlVFfSBhcyBkaXJlY3RlZCBieSB0aGUgYWN0dWFsIGhpbnQgZG9jdW1lbnRhdGlvbi4KCSAgICAgKi8KCSAgICAvLyBwcml2YXRlIHZhbHVlVHlwZTogQ2xhc3M8Pz4KCSAgICAvLyBEZWNvZGVIaW50VHlwZSh2YWx1ZVR5cGU6IENsYXNzPD8+KSB7CgkgICAgLy8gICB0aGlzLnZhbHVlVHlwZSA9IHZhbHVlVHlwZQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgZ2V0VmFsdWVUeXBlKCk6IENsYXNzPD8+IHsKCSAgICAvLyAgIHJldHVybiB2YWx1ZVR5cGUKCSAgICAvLyB9Cgl9KShEZWNvZGVIaW50VHlwZSB8fCAoRGVjb2RlSGludFR5cGUgPSB7fSkpOwoJRGVjb2RlSGludFR5cGUkMS5kZWZhdWx0ID0gRGVjb2RlSGludFR5cGU7CgoJdmFyIENoYXJhY3RlclNldEVDSSA9IHt9OwoKCXZhciBGb3JtYXRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb3JtYXRFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDcgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRm9ybWF0RXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRmKEZvcm1hdEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBGb3JtYXRFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgRm9ybWF0RXhjZXB0aW9uLmdldEZvcm1hdEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEV4Y2VwdGlvbigpOwoJICAgIH07CgkgICAgRm9ybWF0RXhjZXB0aW9uLmtpbmQgPSAnRm9ybWF0RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRm9ybWF0RXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ3LmRlZmF1bHQpKTsKCUZvcm1hdEV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBGb3JtYXRFeGNlcHRpb247CgoJKGZ1bmN0aW9uIChleHBvcnRzKSB7CgkvKgoJICogQ29weXJpZ2h0IDIwMDggWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCWV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHZvaWQgMDsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xID0gRm9ybWF0RXhjZXB0aW9uJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsqLwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJdmFyIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnM7CgkoZnVuY3Rpb24gKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMpIHsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwNDM3Il0gPSAwXSA9ICJDcDQzNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEiXSA9IDFdID0gIklTTzg4NTlfMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzIiXSA9IDJdID0gIklTTzg4NTlfMiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzMiXSA9IDNdID0gIklTTzg4NTlfMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzQiXSA9IDRdID0gIklTTzg4NTlfNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzUiXSA9IDVdID0gIklTTzg4NTlfNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzYiXSA9IDZdID0gIklTTzg4NTlfNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzciXSA9IDddID0gIklTTzg4NTlfNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzgiXSA9IDhdID0gIklTTzg4NTlfOCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzkiXSA9IDldID0gIklTTzg4NTlfOSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEwIl0gPSAxMF0gPSAiSVNPODg1OV8xMCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzExIl0gPSAxMV0gPSAiSVNPODg1OV8xMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEzIl0gPSAxMl0gPSAiSVNPODg1OV8xMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE0Il0gPSAxM10gPSAiSVNPODg1OV8xNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE1Il0gPSAxNF0gPSAiSVNPODg1OV8xNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE2Il0gPSAxNV0gPSAiSVNPODg1OV8xNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJTSklTIl0gPSAxNl0gPSAiU0pJUyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTAiXSA9IDE3XSA9ICJDcDEyNTAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQ3AxMjUxIl0gPSAxOF0gPSAiQ3AxMjUxIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwMTI1MiJdID0gMTldID0gIkNwMTI1MiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTYiXSA9IDIwXSA9ICJDcDEyNTYiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siVW5pY29kZUJpZ1VubWFya2VkIl0gPSAyMV0gPSAiVW5pY29kZUJpZ1VubWFya2VkIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIlVURjgiXSA9IDIyXSA9ICJVVEY4IjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkFTQ0lJIl0gPSAyM10gPSAiQVNDSUkiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQmlnNSJdID0gMjRdID0gIkJpZzUiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siR0IxODAzMCJdID0gMjVdID0gIkdCMTgwMzAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siRVVDX0tSIl0gPSAyNl0gPSAiRVVDX0tSIjsKCX0pKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgPSBleHBvcnRzLkNoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgfHwgKGV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHt9KSk7CgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIENoYXJhY3RlciBTZXQgRUNJLCBhY2NvcmRpbmcgdG8gIkV4dGVuZGVkIENoYW5uZWwgSW50ZXJwcmV0YXRpb25zIiA1LjMuMS4xCgkgKiBvZiBJU08gMTgwMDQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIENoYXJhY3RlclNldEVDSSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBDaGFyYWN0ZXJTZXRFQ0kodmFsdWVJZGVudGlmaWVyLCB2YWx1ZXNQYXJhbSwgbmFtZSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG90aGVyRW5jb2RpbmdOYW1lcyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDM7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgb3RoZXJFbmNvZGluZ05hbWVzW19pIC0gM10gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmFsdWVJZGVudGlmaWVyID0gdmFsdWVJZGVudGlmaWVyOwoJICAgICAgICB0aGlzLm5hbWUgPSBuYW1lOwoJICAgICAgICBpZiAodHlwZW9mIHZhbHVlc1BhcmFtID09PSAnbnVtYmVyJykgewoJICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSBJbnQzMkFycmF5LmZyb20oW3ZhbHVlc1BhcmFtXSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnZhbHVlcyA9IHZhbHVlc1BhcmFtOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzOwoJICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVfSURFTlRJRklFUl9UT19FQ0kuc2V0KHZhbHVlSWRlbnRpZmllciwgdGhpcyk7CgkgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQobmFtZSwgdGhpcyk7CgkgICAgICAgIHZhciB2YWx1ZXMgPSB0aGlzLnZhbHVlczsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gdmFsdWVzLmxlbmd0aDsgaSAhPT0gbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgdmFyIHYgPSB2YWx1ZXNbaV07CgkgICAgICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVTX1RPX0VDSS5zZXQodiwgdGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIG90aGVyRW5jb2RpbmdOYW1lc18xID0gX192YWx1ZXMob3RoZXJFbmNvZGluZ05hbWVzKSwgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKTsgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZTsgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBvdGhlck5hbWUgPSBvdGhlckVuY29kaW5nTmFtZXNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQob3RoZXJOYW1lLCB0aGlzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKG90aGVyRW5jb2RpbmdOYW1lc18xXzEgJiYgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZSAmJiAoX2EgPSBvdGhlckVuY29kaW5nTmFtZXNfMS5yZXR1cm4pKSBfYS5jYWxsKG90aGVyRW5jb2RpbmdOYW1lc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgIH0KCSAgICAvLyBDaGFyYWN0ZXJTZXRFQ0kodmFsdWU6IG51bWJlciAvKmludCovKSB7CgkgICAgLy8gICB0aGlzKG5ldyBJbnQzMkFycmF5IHt2YWx1ZX0pCgkgICAgLy8gfQoJICAgIC8vIENoYXJhY3RlclNldEVDSSh2YWx1ZTogbnVtYmVyIC8qaW50Ki8sIFN0cmluZy4uLiBvdGhlckVuY29kaW5nTmFtZXMpIHsKCSAgICAvLyAgIHRoaXMudmFsdWVzID0gbmV3IEludDMyQXJyYXkge3ZhbHVlfQoJICAgIC8vICAgdGhpcy5vdGhlckVuY29kaW5nTmFtZXMgPSBvdGhlckVuY29kaW5nTmFtZXMKCSAgICAvLyB9CgkgICAgLy8gQ2hhcmFjdGVyU2V0RUNJKHZhbHVlczogSW50MzJBcnJheSwgU3RyaW5nLi4uIG90aGVyRW5jb2RpbmdOYW1lcykgewoJICAgIC8vICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXMKCSAgICAvLyAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzCgkgICAgLy8gfQoJICAgIENoYXJhY3RlclNldEVDSS5wcm90b3R5cGUuZ2V0VmFsdWVJZGVudGlmaWVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZUlkZW50aWZpZXI7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldE5hbWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm5hbWU7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZXNbMF07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmFsdWUgY2hhcmFjdGVyIHNldCBFQ0kgdmFsdWUKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBDaGFyYWN0ZXJTZXRFQ0l9IHJlcHJlc2VudGluZyBFQ0kgb2YgZ2l2ZW4gdmFsdWUsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwgYnV0CgkgICAgICogICB1bnN1cHBvcnRlZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIEVDSSB2YWx1ZSBpcyBpbnZhbGlkCgkgICAgICovCgkgICAgQ2hhcmFjdGVyU2V0RUNJLmdldENoYXJhY3RlclNldEVDSUJ5VmFsdWUgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPCAwIHx8IHZhbHVlID49IDkwMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGNoYXJhY3RlclNldCA9IENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJLmdldCh2YWx1ZSk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNoYXJhY3RlclNldCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGNoYXJhY3RlclNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBuYW1lIGNoYXJhY3RlciBzZXQgRUNJIGVuY29kaW5nIG5hbWUKCSAgICAgKiBAcmV0dXJuIENoYXJhY3RlclNldEVDSSByZXByZXNlbnRpbmcgRUNJIGZvciBjaGFyYWN0ZXIgZW5jb2RpbmcsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwKCSAgICAgKiAgIGJ1dCB1bnN1cHBvcnRlZAoJICAgICAqLwoJICAgIENoYXJhY3RlclNldEVDSS5nZXRDaGFyYWN0ZXJTZXRFQ0lCeU5hbWUgPSBmdW5jdGlvbiAobmFtZSkgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gQ2hhcmFjdGVyU2V0RUNJLk5BTUVfVE9fRUNJLmdldChuYW1lKTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgnaW5jb3JlY3QgdmFsdWUnKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY2hhcmFjdGVyU2V0OwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgQ2hhcmFjdGVyU2V0RUNJKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLmdldE5hbWUoKSA9PT0gb3RoZXIuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlZBTFVFX0lERU5USUZJRVJfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSSA9IG5ldyBNYXAoKTsKCSAgICAvLyBFbnVtIG5hbWUgaXMgYSBKYXZhIGVuY29kaW5nIHZhbGlkIGZvciBqYXZhLmxhbmcgYW5kIGphdmEuaW8KCSAgICAvLyBUWVBFU0NSSVBUUE9SVDogY2hhbmdlZCB0aGUgbWFpbiBsYWJlbCBmb3IgSVNPIGFzIHRoZSBUZXh0RW5jb2RlciBkaWQgbm90IHJlY29nbml6ZWQgdGhlbSBpbiB0aGUgZm9ybSBmcm9tIGphdmEKCSAgICAvLyAoZWcgSVNPODg1OV8xIG11c3QgYmUgSVNPODg1OTEgb3IgSVNPODg1OS0xIG9yIElTTy04ODU5LTEpCgkgICAgLy8gbGF0ZXIgb246IHdlbGwsIGV4Y2VwdCAxNiB3aWNoIGRvZXMgbm90IHdvcmsgd2l0aCBJU084ODU5MTYgc28gdXNlZCBJU08tODg1OS0xIGZvcm0gZm9yIGRlZmF1bHQKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3A0MzcgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3A0MzcsIEludDMyQXJyYXkuZnJvbShbMCwgMl0pLCAnQ3A0MzcnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMSwgSW50MzJBcnJheS5mcm9tKFsxLCAzXSksICdJU08tODg1OS0xJywgJ0lTTzg4NTkxJywgJ0lTTzg4NTlfMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzIgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8yLCA0LCAnSVNPLTg4NTktMicsICdJU084ODU5MicsICdJU084ODU5XzInKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8zID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMywgNSwgJ0lTTy04ODU5LTMnLCAnSVNPODg1OTMnLCAnSVNPODg1OV8zJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzQsIDYsICdJU08tODg1OS00JywgJ0lTTzg4NTk0JywgJ0lTTzg4NTlfNCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV81LCA3LCAnSVNPLTg4NTktNScsICdJU084ODU5NScsICdJU084ODU5XzUnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV82ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfNiwgOCwgJ0lTTy04ODU5LTYnLCAnSVNPODg1OTYnLCAnSVNPODg1OV82Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzcsIDksICdJU08tODg1OS03JywgJ0lTTzg4NTk3JywgJ0lTTzg4NTlfNycpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV84LCAxMCwgJ0lTTy04ODU5LTgnLCAnSVNPODg1OTgnLCAnSVNPODg1OV84Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfOSA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzksIDExLCAnSVNPLTg4NTktOScsICdJU084ODU5OScsICdJU084ODU5XzknKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xMCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzEwLCAxMiwgJ0lTTy04ODU5LTEwJywgJ0lTTzg4NTkxMCcsICdJU084ODU5XzEwJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xMSwgMTMsICdJU08tODg1OS0xMScsICdJU084ODU5MTEnLCAnSVNPODg1OV8xMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzEzID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTMsIDE1LCAnSVNPLTg4NTktMTMnLCAnSVNPODg1OTEzJywgJ0lTTzg4NTlfMTMnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzE0LCAxNiwgJ0lTTy04ODU5LTE0JywgJ0lTTzg4NTkxNCcsICdJU084ODU5XzE0Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xNSwgMTcsICdJU08tODg1OS0xNScsICdJU084ODU5MTUnLCAnSVNPODg1OV8xNScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzE2ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTYsIDE4LCAnSVNPLTg4NTktMTYnLCAnSVNPODg1OTE2JywgJ0lTTzg4NTlfMTYnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuU0pJUyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5TSklTLCAyMCwgJ1NKSVMnLCAnU2hpZnRfSklTJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1MCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTAsIDIxLCAnQ3AxMjUwJywgJ3dpbmRvd3MtMTI1MCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5DcDEyNTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3AxMjUxLCAyMiwgJ0NwMTI1MScsICd3aW5kb3dzLTEyNTEnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3AxMjUyID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkNwMTI1MiwgMjMsICdDcDEyNTInLCAnd2luZG93cy0xMjUyJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1NiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTYsIDI0LCAnQ3AxMjU2JywgJ3dpbmRvd3MtMTI1NicpOwoJICAgIENoYXJhY3RlclNldEVDSS5Vbmljb2RlQmlnVW5tYXJrZWQgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVW5pY29kZUJpZ1VubWFya2VkLCAyNSwgJ1VuaWNvZGVCaWdVbm1hcmtlZCcsICdVVEYtMTZCRScsICdVbmljb2RlQmlnJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlVURjggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVVRGOCwgMjYsICdVVEY4JywgJ1VURi04Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkFTQ0lJID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkFTQ0lJLCBJbnQzMkFycmF5LmZyb20oWzI3LCAxNzBdKSwgJ0FTQ0lJJywgJ1VTLUFTQ0lJJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkJpZzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQmlnNSwgMjgsICdCaWc1Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkdCMTgwMzAgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuR0IxODAzMCwgMjksICdHQjE4MDMwJywgJ0dCMjMxMicsICdFVUNfQ04nLCAnR0JLJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkVVQ19LUiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5FVUNfS1IsIDMwLCAnRVVDX0tSJywgJ0VVQy1LUicpOwoJICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0k7Cgl9KCkpOwoJZXhwb3J0cy5kZWZhdWx0ID0gQ2hhcmFjdGVyU2V0RUNJOwoKCX0oQ2hhcmFjdGVyU2V0RUNJKSk7CgoJdmFyIFN0cmluZ0VuY29kaW5nJDEgPSB7fTsKCgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNiA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbi5raW5kID0gJ1Vuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCkpOwoJVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMS5kZWZhdWx0ID0gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ0VuY29kaW5nJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEgPSBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxOwoJdmFyIENoYXJhY3RlclNldEVDSV8xJDIgPSBDaGFyYWN0ZXJTZXRFQ0k7CgkvKioKCSAqIFJlc3BvbnNpYmxlIGZvciBlbi9kZWNvZGluZyBzdHJpbmdzLgoJICovCgl2YXIgU3RyaW5nRW5jb2RpbmcgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nRW5jb2RpbmcoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIERlY29kZXMgc29tZSBVaW50OEFycmF5IHRvIGEgc3RyaW5nIGZvcm1hdC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5kZWNvZGUgPSBmdW5jdGlvbiAoYnl0ZXMsIGVuY29kaW5nKSB7CgkgICAgICAgIHZhciBlbmNvZGluZ05hbWUgPSB0aGlzLmVuY29kaW5nTmFtZShlbmNvZGluZyk7CgkgICAgICAgIGlmICh0aGlzLmN1c3RvbURlY29kZXIpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmN1c3RvbURlY29kZXIoYnl0ZXMsIGVuY29kaW5nTmFtZSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSW5jcmVhc2VzIGJyb3dzZXIgc3VwcG9ydC4KCSAgICAgICAgaWYgKHR5cGVvZiBUZXh0RGVjb2RlciA9PT0gJ3VuZGVmaW5lZCcgfHwgdGhpcy5zaG91bGREZWNvZGVPbkZhbGxiYWNrKGVuY29kaW5nTmFtZSkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUZhbGxiYWNrKGJ5dGVzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVGV4dERlY29kZXIoZW5jb2RpbmdOYW1lKS5kZWNvZGUoYnl0ZXMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ2hlY2tzIGlmIHRoZSBkZWNvZGluZyBtZXRob2Qgc2hvdWxkIHVzZSB0aGUgZmFsbGJhY2sgZm9yIGRlY29kaW5nCgkgICAgICogb25jZSBOb2RlIFRleHREZWNvZGVyIGRvZXNuJ3Qgc3VwcG9ydCBhbGwgZW5jb2RpbmcgZm9ybWF0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBlbmNvZGluZ05hbWUKCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5zaG91bGREZWNvZGVPbkZhbGxiYWNrID0gZnVuY3Rpb24gKGVuY29kaW5nTmFtZSkgewoJICAgICAgICByZXR1cm4gIVN0cmluZ0VuY29kaW5nLmlzQnJvd3NlcigpICYmIGVuY29kaW5nTmFtZSA9PT0gJ0lTTy04ODU5LTEnOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRW5jb2RlcyBzb21lIHN0cmluZyBpbnRvIGEgVWludDhBcnJheS4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGUgPSBmdW5jdGlvbiAocywgZW5jb2RpbmcpIHsKCSAgICAgICAgdmFyIGVuY29kaW5nTmFtZSA9IHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKTsKCSAgICAgICAgaWYgKHRoaXMuY3VzdG9tRW5jb2RlcikgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3VzdG9tRW5jb2RlcihzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEluY3JlYXNlcyBicm93c2VyIHN1cHBvcnQuCgkgICAgICAgIGlmICh0eXBlb2YgVGV4dEVuY29kZXIgPT09ICd1bmRlZmluZWQnKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5lbmNvZGVGYWxsYmFjayhzKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBUZXh0RW5jb2RlciBvbmx5IGVuY29kZXMgdG8gVVRGOCBieSBkZWZhdWx0IGFzIHNwZWNpZmllZCBieSBlbmNvZGluZy5zcGVjLndoYXR3Zy5vcmcKCSAgICAgICAgcmV0dXJuIG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShzKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzQnJvd3NlciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB7fS50b1N0cmluZy5jYWxsKHdpbmRvdykgPT09ICdbb2JqZWN0IFdpbmRvd10nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHN0cmluZyB2YWx1ZSBmcm9tIHNvbWUgZW5jb2RpbmcgY2hhcmFjdGVyIHNldC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGluZ05hbWUgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgcmV0dXJuIHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZycKCSAgICAgICAgICAgID8gZW5jb2RpbmcKCSAgICAgICAgICAgIDogZW5jb2RpbmcuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBjaGFyYWN0ZXIgc2V0IGZyb20gc29tZSBlbmNvZGluZyBjaGFyYWN0ZXIgc2V0LgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmVuY29kaW5nQ2hhcmFjdGVyU2V0ID0gZnVuY3Rpb24gKGVuY29kaW5nKSB7CgkgICAgICAgIGlmIChlbmNvZGluZyBpbnN0YW5jZW9mIENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdCkgewoJICAgICAgICAgICAgcmV0dXJuIGVuY29kaW5nOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlOYW1lKGVuY29kaW5nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJ1bnMgYSBmYWxsYmFjayBmb3IgdGhlIG5hdGl2ZSBkZWNvZGluZyBmdW5jaW9uLgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmRlY29kZUZhbGxiYWNrID0gZnVuY3Rpb24gKGJ5dGVzLCBlbmNvZGluZykgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gdGhpcy5lbmNvZGluZ0NoYXJhY3RlclNldChlbmNvZGluZyk7CgkgICAgICAgIGlmIChTdHJpbmdFbmNvZGluZy5pc0RlY29kZUZhbGxiYWNrU3VwcG9ydGVkKGNoYXJhY3RlclNldCkpIHsKCSAgICAgICAgICAgIHZhciBzID0gJyc7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSBieXRlcy5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGggPSBieXRlc1tpXS50b1N0cmluZygxNik7CgkgICAgICAgICAgICAgICAgaWYgKGgubGVuZ3RoIDwgMikgewoJICAgICAgICAgICAgICAgICAgICBoID0gJzAnICsgaDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcyArPSAnJScgKyBoOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChzKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuVW5pY29kZUJpZ1VubWFya2VkKSkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgbmV3IFVpbnQxNkFycmF5KGJ5dGVzLmJ1ZmZlcikpOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgiRW5jb2RpbmcgIiArIHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKSArICIgbm90IHN1cHBvcnRlZCBieSBmYWxsYmFjay4iKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzRGVjb2RlRmFsbGJhY2tTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgIHJldHVybiBjaGFyYWN0ZXJTZXQuZXF1YWxzKENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdC5VVEY4KSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuSVNPODg1OV8xKSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuQVNDSUkpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUnVucyBhIGZhbGxiYWNrIGZvciB0aGUgbmF0aXZlIGVuY29kaW5nIGZ1bmNpb24uCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xNzE5Mjg0NS80MzY3NjgzCgkgICAgICovCgkgICAgU3RyaW5nRW5jb2RpbmcuZW5jb2RlRmFsbGJhY2sgPSBmdW5jdGlvbiAocykgewoJICAgICAgICB2YXIgZW5jb2RlZFVSSXN0cmluZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHMpKSk7CgkgICAgICAgIHZhciBjaGFyTGlzdCA9IGVuY29kZWRVUklzdHJpbmcuc3BsaXQoJycpOwoJICAgICAgICB2YXIgdWludEFycmF5ID0gW107CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhckxpc3QubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHVpbnRBcnJheS5wdXNoKGNoYXJMaXN0W2ldLmNoYXJDb2RlQXQoMCkpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheSh1aW50QXJyYXkpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0VuY29kaW5nOwoJfSgpKTsKCVN0cmluZ0VuY29kaW5nJDEuZGVmYXVsdCA9IFN0cmluZ0VuY29kaW5nOwoKCS8qCgkgKiBDb3B5cmlnaHQgKEMpIDIwMTAgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ1V0aWxzJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS5uaW8uY2hhcnNldC5DaGFyc2V0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQzID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSQxID0gQ2hhcmFjdGVyU2V0RUNJOwoJdmFyIFN0cmluZ0VuY29kaW5nXzEkMSA9IFN0cmluZ0VuY29kaW5nJDE7CgkvKioKCSAqIENvbW1vbiBzdHJpbmctcmVsYXRlZCBmdW5jdGlvbnMuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgQWxleCBEdXByZQoJICovCgl2YXIgU3RyaW5nVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nVXRpbHMoKSB7CgkgICAgfQoJICAgIC8vIFNISUZUX0pJUy5lcXVhbHNJZ25vcmVDYXNlKFBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcpIHx8CgkgICAgLy8gRVVDX0pQLmVxdWFsc0lnbm9yZUNhc2UoUExBVEZPUk1fREVGQVVMVF9FTkNPRElORyk7CgkgICAgU3RyaW5nVXRpbHMuY2FzdEFzTm9uVXRmOENoYXIgPSBmdW5jdGlvbiAoY29kZSwgZW5jb2RpbmcpIHsKCSAgICAgICAgaWYgKGVuY29kaW5nID09PSB2b2lkIDApIHsgZW5jb2RpbmcgPSBudWxsOyB9CgkgICAgICAgIC8vIElTTyA4ODU5LTEgaXMgdGhlIEphdmEgZGVmYXVsdCBhcyBVVEYtOCBpcyBKYXZhU2NyaXB0cwoJICAgICAgICAvLyB5b3UgY2FuIHNlZSB0aGlzIG1ldGhvZCBhcyBhIEphdmEgdmVyc2lvbiBvZiBTdHJpbmcuZnJvbUNoYXJDb2RlCgkgICAgICAgIHZhciBlID0gZW5jb2RpbmcgPyBlbmNvZGluZy5nZXROYW1lKCkgOiB0aGlzLklTTzg4NTkxOwoJICAgICAgICAvLyB1c2UgcGFzc2VkIGZvcm1hdCAoZnJvbUNoYXJDb2RlIHdpbGwgcmV0dXJuIFVURjggZW5jb2RpbmcpCgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5kZWNvZGUobmV3IFVpbnQ4QXJyYXkoW2NvZGVdKSwgZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYnl0ZXMgYnl0ZXMgZW5jb2RpbmcgYSBzdHJpbmcsIHdob3NlIGVuY29kaW5nIHNob3VsZCBiZSBndWVzc2VkCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kZSBoaW50cyBpZiBhcHBsaWNhYmxlCgkgICAgICogQHJldHVybiBuYW1lIG9mIGd1ZXNzZWQgZW5jb2Rpbmc7IGF0IHRoZSBtb21lbnQgd2lsbCBvbmx5IGd1ZXNzIG9uZSBvZjoKCSAgICAgKiAge0BsaW5rICNTSElGVF9KSVN9LCB7QGxpbmsgI1VURjh9LCB7QGxpbmsgI0lTTzg4NTkxfSwgb3IgdGhlIHBsYXRmb3JtCgkgICAgICogIGRlZmF1bHQgZW5jb2RpbmcgaWYgbm9uZSBvZiB0aGVzZSBjYW4gcG9zc2libHkgYmUgY29ycmVjdAoJICAgICAqLwoJICAgIFN0cmluZ1V0aWxzLmd1ZXNzRW5jb2RpbmcgPSBmdW5jdGlvbiAoYnl0ZXMsIGhpbnRzKSB7CgkgICAgICAgIGlmIChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpKSB7CgkgICAgICAgICAgICByZXR1cm4gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpLnRvU3RyaW5nKCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRm9yIG5vdywgbWVyZWx5IHRyaWVzIHRvIGRpc3Rpbmd1aXNoIElTTy04ODU5LTEsIFVURi04IGFuZCBTaGlmdF9KSVMsCgkgICAgICAgIC8vIHdoaWNoIHNob3VsZCBiZSBieSBmYXIgdGhlIG1vc3QgY29tbW9uIGVuY29kaW5ncy4KCSAgICAgICAgdmFyIGxlbmd0aCA9IGJ5dGVzLmxlbmd0aDsKCSAgICAgICAgdmFyIGNhbkJlSVNPODg1OTEgPSB0cnVlOwoJICAgICAgICB2YXIgY2FuQmVTaGlmdEpJUyA9IHRydWU7CgkgICAgICAgIHZhciBjYW5CZVVURjggPSB0cnVlOwoJICAgICAgICB2YXIgdXRmOEJ5dGVzTGVmdCA9IDA7CgkgICAgICAgIC8vIGludCB1dGY4TG93Q2hhcnMgPSAwCgkgICAgICAgIHZhciB1dGYyQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGYzQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGY0Qnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciBzamlzQnl0ZXNMZWZ0ID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNMb3dDaGFycyA9IDAKCSAgICAgICAgdmFyIHNqaXNLYXRha2FuYUNoYXJzID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNEb3VibGVCeXRlc0NoYXJzID0gMAoJICAgICAgICB2YXIgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgIHZhciBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgdmFyIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSAwOwoJICAgICAgICB2YXIgc2ppc01heERvdWJsZUJ5dGVzV29yZExlbmd0aCA9IDA7CgkgICAgICAgIC8vIGludCBpc29Mb3dDaGFycyA9IDAKCSAgICAgICAgLy8gaW50IGlzb0hpZ2hDaGFycyA9IDAKCSAgICAgICAgdmFyIGlzb0hpZ2hPdGhlciA9IDA7CgkgICAgICAgIHZhciB1dGY4Ym9tID0gYnl0ZXMubGVuZ3RoID4gMyAmJgoJICAgICAgICAgICAgYnl0ZXNbMF0gPT09IC8qKGJ5dGUpICovIDB4RUYgJiYKCSAgICAgICAgICAgIGJ5dGVzWzFdID09PSAvKihieXRlKSAqLyAweEJCICYmCgkgICAgICAgICAgICBieXRlc1syXSA9PT0gLyooYnl0ZSkgKi8gMHhCRjsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGggJiYgKGNhbkJlSVNPODg1OTEgfHwgY2FuQmVTaGlmdEpJUyB8fCBjYW5CZVVURjgpOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB2YWx1ZSA9IGJ5dGVzW2ldICYgMHhGRjsKCSAgICAgICAgICAgIC8vIFVURi04IHN0dWZmCgkgICAgICAgICAgICBpZiAoY2FuQmVVVEY4KSB7CgkgICAgICAgICAgICAgICAgaWYgKHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDgwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgY2FuQmVVVEY4ID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAoKHZhbHVlICYgMHg4MCkgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4NDApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjhCeXRlc0xlZnQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDIwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjJCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4MTApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjNCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDA4KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXRmNEJ5dGVzQ2hhcnMrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbkJlVVRGOCA9IGZhbHNlOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfSAvLyBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyB1dGY4TG93Q2hhcnMrKwoJICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIElTTy04ODU5LTEgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICAgICAgaWYgKHZhbHVlID4gMHg3RiAmJiB2YWx1ZSA8IDB4QTApIHsKCSAgICAgICAgICAgICAgICAgICAgY2FuQmVJU084ODU5MSA9IGZhbHNlOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA+IDB4OUYpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlIDwgMHhDMCB8fCB2YWx1ZSA9PT0gMHhENyB8fCB2YWx1ZSA9PT0gMHhGNykgewoJICAgICAgICAgICAgICAgICAgICAgICAgaXNvSGlnaE90aGVyKys7CgkgICAgICAgICAgICAgICAgICAgIH0gLy8gZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIGlzb0hpZ2hDaGFycysrCgkgICAgICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgICAgICB9IC8vIGVsc2UgewoJICAgICAgICAgICAgICAgIC8vIGlzb0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAvLyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBTaGlmdF9KSVMgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTKSB7CgkgICAgICAgICAgICAgICAgaWYgKHNqaXNCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA8IDB4NDAgfHwgdmFsdWUgPT09IDB4N0YgfHwgdmFsdWUgPiAweEZDKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVNoaWZ0SklTID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPT09IDB4ODAgfHwgdmFsdWUgPT09IDB4QTAgfHwgdmFsdWUgPiAweEVGKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhbkJlU2hpZnRKSVMgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPiAweEEwICYmIHZhbHVlIDwgMHhFMCkgewoJICAgICAgICAgICAgICAgICAgICBzamlzS2F0YWthbmFDaGFycysrOwoJICAgICAgICAgICAgICAgICAgICBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCsrOwoJICAgICAgICAgICAgICAgICAgICBpZiAoc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA+IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSBzamlzQ3VyS2F0YWthbmFXb3JkTGVuZ3RoOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlID4gMHg3RikgewoJICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgIC8vIHNqaXNEb3VibGVCeXRlc0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGgrKzsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPiBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gc2ppc0N1ckRvdWJsZUJ5dGVzV29yZExlbmd0aDsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gc2ppc0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPSAwOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmIHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVTaGlmdEpJUyAmJiBzamlzQnl0ZXNMZWZ0ID4gMCkgewoJICAgICAgICAgICAgY2FuQmVTaGlmdEpJUyA9IGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhc3kgLS0gaWYgdGhlcmUgaXMgQk9NIG9yIGF0IGxlYXN0IDEgdmFsaWQgbm90LXNpbmdsZSBieXRlIGNoYXJhY3RlciAoYW5kIG5vIGV2aWRlbmNlIGl0IGNhbid0IGJlIFVURi04KSwgZG9uZQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmICh1dGY4Ym9tIHx8IHV0ZjJCeXRlc0NoYXJzICsgdXRmM0J5dGVzQ2hhcnMgKyB1dGY0Qnl0ZXNDaGFycyA+IDApKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuVVRGODsKCSAgICAgICAgfQoJICAgICAgICAvLyBFYXN5IC0tIGlmIGFzc3VtaW5nIFNoaWZ0X0pJUyBvciBhdCBsZWFzdCAzIHZhbGlkIGNvbnNlY3V0aXZlIG5vdC1hc2NpaSBjaGFyYWN0ZXJzIChhbmQgbm8gZXZpZGVuY2UgaXQgY2FuJ3QgYmUpLCBkb25lCgkgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTICYmIChTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTIHx8IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPj0gMyB8fCBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID49IDMpKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuU0hJRlRfSklTOwoJICAgICAgICB9CgkgICAgICAgIC8vIERpc3Rpbmd1aXNoaW5nIFNoaWZ0X0pJUyBhbmQgSVNPLTg4NTktMSBjYW4gYmUgYSBsaXR0bGUgdG91Z2ggZm9yIHNob3J0IHdvcmRzLiBUaGUgY3J1ZGUgaGV1cmlzdGljIGlzOgoJICAgICAgICAvLyAtIElmIHdlIHNhdwoJICAgICAgICAvLyAgIC0gb25seSB0d28gY29uc2VjdXRpdmUga2F0YWthbmEgY2hhcnMgaW4gdGhlIHdob2xlIHRleHQsIG9yCgkgICAgICAgIC8vICAgLSBhdCBsZWFzdCAxMCUgb2YgYnl0ZXMgdGhhdCBjb3VsZCBiZSAidXBwZXIiIG5vdC1hbHBoYW51bWVyaWMgTGF0aW4xLAoJICAgICAgICAvLyAtIHRoZW4gd2UgY29uY2x1ZGUgU2hpZnRfSklTLCBlbHNlIElTTy04ODU5LTEKCSAgICAgICAgaWYgKGNhbkJlSVNPODg1OTEgJiYgY2FuQmVTaGlmdEpJUykgewoJICAgICAgICAgICAgcmV0dXJuIChzamlzTWF4S2F0YWthbmFXb3JkTGVuZ3RoID09PSAyICYmIHNqaXNLYXRha2FuYUNoYXJzID09PSAyKSB8fCBpc29IaWdoT3RoZXIgKiAxMCA+PSBsZW5ndGgKCSAgICAgICAgICAgICAgICA/IFN0cmluZ1V0aWxzLlNISUZUX0pJUyA6IFN0cmluZ1V0aWxzLklTTzg4NTkxOwoJICAgICAgICB9CgkgICAgICAgIC8vIE90aGVyd2lzZSwgdHJ5IGluIG9yZGVyIElTTy04ODU5LTEsIFNoaWZ0IEpJUywgVVRGLTggYW5kIGZhbGwgYmFjayB0byBkZWZhdWx0IHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuSVNPODg1OTE7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlU2hpZnRKSVMpIHsKCSAgICAgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5TSElGVF9KSVM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlVVRGOCkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLlVURjg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gT3RoZXJ3aXNlLCB3ZSB0YWtlIGEgd2lsZCBndWVzcyB3aXRoIHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5QTEFURk9STV9ERUZBVUxUX0VOQ09ESU5HOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xMzQzOTcxMS80MzY3NjgzCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYXBwZW5kIFRoZSBuZXcgc3RyaW5nIHRvIGFwcGVuZC4KCSAgICAgKiBAcGFyYW0gYXJncyBBcmd1bWV0cyB2YWx1ZXMgdG8gYmUgZm9ybWF0ZWQuCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZm9ybWF0ID0gZnVuY3Rpb24gKGFwcGVuZCkgewoJICAgICAgICB2YXIgYXJncyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaSA9IC0xOwoJICAgICAgICBmdW5jdGlvbiBjYWxsYmFjayhleHAsIHAwLCBwMSwgcDIsIHAzLCBwNCkgewoJICAgICAgICAgICAgaWYgKGV4cCA9PT0gJyUlJykKCSAgICAgICAgICAgICAgICByZXR1cm4gJyUnOwoJICAgICAgICAgICAgaWYgKGFyZ3NbKytpXSA9PT0gdW5kZWZpbmVkKQoJICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7CgkgICAgICAgICAgICBleHAgPSBwMiA/IHBhcnNlSW50KHAyLnN1YnN0cigxKSkgOiB1bmRlZmluZWQ7CgkgICAgICAgICAgICB2YXIgYmFzZSA9IHAzID8gcGFyc2VJbnQocDMuc3Vic3RyKDEpKSA6IHVuZGVmaW5lZDsKCSAgICAgICAgICAgIHZhciB2YWw7CgkgICAgICAgICAgICBzd2l0Y2ggKHA0KSB7CgkgICAgICAgICAgICAgICAgY2FzZSAncyc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IGFyZ3NbaV07CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2MnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBhcmdzW2ldWzBdOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdmJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChhcmdzW2ldKS50b0ZpeGVkKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ3AnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvUHJlY2lzaW9uKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2UnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvRXhwb25lbnRpYWwoZXhwKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgY2FzZSAneCc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IHBhcnNlSW50KGFyZ3NbaV0pLnRvU3RyaW5nKGJhc2UgPyBiYXNlIDogMTYpOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdkJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChwYXJzZUludChhcmdzW2ldLCBiYXNlID8gYmFzZSA6IDEwKS50b1ByZWNpc2lvbihleHApKS50b0ZpeGVkKDApOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhbCA9IHR5cGVvZiB2YWwgPT09ICdvYmplY3QnID8gSlNPTi5zdHJpbmdpZnkodmFsKSA6ICgrdmFsKS50b1N0cmluZyhiYXNlKTsKCSAgICAgICAgICAgIHZhciBzaXplID0gcGFyc2VJbnQocDEpOyAvKiBwYWRkaW5nIHNpemUgKi8KCSAgICAgICAgICAgIHZhciBjaCA9IHAxICYmIChwMVswXSArICcnKSA9PT0gJzAnID8gJzAnIDogJyAnOyAvKiBpc251bGw/ICovCgkgICAgICAgICAgICB3aGlsZSAodmFsLmxlbmd0aCA8IHNpemUpCgkgICAgICAgICAgICAgICAgdmFsID0gcDAgIT09IHVuZGVmaW5lZCA/IHZhbCArIGNoIDogY2ggKyB2YWw7IC8qIGlzbWludXM/ICovCgkgICAgICAgICAgICByZXR1cm4gdmFsOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZWdleCA9IC8lKC0pPygwP1swLTldKyk/KFsuXVswLTldKyk/KFsjXVswLTldKyk/KFtzY2ZwZXhkJV0pL2c7CgkgICAgICAgIHJldHVybiBhcHBlbmQucmVwbGFjZShyZWdleCwgY2FsbGJhY2spOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRCeXRlcyA9IGZ1bmN0aW9uIChzdHIsIGVuY29kaW5nKSB7CgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5lbmNvZGUoc3RyLCBlbmNvZGluZyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIHRoZSBjaGFyY29kZSBhdCB0aGUgc3BlY2lmaWVkIGluZGV4IG9yIGF0IGluZGV4IHplcm8uCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZ2V0Q2hhckNvZGUgPSBmdW5jdGlvbiAoc3RyLCBpbmRleCkgewoJICAgICAgICBpZiAoaW5kZXggPT09IHZvaWQgMCkgeyBpbmRleCA9IDA7IH0KCSAgICAgICAgcmV0dXJuIHN0ci5jaGFyQ29kZUF0KGluZGV4KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgY2hhciBmb3IgZ2l2ZW4gY2hhcmNvZGUKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRDaGFyQXQgPSBmdW5jdGlvbiAoY2hhckNvZGUpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoY2hhckNvZGUpOwoJICAgIH07CgkgICAgU3RyaW5nVXRpbHMuU0hJRlRfSklTID0gQ2hhcmFjdGVyU2V0RUNJXzEkMS5kZWZhdWx0LlNKSVMuZ2V0TmFtZSgpOyAvLyAiU0pJUyIKCSAgICBTdHJpbmdVdGlscy5HQjIzMTIgPSAnR0IyMzEyJzsKCSAgICBTdHJpbmdVdGlscy5JU084ODU5MSA9IENoYXJhY3RlclNldEVDSV8xJDEuZGVmYXVsdC5JU084ODU5XzEuZ2V0TmFtZSgpOyAvLyAiSVNPODg1OV8xIgoJICAgIFN0cmluZ1V0aWxzLkVVQ19KUCA9ICdFVUNfSlAnOwoJICAgIFN0cmluZ1V0aWxzLlVURjggPSBDaGFyYWN0ZXJTZXRFQ0lfMSQxLmRlZmF1bHQuVVRGOC5nZXROYW1lKCk7IC8vICJVVEY4IgoJICAgIFN0cmluZ1V0aWxzLlBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcgPSBTdHJpbmdVdGlscy5VVEY4OyAvLyAiVVRGOCIvL0NoYXJzZXQuZGVmYXVsdENoYXJzZXQoKS5uYW1lKCkKCSAgICBTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTID0gZmFsc2U7CgkgICAgcmV0dXJuIFN0cmluZ1V0aWxzOwoJfSgpKTsKCVN0cmluZ1V0aWxzJDEuZGVmYXVsdCA9IFN0cmluZ1V0aWxzOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdHJpbmdCdWlsZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBTdHJpbmdVdGlsc18xJDEgPSBTdHJpbmdVdGlscyQxOwoJdmFyIFN0cmluZ0J1aWxkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nQnVpbGRlcih2YWx1ZSkgewoJICAgICAgICBpZiAodmFsdWUgPT09IHZvaWQgMCkgeyB2YWx1ZSA9ICcnOyB9CgkgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTsKCSAgICB9CgkgICAgU3RyaW5nQnVpbGRlci5wcm90b3R5cGUuZW5hYmxlRGVjb2RpbmcgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgdGhpcy5lbmNvZGluZyA9IGVuY29kaW5nOwoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZCA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIGlmICh0eXBlb2YgcyA9PT0gJ3N0cmluZycpIHsKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gcy50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHRoaXMuZW5jb2RpbmcpIHsKCSAgICAgICAgICAgIC8vIHVzZSBwYXNzZWQgZm9ybWF0IChmcm9tQ2hhckNvZGUgd2lsbCByZXR1cm4gVVRGOCBlbmNvZGluZykKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nVXRpbHNfMSQxLmRlZmF1bHQuY2FzdEFzTm9uVXRmOENoYXIocywgdGhpcy5lbmNvZGluZyk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBjb3JyZWN0bHkgY29udmVydHMgZnJvbSBVVEYtOCwgYnV0IG5vdCBvdGhlciBlbmNvZGluZ3MKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShzKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZENoYXJzID0gZnVuY3Rpb24gKHN0ciwgb2Zmc2V0LCBsZW4pIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IG9mZnNldDsgb2Zmc2V0IDwgb2Zmc2V0ICsgbGVuOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kKHN0cltpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5sZW5ndGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmxlbmd0aDsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmNoYXJBdChuKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmRlbGV0ZUNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIHRoaXMudmFsdWUuc3Vic3RyaW5nKG4gKyAxKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnNldENoYXJBdCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgMSk7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zdWJzdHJpbmcgPSBmdW5jdGlvbiAoc3RhcnQsIGVuZCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZS5zdWJzdHJpbmcoc3RhcnQsIGVuZCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAbm90ZSBoZWxwZXIgbWV0aG9kIGZvciBSU1MgRXhwYW5kZWQKCSAgICAgKi8KCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zZXRMZW5ndGhUb1plcm8gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSAnJzsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgYy5sZW5ndGgpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0J1aWxkZXI7Cgl9KCkpOwoJU3RyaW5nQnVpbGRlciQxLmRlZmF1bHQgPSBTdHJpbmdCdWlsZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQml0TWF0cml4JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIEJpdEFycmF5XzEkMSA9IEJpdEFycmF5JDE7Cgl2YXIgU3lzdGVtXzEkMyA9IFN5c3RlbSQxOwoJdmFyIEFycmF5c18xID0gQXJyYXlzJDE7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDIgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNyA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgMkQgbWF0cml4IG9mIGJpdHMuIEluIGZ1bmN0aW9uIGFyZ3VtZW50cyBiZWxvdywgYW5kIHRocm91Z2hvdXQgdGhlIGNvbW1vbgoJICogbW9kdWxlLCB4IGlzIHRoZSBjb2x1bW4gcG9zaXRpb24sIGFuZCB5IGlzIHRoZSByb3cgcG9zaXRpb24uIFRoZSBvcmRlcmluZyBpcyBhbHdheXMgeCwgeS4KCSAqIFRoZSBvcmlnaW4gaXMgYXQgdGhlIHRvcC1sZWZ0LjwvcD4KCSAqCgkgKiA8cD5JbnRlcm5hbGx5IHRoZSBiaXRzIGFyZSByZXByZXNlbnRlZCBpbiBhIDEtRCBhcnJheSBvZiAzMi1iaXQgaW50cy4gSG93ZXZlciwgZWFjaCByb3cgYmVnaW5zCgkgKiB3aXRoIGEgbmV3IGludC4gVGhpcyBpcyBkb25lIGludGVudGlvbmFsbHkgc28gdGhhdCB3ZSBjYW4gY29weSBvdXQgYSByb3cgaW50byBhIEJpdEFycmF5IHZlcnkKCSAqIGVmZmljaWVudGx5LjwvcD4KCSAqCgkgKiA8cD5UaGUgb3JkZXJpbmcgb2YgYml0cyBpcyByb3ctbWFqb3IuIFdpdGhpbiBlYWNoIGludCwgdGhlIGxlYXN0IHNpZ25pZmljYW50IGJpdHMgYXJlIHVzZWQgZmlyc3QsCgkgKiBtZWFuaW5nIHRoZXkgcmVwcmVzZW50IGxvd2VyIHggdmFsdWVzLiBUaGlzIGlzIGNvbXBhdGlibGUgd2l0aCBCaXRBcnJheSdzIGltcGxlbWVudGF0aW9uLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpdE1hdHJpeCAvKmltcGxlbWVudHMgQ2xvbmVhYmxlKi8gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSBzcXVhcmUge0BsaW5rIEJpdE1hdHJpeH0uCgkgICAgICoKCSAgICAgKiBAcGFyYW0gZGltZW5zaW9uIGhlaWdodCBhbmQgd2lkdGgKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoZGltZW5zaW9uOiBudW1iZXIgLyppbnQqLykgewoJICAgIC8vICAgdGhpcyhkaW1lbnNpb24sIGRpbWVuc2lvbikKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSB7QGxpbmsgQml0TWF0cml4fS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB3aWR0aCBiaXQgbWF0cml4IHdpZHRoCgkgICAgICogQHBhcmFtIGhlaWdodCBiaXQgbWF0cml4IGhlaWdodAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3Rvcih3aWR0aDogbnVtYmVyIC8qaW50Ki8sIGhlaWdodDogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh3aWR0aCA8IDEgfHwgaGVpZ2h0IDwgMSkgewoJICAgIC8vICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJCb3RoIGRpbWVuc2lvbnMgbXVzdCBiZSBncmVhdGVyIHRoYW4gMCIpCgkgICAgLy8gICB9CgkgICAgLy8gICB0aGlzLndpZHRoID0gd2lkdGgKCSAgICAvLyAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0CgkgICAgLy8gICB0aGlzLnJvd1NpemUgPSAod2lkdGggKyAzMSkgLyAzMgoJICAgIC8vICAgYml0cyA9IG5ldyBpbnRbcm93U2l6ZSAqIGhlaWdodF07CgkgICAgLy8gfQoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeCh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgcm93U2l6ZSAvKmludCovLCBiaXRzKSB7CgkgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDsKCSAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CgkgICAgICAgIHRoaXMucm93U2l6ZSA9IHJvd1NpemU7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGhlaWdodCB8fCBudWxsID09PSBoZWlnaHQpIHsKCSAgICAgICAgICAgIGhlaWdodCA9IHdpZHRoOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgICAgICBpZiAod2lkdGggPCAxIHx8IGhlaWdodCA8IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0JvdGggZGltZW5zaW9ucyBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAwJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gcm93U2l6ZSB8fCBudWxsID09PSByb3dTaXplKSB7CgkgICAgICAgICAgICByb3dTaXplID0gTWF0aC5mbG9vcigod2lkdGggKyAzMSkgLyAzMik7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yb3dTaXplID0gcm93U2l6ZTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICB0aGlzLmJpdHMgPSBuZXcgSW50MzJBcnJheSh0aGlzLnJvd1NpemUgKiB0aGlzLmhlaWdodCk7CgkgICAgICAgIH0KCSAgICB9CgkgICAgLyoqCgkgICAgICogSW50ZXJwcmV0cyBhIDJEIGFycmF5IG9mIGJvb2xlYW5zIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0sIHdoZXJlICJ0cnVlIiBtZWFucyBhbiAib24iIGJpdC4KCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBpbWFnZSBiaXRzIG9mIHRoZSBpbWFnZSwgYXMgYSByb3ctbWFqb3IgMkQgYXJyYXkuIEVsZW1lbnRzIGFyZSBhcnJheXMgcmVwcmVzZW50aW5nIHJvd3MKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCaXRNYXRyaXh9IHJlcHJlc2VudGF0aW9uIG9mIGltYWdlCgkgICAgICovCgkgICAgQml0TWF0cml4LnBhcnNlRnJvbUJvb2xlYW5BcnJheSA9IGZ1bmN0aW9uIChpbWFnZSkgewoJICAgICAgICB2YXIgaGVpZ2h0ID0gaW1hZ2UubGVuZ3RoOwoJICAgICAgICB2YXIgd2lkdGggPSBpbWFnZVswXS5sZW5ndGg7CgkgICAgICAgIHZhciBiaXRzID0gbmV3IEJpdE1hdHJpeCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBoZWlnaHQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGltYWdlSSA9IGltYWdlW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB3aWR0aDsgaisrKSB7CgkgICAgICAgICAgICAgICAgaWYgKGltYWdlSVtqXSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldChqLCBpKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBzdHJpbmdSZXByZXNlbnRhdGlvbgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcKCSAgICAgKiBAcGFyYW0gdW5zZXRTdHJpbmcKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucGFyc2VGcm9tU3RyaW5nID0gZnVuY3Rpb24gKHN0cmluZ1JlcHJlc2VudGF0aW9uLCBzZXRTdHJpbmcsIHVuc2V0U3RyaW5nKSB7CgkgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnc3RyaW5nUmVwcmVzZW50YXRpb24gY2Fubm90IGJlIG51bGwnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBBcnJheShzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpOwoJICAgICAgICB2YXIgYml0c1BvcyA9IDA7CgkgICAgICAgIHZhciByb3dTdGFydFBvcyA9IDA7CgkgICAgICAgIHZhciByb3dMZW5ndGggPSAtMTsKCSAgICAgICAgdmFyIG5Sb3dzID0gMDsKCSAgICAgICAgdmFyIHBvcyA9IDA7CgkgICAgICAgIHdoaWxlIChwb3MgPCBzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpIHsKCSAgICAgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbi5jaGFyQXQocG9zKSA9PT0gJ1xuJyB8fAoJICAgICAgICAgICAgICAgIHN0cmluZ1JlcHJlc2VudGF0aW9uLmNoYXJBdChwb3MpID09PSAnXHInKSB7CgkgICAgICAgICAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgICAgICAgICBpZiAocm93TGVuZ3RoID09PSAtMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcm93TGVuZ3RoID0gYml0c1BvcyAtIHJvd1N0YXJ0UG9zOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGJpdHNQb3MgLSByb3dTdGFydFBvcyAhPT0gcm93TGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdyb3cgbGVuZ3RocyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICByb3dTdGFydFBvcyA9IGJpdHNQb3M7CgkgICAgICAgICAgICAgICAgICAgIG5Sb3dzKys7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHBvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoc3RyaW5nUmVwcmVzZW50YXRpb24uc3Vic3RyaW5nKHBvcywgcG9zICsgc2V0U3RyaW5nLmxlbmd0aCkgPT09IHNldFN0cmluZykgewoJICAgICAgICAgICAgICAgIHBvcyArPSBzZXRTdHJpbmcubGVuZ3RoOwoJICAgICAgICAgICAgICAgIGJpdHNbYml0c1Bvc10gPSB0cnVlOwoJICAgICAgICAgICAgICAgIGJpdHNQb3MrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHN0cmluZ1JlcHJlc2VudGF0aW9uLnN1YnN0cmluZyhwb3MsIHBvcyArIHVuc2V0U3RyaW5nLmxlbmd0aCkgPT09IHVuc2V0U3RyaW5nKSB7CgkgICAgICAgICAgICAgICAgcG9zICs9IHVuc2V0U3RyaW5nLmxlbmd0aDsKCSAgICAgICAgICAgICAgICBiaXRzW2JpdHNQb3NdID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgYml0c1BvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnaWxsZWdhbCBjaGFyYWN0ZXIgZW5jb3VudGVyZWQ6ICcgKyBzdHJpbmdSZXByZXNlbnRhdGlvbi5zdWJzdHJpbmcocG9zKSk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm8gRU9MIGF0IGVuZD8KCSAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgaWYgKHJvd0xlbmd0aCA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICByb3dMZW5ndGggPSBiaXRzUG9zIC0gcm93U3RhcnRQb3M7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmIChiaXRzUG9zIC0gcm93U3RhcnRQb3MgIT09IHJvd0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ3JvdyBsZW5ndGhzIGRvIG5vdCBtYXRjaCcpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgblJvd3MrKzsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbWF0cml4ID0gbmV3IEJpdE1hdHJpeChyb3dMZW5ndGgsIG5Sb3dzKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiaXRzUG9zOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChiaXRzW2ldKSB7CgkgICAgICAgICAgICAgICAgbWF0cml4LnNldChNYXRoLmZsb29yKGkgJSByb3dMZW5ndGgpLCBNYXRoLmZsb29yKGkgLyByb3dMZW5ndGgpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbWF0cml4OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+R2V0cyB0aGUgcmVxdWVzdGVkIGJpdCwgd2hlcmUgdHJ1ZSBtZWFucyBibGFjay48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0geCBUaGUgaG9yaXpvbnRhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggY29sdW1uKQoJICAgICAqIEBwYXJhbSB5IFRoZSB2ZXJ0aWNhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggcm93KQoJICAgICAqIEByZXR1cm4gdmFsdWUgb2YgZ2l2ZW4gYml0IGluIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHggLyppbnQqLywgeSAvKmludCovKSB7CgkgICAgICAgIHZhciBvZmZzZXQgPSB5ICogdGhpcy5yb3dTaXplICsgTWF0aC5mbG9vcih4IC8gMzIpOwoJICAgICAgICByZXR1cm4gKCh0aGlzLmJpdHNbb2Zmc2V0XSA+Pj4gKHggJiAweDFmKSkgJiAxKSAhPT0gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgdGhlIGdpdmVuIGJpdCB0byB0cnVlLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB4IFRoZSBob3Jpem9udGFsIGNvbXBvbmVudCAoaS5lLiB3aGljaCBjb2x1bW4pCgkgICAgICogQHBhcmFtIHkgVGhlIHZlcnRpY2FsIGNvbXBvbmVudCAoaS5lLiB3aGljaCByb3cpCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIHw9ICgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRjsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUudW5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdICY9IH4oKDEgPDwgKHggJiAweDFmKSkgJiAweEZGRkZGRkZGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkZsaXBzIHRoZSBnaXZlbiBiaXQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHggVGhlIGhvcml6b250YWwgY29tcG9uZW50IChpLmUuIHdoaWNoIGNvbHVtbikKCSAgICAgKiBAcGFyYW0geSBUaGUgdmVydGljYWwgY29tcG9uZW50IChpLmUuIHdoaWNoIHJvdykKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmZsaXAgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIF49ICgoMSA8PCAoeCAmIDB4MWYpKSAmIDB4RkZGRkZGRkYpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRXhjbHVzaXZlLW9yIChYT1IpOiBGbGlwIHRoZSBiaXQgaW4gdGhpcyB7QGNvZGUgQml0TWF0cml4fSBpZiB0aGUgY29ycmVzcG9uZGluZwoJICAgICAqIG1hc2sgYml0IGlzIHNldC4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBtYXNrIFhPUiBtYXNrCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAobWFzaykgewoJICAgICAgICBpZiAodGhpcy53aWR0aCAhPT0gbWFzay5nZXRXaWR0aCgpIHx8IHRoaXMuaGVpZ2h0ICE9PSBtYXNrLmdldEhlaWdodCgpCgkgICAgICAgICAgICB8fCB0aGlzLnJvd1NpemUgIT09IG1hc2suZ2V0Um93U2l6ZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdpbnB1dCBtYXRyaXggZGltZW5zaW9ucyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcm93QXJyYXkgPSBuZXcgQml0QXJyYXlfMSQxLmRlZmF1bHQoTWF0aC5mbG9vcih0aGlzLndpZHRoIC8gMzIpICsgMSk7CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIHZhciBvZmZzZXQgPSB5ICogcm93U2l6ZTsKCSAgICAgICAgICAgIHZhciByb3cgPSBtYXNrLmdldFJvdyh5LCByb3dBcnJheSkuZ2V0Qml0QXJyYXkoKTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgcm93U2l6ZTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgYml0c1tvZmZzZXQgKyB4XSBePSByb3dbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBtYXggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkrKykgewoJICAgICAgICAgICAgYml0c1tpXSA9IDA7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgYSBzcXVhcmUgcmVnaW9uIG9mIHRoZSBiaXQgbWF0cml4IHRvIHRydWUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGxlZnQgVGhlIGhvcml6b250YWwgcG9zaXRpb24gdG8gYmVnaW4gYXQgKGluY2x1c2l2ZSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB2ZXJ0aWNhbCBwb3NpdGlvbiB0byBiZWdpbiBhdCAoaW5jbHVzaXZlKQoJICAgICAqIEBwYXJhbSB3aWR0aCBUaGUgd2lkdGggb2YgdGhlIHJlZ2lvbgoJICAgICAqIEBwYXJhbSBoZWlnaHQgVGhlIGhlaWdodCBvZiB0aGUgcmVnaW9uCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXRSZWdpb24gPSBmdW5jdGlvbiAobGVmdCAvKmludCovLCB0b3AgLyppbnQqLywgd2lkdGggLyppbnQqLywgaGVpZ2h0IC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHRvcCA8IDAgfHwgbGVmdCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0xlZnQgYW5kIHRvcCBtdXN0IGJlIG5vbm5lZ2F0aXZlJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGhlaWdodCA8IDEgfHwgd2lkdGggPCAxKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdIZWlnaHQgYW5kIHdpZHRoIG11c3QgYmUgYXQgbGVhc3QgMScpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByaWdodCA9IGxlZnQgKyB3aWR0aDsKCSAgICAgICAgdmFyIGJvdHRvbSA9IHRvcCArIGhlaWdodDsKCSAgICAgICAgaWYgKGJvdHRvbSA+IHRoaXMuaGVpZ2h0IHx8IHJpZ2h0ID4gdGhpcy53aWR0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnVGhlIHJlZ2lvbiBtdXN0IGZpdCBpbnNpZGUgdGhlIG1hdHJpeCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IHRvcDsgeSA8IGJvdHRvbTsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHJvd1NpemU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gbGVmdDsgeCA8IHJpZ2h0OyB4KyspIHsKCSAgICAgICAgICAgICAgICBiaXRzW29mZnNldCArIE1hdGguZmxvb3IoeCAvIDMyKV0gfD0gKCgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRik7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEEgZmFzdCBtZXRob2QgdG8gcmV0cmlldmUgb25lIHJvdyBvZiBkYXRhIGZyb20gdGhlIG1hdHJpeCBhcyBhIEJpdEFycmF5LgoJICAgICAqCgkgICAgICogQHBhcmFtIHkgVGhlIHJvdyB0byByZXRyaWV2ZQoJICAgICAqIEBwYXJhbSByb3cgQW4gb3B0aW9uYWwgY2FsbGVyLWFsbG9jYXRlZCBCaXRBcnJheSwgd2lsbCBiZSBhbGxvY2F0ZWQgaWYgbnVsbCBvciB0b28gc21hbGwKCSAgICAgKiBAcmV0dXJuIFRoZSByZXN1bHRpbmcgQml0QXJyYXkgLSB0aGlzIHJlZmVyZW5jZSBzaG91bGQgYWx3YXlzIGJlIHVzZWQgZXZlbiB3aGVuIHBhc3NpbmcKCSAgICAgKiAgICAgICAgIHlvdXIgb3duIHJvdwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Um93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIGlmIChyb3cgPT09IG51bGwgfHwgcm93ID09PSB1bmRlZmluZWQgfHwgcm93LmdldFNpemUoKSA8IHRoaXMud2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh0aGlzLndpZHRoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHJvdy5jbGVhcigpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiByb3dTaXplOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHJvd1NpemU7IHgrKykgewoJICAgICAgICAgICAgcm93LnNldEJ1bGsoeCAqIDMyLCBiaXRzW29mZnNldCArIHhdKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIHkgcm93IHRvIHNldAoJICAgICAqIEBwYXJhbSByb3cge0BsaW5rIEJpdEFycmF5fSB0byBjb3B5IGZyb20KCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLnNldFJvdyA9IGZ1bmN0aW9uICh5IC8qaW50Ki8sIHJvdykgewoJICAgICAgICBTeXN0ZW1fMSQzLmRlZmF1bHQuYXJyYXljb3B5KHJvdy5nZXRCaXRBcnJheSgpLCAwLCB0aGlzLmJpdHMsIHkgKiB0aGlzLnJvd1NpemUsIHRoaXMucm93U2l6ZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBNb2RpZmllcyB0aGlzIHtAY29kZSBCaXRNYXRyaXh9IHRvIHJlcHJlc2VudCB0aGUgc2FtZSBidXQgcm90YXRlZCAxODAgZGVncmVlcwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUucm90YXRlMTgwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgdG9wUm93ID0gbmV3IEJpdEFycmF5XzEkMS5kZWZhdWx0KHdpZHRoKTsKCSAgICAgICAgdmFyIGJvdHRvbVJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh3aWR0aCk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IE1hdGguZmxvb3IoKGhlaWdodCArIDEpIC8gMik7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB0b3BSb3cgPSB0aGlzLmdldFJvdyhpLCB0b3BSb3cpOwoJICAgICAgICAgICAgYm90dG9tUm93ID0gdGhpcy5nZXRSb3coaGVpZ2h0IC0gMSAtIGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0b3BSb3cucmV2ZXJzZSgpOwoJICAgICAgICAgICAgYm90dG9tUm93LnJldmVyc2UoKTsKCSAgICAgICAgICAgIHRoaXMuc2V0Um93KGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0aGlzLnNldFJvdyhoZWlnaHQgLSAxIC0gaSwgdG9wUm93KTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIHRoZSBlbmNsb3NpbmcgcmVjdGFuZ2xlIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBsZWZ0LHRvcCx3aWR0aCxoZWlnaHR9IGVuY2xvc2luZyByZWN0YW5nbGUgb2YgYWxsIDEgYml0cywgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldEVuY2xvc2luZ1JlY3RhbmdsZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIGhlaWdodCA9IHRoaXMuaGVpZ2h0OwoJICAgICAgICB2YXIgcm93U2l6ZSA9IHRoaXMucm93U2l6ZTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBsZWZ0ID0gd2lkdGg7CgkgICAgICAgIHZhciB0b3AgPSBoZWlnaHQ7CgkgICAgICAgIHZhciByaWdodCA9IC0xOwoJICAgICAgICB2YXIgYm90dG9tID0gLTE7CgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHgzMiA9IDA7IHgzMiA8IHJvd1NpemU7IHgzMisrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHRoZUJpdHMgPSBiaXRzW3kgKiByb3dTaXplICsgeDMyXTsKCSAgICAgICAgICAgICAgICBpZiAodGhlQml0cyAhPT0gMCkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA8IHRvcCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA+IGJvdHRvbSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgYm90dG9tID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeDMyICogMzIgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYml0ID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdCsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdCA9IHgzMiAqIDMyICsgYml0OwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGlmICh4MzIgKiAzMiArIDMxID4gcmlnaHQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiaXQgPSAzMTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgodGhlQml0cyA+Pj4gYml0KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPiByaWdodCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0ID0geDMyICogMzIgKyBiaXQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJpZ2h0IDwgbGVmdCB8fCBib3R0b20gPCB0b3ApIHsKCSAgICAgICAgICAgIHJldHVybiBudWxsOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2xlZnQsIHRvcCwgcmlnaHQgLSBsZWZ0ICsgMSwgYm90dG9tIC0gdG9wICsgMV0pOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIGEgY29ybmVyIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSB4LHl9IGNvb3JkaW5hdGUgb2YgdG9wLWxlZnQtbW9zdCAxIGJpdCwgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldFRvcExlZnRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IDA7CgkgICAgICAgIHdoaWxlIChiaXRzT2Zmc2V0IDwgYml0cy5sZW5ndGggJiYgYml0c1tiaXRzT2Zmc2V0XSA9PT0gMCkgewoJICAgICAgICAgICAgYml0c09mZnNldCsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChiaXRzT2Zmc2V0ID09PSBiaXRzLmxlbmd0aCkgewoJICAgICAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHkgPSBiaXRzT2Zmc2V0IC8gcm93U2l6ZTsKCSAgICAgICAgdmFyIHggPSAoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDA7CgkgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgYml0Kys7CgkgICAgICAgIH0KCSAgICAgICAgeCArPSBiaXQ7CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW3gsIHldKTsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Qm90dG9tUmlnaHRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IGJpdHMubGVuZ3RoIC0gMTsKCSAgICAgICAgd2hpbGUgKGJpdHNPZmZzZXQgPj0gMCAmJiBiaXRzW2JpdHNPZmZzZXRdID09PSAwKSB7CgkgICAgICAgICAgICBiaXRzT2Zmc2V0LS07CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJpdHNPZmZzZXQgPCAwKSB7CgkgICAgICAgICAgICByZXR1cm4gbnVsbDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IoYml0c09mZnNldCAvIHJvd1NpemUpOwoJICAgICAgICB2YXIgeCA9IE1hdGguZmxvb3IoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDMxOwoJICAgICAgICB3aGlsZSAoKHRoZUJpdHMgPj4+IGJpdCkgPT09IDApIHsKCSAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICB9CgkgICAgICAgIHggKz0gYml0OwoJICAgICAgICByZXR1cm4gSW50MzJBcnJheS5mcm9tKFt4LCB5XSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMud2lkdGg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0SGVpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5oZWlnaHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSByb3cgc2l6ZSBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRSb3dTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yb3dTaXplOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdE1hdHJpeCkpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy53aWR0aCA9PT0gb3RoZXIud2lkdGggJiYgdGhpcy5oZWlnaHQgPT09IG90aGVyLmhlaWdodCAmJiB0aGlzLnJvd1NpemUgPT09IG90aGVyLnJvd1NpemUgJiYKCSAgICAgICAgICAgIEFycmF5c18xLmRlZmF1bHQuZXF1YWxzKHRoaXMuYml0cywgb3RoZXIuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGhhc2ggPSB0aGlzLndpZHRoOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy53aWR0aDsKCSAgICAgICAgaGFzaCA9IDMxICogaGFzaCArIHRoaXMuaGVpZ2h0OwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy5yb3dTaXplOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgQXJyYXlzXzEuZGVmYXVsdC5oYXNoQ29kZSh0aGlzLmJpdHMpOwoJICAgICAgICByZXR1cm4gaGFzaDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIHVzaW5nICJYIiBmb3Igc2V0IGFuZCAiICIgZm9yIHVuc2V0IGJpdHMKCSAgICAgKi8KCSAgICAvKkBPdmVycmlkZSovCgkgICAgLy8gcHVibGljIHRvU3RyaW5nKCk6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdG9TdHJpbmcoIjogIlgsICIgICIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgdG9TdHJpbmcoc2V0U3RyaW5nOiBzdHJpbmcgPSAiWCAiLCB1bnNldFN0cmluZzogc3RyaW5nID0gIiAgIik6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5idWlsZFRvU3RyaW5nKHNldFN0cmluZywgdW5zZXRTdHJpbmcsICJcbiIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEBwYXJhbSBsaW5lU2VwYXJhdG9yIG5ld2xpbmUgY2hhcmFjdGVyIGluIHN0cmluZyByZXByZXNlbnRhdGlvbgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MgYW5kIGxpbmUgc2VwYXJhdG9yCgkgICAgICogQGRlcHJlY2F0ZWQgY2FsbCB7QGxpbmsgI3RvU3RyaW5nKFN0cmluZyxTdHJpbmcpfSBvbmx5LCB3aGljaCB1c2VzIFxuIGxpbmUgc2VwYXJhdG9yIGFsd2F5cwoJICAgICAqLwoJICAgIC8vIEBEZXByZWNhdGVkCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uIChzZXRTdHJpbmcsIHVuc2V0U3RyaW5nLCBsaW5lU2VwYXJhdG9yKSB7CgkgICAgICAgIGlmIChzZXRTdHJpbmcgPT09IHZvaWQgMCkgeyBzZXRTdHJpbmcgPSAnWCAnOyB9CgkgICAgICAgIGlmICh1bnNldFN0cmluZyA9PT0gdm9pZCAwKSB7IHVuc2V0U3RyaW5nID0gJyAgJzsgfQoJICAgICAgICBpZiAobGluZVNlcGFyYXRvciA9PT0gdm9pZCAwKSB7IGxpbmVTZXBhcmF0b3IgPSAnXG4nOyB9CgkgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkVG9TdHJpbmcoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcik7CgkgICAgfTsKCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmJ1aWxkVG9TdHJpbmcgPSBmdW5jdGlvbiAoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcikgewoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgLy8gcmVzdWx0LmFwcGVuZChsaW5lU2VwYXJhdG9yKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IHRoaXMud2lkdGg7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCh0aGlzLmdldCh4LCB5KSA/IHNldFN0cmluZyA6IHVuc2V0U3RyaW5nKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQobGluZVNlcGFyYXRvcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdC50b1N0cmluZygpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0TWF0cml4KHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCB0aGlzLnJvd1NpemUsIHRoaXMuYml0cy5zbGljZSgpKTsKCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXg7Cgl9KCkpOwoJQml0TWF0cml4JDEuZGVmYXVsdCA9IEJpdE1hdHJpeDsKCgl2YXIgTm90Rm91bmRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShOb3RGb3VuZEV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBOb3RGb3VuZEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZChOb3RGb3VuZEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBOb3RGb3VuZEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5nZXROb3RGb3VuZEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IE5vdEZvdW5kRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5raW5kID0gJ05vdEZvdW5kRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gTm90Rm91bmRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCkpOwoJTm90Rm91bmRFeGNlcHRpb24kMS5kZWZhdWx0ID0gTm90Rm91bmRFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYyA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24geyovCgl2YXIgQmluYXJpemVyXzEgPSBCaW5hcml6ZXIkMTsKCXZhciBCaXRBcnJheV8xID0gQml0QXJyYXkkMTsKCXZhciBCaXRNYXRyaXhfMSQ1ID0gQml0TWF0cml4JDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQ2ID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qKgoJICogVGhpcyBCaW5hcml6ZXIgaW1wbGVtZW50YXRpb24gdXNlcyB0aGUgb2xkIFpYaW5nIGdsb2JhbCBoaXN0b2dyYW0gYXBwcm9hY2guIEl0IGlzIHN1aXRhYmxlCgkgKiBmb3IgbG93LWVuZCBtb2JpbGUgZGV2aWNlcyB3aGljaCBkb24ndCBoYXZlIGVub3VnaCBDUFUgb3IgbWVtb3J5IHRvIHVzZSBhIGxvY2FsIHRocmVzaG9sZGluZwoJICogYWxnb3JpdGhtLiBIb3dldmVyLCBiZWNhdXNlIGl0IHBpY2tzIGEgZ2xvYmFsIGJsYWNrIHBvaW50LCBpdCBjYW5ub3QgaGFuZGxlIGRpZmZpY3VsdCBzaGFkb3dzCgkgKiBhbmQgZ3JhZGllbnRzLgoJICoKCSAqIEZhc3RlciBtb2JpbGUgZGV2aWNlcyBhbmQgYWxsIGRlc2t0b3AgYXBwbGljYXRpb25zIHNob3VsZCBwcm9iYWJseSB1c2UgSHlicmlkQmluYXJpemVyIGluc3RlYWQuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGMoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5sdW1pbmFuY2VzID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkVNUFRZOwoJICAgICAgICBfdGhpcy5idWNrZXRzID0gbmV3IEludDMyQXJyYXkoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CVUNLRVRTKTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvLyBBcHBsaWVzIHNpbXBsZSBzaGFycGVuaW5nIHRvIHRoZSByb3cgZGF0YSB0byBpbXByb3ZlIHBlcmZvcm1hbmNlIG9mIHRoZSAxRCBSZWFkZXJzLgoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmdldEJsYWNrUm93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gdW5kZWZpbmVkIHx8IHJvdyA9PT0gbnVsbCB8fCByb3cuZ2V0U2l6ZSgpIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xLmRlZmF1bHQod2lkdGgpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgcm93LmNsZWFyKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5pbml0QXJyYXlzKHdpZHRoKTsKCSAgICAgICAgdmFyIGxvY2FsTHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRSb3coeSwgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgdmFyIGxvY2FsQnVja2V0cyA9IHRoaXMuYnVja2V0czsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICBsb2NhbEJ1Y2tldHNbKGxvY2FsTHVtaW5hbmNlc1t4XSAmIDB4ZmYpID4+IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfU0hJRlRdKys7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJsYWNrUG9pbnQgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuZXN0aW1hdGVCbGFja1BvaW50KGxvY2FsQnVja2V0cyk7CgkgICAgICAgIGlmICh3aWR0aCA8IDMpIHsKCSAgICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZSBmb3IgdmVyeSBzbWFsbCBpbWFnZXMKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgICAgIGlmICgobG9jYWxMdW1pbmFuY2VzW3hdICYgMHhmZikgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIHJvdy5zZXQoeCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGxlZnQgPSBsb2NhbEx1bWluYW5jZXNbMF0gJiAweGZmOwoJICAgICAgICAgICAgdmFyIGNlbnRlciA9IGxvY2FsTHVtaW5hbmNlc1sxXSAmIDB4ZmY7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMTsgeCA8IHdpZHRoIC0gMTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHJpZ2h0ID0gbG9jYWxMdW1pbmFuY2VzW3ggKyAxXSAmIDB4ZmY7CgkgICAgICAgICAgICAgICAgLy8gQSBzaW1wbGUgLTEgNCAtMSBib3ggZmlsdGVyIHdpdGggYSB3ZWlnaHQgb2YgMi4KCSAgICAgICAgICAgICAgICBpZiAoKChjZW50ZXIgKiA0KSAtIGxlZnQgLSByaWdodCkgLyAyIDwgYmxhY2tQb2ludCkgewoJICAgICAgICAgICAgICAgICAgICByb3cuc2V0KHgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBsZWZ0ID0gY2VudGVyOwoJICAgICAgICAgICAgICAgIGNlbnRlciA9IHJpZ2h0OwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByb3c7CgkgICAgfTsKCSAgICAvLyBEb2VzIG5vdCBzaGFycGVuIHRoZSBkYXRhLCBhcyB0aGlzIGNhbGwgaXMgaW50ZW5kZWQgdG8gb25seSBiZSB1c2VkIGJ5IDJEIFJlYWRlcnMuCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIG1hdHJpeCA9IG5ldyBCaXRNYXRyaXhfMSQ1LmRlZmF1bHQod2lkdGgsIGhlaWdodCk7CgkgICAgICAgIC8vIFF1aWNrbHkgY2FsY3VsYXRlcyB0aGUgaGlzdG9ncmFtIGJ5IHNhbXBsaW5nIGZvdXIgcm93cyBmcm9tIHRoZSBpbWFnZS4gVGhpcyBwcm92ZWQgdG8gYmUKCSAgICAgICAgLy8gbW9yZSByb2J1c3Qgb24gdGhlIGJsYWNrYm94IHRlc3RzIHRoYW4gc2FtcGxpbmcgYSBkaWFnb25hbCBhcyB3ZSB1c2VkIHRvIGRvLgoJICAgICAgICB0aGlzLmluaXRBcnJheXMod2lkdGgpOwoJICAgICAgICB2YXIgbG9jYWxCdWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB5ID0gMTsgeSA8IDU7IHkrKykgewoJICAgICAgICAgICAgdmFyIHJvdyA9IE1hdGguZmxvb3IoKGhlaWdodCAqIHkpIC8gNSk7CgkgICAgICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzXzEgPSBzb3VyY2UuZ2V0Um93KHJvdywgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgICAgIHZhciByaWdodCA9IE1hdGguZmxvb3IoKHdpZHRoICogNCkgLyA1KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSBNYXRoLmZsb29yKHdpZHRoIC8gNSk7IHggPCByaWdodDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzXzFbeF0gJiAweGZmOwoJICAgICAgICAgICAgICAgIGxvY2FsQnVja2V0c1twaXhlbCA+PiBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUXSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBibGFja1BvaW50ID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludChsb2NhbEJ1Y2tldHMpOwoJICAgICAgICAvLyBXZSBkZWxheSByZWFkaW5nIHRoZSBlbnRpcmUgaW1hZ2UgbHVtaW5hbmNlIHVudGlsIHRoZSBibGFjayBwb2ludCBlc3RpbWF0aW9uIHN1Y2NlZWRzLgoJICAgICAgICAvLyBBbHRob3VnaCB3ZSBlbmQgdXAgcmVhZGluZyBmb3VyIHJvd3MgdHdpY2UsIGl0IGlzIGNvbnNpc3RlbnQgd2l0aCBvdXIgbW90dG8gb2YKCSAgICAgICAgLy8gImZhaWwgcXVpY2tseSIgd2hpY2ggaXMgbmVjZXNzYXJ5IGZvciBjb250aW51b3VzIHNjYW5uaW5nLgoJICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzID0gc291cmNlLmdldE1hdHJpeCgpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzW29mZnNldCArIHhdICYgMHhmZjsKCSAgICAgICAgICAgICAgICBpZiAocGl4ZWwgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIG1hdHJpeC5zZXQoeCwgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBtYXRyaXg7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLnByb3RvdHlwZS5jcmVhdGVCaW5hcml6ZXIgPSBmdW5jdGlvbiAoc291cmNlKSB7CgkgICAgICAgIHJldHVybiBuZXcgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyKHNvdXJjZSk7CgkgICAgfTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmluaXRBcnJheXMgPSBmdW5jdGlvbiAobHVtaW5hbmNlU2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmICh0aGlzLmx1bWluYW5jZXMubGVuZ3RoIDwgbHVtaW5hbmNlU2l6ZSkgewoJICAgICAgICAgICAgdGhpcy5sdW1pbmFuY2VzID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGx1bWluYW5jZVNpemUpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBidWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQlVDS0VUUzsgeCsrKSB7CgkgICAgICAgICAgICBidWNrZXRzW3hdID0gMDsKCSAgICAgICAgfQoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludCA9IGZ1bmN0aW9uIChidWNrZXRzKSB7CgkgICAgICAgIC8vIEZpbmQgdGhlIHRhbGxlc3QgcGVhayBpbiB0aGUgaGlzdG9ncmFtLgoJICAgICAgICB2YXIgbnVtQnVja2V0cyA9IGJ1Y2tldHMubGVuZ3RoOwoJICAgICAgICB2YXIgbWF4QnVja2V0Q291bnQgPSAwOwoJICAgICAgICB2YXIgZmlyc3RQZWFrID0gMDsKCSAgICAgICAgdmFyIGZpcnN0UGVha1NpemUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgaWYgKGJ1Y2tldHNbeF0gPiBmaXJzdFBlYWtTaXplKSB7CgkgICAgICAgICAgICAgICAgZmlyc3RQZWFrID0geDsKCSAgICAgICAgICAgICAgICBmaXJzdFBlYWtTaXplID0gYnVja2V0c1t4XTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChidWNrZXRzW3hdID4gbWF4QnVja2V0Q291bnQpIHsKCSAgICAgICAgICAgICAgICBtYXhCdWNrZXRDb3VudCA9IGJ1Y2tldHNbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCB0aGUgc2Vjb25kLXRhbGxlc3QgcGVhayB3aGljaCBpcyBzb21ld2hhdCBmYXIgZnJvbSB0aGUgdGFsbGVzdCBwZWFrLgoJICAgICAgICB2YXIgc2Vjb25kUGVhayA9IDA7CgkgICAgICAgIHZhciBzZWNvbmRQZWFrU2NvcmUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgdmFyIGRpc3RhbmNlVG9CaWdnZXN0ID0geCAtIGZpcnN0UGVhazsKCSAgICAgICAgICAgIC8vIEVuY291cmFnZSBtb3JlIGRpc3RhbnQgc2Vjb25kIHBlYWtzIGJ5IG11bHRpcGx5aW5nIGJ5IHNxdWFyZSBvZiBkaXN0YW5jZS4KCSAgICAgICAgICAgIHZhciBzY29yZSA9IGJ1Y2tldHNbeF0gKiBkaXN0YW5jZVRvQmlnZ2VzdCAqIGRpc3RhbmNlVG9CaWdnZXN0OwoJICAgICAgICAgICAgaWYgKHNjb3JlID4gc2Vjb25kUGVha1Njb3JlKSB7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVhayA9IHg7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVha1Njb3JlID0gc2NvcmU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTWFrZSBzdXJlIGZpcnN0UGVhayBjb3JyZXNwb25kcyB0byB0aGUgYmxhY2sgcGVhay4KCSAgICAgICAgaWYgKGZpcnN0UGVhayA+IHNlY29uZFBlYWspIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZmlyc3RQZWFrOwoJICAgICAgICAgICAgZmlyc3RQZWFrID0gc2Vjb25kUGVhazsKCSAgICAgICAgICAgIHNlY29uZFBlYWsgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHRoZXJlIGlzIHRvbyBsaXR0bGUgY29udHJhc3QgaW4gdGhlIGltYWdlIHRvIHBpY2sgYSBtZWFuaW5nZnVsIGJsYWNrIHBvaW50LCB0aHJvdyByYXRoZXIKCSAgICAgICAgLy8gdGhhbiB3YXN0ZSB0aW1lIHRyeWluZyB0byBkZWNvZGUgdGhlIGltYWdlLCBhbmQgcmlzayBmYWxzZSBwb3NpdGl2ZXMuCgkgICAgICAgIGlmIChzZWNvbmRQZWFrIC0gZmlyc3RQZWFrIDw9IG51bUJ1Y2tldHMgLyAxNikgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCBhIHZhbGxleSBiZXR3ZWVuIHRoZW0gdGhhdCBpcyBsb3cgYW5kIGNsb3NlciB0byB0aGUgd2hpdGUgcGVhay4KCSAgICAgICAgdmFyIGJlc3RWYWxsZXkgPSBzZWNvbmRQZWFrIC0gMTsKCSAgICAgICAgdmFyIGJlc3RWYWxsZXlTY29yZSA9IC0xOwoJICAgICAgICBmb3IgKHZhciB4ID0gc2Vjb25kUGVhayAtIDE7IHggPiBmaXJzdFBlYWs7IHgtLSkgewoJICAgICAgICAgICAgdmFyIGZyb21GaXJzdCA9IHggLSBmaXJzdFBlYWs7CgkgICAgICAgICAgICB2YXIgc2NvcmUgPSBmcm9tRmlyc3QgKiBmcm9tRmlyc3QgKiAoc2Vjb25kUGVhayAtIHgpICogKG1heEJ1Y2tldENvdW50IC0gYnVja2V0c1t4XSk7CgkgICAgICAgICAgICBpZiAoc2NvcmUgPiBiZXN0VmFsbGV5U2NvcmUpIHsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5ID0geDsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5U2NvcmUgPSBzY29yZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gYmVzdFZhbGxleSA8PCBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUOwoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CSVRTID0gNTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUID0gOCAtIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX0JVQ0tFVFMgPSAxIDw8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuRU1QVFkgPSBVaW50OENsYW1wZWRBcnJheS5mcm9tKFswXSk7CgkgICAgcmV0dXJuIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCX0oQmluYXJpemVyXzEuZGVmYXVsdCkpOwoJR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyJDEuZGVmYXVsdCA9IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyRiID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEh5YnJpZEJpbmFyaXplciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyXzEgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMTsKCXZhciBCaXRNYXRyaXhfMSQ0ID0gQml0TWF0cml4JDE7CgkvKioKCSAqIFRoaXMgY2xhc3MgaW1wbGVtZW50cyBhIGxvY2FsIHRocmVzaG9sZGluZyBhbGdvcml0aG0sIHdoaWNoIHdoaWxlIHNsb3dlciB0aGFuIHRoZQoJICogR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBpcyBmYWlybHkgZWZmaWNpZW50IGZvciB3aGF0IGl0IGRvZXMuIEl0IGlzIGRlc2lnbmVkIGZvcgoJICogaGlnaCBmcmVxdWVuY3kgaW1hZ2VzIG9mIGJhcmNvZGVzIHdpdGggYmxhY2sgZGF0YSBvbiB3aGl0ZSBiYWNrZ3JvdW5kcy4gRm9yIHRoaXMgYXBwbGljYXRpb24sCgkgKiBpdCBkb2VzIGEgbXVjaCBiZXR0ZXIgam9iIHRoYW4gYSBnbG9iYWwgYmxhY2twb2ludCB3aXRoIHNldmVyZSBzaGFkb3dzIGFuZCBncmFkaWVudHMuCgkgKiBIb3dldmVyIGl0IHRlbmRzIHRvIHByb2R1Y2UgYXJ0aWZhY3RzIG9uIGxvd2VyIGZyZXF1ZW5jeSBpbWFnZXMgYW5kIGlzIHRoZXJlZm9yZSBub3QKCSAqIGEgZ29vZCBnZW5lcmFsIHB1cnBvc2UgYmluYXJpemVyIGZvciB1c2VzIG91dHNpZGUgWlhpbmcuCgkgKgoJICogVGhpcyBjbGFzcyBleHRlbmRzIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplciwgdXNpbmcgdGhlIG9sZGVyIGhpc3RvZ3JhbSBhcHByb2FjaCBmb3IgMUQgcmVhZGVycywKCSAqIGFuZCB0aGUgbmV3ZXIgbG9jYWwgYXBwcm9hY2ggZm9yIDJEIHJlYWRlcnMuIDFEIGRlY29kaW5nIHVzaW5nIGEgcGVyLXJvdyBoaXN0b2dyYW0gaXMgYWxyZWFkeQoJICogaW5oZXJlbnRseSBsb2NhbCwgYW5kIG9ubHkgZmFpbHMgZm9yIGhvcml6b250YWwgZ3JhZGllbnRzLiBXZSBjYW4gcmV2aXNpdCB0aGF0IHByb2JsZW0gbGF0ZXIsCgkgKiBidXQgZm9yIG5vdyBpdCB3YXMgbm90IGEgd2luIHRvIHVzZSBsb2NhbCBibG9ja3MgZm9yIDFELgoJICoKCSAqIFRoaXMgQmluYXJpemVyIGlzIHRoZSBkZWZhdWx0IGZvciB0aGUgdW5pdCB0ZXN0cyBhbmQgdGhlIHJlY29tbWVuZGVkIGNsYXNzIGZvciBsaWJyYXJ5IHVzZXJzLgoJICoKCSAqIEBhdXRob3IgZHN3aXRraW5AZ29vZ2xlLmNvbSAoRGFuaWVsIFN3aXRraW4pCgkgKi8KCXZhciBIeWJyaWRCaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGIoSHlicmlkQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEh5YnJpZEJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tYXRyaXggPSBudWxsOwoJICAgICAgICByZXR1cm4gX3RoaXM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIENhbGN1bGF0ZXMgdGhlIGZpbmFsIEJpdE1hdHJpeCBvbmNlIGZvciBhbGwgcmVxdWVzdHMuIFRoaXMgY291bGQgYmUgY2FsbGVkIG9uY2UgZnJvbSB0aGUKCSAgICAgKiBjb25zdHJ1Y3RvciBpbnN0ZWFkLCBidXQgdGhlcmUgYXJlIHNvbWUgYWR2YW50YWdlcyB0byBkb2luZyBpdCBsYXppbHksIHN1Y2ggYXMgbWFraW5nCgkgICAgICogcHJvZmlsaW5nIGVhc2llciwgYW5kIG5vdCBkb2luZyBoZWF2eSBsaWZ0aW5nIHdoZW4gY2FsbGVycyBkb24ndCBleHBlY3QgaXQuCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLm1hdHJpeCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKHdpZHRoID49IEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiAmJiBoZWlnaHQgPj0gSHlicmlkQmluYXJpemVyLk1JTklNVU1fRElNRU5TSU9OKSB7CgkgICAgICAgICAgICB2YXIgbHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRNYXRyaXgoKTsKCSAgICAgICAgICAgIHZhciBzdWJXaWR0aCA9IHdpZHRoID4+IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKCh3aWR0aCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViV2lkdGgrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciBzdWJIZWlnaHQgPSBoZWlnaHQgPj4gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICBpZiAoKGhlaWdodCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViSGVpZ2h0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgYmxhY2tQb2ludHMgPSBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMobHVtaW5hbmNlcywgc3ViV2lkdGgsIHN1YkhlaWdodCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgICAgICB2YXIgbmV3TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDQuZGVmYXVsdCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgICAgIEh5YnJpZEJpbmFyaXplci5jYWxjdWxhdGVUaHJlc2hvbGRGb3JCbG9jayhsdW1pbmFuY2VzLCBzdWJXaWR0aCwgc3ViSGVpZ2h0LCB3aWR0aCwgaGVpZ2h0LCBibGFja1BvaW50cywgbmV3TWF0cml4KTsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gbmV3TWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgLy8gSWYgdGhlIGltYWdlIGlzIHRvbyBzbWFsbCwgZmFsbCBiYWNrIHRvIHRoZSBnbG9iYWwgaGlzdG9ncmFtIGFwcHJvYWNoLgoJICAgICAgICAgICAgdGhpcy5tYXRyaXggPSBfc3VwZXIucHJvdG90eXBlLmdldEJsYWNrTWF0cml4LmNhbGwodGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuY3JlYXRlQmluYXJpemVyID0gZnVuY3Rpb24gKHNvdXJjZSkgewoJICAgICAgICByZXR1cm4gbmV3IEh5YnJpZEJpbmFyaXplcihzb3VyY2UpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRm9yIGVhY2ggYmxvY2sgaW4gdGhlIGltYWdlLCBjYWxjdWxhdGUgdGhlIGF2ZXJhZ2UgYmxhY2sgcG9pbnQgdXNpbmcgYSA1eDUgZ3JpZAoJICAgICAqIG9mIHRoZSBibG9ja3MgYXJvdW5kIGl0LiBBbHNvIGhhbmRsZXMgdGhlIGNvcm5lciBjYXNlcyAoZnJhY3Rpb25hbCBibG9ja3MgYXJlIGNvbXB1dGVkIGJhc2VkCgkgICAgICogb24gdGhlIGxhc3QgcGl4ZWxzIGluIHRoZSByb3cvY29sdW1uIHdoaWNoIGFyZSBhbHNvIHVzZWQgaW4gdGhlIHByZXZpb3VzIGJsb2NrKS4KCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlVGhyZXNob2xkRm9yQmxvY2sgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBibGFja1BvaW50cywgbWF0cml4KSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBzdWJIZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgdG9wXzEgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHksIDIsIHN1YkhlaWdodCAtIDMpOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBzdWJXaWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHhvZmZzZXQgPSB4IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgICAgIGlmICh4b2Zmc2V0ID4gbWF4WE9mZnNldCkgewoJICAgICAgICAgICAgICAgICAgICB4b2Zmc2V0ID0gbWF4WE9mZnNldDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgdmFyIGxlZnQgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHgsIDIsIHN1YldpZHRoIC0gMyk7CgkgICAgICAgICAgICAgICAgdmFyIHN1bSA9IDA7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeiA9IC0yOyB6IDw9IDI7IHorKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgYmxhY2tSb3cgPSBibGFja1BvaW50c1t0b3BfMSArIHpdOwoJICAgICAgICAgICAgICAgICAgICBzdW0gKz0gYmxhY2tSb3dbbGVmdCAtIDJdICsgYmxhY2tSb3dbbGVmdCAtIDFdICsgYmxhY2tSb3dbbGVmdF0gKyBibGFja1Jvd1tsZWZ0ICsgMV0gKyBibGFja1Jvd1tsZWZ0ICsgMl07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlID0gc3VtIC8gMjU7CgkgICAgICAgICAgICAgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrKGx1bWluYW5jZXMsIHhvZmZzZXQsIHlvZmZzZXQsIGF2ZXJhZ2UsIHdpZHRoLCBtYXRyaXgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FwID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG1pbiAvKmludCovLCBtYXggLyppbnQqLykgewoJICAgICAgICByZXR1cm4gdmFsdWUgPCBtaW4gPyBtaW4gOiB2YWx1ZSA+IG1heCA/IG1heCA6IHZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbGllcyBhIHNpbmdsZSB0aHJlc2hvbGQgdG8gYSBibG9jayBvZiBwaXhlbHMuCgkgICAgICovCgkgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrID0gZnVuY3Rpb24gKGx1bWluYW5jZXMsIHhvZmZzZXQgLyppbnQqLywgeW9mZnNldCAvKmludCovLCB0aHJlc2hvbGQgLyppbnQqLywgc3RyaWRlIC8qaW50Ki8sIG1hdHJpeCkgewoJICAgICAgICBmb3IgKHZhciB5ID0gMCwgb2Zmc2V0ID0geW9mZnNldCAqIHN0cmlkZSArIHhvZmZzZXQ7IHkgPCBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsgeSsrLCBvZmZzZXQgKz0gc3RyaWRlKSB7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB4KyspIHsKCSAgICAgICAgICAgICAgICAvLyBDb21wYXJpc29uIG5lZWRzIHRvIGJlIDw9IHNvIHRoYXQgYmxhY2sgPT0gMCBwaXhlbHMgYXJlIGJsYWNrIGV2ZW4gaWYgdGhlIHRocmVzaG9sZCBpcyAwLgoJICAgICAgICAgICAgICAgIGlmICgobHVtaW5hbmNlc1tvZmZzZXQgKyB4XSAmIDB4RkYpIDw9IHRocmVzaG9sZCkgewoJICAgICAgICAgICAgICAgICAgICBtYXRyaXguc2V0KHhvZmZzZXQgKyB4LCB5b2Zmc2V0ICsgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDYWxjdWxhdGVzIGEgc2luZ2xlIGJsYWNrIHBvaW50IGZvciBlYWNoIGJsb2NrIG9mIHBpeGVscyBhbmQgc2F2ZXMgaXQgYXdheS4KCSAgICAgKiBTZWUgdGhlIGZvbGxvd2luZyB0aHJlYWQgZm9yIGEgZGlzY3Vzc2lvbiBvZiB0aGlzIGFsZ29yaXRobToKCSAgICAgKiAgaHR0cDovL2dyb3Vwcy5nb29nbGUuY29tL2dyb3VwL3p4aW5nL2Jyb3dzZV90aHJlYWQvdGhyZWFkL2QwNmVmYTJjMzVhN2RkYzAKCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOndoaXRlc3BhY2UKCSAgICAgICAgdmFyIGJsYWNrUG9pbnRzID0gbmV3IEFycmF5KHN1YkhlaWdodCk7IC8vIHN1YldpZHRoCgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgc3ViSGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGJsYWNrUG9pbnRzW3ldID0gbmV3IEludDMyQXJyYXkoc3ViV2lkdGgpOwoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHN1YldpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgeG9mZnNldCA9IHggPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICAgICAgaWYgKHhvZmZzZXQgPiBtYXhYT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgICAgIHhvZmZzZXQgPSBtYXhYT2Zmc2V0OwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB2YXIgc3VtID0gMDsKCSAgICAgICAgICAgICAgICB2YXIgbWluID0gMHhGRjsKCSAgICAgICAgICAgICAgICB2YXIgbWF4ID0gMDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciB5eSA9IDAsIG9mZnNldCA9IHlvZmZzZXQgKiB3aWR0aCArIHhvZmZzZXQ7IHl5IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHl5KyssIG9mZnNldCArPSB3aWR0aCkgewoJICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwaXhlbCA9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgIHN1bSArPSBwaXhlbDsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0aWxsIGxvb2tpbmcgZm9yIGdvb2QgY29udHJhc3QKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwaXhlbCA8IG1pbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbiA9IHBpeGVsOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBpeGVsID4gbWF4KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4ID0gcGl4ZWw7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgLy8gc2hvcnQtY2lyY3VpdCBtaW4vbWF4IHRlc3RzIG9uY2UgZHluYW1pYyByYW5nZSBpcyBtZXQKCSAgICAgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA+IEh5YnJpZEJpbmFyaXplci5NSU5fRFlOQU1JQ19SQU5HRSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmluaXNoIHRoZSByZXN0IG9mIHRoZSByb3dzIHF1aWNrbHkKCSAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoeXkrKywgb2Zmc2V0ICs9IHdpZHRoOyB5eSA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB5eSsrLCBvZmZzZXQgKz0gd2lkdGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VtICs9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgLy8gVGhlIGRlZmF1bHQgZXN0aW1hdGUgaXMgdGhlIGF2ZXJhZ2Ugb2YgdGhlIHZhbHVlcyBpbiB0aGUgYmxvY2suCgkgICAgICAgICAgICAgICAgdmFyIGF2ZXJhZ2UgPSBzdW0gPj4gKEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSICogMik7CgkgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA8PSBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gSWYgdmFyaWF0aW9uIHdpdGhpbiB0aGUgYmxvY2sgaXMgbG93LCBhc3N1bWUgdGhpcyBpcyBhIGJsb2NrIHdpdGggb25seSBsaWdodCBvciBvbmx5CgkgICAgICAgICAgICAgICAgICAgIC8vIGRhcmsgcGl4ZWxzLiBJbiB0aGF0IGNhc2Ugd2UgZG8gbm90IHdhbnQgdG8gdXNlIHRoZSBhdmVyYWdlLCBhcyBpdCB3b3VsZCBkaXZpZGUgdGhpcwoJICAgICAgICAgICAgICAgICAgICAvLyBsb3cgY29udHJhc3QgYXJlYSBpbnRvIGJsYWNrIGFuZCB3aGl0ZSBwaXhlbHMsIGVzc2VudGlhbGx5IGNyZWF0aW5nIGRhdGEgb3V0IG9mIG5vaXNlLgoJICAgICAgICAgICAgICAgICAgICAvLwoJICAgICAgICAgICAgICAgICAgICAvLyBUaGUgZGVmYXVsdCBhc3N1bXB0aW9uIGlzIHRoYXQgdGhlIGJsb2NrIGlzIGxpZ2h0L2JhY2tncm91bmQuIFNpbmNlIG5vIGVzdGltYXRlIGZvcgoJICAgICAgICAgICAgICAgICAgICAvLyB0aGUgbGV2ZWwgb2YgZGFyayBwaXhlbHMgZXhpc3RzIGxvY2FsbHksIHVzZSBoYWxmIHRoZSBtaW4gZm9yIHRoZSBibG9jay4KCSAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IG1pbiAvIDI7CgkgICAgICAgICAgICAgICAgICAgIGlmICh5ID4gMCAmJiB4ID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29ycmVjdCB0aGUgIndoaXRlIGJhY2tncm91bmQiIGFzc3VtcHRpb24gZm9yIGJsb2NrcyB0aGF0IGhhdmUgbmVpZ2hib3JzIGJ5IGNvbXBhcmluZwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHBpeGVscyBpbiB0aGlzIGJsb2NrIHRvIHRoZSBwcmV2aW91c2x5IGNhbGN1bGF0ZWQgYmxhY2sgcG9pbnRzLiBUaGlzIGlzIGJhc2VkIG9uCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgZmFjdCB0aGF0IGRhcmsgYmFyY29kZSBzeW1ib2xvZ3kgaXMgYWx3YXlzIHN1cnJvdW5kZWQgYnkgc29tZSBhbW91bnQgb2YgbGlnaHQKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJhY2tncm91bmQgZm9yIHdoaWNoIHJlYXNvbmFibGUgYmxhY2sgcG9pbnQgZXN0aW1hdGVzIHdlcmUgbWFkZS4gVGhlIGJwIGVzdGltYXRlZCBhdAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGJvdW5kYXJpZXMgaXMgdXNlZCBmb3IgdGhlIGludGVyaW9yLgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIChtaW4gPCBicCkgaXMgYXJiaXRyYXJ5IGJ1dCB3b3JrcyBiZXR0ZXIgdGhhbiBvdGhlciBoZXVyaXN0aWNzIHRoYXQgd2VyZSB0cmllZC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50ID0gKGJsYWNrUG9pbnRzW3kgLSAxXVt4XSArICgyICogYmxhY2tQb2ludHNbeV1beCAtIDFdKSArIGJsYWNrUG9pbnRzW3kgLSAxXVt4IC0gMV0pIC8gNDsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtaW4gPCBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IGF2ZXJhZ2VOZWlnaGJvckJsYWNrUG9pbnQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYmxhY2tQb2ludHNbeV1beF0gPSBhdmVyYWdlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBibGFja1BvaW50czsKCSAgICB9OwoJICAgIC8vIFRoaXMgY2xhc3MgdXNlcyA1eDUgYmxvY2tzIHRvIGNvbXB1dGUgbG9jYWwgbHVtaW5hbmNlLCB3aGVyZSBlYWNoIGJsb2NrIGlzIDh4OCBwaXhlbHMuCgkgICAgLy8gU28gdGhpcyBpcyB0aGUgc21hbGxlc3QgZGltZW5zaW9uIGluIGVhY2ggYXhpcyB3ZSBjYW4gYWNjZXB0LgoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSID0gMzsKCSAgICBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSA9IDEgPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7IC8vIC4uLjAxMDAuLi4wMAoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0sgPSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSAtIDE7IC8vIC4uLjAwMTEuLi4xMQoJICAgIEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiA9IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFICogNTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UgPSAyNDsKCSAgICByZXR1cm4gSHlicmlkQmluYXJpemVyOwoJfShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXJfMS5kZWZhdWx0KSk7Cgl2YXIgX2RlZmF1bHQkMiA9IEh5YnJpZEJpbmFyaXplciQxLmRlZmF1bHQgPSBIeWJyaWRCaW5hcml6ZXI7CgoJdmFyIFJHQkx1bWluYW5jZVNvdXJjZSQxID0ge307CgoJdmFyIEludmVydGVkTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgl2YXIgTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMSA9IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJDE7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nIHsqLwoJLyoqCgkgKiBUaGUgcHVycG9zZSBvZiB0aGlzIGNsYXNzIGhpZXJhcmNoeSBpcyB0byBhYnN0cmFjdCBkaWZmZXJlbnQgYml0bWFwIGltcGxlbWVudGF0aW9ucyBhY3Jvc3MKCSAqIHBsYXRmb3JtcyBpbnRvIGEgc3RhbmRhcmQgaW50ZXJmYWNlIGZvciByZXF1ZXN0aW5nIGdyZXlzY2FsZSBsdW1pbmFuY2UgdmFsdWVzLiBUaGUgaW50ZXJmYWNlCgkgKiBvbmx5IHByb3ZpZGVzIGltbXV0YWJsZSBtZXRob2RzOyB0aGVyZWZvcmUgY3JvcCBhbmQgcm90YXRpb24gY3JlYXRlIGNvcGllcy4gVGhpcyBpcyB0byBlbnN1cmUKCSAqIHRoYXQgb25lIFJlYWRlciBkb2VzIG5vdCBtb2RpZnkgdGhlIG9yaWdpbmFsIGx1bWluYW5jZSBzb3VyY2UgYW5kIGxlYXZlIGl0IGluIGFuIHVua25vd24gc3RhdGUKCSAqIGZvciBvdGhlciBSZWFkZXJzIGluIHRoZSBjaGFpbi4KCSAqCgkgKiBAYXV0aG9yIGRzd2l0a2luQGdvb2dsZS5jb20gKERhbmllbCBTd2l0a2luKQoJICovCgl2YXIgTHVtaW5hbmNlU291cmNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEx1bWluYW5jZVNvdXJjZSh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgYml0bWFwLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0V2lkdGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLndpZHRoOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBUaGUgaGVpZ2h0IG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRIZWlnaHQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmhlaWdodDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNyb3BwaW5nLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIGNyb3BwZWQgaW1hZ2UgZGF0YS4gSW1wbGVtZW50YXRpb25zIG1heSBrZWVwIGEgcmVmZXJlbmNlIHRvIHRoZQoJICAgICAqIG9yaWdpbmFsIGRhdGEgcmF0aGVyIHRoYW4gYSBjb3B5LiBPbmx5IGNhbGxhYmxlIGlmIGlzQ3JvcFN1cHBvcnRlZCgpIGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gbGVmdCBUaGUgbGVmdCBjb29yZGluYXRlLCB3aGljaCBtdXN0IGJlIGluIFswLGdldFdpZHRoKCkpCgkgICAgICogQHBhcmFtIHRvcCBUaGUgdG9wIGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0SGVpZ2h0KCkpCgkgICAgICogQHBhcmFtIHdpZHRoIFRoZSB3aWR0aCBvZiB0aGUgcmVjdGFuZ2xlIHRvIGNyb3AuCgkgICAgICogQHBhcmFtIGhlaWdodCBUaGUgaGVpZ2h0IG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcmV0dXJuIEEgY3JvcHBlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCBjcm9wcGluZy4nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNvdW50ZXItY2xvY2t3aXNlIHJvdGF0aW9uLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCByb3RhdGlvbiBieSA5MCBkZWdyZWVzLicpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBhIG5ldyBvYmplY3Qgd2l0aCByb3RhdGVkIGltYWdlIGRhdGEgYnkgNDUgZGVncmVlcyBjb3VudGVyY2xvY2t3aXNlLgoJICAgICAqIE9ubHkgY2FsbGFibGUgaWYge0BsaW5rICNpc1JvdGF0ZVN1cHBvcnRlZCgpfSBpcyB0cnVlLgoJICAgICAqCgkgICAgICogQHJldHVybiBBIHJvdGF0ZWQgdmVyc2lvbiBvZiB0aGlzIG9iamVjdC4KCSAgICAgKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnJvdGF0ZUNvdW50ZXJDbG9ja3dpc2U0NSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnVGhpcyBsdW1pbmFuY2Ugc291cmNlIGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24gYnkgNDUgZGVncmVlcy4nKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcm93ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHRoaXMud2lkdGgpOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQxLmRlZmF1bHQoKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCB0aGlzLmhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgc291cmNlUm93ID0gdGhpcy5nZXRSb3coeSwgcm93KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgdGhpcy53aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGx1bWluYW5jZSA9IHNvdXJjZVJvd1t4XSAmIDB4RkY7CgkgICAgICAgICAgICAgICAgdmFyIGMgPSB2b2lkIDA7CgkgICAgICAgICAgICAgICAgaWYgKGx1bWluYW5jZSA8IDB4NDApIHsKCSAgICAgICAgICAgICAgICAgICAgYyA9ICcjJzsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAobHVtaW5hbmNlIDwgMHg4MCkgewoJICAgICAgICAgICAgICAgICAgICBjID0gJysnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmIChsdW1pbmFuY2UgPCAweEMwKSB7CgkgICAgICAgICAgICAgICAgICAgIGMgPSAnLic7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICBjID0gJyAnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICByZXN1bHQuYXBwZW5kKGMpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCgnXG4nKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0LnRvU3RyaW5nKCk7CgkgICAgfTsKCSAgICByZXR1cm4gTHVtaW5hbmNlU291cmNlOwoJfSgpKTsKCUx1bWluYW5jZVNvdXJjZSQxLmRlZmF1bHQgPSBMdW1pbmFuY2VTb3VyY2U7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnZlcnRlZEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEkMSA9IEx1bWluYW5jZVNvdXJjZSQxOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogQSB3cmFwcGVyIGltcGxlbWVudGF0aW9uIG9mIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHdoaWNoIGludmVydHMgdGhlIGx1bWluYW5jZXMgaXQgcmV0dXJucyAtLSBibGFjayBiZWNvbWVzCgkgKiB3aGl0ZSBhbmQgdmljZSB2ZXJzYSwgYW5kIGVhY2ggdmFsdWUgYmVjb21lcyAoMjU1LXZhbHVlKS4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGEoSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UsIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UoZGVsZWdhdGUpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVsZWdhdGUuZ2V0V2lkdGgoKSwgZGVsZWdhdGUuZ2V0SGVpZ2h0KCkpIHx8IHRoaXM7CgkgICAgICAgIF90aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgdmFyIHNvdXJjZVJvdyA9IHRoaXMuZGVsZWdhdGUuZ2V0Um93KHksIHJvdyk7CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3aWR0aDsgaSsrKSB7CgkgICAgICAgICAgICBzb3VyY2VSb3dbaV0gPSAvKihieXRlKSovICgyNTUgLSAoc291cmNlUm93W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBzb3VyY2VSb3c7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmdldE1hdHJpeCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIG1hdHJpeCA9IHRoaXMuZGVsZWdhdGUuZ2V0TWF0cml4KCk7CgkgICAgICAgIHZhciBsZW5ndGggPSB0aGlzLmdldFdpZHRoKCkgKiB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgaW52ZXJ0ZWRNYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkobGVuZ3RoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgICAgICAgICAgaW52ZXJ0ZWRNYXRyaXhbaV0gPSAvKihieXRlKSovICgyNTUgLSAobWF0cml4W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBpbnZlcnRlZE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUuY3JvcChsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlLmlzUm90YXRlU3VwcG9ydGVkKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG9yaWdpbmFsIGRlbGVnYXRlIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHNpbmNlIGludmVydCB1bmRvZXMgaXRzZWxmCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCkpOwoJICAgIH07CgkgICAgcmV0dXJuIEludmVydGVkTHVtaW5hbmNlU291cmNlOwoJfShMdW1pbmFuY2VTb3VyY2VfMSQxLmRlZmF1bHQpKTsKCUludmVydGVkTHVtaW5hbmNlU291cmNlJDEuZGVmYXVsdCA9IEludmVydGVkTHVtaW5hbmNlU291cmNlOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUkdCTHVtaW5hbmNlU291cmNlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkgLy8gcmVxdWlyZWQgYmVjYXVzZSBvZiBjaXJjdWxhciBkZXBlbmRlbmNpZXMgYmV0d2VlbiBMdW1pbmFuY2VTb3VyY2UgYW5kIEludmVydGVkTHVtaW5hbmNlU291cmNlCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMSA9IEludmVydGVkTHVtaW5hbmNlU291cmNlJDE7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEgPSBMdW1pbmFuY2VTb3VyY2UkMTsKCXZhciBTeXN0ZW1fMSQyID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNiA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBUaGlzIGNsYXNzIGlzIHVzZWQgdG8gaGVscCBkZWNvZGUgaW1hZ2VzIGZyb20gZmlsZXMgd2hpY2ggYXJyaXZlIGFzIFJHQiBkYXRhIGZyb20KCSAqIGFuIEFSR0IgcGl4ZWwgYXJyYXkuIEl0IGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24uCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgQmV0YW1pbm9zCgkgKi8KCXZhciBSR0JMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDkoUkdCTHVtaW5hbmNlU291cmNlLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIFJHQkx1bWluYW5jZVNvdXJjZShsdW1pbmFuY2VzLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgZGF0YVdpZHRoIC8qaW50Ki8sIGRhdGFIZWlnaHQgLyppbnQqLywgbGVmdCAvKmludCovLCB0b3AgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCB3aWR0aCwgaGVpZ2h0KSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5kYXRhV2lkdGggPSBkYXRhV2lkdGg7CgkgICAgICAgIF90aGlzLmRhdGFIZWlnaHQgPSBkYXRhSGVpZ2h0OwoJICAgICAgICBfdGhpcy5sZWZ0ID0gbGVmdDsKCSAgICAgICAgX3RoaXMudG9wID0gdG9wOwoJICAgICAgICBpZiAobHVtaW5hbmNlcy5CWVRFU19QRVJfRUxFTUVOVCA9PT0gNCkgeyAvLyBJbnQzMkFycmF5CgkgICAgICAgICAgICB2YXIgc2l6ZSA9IHdpZHRoICogaGVpZ2h0OwoJICAgICAgICAgICAgdmFyIGx1bWluYW5jZXNVaW50OEFycmF5ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHNpemUpOwoJICAgICAgICAgICAgZm9yICh2YXIgb2Zmc2V0ID0gMDsgb2Zmc2V0IDwgc2l6ZTsgb2Zmc2V0KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgcGl4ZWwgPSBsdW1pbmFuY2VzW29mZnNldF07CgkgICAgICAgICAgICAgICAgdmFyIHIgPSAocGl4ZWwgPj4gMTYpICYgMHhmZjsgLy8gcmVkCgkgICAgICAgICAgICAgICAgdmFyIGcyID0gKHBpeGVsID4+IDcpICYgMHgxZmU7IC8vIDIgKiBncmVlbgoJICAgICAgICAgICAgICAgIHZhciBiID0gcGl4ZWwgJiAweGZmOyAvLyBibHVlCgkgICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGdyZWVuLWZhdm91cmluZyBhdmVyYWdlIGNoZWFwbHkKCSAgICAgICAgICAgICAgICBsdW1pbmFuY2VzVWludDhBcnJheVtvZmZzZXRdID0gLyooYnl0ZSkgKi8gKChyICsgZzIgKyBiKSAvIDQpICYgMHhGRjsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzVWludDhBcnJheTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGRhdGFXaWR0aCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YVdpZHRoID0gd2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gZGF0YUhlaWdodCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YUhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBsZWZ0KSB7CgkgICAgICAgICAgICBfdGhpcy5sZWZ0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSB0b3ApIHsKCSAgICAgICAgICAgIF90aGlzLnRvcCA9IDA7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKF90aGlzLmxlZnQgKyB3aWR0aCA+IF90aGlzLmRhdGFXaWR0aCB8fCBfdGhpcy50b3AgKyBoZWlnaHQgPiBfdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNi5kZWZhdWx0KCdDcm9wIHJlY3RhbmdsZSBkb2VzIG5vdCBmaXQgd2l0aGluIGltYWdlIGRhdGEuJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgaWYgKHkgPCAwIHx8IHkgPj0gdGhpcy5nZXRIZWlnaHQoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCgnUmVxdWVzdGVkIHJvdyBpcyBvdXRzaWRlIHRoZSBpbWFnZTogJyArIHkpOwoJICAgICAgICB9CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gbnVsbCB8fCByb3cgPT09IHVuZGVmaW5lZCB8fCByb3cubGVuZ3RoIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBVaW50OENsYW1wZWRBcnJheSh3aWR0aCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG9mZnNldCA9ICh5ICsgdGhpcy50b3ApICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIFN5c3RlbV8xJDIuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5sdW1pbmFuY2VzLCBvZmZzZXQsIHJvdywgMCwgd2lkdGgpOwoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJHQkx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0TWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBJZiB0aGUgY2FsbGVyIGFza3MgZm9yIHRoZSBlbnRpcmUgdW5kZXJseWluZyBpbWFnZSwgc2F2ZSB0aGUgY29weSBhbmQgZ2l2ZSB0aGVtIHRoZQoJICAgICAgICAvLyBvcmlnaW5hbCBkYXRhLiBUaGUgZG9jcyBzcGVjaWZpY2FsbHkgd2FybiB0aGF0IHJlc3VsdC5sZW5ndGggbXVzdCBiZSBpZ25vcmVkLgoJICAgICAgICBpZiAod2lkdGggPT09IHRoaXMuZGF0YVdpZHRoICYmIGhlaWdodCA9PT0gdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5sdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhcmVhID0gd2lkdGggKiBoZWlnaHQ7CgkgICAgICAgIHZhciBtYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkoYXJlYSk7CgkgICAgICAgIHZhciBpbnB1dE9mZnNldCA9IHRoaXMudG9wICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIC8vIElmIHRoZSB3aWR0aCBtYXRjaGVzIHRoZSBmdWxsIHdpZHRoIG9mIHRoZSB1bmRlcmx5aW5nIGRhdGEsIHBlcmZvcm0gYSBzaW5nbGUgY29weS4KCSAgICAgICAgaWYgKHdpZHRoID09PSB0aGlzLmRhdGFXaWR0aCkgewoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIDAsIGFyZWEpOwoJICAgICAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICAgICAgfQoJICAgICAgICAvLyBPdGhlcndpc2UgY29weSBvbmUgY3JvcHBlZCByb3cgYXQgYSB0aW1lLgoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb3V0cHV0T2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIG91dHB1dE9mZnNldCwgd2lkdGgpOwoJICAgICAgICAgICAgaW5wdXRPZmZzZXQgKz0gdGhpcy5kYXRhV2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSR0JMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmlzQ3JvcFN1cHBvcnRlZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgUkdCTHVtaW5hbmNlU291cmNlKHRoaXMubHVtaW5hbmNlcywgd2lkdGgsIGhlaWdodCwgdGhpcy5kYXRhV2lkdGgsIHRoaXMuZGF0YUhlaWdodCwgdGhpcy5sZWZ0ICsgbGVmdCwgdGhpcy50b3AgKyB0b3ApOwoJICAgIH07CgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMS5kZWZhdWx0KHRoaXMpOwoJICAgIH07CgkgICAgcmV0dXJuIFJHQkx1bWluYW5jZVNvdXJjZTsKCX0oTHVtaW5hbmNlU291cmNlXzEuZGVmYXVsdCkpOwoJdmFyIF9kZWZhdWx0JDEgPSBSR0JMdW1pbmFuY2VTb3VyY2UkMS5kZWZhdWx0ID0gUkdCTHVtaW5hbmNlU291cmNlOwoKCXZhciBRUkNvZGVSZWFkZXIkMSA9IHt9OwoKCXZhciBCYXJjb2RlRm9ybWF0JDEgPSB7fTsKCgkvKgoJICogRGlyZWN0IHBvcnQgdG8gVHlwZVNjcmlwdCBvZiBaWGluZyBieSBBZHJpYW4gVG/ImWPEgwoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmFyY29kZUZvcm1hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogRW51bWVyYXRlcyBiYXJjb2RlIGZvcm1hdHMga25vd24gdG8gdGhpcyBwYWNrYWdlLiBQbGVhc2Uga2VlcCBhbHBoYWJldGl6ZWQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJhcmNvZGVGb3JtYXQ7CgkoZnVuY3Rpb24gKEJhcmNvZGVGb3JtYXQpIHsKCSAgICAvKiogQXp0ZWMgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJBWlRFQyJdID0gMF0gPSAiQVpURUMiOwoJICAgIC8qKiBDT0RBQkFSIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREFCQVIiXSA9IDFdID0gIkNPREFCQVIiOwoJICAgIC8qKiBDb2RlIDM5IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfMzkiXSA9IDJdID0gIkNPREVfMzkiOwoJICAgIC8qKiBDb2RlIDkzIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfOTMiXSA9IDNdID0gIkNPREVfOTMiOwoJICAgIC8qKiBDb2RlIDEyOCAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJDT0RFXzEyOCJdID0gNF0gPSAiQ09ERV8xMjgiOwoJICAgIC8qKiBEYXRhIE1hdHJpeCAyRCBiYXJjb2RlIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkRBVEFfTUFUUklYIl0gPSA1XSA9ICJEQVRBX01BVFJJWCI7CgkgICAgLyoqIEVBTi04IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkVBTl84Il0gPSA2XSA9ICJFQU5fOCI7CgkgICAgLyoqIEVBTi0xMyAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJFQU5fMTMiXSA9IDddID0gIkVBTl8xMyI7CgkgICAgLyoqIElURiAoSW50ZXJsZWF2ZWQgVHdvIG9mIEZpdmUpIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIklURiJdID0gOF0gPSAiSVRGIjsKCSAgICAvKiogTWF4aUNvZGUgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJNQVhJQ09ERSJdID0gOV0gPSAiTUFYSUNPREUiOwoJICAgIC8qKiBQREY0MTcgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUERGXzQxNyJdID0gMTBdID0gIlBERl80MTciOwoJICAgIC8qKiBRUiBDb2RlIDJEIGJhcmNvZGUgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUVJfQ09ERSJdID0gMTFdID0gIlFSX0NPREUiOwoJICAgIC8qKiBSU1MgMTQgKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlJTU18xNCJdID0gMTJdID0gIlJTU18xNCI7CgkgICAgLyoqIFJTUyBFWFBBTkRFRCAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUlNTX0VYUEFOREVEIl0gPSAxM10gPSAiUlNTX0VYUEFOREVEIjsKCSAgICAvKiogVVBDLUEgMUQgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiVVBDX0EiXSA9IDE0XSA9ICJVUENfQSI7CgkgICAgLyoqIFVQQy1FIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FIl0gPSAxNV0gPSAiVVBDX0UiOwoJICAgIC8qKiBVUEMvRUFOIGV4dGVuc2lvbiBmb3JtYXQuIE5vdCBhIHN0YW5kLWFsb25lIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSAxNl0gPSAiVVBDX0VBTl9FWFRFTlNJT04iOwoJfSkoQmFyY29kZUZvcm1hdCB8fCAoQmFyY29kZUZvcm1hdCA9IHt9KSk7CglCYXJjb2RlRm9ybWF0JDEuZGVmYXVsdCA9IEJhcmNvZGVGb3JtYXQ7CgoJdmFyIFJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIFN5c3RlbV8xJDEgPSBTeXN0ZW0kMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBiYXJjb2RlIHdpdGhpbiBhbiBpbWFnZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocHJpdmF0ZSB0ZXh0OiBzdHJpbmcsCgkgICAgLy8gICAgICAgICAgICAgICBVaW50OEFycmF5IHJhd0J5dGVzLAoJICAgIC8vICAgICAgICAgICAgICAgUmVzdWx0UG9jb25zdCByZXN1bHRQb2ludHM6IEludDMyQXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICBCYXJjb2RlRm9ybWF0IGZvcm1hdCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmVzdWx0UG9pbnRzLCBmb3JtYXQsIFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpKQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IodGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgVWludDhBcnJheSByYXdCeXRlcywKCSAgICAvLyAgICAgICAgICAgICAgIFJlc3VsdFBvY29uc3QgcmVzdWx0UG9pbnRzOiBJbnQzMkFycmF5LAoJICAgIC8vICAgICAgICAgICAgICAgQmFyY29kZUZvcm1hdCBmb3JtYXQsCgkgICAgLy8gICAgICAgICAgICAgICBsb25nIHRpbWVzdGFtcCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoLAoJICAgIC8vICAgICAgICByZXN1bHRQb2ludHMsIGZvcm1hdCwgdGltZXN0YW1wKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBSZXN1bHQodGV4dCwgcmF3Qnl0ZXMsIG51bUJpdHMsIHJlc3VsdFBvaW50cywgZm9ybWF0LCB0aW1lc3RhbXApIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPT09IHZvaWQgMCkgeyBudW1CaXRzID0gcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoOyB9CgkgICAgICAgIGlmICh0aW1lc3RhbXAgPT09IHZvaWQgMCkgeyB0aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsgfQoJICAgICAgICB0aGlzLnRleHQgPSB0ZXh0OwoJICAgICAgICB0aGlzLnJhd0J5dGVzID0gcmF3Qnl0ZXM7CgkgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gcmVzdWx0UG9pbnRzOwoJICAgICAgICB0aGlzLmZvcm1hdCA9IGZvcm1hdDsKCSAgICAgICAgdGhpcy50aW1lc3RhbXAgPSB0aW1lc3RhbXA7CgkgICAgICAgIHRoaXMudGV4dCA9IHRleHQ7CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gbnVtQml0cyB8fCBudWxsID09PSBudW1CaXRzKSB7CgkgICAgICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IG51bGwgfHwgcmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludHMgPSByZXN1bHRQb2ludHM7CgkgICAgICAgIHRoaXMuZm9ybWF0ID0gZm9ybWF0OwoJICAgICAgICB0aGlzLnJlc3VsdE1ldGFkYXRhID0gbnVsbDsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gdGltZXN0YW1wIHx8IG51bGwgPT09IHRpbWVzdGFtcCkgewoJICAgICAgICAgICAgdGhpcy50aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMudGltZXN0YW1wID0gdGltZXN0YW1wOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IHRleHQgZW5jb2RlZCBieSB0aGUgYmFyY29kZQoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0VGV4dCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGV4dDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IGJ5dGVzIGVuY29kZWQgYnkgdGhlIGJhcmNvZGUsIGlmIGFwcGxpY2FibGUsIG90aGVyd2lzZSB7QGNvZGUgbnVsbH0KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0TnVtQml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMubnVtQml0czsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcG9pbnRzIHJlbGF0ZWQgdG8gdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGVzZSBhcmUgdHlwaWNhbGx5IHBvaW50cwoJICAgICAqICAgICAgICAgaWRlbnRpZnlpbmcgZmluZGVyIHBhdHRlcm5zIG9yIHRoZSBjb3JuZXJzIG9mIHRoZSBiYXJjb2RlLiBUaGUgZXhhY3QgbWVhbmluZyBpcwoJICAgICAqICAgICAgICAgc3BlY2lmaWMgdG8gdGhlIHR5cGUgb2YgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkLgoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0UmVzdWx0UG9pbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCYXJjb2RlRm9ybWF0fSByZXByZXNlbnRpbmcgdGhlIGZvcm1hdCBvZiB0aGUgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkCgkgICAgICovCgkgICAgUmVzdWx0LnByb3RvdHlwZS5nZXRCYXJjb2RlRm9ybWF0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBNYXB9IG1hcHBpbmcge0BsaW5rIFJlc3VsdE1ldGFkYXRhVHlwZX0ga2V5cyB0byB2YWx1ZXMuIE1heSBiZQoJICAgICAqICAge0Bjb2RlIG51bGx9LiBUaGlzIGNvbnRhaW5zIG9wdGlvbmFsIG1ldGFkYXRhIGFib3V0IHdoYXQgd2FzIGRldGVjdGVkIGFib3V0IHRoZSBiYXJjb2RlLAoJICAgICAqICAgbGlrZSBvcmllbnRhdGlvbi4KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJlc3VsdE1ldGFkYXRhID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRNZXRhZGF0YTsKCSAgICB9OwoJICAgIFJlc3VsdC5wcm90b3R5cGUucHV0TWV0YWRhdGEgPSBmdW5jdGlvbiAodHlwZSwgdmFsdWUpIHsKCSAgICAgICAgaWYgKHRoaXMucmVzdWx0TWV0YWRhdGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0TWV0YWRhdGEgPSBuZXcgTWFwKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YS5zZXQodHlwZSwgdmFsdWUpOwoJICAgIH07CgkgICAgUmVzdWx0LnByb3RvdHlwZS5wdXRBbGxNZXRhZGF0YSA9IGZ1bmN0aW9uIChtZXRhZGF0YSkgewoJICAgICAgICBpZiAobWV0YWRhdGEgIT09IG51bGwpIHsKCSAgICAgICAgICAgIGlmICh0aGlzLnJlc3VsdE1ldGFkYXRhID09PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG1ldGFkYXRhOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG5ldyBNYXAobWV0YWRhdGEpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmFkZFJlc3VsdFBvaW50cyA9IGZ1bmN0aW9uIChuZXdQb2ludHMpIHsKCSAgICAgICAgdmFyIG9sZFBvaW50cyA9IHRoaXMucmVzdWx0UG9pbnRzOwoJICAgICAgICBpZiAob2xkUG9pbnRzID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aGlzLnJlc3VsdFBvaW50cyA9IG5ld1BvaW50czsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChuZXdQb2ludHMgIT09IG51bGwgJiYgbmV3UG9pbnRzLmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgIHZhciBhbGxQb2ludHMgPSBuZXcgQXJyYXkob2xkUG9pbnRzLmxlbmd0aCArIG5ld1BvaW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgU3lzdGVtXzEkMS5kZWZhdWx0LmFycmF5Y29weShvbGRQb2ludHMsIDAsIGFsbFBvaW50cywgMCwgb2xkUG9pbnRzLmxlbmd0aCk7CgkgICAgICAgICAgICBTeXN0ZW1fMSQxLmRlZmF1bHQuYXJyYXljb3B5KG5ld1BvaW50cywgMCwgYWxsUG9pbnRzLCBvbGRQb2ludHMubGVuZ3RoLCBuZXdQb2ludHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gYWxsUG9pbnRzOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFRpbWVzdGFtcCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRleHQ7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0OwoJfSgpKTsKCVJlc3VsdCQxLmRlZmF1bHQgPSBSZXN1bHQ7CgoJdmFyIFJlc3VsdE1ldGFkYXRhVHlwZSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA4IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHRNZXRhZGF0YVR5cGUkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogUmVwcmVzZW50cyBzb21lIHR5cGUgb2YgbWV0YWRhdGEgYWJvdXQgdGhlIHJlc3VsdCBvZiB0aGUgZGVjb2RpbmcgdGhhdCB0aGUgZGVjb2RlcgoJICogd2lzaGVzIHRvIGNvbW11bmljYXRlIGJhY2sgdG8gdGhlIGNhbGxlci4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlOwoJKGZ1bmN0aW9uIChSZXN1bHRNZXRhZGF0YVR5cGUpIHsKCSAgICAvKioKCSAgICAgKiBVbnNwZWNpZmllZCwgYXBwbGljYXRpb24tc3BlY2lmaWMgbWV0YWRhdGEuIE1hcHMgdG8gYW4gdW5zcGVjaWZpZWQge0BsaW5rIE9iamVjdH0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiT1RIRVIiXSA9IDBdID0gIk9USEVSIjsKCSAgICAvKioKCSAgICAgKiBEZW5vdGVzIHRoZSBsaWtlbHkgYXBwcm94aW1hdGUgb3JpZW50YXRpb24gb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGlzIHZhbHVlCgkgICAgICogaXMgZ2l2ZW4gYXMgZGVncmVlcyByb3RhdGVkIGNsb2Nrd2lzZSBmcm9tIHRoZSBub3JtYWwsIHVwcmlnaHQgb3JpZW50YXRpb24uCgkgICAgICogRm9yIGV4YW1wbGUgYSAxRCBiYXJjb2RlIHdoaWNoIHdhcyBmb3VuZCBieSByZWFkaW5nIHRvcC10by1ib3R0b20gd291bGQgYmUKCSAgICAgKiBzYWlkIHRvIGhhdmUgb3JpZW50YXRpb24gIjkwIi4gVGhpcyBrZXkgbWFwcyB0byBhbiB7QGxpbmsgSW50ZWdlcn0gd2hvc2UKCSAgICAgKiB2YWx1ZSBpcyBpbiB0aGUgcmFuZ2UgWzAsMzYwKS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJPUklFTlRBVElPTiJdID0gMV0gPSAiT1JJRU5UQVRJT04iOwoJICAgIC8qKgoJICAgICAqIDxwPjJEIGJhcmNvZGUgZm9ybWF0cyB0eXBpY2FsbHkgZW5jb2RlIHRleHQsIGJ1dCBhbGxvdyBmb3IgYSBzb3J0IG9mICdieXRlIG1vZGUnCgkgICAgICogd2hpY2ggaXMgc29tZXRpbWVzIHVzZWQgdG8gZW5jb2RlIGJpbmFyeSBkYXRhLiBXaGlsZSB7QGxpbmsgUmVzdWx0fSBtYWtlcyBhdmFpbGFibGUKCSAgICAgKiB0aGUgY29tcGxldGUgcmF3IGJ5dGVzIGluIHRoZSBiYXJjb2RlIGZvciB0aGVzZSBmb3JtYXRzLCBpdCBkb2VzIG5vdCBvZmZlciB0aGUgYnl0ZXMKCSAgICAgKiBmcm9tIHRoZSBieXRlIHNlZ21lbnRzIGFsb25lLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWFwcyB0byBhIHtAbGluayBqYXZhLnV0aWwuTGlzdH0gb2YgYnl0ZSBhcnJheXMgY29ycmVzcG9uZGluZyB0byB0aGUKCSAgICAgKiByYXcgYnl0ZXMgaW4gdGhlIGJ5dGUgc2VnbWVudHMgaW4gdGhlIGJhcmNvZGUsIGluIG9yZGVyLjwvcD4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJCWVRFX1NFR01FTlRTIl0gPSAyXSA9ICJCWVRFX1NFR01FTlRTIjsKCSAgICAvKioKCSAgICAgKiBFcnJvciBjb3JyZWN0aW9uIGxldmVsIHVzZWQsIGlmIGFwcGxpY2FibGUuIFRoZSB2YWx1ZSB0eXBlIGRlcGVuZHMgb24gdGhlCgkgICAgICogZm9ybWF0LCBidXQgaXMgdHlwaWNhbGx5IGEgU3RyaW5nLgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiXSA9IDNdID0gIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHBlcmlvZGljYWxzLCBpbmRpY2F0ZXMgdGhlIGlzc3VlIG51bWJlciBhcyBhbiB7QGxpbmsgSW50ZWdlcn0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiSVNTVUVfTlVNQkVSIl0gPSA0XSA9ICJJU1NVRV9OVU1CRVIiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHByb2R1Y3RzLCBpbmRpY2F0ZXMgdGhlIHN1Z2dlc3RlZCByZXRhaWwgcHJpY2UgaW4gdGhlIGJhcmNvZGUgYXMgYQoJICAgICAqIGZvcm1hdHRlZCB7QGxpbmsgU3RyaW5nfS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJTVUdHRVNURURfUFJJQ0UiXSA9IDVdID0gIlNVR0dFU1RFRF9QUklDRSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBwb3NzaWJsZSBjb3VudHJ5IG9mIG1hbnVmYWN0dXJlIGFzIGEge0BsaW5rIFN0cmluZ30gZGVub3RpbmcgdGhlCgkgICAgICogSVNPIGNvdW50cnkgY29kZS4gU29tZSBtYXAgdG8gbXVsdGlwbGUgcG9zc2libGUgY291bnRyaWVzLCBsaWtlICJVUy9DQSIuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUE9TU0lCTEVfQ09VTlRSWSJdID0gNl0gPSAiUE9TU0lCTEVfQ09VTlRSWSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBleHRlbnNpb24gdGV4dAoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSA3XSA9ICJVUENfRUFOX0VYVEVOU0lPTiI7CgkgICAgLyoqCgkgICAgICogUERGNDE3LXNwZWNpZmljIG1ldGFkYXRhCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUERGNDE3X0VYVFJBX01FVEFEQVRBIl0gPSA4XSA9ICJQREY0MTdfRVhUUkFfTUVUQURBVEEiOwoJICAgIC8qKgoJICAgICAqIElmIHRoZSBjb2RlIGZvcm1hdCBzdXBwb3J0cyBzdHJ1Y3R1cmVkIGFwcGVuZCBhbmQgdGhlIGN1cnJlbnQgc2Nhbm5lZCBjb2RlIGlzIHBhcnQgb2Ygb25lIHRoZW4gdGhlCgkgICAgICogc2VxdWVuY2UgbnVtYmVyIGlzIGdpdmVuIHdpdGggaXQuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UiXSA9IDldID0gIlNUUlVDVFVSRURfQVBQRU5EX1NFUVVFTkNFIjsKCSAgICAvKioKCSAgICAgKiBJZiB0aGUgY29kZSBmb3JtYXQgc3VwcG9ydHMgc3RydWN0dXJlZCBhcHBlbmQgYW5kIHRoZSBjdXJyZW50IHNjYW5uZWQgY29kZSBpcyBwYXJ0IG9mIG9uZSB0aGVuIHRoZQoJICAgICAqIHBhcml0eSBpcyBnaXZlbiB3aXRoIGl0LgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSJdID0gMTBdID0gIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSI7Cgl9KShSZXN1bHRNZXRhZGF0YVR5cGUgfHwgKFJlc3VsdE1ldGFkYXRhVHlwZSA9IHt9KSk7CglSZXN1bHRNZXRhZGF0YVR5cGUkMS5kZWZhdWx0ID0gUmVzdWx0TWV0YWRhdGFUeXBlOwoKCXZhciBEZWNvZGVyJDEgPSB7fTsKCgl2YXIgQ2hlY2tzdW1FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkOCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShDaGVja3N1bUV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNCA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBDaGVja3N1bUV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkOChDaGVja3N1bUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBDaGVja3N1bUV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5nZXRDaGVja3N1bUluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IENoZWNrc3VtRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5raW5kID0gJ0NoZWNrc3VtRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQ2hlY2tzdW1FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCkpOwoJQ2hlY2tzdW1FeGNlcHRpb24kMS5kZWZhdWx0ID0gQ2hlY2tzdW1FeGNlcHRpb247CgoJdmFyIEdlbmVyaWNHRiQxID0ge307CgoJdmFyIEdlbmVyaWNHRlBvbHkkMSA9IHt9OwoKCXZhciBBYnN0cmFjdEdlbmVyaWNHRiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBYnN0cmFjdEdlbmVyaWNHRiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGNvbnRhaW5zIHV0aWxpdHkgbWV0aG9kcyBmb3IgcGVyZm9ybWluZyBtYXRoZW1hdGljYWwgb3BlcmF0aW9ucyBvdmVyCgkgKiB0aGUgR2Fsb2lzIEZpZWxkcy4gT3BlcmF0aW9ucyB1c2UgYSBnaXZlbiBwcmltaXRpdmUgcG9seW5vbWlhbCBpbiBjYWxjdWxhdGlvbnMuPC9wPgoJICoKCSAqIDxwPlRocm91Z2hvdXQgdGhpcyBwYWNrYWdlLCBlbGVtZW50cyBvZiB0aGUgR0YgYXJlIHJlcHJlc2VudGVkIGFzIGFuIHtAY29kZSBpbnR9CgkgKiBmb3IgY29udmVuaWVuY2UgYW5kIHNwZWVkIChidXQgYXQgdGhlIGNvc3Qgb2YgbWVtb3J5KS4KCSAqIDwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBEYXZpZCBPbGl2aWVyCgkgKi8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBYnN0cmFjdEdlbmVyaWNHRigpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiAyIHRvIHRoZSBwb3dlciBvZiBhIGluIEdGKHNpemUpCgkgICAgICovCgkgICAgQWJzdHJhY3RHZW5lcmljR0YucHJvdG90eXBlLmV4cCA9IGZ1bmN0aW9uIChhKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmV4cFRhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBiYXNlIDIgbG9nIG9mIGEgaW4gR0Yoc2l6ZSkKCSAgICAgKi8KCSAgICBBYnN0cmFjdEdlbmVyaWNHRi5wcm90b3R5cGUubG9nID0gZnVuY3Rpb24gKGEgLyppbnQqLykgewoJICAgICAgICBpZiAoYSA9PT0gMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0aGlzLmxvZ1RhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSW1wbGVtZW50cyBib3RoIGFkZGl0aW9uIGFuZCBzdWJ0cmFjdGlvbiAtLSB0aGV5IGFyZSB0aGUgc2FtZSBpbiBHRihzaXplKS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gc3VtL2RpZmZlcmVuY2Ugb2YgYSBhbmQgYgoJICAgICAqLwoJICAgIEFic3RyYWN0R2VuZXJpY0dGLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIGEgXiBiOwoJICAgIH07CgkgICAgcmV0dXJuIEFic3RyYWN0R2VuZXJpY0dGOwoJfSgpKTsKCUFic3RyYWN0R2VuZXJpY0dGJDEuZGVmYXVsdCA9IEFic3RyYWN0R2VuZXJpY0dGOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGUG9seSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5yZWVkc29sb21vbiB7Ki8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRl8xJDEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIFN5c3RlbV8xID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNCA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgcG9seW5vbWlhbCB3aG9zZSBjb2VmZmljaWVudHMgYXJlIGVsZW1lbnRzIG9mIGEgR0YuCgkgKiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBhcmUgaW1tdXRhYmxlLjwvcD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdlbmVyaWNHRlBvbHkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGZpZWxkIHRoZSB7QGxpbmsgR2VuZXJpY0dGfSBpbnN0YW5jZSByZXByZXNlbnRpbmcgdGhlIGZpZWxkIHRvIHVzZQoJICAgICAqIHRvIHBlcmZvcm0gY29tcHV0YXRpb25zCgkgICAgICogQHBhcmFtIGNvZWZmaWNpZW50cyBjb2VmZmljaWVudHMgYXMgaW50cyByZXByZXNlbnRpbmcgZWxlbWVudHMgb2YgR0Yoc2l6ZSksIGFycmFuZ2VkCgkgICAgICogZnJvbSBtb3N0IHNpZ25pZmljYW50IChoaWdoZXN0LXBvd2VyIHRlcm0pIGNvZWZmaWNpZW50IHRvIGxlYXN0IHNpZ25pZmljYW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYXJndW1lbnQgaXMgbnVsbCBvciBlbXB0eSwKCSAgICAgKiBvciBpZiBsZWFkaW5nIGNvZWZmaWNpZW50IGlzIDAgYW5kIHRoaXMgaXMgbm90IGEKCSAgICAgKiBjb25zdGFudCBwb2x5bm9taWFsICh0aGF0IGlzLCBpdCBpcyBub3QgdGhlIG1vbm9taWFsICIwIikKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBHZW5lcmljR0ZQb2x5KGZpZWxkLCBjb2VmZmljaWVudHMpIHsKCSAgICAgICAgaWYgKGNvZWZmaWNpZW50cy5sZW5ndGggPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmZpZWxkID0gZmllbGQ7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHNMZW5ndGggPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICBpZiAoY29lZmZpY2llbnRzTGVuZ3RoID4gMSAmJiBjb2VmZmljaWVudHNbMF0gPT09IDApIHsKCSAgICAgICAgICAgIC8vIExlYWRpbmcgdGVybSBtdXN0IGJlIG5vbi16ZXJvIGZvciBhbnl0aGluZyBleGNlcHQgdGhlIGNvbnN0YW50IHBvbHlub21pYWwgIjAiCgkgICAgICAgICAgICB2YXIgZmlyc3ROb25aZXJvID0gMTsKCSAgICAgICAgICAgIHdoaWxlIChmaXJzdE5vblplcm8gPCBjb2VmZmljaWVudHNMZW5ndGggJiYgY29lZmZpY2llbnRzW2ZpcnN0Tm9uWmVyb10gPT09IDApIHsKCSAgICAgICAgICAgICAgICBmaXJzdE5vblplcm8rKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChmaXJzdE5vblplcm8gPT09IGNvZWZmaWNpZW50c0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRoaXMuY29lZmZpY2llbnRzID0gSW50MzJBcnJheS5mcm9tKFswXSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICB0aGlzLmNvZWZmaWNpZW50cyA9IG5ldyBJbnQzMkFycmF5KGNvZWZmaWNpZW50c0xlbmd0aCAtIGZpcnN0Tm9uWmVybyk7CgkgICAgICAgICAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkoY29lZmZpY2llbnRzLCBmaXJzdE5vblplcm8sIHRoaXMuY29lZmZpY2llbnRzLCAwLCB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdGhpcy5jb2VmZmljaWVudHMgPSBjb2VmZmljaWVudHM7CgkgICAgICAgIH0KCSAgICB9CgkgICAgR2VuZXJpY0dGUG9seS5wcm90b3R5cGUuZ2V0Q29lZmZpY2llbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGRlZ3JlZSBvZiB0aGlzIHBvbHlub21pYWwKCSAgICAgKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5nZXREZWdyZWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGlzIHBvbHlub21pYWwgaXMgdGhlIG1vbm9taWFsICIwIgoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmlzWmVybyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29lZmZpY2llbnRzWzBdID09PSAwOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBjb2VmZmljaWVudCBvZiB4XmRlZ3JlZSB0ZXJtIGluIHRoaXMgcG9seW5vbWlhbAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmdldENvZWZmaWNpZW50ID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50c1t0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxIC0gZGVncmVlXTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gZXZhbHVhdGlvbiBvZiB0aGlzIHBvbHlub21pYWwgYXQgYSBnaXZlbiBwb2ludAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmV2YWx1YXRlQXQgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHJldHVybiB0aGUgeF4wIGNvZWZmaWNpZW50CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgY29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciByZXN1bHQ7CgkgICAgICAgIGlmIChhID09PSAxKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHRoZSBzdW0gb2YgdGhlIGNvZWZmaWNpZW50cwoJICAgICAgICAgICAgcmVzdWx0ID0gMDsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7IGkgIT09IGxlbmd0aF8xOyBpKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgY29lZmZpY2llbnQgPSBjb2VmZmljaWVudHNbaV07CgkgICAgICAgICAgICAgICAgcmVzdWx0ID0gQWJzdHJhY3RHZW5lcmljR0ZfMSQxLmRlZmF1bHQuYWRkT3JTdWJ0cmFjdChyZXN1bHQsIGNvZWZmaWNpZW50KTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgICAgIH0KCSAgICAgICAgcmVzdWx0ID0gY29lZmZpY2llbnRzWzBdOwoJICAgICAgICB2YXIgc2l6ZSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICByZXN1bHQgPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KGZpZWxkLm11bHRpcGx5KGEsIHJlc3VsdCksIGNvZWZmaWNpZW50c1tpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRoaXMuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiBvdGhlcjsKCSAgICAgICAgfQoJICAgICAgICBpZiAob3RoZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzbWFsbGVyQ29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBsYXJnZXJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIGlmIChzbWFsbGVyQ29lZmZpY2llbnRzLmxlbmd0aCA+IGxhcmdlckNvZWZmaWNpZW50cy5sZW5ndGgpIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gc21hbGxlckNvZWZmaWNpZW50czsKCSAgICAgICAgICAgIHNtYWxsZXJDb2VmZmljaWVudHMgPSBsYXJnZXJDb2VmZmljaWVudHM7CgkgICAgICAgICAgICBsYXJnZXJDb2VmZmljaWVudHMgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzdW1EaWZmID0gbmV3IEludDMyQXJyYXkobGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCk7CgkgICAgICAgIHZhciBsZW5ndGhEaWZmID0gbGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCAtIHNtYWxsZXJDb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICAvLyBDb3B5IGhpZ2gtb3JkZXIgdGVybXMgb25seSBmb3VuZCBpbiBoaWdoZXItZGVncmVlIHBvbHlub21pYWwncyBjb2VmZmljaWVudHMKCSAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkobGFyZ2VyQ29lZmZpY2llbnRzLCAwLCBzdW1EaWZmLCAwLCBsZW5ndGhEaWZmKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGxlbmd0aERpZmY7IGkgPCBsYXJnZXJDb2VmZmljaWVudHMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHN1bURpZmZbaV0gPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KHNtYWxsZXJDb2VmZmljaWVudHNbaSAtIGxlbmd0aERpZmZdLCBsYXJnZXJDb2VmZmljaWVudHNbaV0pOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seSh0aGlzLmZpZWxkLCBzdW1EaWZmKTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5ID0gZnVuY3Rpb24gKG90aGVyKSB7CgkgICAgICAgIGlmICghdGhpcy5maWVsZC5lcXVhbHMob3RoZXIuZmllbGQpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdHZW5lcmljR0ZQb2x5cyBkbyBub3QgaGF2ZSBzYW1lIEdlbmVyaWNHRiBmaWVsZCcpOwoJICAgICAgICB9CgkgICAgICAgIGlmICh0aGlzLmlzWmVybygpIHx8IG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGFDb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIGFMZW5ndGggPSBhQ29lZmZpY2llbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBiTGVuZ3RoID0gYkNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoYUxlbmd0aCArIGJMZW5ndGggLSAxKTsKCSAgICAgICAgdmFyIGZpZWxkID0gdGhpcy5maWVsZDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhTGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBhQ29lZmYgPSBhQ29lZmZpY2llbnRzW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBiTGVuZ3RoOyBqKyspIHsKCSAgICAgICAgICAgICAgICBwcm9kdWN0W2kgKyBqXSA9IEFic3RyYWN0R2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocHJvZHVjdFtpICsgal0sIGZpZWxkLm11bHRpcGx5KGFDb2VmZiwgYkNvZWZmaWNpZW50c1tqXSkpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5tdWx0aXBseVNjYWxhciA9IGZ1bmN0aW9uIChzY2FsYXIgLyppbnQqLykgewoJICAgICAgICBpZiAoc2NhbGFyID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHNjYWxhciA9PT0gMSkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIHByb2R1Y3RbaV0gPSBmaWVsZC5tdWx0aXBseShjb2VmZmljaWVudHNbaV0sIHNjYWxhcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmljR0ZQb2x5KGZpZWxkLCBwcm9kdWN0KTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5QnlNb25vbWlhbCA9IGZ1bmN0aW9uIChkZWdyZWUgLyppbnQqLywgY29lZmZpY2llbnQgLyppbnQqLykgewoJICAgICAgICBpZiAoZGVncmVlIDwgMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChjb2VmZmljaWVudCA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuZ2V0WmVybygpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIHNpemUgPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICB2YXIgcHJvZHVjdCA9IG5ldyBJbnQzMkFycmF5KHNpemUgKyBkZWdyZWUpOwoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpemU7IGkrKykgewoJICAgICAgICAgICAgcHJvZHVjdFtpXSA9IGZpZWxkLm11bHRpcGx5KGNvZWZmaWNpZW50c1tpXSwgY29lZmZpY2llbnQpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5kaXZpZGUgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdEaXZpZGUgYnkgMCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBxdW90aWVudCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHJlbWFpbmRlciA9IHRoaXM7CgkgICAgICAgIHZhciBkZW5vbWluYXRvckxlYWRpbmdUZXJtID0gb3RoZXIuZ2V0Q29lZmZpY2llbnQob3RoZXIuZ2V0RGVncmVlKCkpOwoJICAgICAgICB2YXIgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0gPSBmaWVsZC5pbnZlcnNlKGRlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICB3aGlsZSAocmVtYWluZGVyLmdldERlZ3JlZSgpID49IG90aGVyLmdldERlZ3JlZSgpICYmICFyZW1haW5kZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHZhciBkZWdyZWVEaWZmZXJlbmNlID0gcmVtYWluZGVyLmdldERlZ3JlZSgpIC0gb3RoZXIuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICB2YXIgc2NhbGUgPSBmaWVsZC5tdWx0aXBseShyZW1haW5kZXIuZ2V0Q29lZmZpY2llbnQocmVtYWluZGVyLmdldERlZ3JlZSgpKSwgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICAgICAgdmFyIHRlcm0gPSBvdGhlci5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZmVyZW5jZSwgc2NhbGUpOwoJICAgICAgICAgICAgdmFyIGl0ZXJhdGlvblF1b3RpZW50ID0gZmllbGQuYnVpbGRNb25vbWlhbChkZWdyZWVEaWZmZXJlbmNlLCBzY2FsZSk7CgkgICAgICAgICAgICBxdW90aWVudCA9IHF1b3RpZW50LmFkZE9yU3VidHJhY3QoaXRlcmF0aW9uUXVvdGllbnQpOwoJICAgICAgICAgICAgcmVtYWluZGVyID0gcmVtYWluZGVyLmFkZE9yU3VidHJhY3QodGVybSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFtxdW90aWVudCwgcmVtYWluZGVyXTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJlc3VsdCA9ICcnOwoJICAgICAgICBmb3IgKHZhciBkZWdyZWUgPSB0aGlzLmdldERlZ3JlZSgpOyBkZWdyZWUgPj0gMDsgZGVncmVlLS0pIHsKCSAgICAgICAgICAgIHZhciBjb2VmZmljaWVudCA9IHRoaXMuZ2V0Q29lZmZpY2llbnQoZGVncmVlKTsKCSAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCA8IDApIHsKCSAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgLSAnOwoJICAgICAgICAgICAgICAgICAgICBjb2VmZmljaWVudCA9IC1jb2VmZmljaWVudDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgKyAnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgPT09IDAgfHwgY29lZmZpY2llbnQgIT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGFscGhhUG93ZXIgPSB0aGlzLmZpZWxkLmxvZyhjb2VmZmljaWVudCk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChhbHBoYVBvd2VyID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJzEnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFscGhhUG93ZXIgPT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnYSc7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJ2FeJzsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSBhbHBoYVBvd2VyOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGRlZ3JlZSA9PT0gMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICd4JzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAneF4nOwoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IGRlZ3JlZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIEdlbmVyaWNHRlBvbHk7Cgl9KCkpOwoJR2VuZXJpY0dGUG9seSQxLmRlZmF1bHQgPSBHZW5lcmljR0ZQb2x5OwoKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkMyA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcml0aG1ldGljRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ3KEFyaXRobWV0aWNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJpdGhtZXRpY0V4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcml0aG1ldGljRXhjZXB0aW9uLmtpbmQgPSAnQXJpdGhtZXRpY0V4Y2VwdGlvbic7CgkgICAgcmV0dXJuIEFyaXRobWV0aWNFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCkpOwoJQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLmRlZmF1bHQgPSBBcml0aG1ldGljRXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uLnJlZWRzb2xvbW9uIHsqLwoJdmFyIEdlbmVyaWNHRlBvbHlfMSQxID0gR2VuZXJpY0dGUG9seSQxOwoJdmFyIEFic3RyYWN0R2VuZXJpY0dGXzEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIEludGVnZXJfMSQxID0gSW50ZWdlciQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDMgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uXzEgPSBBcml0aG1ldGljRXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgY29udGFpbnMgdXRpbGl0eSBtZXRob2RzIGZvciBwZXJmb3JtaW5nIG1hdGhlbWF0aWNhbCBvcGVyYXRpb25zIG92ZXIKCSAqIHRoZSBHYWxvaXMgRmllbGRzLiBPcGVyYXRpb25zIHVzZSBhIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsIGluIGNhbGN1bGF0aW9ucy48L3A+CgkgKgoJICogPHA+VGhyb3VnaG91dCB0aGlzIHBhY2thZ2UsIGVsZW1lbnRzIG9mIHRoZSBHRiBhcmUgcmVwcmVzZW50ZWQgYXMgYW4ge0Bjb2RlIGludH0KCSAqIGZvciBjb252ZW5pZW5jZSBhbmQgc3BlZWQgKGJ1dCBhdCB0aGUgY29zdCBvZiBtZW1vcnkpLgoJICogPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKiBAYXV0aG9yIERhdmlkIE9saXZpZXIKCSAqLwoJdmFyIEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkNihHZW5lcmljR0YsIF9zdXBlcik7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlIGEgcmVwcmVzZW50YXRpb24gb2YgR0Yoc2l6ZSkgdXNpbmcgdGhlIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsLgoJICAgICAqCgkgICAgICogQHBhcmFtIHByaW1pdGl2ZSBpcnJlZHVjaWJsZSBwb2x5bm9taWFsIHdob3NlIGNvZWZmaWNpZW50cyBhcmUgcmVwcmVzZW50ZWQgYnkKCSAgICAgKiAgdGhlIGJpdHMgb2YgYW4gaW50LCB3aGVyZSB0aGUgbGVhc3Qtc2lnbmlmaWNhbnQgYml0IHJlcHJlc2VudHMgdGhlIGNvbnN0YW50CgkgICAgICogIGNvZWZmaWNpZW50CgkgICAgICogQHBhcmFtIHNpemUgdGhlIHNpemUgb2YgdGhlIGZpZWxkCgkgICAgICogQHBhcmFtIGIgdGhlIGZhY3RvciBiIGluIHRoZSBnZW5lcmF0b3IgcG9seW5vbWlhbCBjYW4gYmUgMC0gb3IgMS1iYXNlZAoJICAgICAqICAoZyh4KSA9ICh4K2FeYikoeCthXihiKzEpKS4uLih4K2FeKGIrMnQtMSkpKS4KCSAgICAgKiAgSW4gbW9zdCBjYXNlcyBpdCBzaG91bGQgYmUgMSwgYnV0IGZvciBRUiBjb2RlIGl0IGlzIDAuCgkgICAgICovCgkgICAgZnVuY3Rpb24gR2VuZXJpY0dGKHByaW1pdGl2ZSAvKmludCovLCBzaXplIC8qaW50Ki8sIGdlbmVyYXRvckJhc2UgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5wcmltaXRpdmUgPSBwcmltaXRpdmU7CgkgICAgICAgIF90aGlzLnNpemUgPSBzaXplOwoJICAgICAgICBfdGhpcy5nZW5lcmF0b3JCYXNlID0gZ2VuZXJhdG9yQmFzZTsKCSAgICAgICAgdmFyIGV4cFRhYmxlID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciB4ID0gMTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIGV4cFRhYmxlW2ldID0geDsKCSAgICAgICAgICAgIHggKj0gMjsgLy8gd2UncmUgYXNzdW1pbmcgdGhlIGdlbmVyYXRvciBhbHBoYSBpcyAyCgkgICAgICAgICAgICBpZiAoeCA+PSBzaXplKSB7CgkgICAgICAgICAgICAgICAgeCBePSBwcmltaXRpdmU7CgkgICAgICAgICAgICAgICAgeCAmPSBzaXplIC0gMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBfdGhpcy5leHBUYWJsZSA9IGV4cFRhYmxlOwoJICAgICAgICB2YXIgbG9nVGFibGUgPSBuZXcgSW50MzJBcnJheShzaXplKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplIC0gMTsgaSsrKSB7CgkgICAgICAgICAgICBsb2dUYWJsZVtleHBUYWJsZVtpXV0gPSBpOwoJICAgICAgICB9CgkgICAgICAgIF90aGlzLmxvZ1RhYmxlID0gbG9nVGFibGU7CgkgICAgICAgIC8vIGxvZ1RhYmxlWzBdID09IDAgYnV0IHRoaXMgc2hvdWxkIG5ldmVyIGJlIHVzZWQKCSAgICAgICAgX3RoaXMuemVybyA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzBdKSk7CgkgICAgICAgIF90aGlzLm9uZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzFdKSk7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRaZXJvID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRPbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm9uZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdGhlIG1vbm9taWFsIHJlcHJlc2VudGluZyBjb2VmZmljaWVudCAqIHheZGVncmVlCgkgICAgICovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5idWlsZE1vbm9taWFsID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovLCBjb2VmZmljaWVudCAvKmludCovKSB7CgkgICAgICAgIGlmIChkZWdyZWUgPCAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkMy5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvZWZmaWNpZW50ID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheShkZWdyZWUgKyAxKTsKCSAgICAgICAgY29lZmZpY2llbnRzWzBdID0gY29lZmZpY2llbnQ7CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seV8xJDEuZGVmYXVsdCh0aGlzLCBjb2VmZmljaWVudHMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBtdWx0aXBsaWNhdGl2ZSBpbnZlcnNlIG9mIGEKCSAgICAgKi8KCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmludmVyc2UgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQXJpdGhtZXRpY0V4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5leHBUYWJsZVt0aGlzLnNpemUgLSB0aGlzLmxvZ1RhYmxlW2FdIC0gMV07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHByb2R1Y3Qgb2YgYSBhbmQgYiBpbiBHRihzaXplKQoJICAgICAqLwoJICAgIEdlbmVyaWNHRi5wcm90b3R5cGUubXVsdGlwbHkgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGEgPT09IDAgfHwgYiA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDA7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZXhwVGFibGVbKHRoaXMubG9nVGFibGVbYV0gKyB0aGlzLmxvZ1RhYmxlW2JdKSAlICh0aGlzLnNpemUgLSAxKV07CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldFNpemUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnNpemU7CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldEdlbmVyYXRvckJhc2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRvckJhc2U7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICgnR0YoMHgnICsgSW50ZWdlcl8xJDEuZGVmYXVsdC50b0hleFN0cmluZyh0aGlzLnByaW1pdGl2ZSkgKyAnLCcgKyB0aGlzLnNpemUgKyAnKScpOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICByZXR1cm4gbyA9PT0gdGhpczsKCSAgICB9OwoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEyID0gbmV3IEdlbmVyaWNHRigweDEwNjksIDQwOTYsIDEpOyAvLyB4XjEyICsgeF42ICsgeF41ICsgeF4zICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEwID0gbmV3IEdlbmVyaWNHRigweDQwOSwgMTAyNCwgMSk7IC8vIHheMTAgKyB4XjMgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfNiA9IG5ldyBHZW5lcmljR0YoMHg0MywgNjQsIDEpOyAvLyB4XjYgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19QQVJBTSA9IG5ldyBHZW5lcmljR0YoMHgxMywgMTYsIDEpOyAvLyB4XjQgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5RUl9DT0RFX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTFkLCAyNTYsIDApOyAvLyB4XjggKyB4XjQgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkRBVEFfTUFUUklYX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTJkLCAyNTYsIDEpOyAvLyB4XjggKyB4XjUgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfOCA9IEdlbmVyaWNHRi5EQVRBX01BVFJJWF9GSUVMRF8yNTY7CgkgICAgR2VuZXJpY0dGLk1BWElDT0RFX0ZJRUxEXzY0ID0gR2VuZXJpY0dGLkFaVEVDX0RBVEFfNjsKCSAgICByZXR1cm4gR2VuZXJpY0dGOwoJfShBYnN0cmFjdEdlbmVyaWNHRl8xLmRlZmF1bHQpKTsKCUdlbmVyaWNHRiQxLmRlZmF1bHQgPSBHZW5lcmljR0Y7CgoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciQxID0ge307CgoJdmFyIFJlZWRTb2xvbW9uRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDUgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVlZFNvbG9tb25FeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDIgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgUmVlZFNvbG9tb25FeGNlcHRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDUoUmVlZFNvbG9tb25FeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gUmVlZFNvbG9tb25FeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgUmVlZFNvbG9tb25FeGNlcHRpb24ua2luZCA9ICdSZWVkU29sb21vbkV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQyLmRlZmF1bHQpKTsKCVJlZWRTb2xvbW9uRXhjZXB0aW9uJDEuZGVmYXVsdCA9IFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkNCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDEgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSWxsZWdhbFN0YXRlRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ0KElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSWxsZWdhbFN0YXRlRXhjZXB0aW9uLmtpbmQgPSAnSWxsZWdhbFN0YXRlRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gSWxsZWdhbFN0YXRlRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQxLmRlZmF1bHQpKTsKCUlsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBJbGxlZ2FsU3RhdGVFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWVkU29sb21vbkRlY29kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24ucmVlZHNvbG9tb24geyovCgl2YXIgR2VuZXJpY0dGXzEkMSA9IEdlbmVyaWNHRiQxOwoJdmFyIEdlbmVyaWNHRlBvbHlfMSA9IEdlbmVyaWNHRlBvbHkkMTsKCXZhciBSZWVkU29sb21vbkV4Y2VwdGlvbl8xID0gUmVlZFNvbG9tb25FeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMSA9IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5JbXBsZW1lbnRzIFJlZWQtU29sb21vbiBkZWNvZGluZywgYXMgdGhlIG5hbWUgaW1wbGllcy48L3A+CgkgKgoJICogPHA+VGhlIGFsZ29yaXRobSB3aWxsIG5vdCBiZSBleHBsYWluZWQgaGVyZSwgYnV0IHRoZSBmb2xsb3dpbmcgcmVmZXJlbmNlcyB3ZXJlIGhlbHBmdWwKCSAqIGluIGNyZWF0aW5nIHRoaXMgaW1wbGVtZW50YXRpb246PC9wPgoJICoKCSAqIDx1bD4KCSAqIDxsaT5CcnVjZSBNYWdncy4KCSAqIDxhIGhyZWY9Imh0dHA6Ly93d3cuY3MuY211LmVkdS9hZnMvY3MuY211LmVkdS9wcm9qZWN0L3BzY2ljby1ndXliL3JlYWx3b3JsZC93d3cvcnNfZGVjb2RlLnBzIj4KCSAqICJEZWNvZGluZyBSZWVkLVNvbG9tb24gQ29kZXMiPC9hPiAoc2VlIGRpc2N1c3Npb24gb2YgRm9ybmV5J3MgRm9ybXVsYSk8L2xpPgoJICogPGxpPkouSS4gSGFsbC4gPGEgaHJlZj0id3d3Lm10aC5tc3UuZWR1L35qaGFsbC9jbGFzc2VzL2NvZGVub3Rlcy9HUlMucGRmIj4KCSAqICJDaGFwdGVyIDUuIEdlbmVyYWxpemVkIFJlZWQtU29sb21vbiBDb2RlcyI8L2E+CgkgKiAoc2VlIGRpc2N1c3Npb24gb2YgRXVjbGlkZWFuIGFsZ29yaXRobSk8L2xpPgoJICogPC91bD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgV2lsbGlhbSBSdWNrbGlkZ2UKCSAqIEBhdXRob3Igc2FuZm9yZHNxdWlyZXMKCSAqLwoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBSZWVkU29sb21vbkRlY29kZXIoZmllbGQpIHsKCSAgICAgICAgdGhpcy5maWVsZCA9IGZpZWxkOwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5EZWNvZGVzIGdpdmVuIHNldCBvZiByZWNlaXZlZCBjb2Rld29yZHMsIHdoaWNoIGluY2x1ZGUgYm90aCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uCgkgICAgICogY29kZXdvcmRzLiBSZWFsbHksIHRoaXMgbWVhbnMgaXQgdXNlcyBSZWVkLVNvbG9tb24gdG8gZGV0ZWN0IGFuZCBjb3JyZWN0IGVycm9ycywgaW4tcGxhY2UsCgkgICAgICogaW4gdGhlIGlucHV0LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByZWNlaXZlZCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcwoJICAgICAqIEBwYXJhbSB0d29TIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBhdmFpbGFibGUKCSAgICAgKiBAdGhyb3dzIFJlZWRTb2xvbW9uRXhjZXB0aW9uIGlmIGRlY29kaW5nIGZhaWxzIGZvciBhbnkgcmVhc29uCgkgICAgICovCgkgICAgUmVlZFNvbG9tb25EZWNvZGVyLnByb3RvdHlwZS5kZWNvZGUgPSBmdW5jdGlvbiAocmVjZWl2ZWQsIHR3b1MgLyppbnQqLykgewoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgcG9seSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgcmVjZWl2ZWQpOwoJICAgICAgICB2YXIgc3luZHJvbWVDb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheSh0d29TKTsKCSAgICAgICAgdmFyIG5vRXJyb3IgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHR3b1M7IGkrKykgewoJICAgICAgICAgICAgdmFyIGV2YWxSZXN1bHQgPSBwb2x5LmV2YWx1YXRlQXQoZmllbGQuZXhwKGkgKyBmaWVsZC5nZXRHZW5lcmF0b3JCYXNlKCkpKTsKCSAgICAgICAgICAgIHN5bmRyb21lQ29lZmZpY2llbnRzW3N5bmRyb21lQ29lZmZpY2llbnRzLmxlbmd0aCAtIDEgLSBpXSA9IGV2YWxSZXN1bHQ7CgkgICAgICAgICAgICBpZiAoZXZhbFJlc3VsdCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIG5vRXJyb3IgPSBmYWxzZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAobm9FcnJvcikgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzeW5kcm9tZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgc3luZHJvbWVDb2VmZmljaWVudHMpOwoJICAgICAgICB2YXIgc2lnbWFPbWVnYSA9IHRoaXMucnVuRXVjbGlkZWFuQWxnb3JpdGhtKGZpZWxkLmJ1aWxkTW9ub21pYWwodHdvUywgMSksIHN5bmRyb21lLCB0d29TKTsKCSAgICAgICAgdmFyIHNpZ21hID0gc2lnbWFPbWVnYVswXTsKCSAgICAgICAgdmFyIG9tZWdhID0gc2lnbWFPbWVnYVsxXTsKCSAgICAgICAgdmFyIGVycm9yTG9jYXRpb25zID0gdGhpcy5maW5kRXJyb3JMb2NhdGlvbnMoc2lnbWEpOwoJICAgICAgICB2YXIgZXJyb3JNYWduaXR1ZGVzID0gdGhpcy5maW5kRXJyb3JNYWduaXR1ZGVzKG9tZWdhLCBlcnJvckxvY2F0aW9ucyk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZXJyb3JMb2NhdGlvbnMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IHJlY2VpdmVkLmxlbmd0aCAtIDEgLSBmaWVsZC5sb2coZXJyb3JMb2NhdGlvbnNbaV0pOwoJICAgICAgICAgICAgaWYgKHBvc2l0aW9uIDwgMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ0JhZCBlcnJvciBsb2NhdGlvbicpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVjZWl2ZWRbcG9zaXRpb25dID0gR2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocmVjZWl2ZWRbcG9zaXRpb25dLCBlcnJvck1hZ25pdHVkZXNbaV0pOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZWVkU29sb21vbkRlY29kZXIucHJvdG90eXBlLnJ1bkV1Y2xpZGVhbkFsZ29yaXRobSA9IGZ1bmN0aW9uIChhLCBiLCBSIC8qaW50Ki8pIHsKCSAgICAgICAgLy8gQXNzdW1lIGEncyBkZWdyZWUgaXMgPj0gYidzCgkgICAgICAgIGlmIChhLmdldERlZ3JlZSgpIDwgYi5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgdmFyIHRlbXAgPSBhOwoJICAgICAgICAgICAgYSA9IGI7CgkgICAgICAgICAgICBiID0gdGVtcDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgckxhc3QgPSBhOwoJICAgICAgICB2YXIgciA9IGI7CgkgICAgICAgIHZhciB0TGFzdCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHQgPSBmaWVsZC5nZXRPbmUoKTsKCSAgICAgICAgLy8gUnVuIEV1Y2xpZGVhbiBhbGdvcml0aG0gdW50aWwgcidzIGRlZ3JlZSBpcyBsZXNzIHRoYW4gUi8yCgkgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IChSIC8gMiB8IDApKSB7CgkgICAgICAgICAgICB2YXIgckxhc3RMYXN0ID0gckxhc3Q7CgkgICAgICAgICAgICB2YXIgdExhc3RMYXN0ID0gdExhc3Q7CgkgICAgICAgICAgICByTGFzdCA9IHI7CgkgICAgICAgICAgICB0TGFzdCA9IHQ7CgkgICAgICAgICAgICAvLyBEaXZpZGUgckxhc3RMYXN0IGJ5IHJMYXN0LCB3aXRoIHF1b3RpZW50IGluIHEgYW5kIHJlbWFpbmRlciBpbiByCgkgICAgICAgICAgICBpZiAockxhc3QuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgICAgICAvLyBPb3BzLCBFdWNsaWRlYW4gYWxnb3JpdGhtIGFscmVhZHkgdGVybWluYXRlZD8KCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUmVlZFNvbG9tb25FeGNlcHRpb25fMS5kZWZhdWx0KCdyX3tpLTF9IHdhcyB6ZXJvJyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByID0gckxhc3RMYXN0OwoJICAgICAgICAgICAgdmFyIHEgPSBmaWVsZC5nZXRaZXJvKCk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3JMZWFkaW5nVGVybSA9IHJMYXN0LmdldENvZWZmaWNpZW50KHJMYXN0LmdldERlZ3JlZSgpKTsKCSAgICAgICAgICAgIHZhciBkbHRJbnZlcnNlID0gZmllbGQuaW52ZXJzZShkZW5vbWluYXRvckxlYWRpbmdUZXJtKTsKCSAgICAgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IHJMYXN0LmdldERlZ3JlZSgpICYmICFyLmlzWmVybygpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlZ3JlZURpZmYgPSByLmdldERlZ3JlZSgpIC0gckxhc3QuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gZmllbGQubXVsdGlwbHkoci5nZXRDb2VmZmljaWVudChyLmdldERlZ3JlZSgpKSwgZGx0SW52ZXJzZSk7CgkgICAgICAgICAgICAgICAgcSA9IHEuYWRkT3JTdWJ0cmFjdChmaWVsZC5idWlsZE1vbm9taWFsKGRlZ3JlZURpZmYsIHNjYWxlKSk7CgkgICAgICAgICAgICAgICAgciA9IHIuYWRkT3JTdWJ0cmFjdChyTGFzdC5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZiwgc2NhbGUpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHQgPSBxLm11bHRpcGx5KHRMYXN0KS5hZGRPclN1YnRyYWN0KHRMYXN0TGFzdCk7CgkgICAgICAgICAgICBpZiAoci5nZXREZWdyZWUoKSA+PSByTGFzdC5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMS5kZWZhdWx0KCdEaXZpc2lvbiBhbGdvcml0aG0gZmFpbGVkIHRvIHJlZHVjZSBwb2x5bm9taWFsPycpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBzaWdtYVRpbGRlQXRaZXJvID0gdC5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgaWYgKHNpZ21hVGlsZGVBdFplcm8gPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ3NpZ21hVGlsZGUoMCkgd2FzIHplcm8nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaW52ZXJzZSA9IGZpZWxkLmludmVyc2Uoc2lnbWFUaWxkZUF0WmVybyk7CgkgICAgICAgIHZhciBzaWdtYSA9IHQubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHZhciBvbWVnYSA9IHIubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHJldHVybiBbc2lnbWEsIG9tZWdhXTsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTG9jYXRpb25zID0gZnVuY3Rpb24gKGVycm9yTG9jYXRvcikgewoJICAgICAgICAvLyBUaGlzIGlzIGEgZGlyZWN0IGFwcGxpY2F0aW9uIG9mIENoaWVuJ3Mgc2VhcmNoCgkgICAgICAgIHZhciBudW1FcnJvcnMgPSBlcnJvckxvY2F0b3IuZ2V0RGVncmVlKCk7CgkgICAgICAgIGlmIChudW1FcnJvcnMgPT09IDEpIHsgLy8gc2hvcnRjdXQKCSAgICAgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2Vycm9yTG9jYXRvci5nZXRDb2VmZmljaWVudCgxKV0pOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgSW50MzJBcnJheShudW1FcnJvcnMpOwoJICAgICAgICB2YXIgZSA9IDA7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgZmllbGQuZ2V0U2l6ZSgpICYmIGUgPCBudW1FcnJvcnM7IGkrKykgewoJICAgICAgICAgICAgaWYgKGVycm9yTG9jYXRvci5ldmFsdWF0ZUF0KGkpID09PSAwKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0W2VdID0gZmllbGQuaW52ZXJzZShpKTsKCSAgICAgICAgICAgICAgICBlKys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGUgIT09IG51bUVycm9ycykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IFJlZWRTb2xvbW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnRXJyb3IgbG9jYXRvciBkZWdyZWUgZG9lcyBub3QgbWF0Y2ggbnVtYmVyIG9mIHJvb3RzJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTWFnbml0dWRlcyA9IGZ1bmN0aW9uIChlcnJvckV2YWx1YXRvciwgZXJyb3JMb2NhdGlvbnMpIHsKCSAgICAgICAgLy8gVGhpcyBpcyBkaXJlY3RseSBhcHBseWluZyBGb3JuZXkncyBGb3JtdWxhCgkgICAgICAgIHZhciBzID0gZXJyb3JMb2NhdGlvbnMubGVuZ3RoOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IEludDMyQXJyYXkocyk7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgczsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeGlJbnZlcnNlID0gZmllbGQuaW52ZXJzZShlcnJvckxvY2F0aW9uc1tpXSk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSAxOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaSAhPT0gaikgewoJICAgICAgICAgICAgICAgICAgICAvLyBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLAoJICAgICAgICAgICAgICAgICAgICAvLyAgICBHZW5lcmljR0YuYWRkT3JTdWJ0cmFjdCgxLCBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKSkpCgkgICAgICAgICAgICAgICAgICAgIC8vIEFib3ZlIHNob3VsZCB3b3JrIGJ1dCBmYWlscyBvbiBzb21lIEFwcGxlIGFuZCBMaW51eCBKREtzIGR1ZSB0byBhIEhvdHNwb3QgYnVnLgoJICAgICAgICAgICAgICAgICAgICAvLyBCZWxvdyBpcyBhIGZ1bm55LWxvb2tpbmcgd29ya2Fyb3VuZCBmcm9tIFN0ZXZlbiBQYXJrZXMKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm0gPSBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm1QbHVzMSA9ICh0ZXJtICYgMHgxKSA9PT0gMCA/IHRlcm0gfCAxIDogdGVybSAmIH4xOwoJICAgICAgICAgICAgICAgICAgICBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLCB0ZXJtUGx1czEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KGVycm9yRXZhbHVhdG9yLmV2YWx1YXRlQXQoeGlJbnZlcnNlKSwgZmllbGQuaW52ZXJzZShkZW5vbWluYXRvcikpOwoJICAgICAgICAgICAgaWYgKGZpZWxkLmdldEdlbmVyYXRvckJhc2UoKSAhPT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KHJlc3VsdFtpXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRGVjb2RlcjsKCX0oKSk7CglSZWVkU29sb21vbkRlY29kZXIkMS5kZWZhdWx0ID0gUmVlZFNvbG9tb25EZWNvZGVyOwoKCXZhciBCaXRNYXRyaXhQYXJzZXIkMSA9IHt9OwoKCXZhciBWZXJzaW9uJDEgPSB7fTsKCgl2YXIgRm9ybWF0SW5mb3JtYXRpb24kMSA9IHt9OwoKCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IHt9OwoKCXZhciBBcmd1bWVudEV4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyQzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkMyhBcmd1bWVudEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBcmd1bWVudEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0FyZ3VtZW50RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQXJndW1lbnRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xLmRlZmF1bHQpKTsKCUFyZ3VtZW50RXhjZXB0aW9uJDEuZGVmYXVsdCA9IEFyZ3VtZW50RXhjZXB0aW9uOwoKCShmdW5jdGlvbiAoZXhwb3J0cykgewoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CglleHBvcnRzLkVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gdm9pZCAwOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbl8xID0gQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJdmFyIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzOwoJKGZ1bmN0aW9uIChFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcykgewoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJMIl0gPSAwXSA9ICJMIjsKCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1tFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1siTSJdID0gMV0gPSAiTSI7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbIlEiXSA9IDJdID0gIlEiOwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJIIl0gPSAzXSA9ICJIIjsKCX0pKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyB8fCAoZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyA9IHt9KSk7CgkvKioKCSAqIDxwPlNlZSBJU08gMTgwMDQ6MjAwNiwgNi41LjEuIFRoaXMgZW51bSBlbmNhcHN1bGF0ZXMgdGhlIGZvdXIgZXJyb3IgY29ycmVjdGlvbiBsZXZlbHMKCSAqIGRlZmluZWQgYnkgdGhlIFFSIGNvZGUgc3RhbmRhcmQuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFcnJvckNvcnJlY3Rpb25MZXZlbCh2YWx1ZSwgc3RyaW5nVmFsdWUsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2V0KGJpdHMsIHRoaXMpOwoJICAgICAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5nZXRCaXRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZnJvbVN0cmluZyA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIHN3aXRjaCAocykgewoJICAgICAgICAgICAgY2FzZSAnTCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5MOwoJICAgICAgICAgICAgY2FzZSAnTSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5NOwoJICAgICAgICAgICAgY2FzZSAnUSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5ROwoJICAgICAgICAgICAgY2FzZSAnSCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5IOwoJICAgICAgICAgICAgZGVmYXVsdDogdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9uXzEuZGVmYXVsdChzICsgJ25vdCBhdmFpbGFibGUnKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG90aGVyID0gbzsKCSAgICAgICAgcmV0dXJuIHRoaXMudmFsdWUgPT09IG90aGVyLnZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgaW50IGNvbnRhaW5pbmcgdGhlIHR3byBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSdzIGVycm9yIGNvcnJlY3Rpb24gbGV2ZWwKCSAgICAgKiBAcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsIHJlcHJlc2VudGluZyB0aGUgZW5jb2RlZCBlcnJvciBjb3JyZWN0aW9uIGxldmVsCgkgICAgICovCgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZm9yQml0cyA9IGZ1bmN0aW9uIChiaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGJpdHMgPCAwIHx8IGJpdHMgPj0gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuZ2V0KGJpdHMpOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX1ZBTFVFID0gbmV3IE1hcCgpOwoJICAgIC8qKiBMID0gfjclIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5MID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkwsICdMJywgMHgwMSk7CgkgICAgLyoqIE0gPSB+MTUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5NID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLk0sICdNJywgMHgwMCk7CgkgICAgLyoqIFEgPSB+MjUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5RID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLlEsICdRJywgMHgwMyk7CgkgICAgLyoqIEggPSB+MzAlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5IID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkgsICdIJywgMHgwMik7CgkgICAgcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IEVycm9yQ29ycmVjdGlvbkxldmVsOwoKCX0oRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9ybWF0SW5mb3JtYXRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbF8xID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWw7Cgl2YXIgSW50ZWdlcl8xID0gSW50ZWdlciQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBRUiBDb2RlJ3MgZm9ybWF0IGluZm9ybWF0aW9uLCBpbmNsdWRpbmcgdGhlIGRhdGEgbWFzayB1c2VkIGFuZAoJICogZXJyb3IgY29ycmVjdGlvbiBsZXZlbC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBzZWUgRGF0YU1hc2sKCSAqIEBzZWUgRXJyb3JDb3JyZWN0aW9uTGV2ZWwKCSAqLwoJdmFyIEZvcm1hdEluZm9ybWF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZvcm1hdEluZm9ybWF0aW9uKGZvcm1hdEluZm8gLyppbnQqLykgewoJICAgICAgICAvLyBCaXRzIDMsNAoJICAgICAgICB0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWxfMS5kZWZhdWx0LmZvckJpdHMoKGZvcm1hdEluZm8gPj4gMykgJiAweDAzKTsKCSAgICAgICAgLy8gQm90dG9tIDMgYml0cwoJICAgICAgICB0aGlzLmRhdGFNYXNrID0gLyooYnl0ZSkgKi8gKGZvcm1hdEluZm8gJiAweDA3KTsKCSAgICB9CgkgICAgRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyA9IGZ1bmN0aW9uIChhIC8qaW50Ki8sIGIgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gSW50ZWdlcl8xLmRlZmF1bHQuYml0Q291bnQoYSBeIGIpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIG1hc2tlZEZvcm1hdEluZm8xIGZvcm1hdCBpbmZvIGluZGljYXRvciwgd2l0aCBtYXNrIHN0aWxsIGFwcGxpZWQKCSAgICAgKiBAcGFyYW0gbWFza2VkRm9ybWF0SW5mbzIgc2Vjb25kIGNvcHkgb2Ygc2FtZSBpbmZvOyBib3RoIGFyZSBjaGVja2VkIGF0IHRoZSBzYW1lIHRpbWUKCSAgICAgKiAgdG8gZXN0YWJsaXNoIGJlc3QgbWF0Y2gKCSAgICAgKiBAcmV0dXJuIGluZm9ybWF0aW9uIGFib3V0IHRoZSBmb3JtYXQgaXQgc3BlY2lmaWVzLCBvciB7QGNvZGUgbnVsbH0KCSAgICAgKiAgaWYgZG9lc24ndCBzZWVtIHRvIG1hdGNoIGFueSBrbm93biBwYXR0ZXJuCgkgICAgICovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24uZGVjb2RlRm9ybWF0SW5mb3JtYXRpb24gPSBmdW5jdGlvbiAobWFza2VkRm9ybWF0SW5mbzEgLyppbnQqLywgbWFza2VkRm9ybWF0SW5mbzIgLyppbnQqLykgewoJICAgICAgICB2YXIgZm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uLmRvRGVjb2RlRm9ybWF0SW5mb3JtYXRpb24obWFza2VkRm9ybWF0SW5mbzEsIG1hc2tlZEZvcm1hdEluZm8yKTsKCSAgICAgICAgaWYgKGZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiBmb3JtYXRJbmZvOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNob3VsZCByZXR1cm4gbnVsbCwgYnV0LCBzb21lIFFSIGNvZGVzIGFwcGFyZW50bHkKCSAgICAgICAgLy8gZG8gbm90IG1hc2sgdGhpcyBpbmZvLiBUcnkgYWdhaW4gYnkgYWN0dWFsbHkgbWFza2luZyB0aGUgcGF0dGVybgoJICAgICAgICAvLyBmaXJzdAoJICAgICAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb24uZG9EZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihtYXNrZWRGb3JtYXRJbmZvMSBeIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX01BU0tfUVIsIG1hc2tlZEZvcm1hdEluZm8yIF4gRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUik7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5kb0RlY29kZUZvcm1hdEluZm9ybWF0aW9uID0gZnVuY3Rpb24gKG1hc2tlZEZvcm1hdEluZm8xIC8qaW50Ki8sIG1hc2tlZEZvcm1hdEluZm8yIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGVfMSwgX2E7CgkgICAgICAgIC8vIEZpbmQgdGhlIGludCBpbiBGT1JNQVRfSU5GT19ERUNPREVfTE9PS1VQIHdpdGggZmV3ZXN0IGJpdHMgZGlmZmVyaW5nCgkgICAgICAgIHZhciBiZXN0RGlmZmVyZW5jZSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgICAgICB2YXIgYmVzdEZvcm1hdEluZm8gPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyQ2KEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVApLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlY29kZUluZm8gPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0SW5mbyA9IGRlY29kZUluZm9bMF07CgkgICAgICAgICAgICAgICAgaWYgKHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8xIHx8IHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8yKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGFuIGV4YWN0IG1hdGNoCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRm9ybWF0SW5mb3JtYXRpb24oZGVjb2RlSW5mb1sxXSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBiaXRzRGlmZmVyZW5jZSA9IEZvcm1hdEluZm9ybWF0aW9uLm51bUJpdHNEaWZmZXJpbmcobWFza2VkRm9ybWF0SW5mbzEsIHRhcmdldEluZm8pOwoJICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgIGJlc3RGb3JtYXRJbmZvID0gZGVjb2RlSW5mb1sxXTsKCSAgICAgICAgICAgICAgICAgICAgYmVzdERpZmZlcmVuY2UgPSBiaXRzRGlmZmVyZW5jZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKG1hc2tlZEZvcm1hdEluZm8xICE9PSBtYXNrZWRGb3JtYXRJbmZvMikgewoJICAgICAgICAgICAgICAgICAgICAvLyBhbHNvIHRyeSB0aGUgb3RoZXIgb3B0aW9uCgkgICAgICAgICAgICAgICAgICAgIGJpdHNEaWZmZXJlbmNlID0gRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyhtYXNrZWRGb3JtYXRJbmZvMiwgdGFyZ2V0SW5mbyk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0Rm9ybWF0SW5mbyA9IGRlY29kZUluZm9bMV07CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2MgJiYgIV9jLmRvbmUgJiYgKF9hID0gX2IucmV0dXJuKSkgX2EuY2FsbChfYik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSGFtbWluZyBkaXN0YW5jZSBvZiB0aGUgMzIgbWFza2VkIGNvZGVzIGlzIDcsIGJ5IGNvbnN0cnVjdGlvbiwgc28gPD0gMyBiaXRzCgkgICAgICAgIC8vIGRpZmZlcmluZyBtZWFucyB3ZSBmb3VuZCBhIG1hdGNoCgkgICAgICAgIGlmIChiZXN0RGlmZmVyZW5jZSA8PSAzKSB7CgkgICAgICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEluZm9ybWF0aW9uKGJlc3RGb3JtYXRJbmZvKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICB9OwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5nZXRFcnJvckNvcnJlY3Rpb25MZXZlbCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJyb3JDb3JyZWN0aW9uTGV2ZWw7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5wcm90b3R5cGUuZ2V0RGF0YU1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFNYXNrOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsLmdldEJpdHMoKSA8PCAzKSB8IHRoaXMuZGF0YU1hc2s7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24ucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBGb3JtYXRJbmZvcm1hdGlvbikpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvckNvcnJlY3Rpb25MZXZlbCA9PT0gb3RoZXIuZXJyb3JDb3JyZWN0aW9uTGV2ZWwgJiYKCSAgICAgICAgICAgIHRoaXMuZGF0YU1hc2sgPT09IG90aGVyLmRhdGFNYXNrOwoJICAgIH07CgkgICAgRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUiA9IDB4NTQxMjsKCSAgICAvKioKCSAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYsIEFubmV4IEMsIFRhYmxlIEMuMQoJICAgICAqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVAgPSBbCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1NDEyLCAweDAwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1MTI1LCAweDAxXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1RTdDLCAweDAyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1QjRCLCAweDAzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0NUY5LCAweDA0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0MENFLCAweDA1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0Rjk3LCAweDA2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0QUEwLCAweDA3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3N0M0LCAweDA4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3MkYzLCAweDA5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3REFBLCAweDBBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3ODlELCAweDBCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2NjJGLCAweDBDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2MzE4LCAweDBEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2QzQxLCAweDBFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2OTc2LCAweDBGXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxNjg5LCAweDEwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxM0JFLCAweDExXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxQ0U3LCAweDEyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxOUQwLCAweDEzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwNzYyLCAweDE0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwMjU1LCAweDE1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwRDBDLCAweDE2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwODNCLCAweDE3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzNTVGLCAweDE4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzMDY4LCAweDE5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzRjMxLCAweDFBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzQTA2LCAweDFCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyNEI0LCAweDFDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyMTgzLCAweDFEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyRURBLCAweDFFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyQkVELCAweDFGXSksCgkgICAgXTsKCSAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb247Cgl9KCkpOwoJRm9ybWF0SW5mb3JtYXRpb24kMS5kZWZhdWx0ID0gRm9ybWF0SW5mb3JtYXRpb247CgoJdmFyIEVDQmxvY2tzJDEgPSB7fTsKCgl2YXIgX192YWx1ZXMkNSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0Jsb2NrcyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHNldCBvZiBlcnJvci1jb3JyZWN0aW9uIGJsb2NrcyBpbiBvbmUgc3ltYm9sIHZlcnNpb24uIE1vc3QgdmVyc2lvbnMgd2lsbAoJICogdXNlIGJsb2NrcyBvZiBkaWZmZXJpbmcgc2l6ZXMgd2l0aGluIG9uZSB2ZXJzaW9uLCBzbywgdGhpcyBlbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yCgkgKiBlYWNoIHNldCBvZiBibG9ja3MuIEl0IGFsc28gaG9sZHMgdGhlIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBwZXIgYmxvY2sgc2luY2UgaXQKCSAqIHdpbGwgYmUgdGhlIHNhbWUgYWNyb3NzIGFsbCBibG9ja3Mgd2l0aGluIG9uZSB2ZXJzaW9uLjwvcD4KCSAqLwoJdmFyIEVDQmxvY2tzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEVDQmxvY2tzKGVjQ29kZXdvcmRzUGVyQmxvY2sgLyppbnQqLykgewoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayA9IGVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgICAgIHRoaXMuZWNCbG9ja3MgPSBlY0Jsb2NrczsKCSAgICB9CgkgICAgRUNCbG9ja3MucHJvdG90eXBlLmdldEVDQ29kZXdvcmRzUGVyQmxvY2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0TnVtQmxvY2tzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIHRvdGFsID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tzID0gdGhpcy5lY0Jsb2NrczsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIGVjQmxvY2tzXzEgPSBfX3ZhbHVlcyQ1KGVjQmxvY2tzKSwgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCk7ICFlY0Jsb2Nrc18xXzEuZG9uZTsgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tzXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbCArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2Nrc18xXzEgJiYgIWVjQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGVjQmxvY2tzXzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2Nrc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdG90YWw7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0VG90YWxFQ0NvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayAqIHRoaXMuZ2V0TnVtQmxvY2tzKCk7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0RUNCbG9ja3MgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQmxvY2tzOwoJICAgIH07CgkgICAgcmV0dXJuIEVDQmxvY2tzOwoJfSgpKTsKCUVDQmxvY2tzJDEuZGVmYXVsdCA9IEVDQmxvY2tzOwoKCXZhciBFQ0IkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yIG9uZSBlcnJvci1jb3JyZWN0aW9uIGJsb2NrIGluIG9uZSBzeW1ib2wgdmVyc2lvbi4KCSAqIFRoaXMgaW5jbHVkZXMgdGhlIG51bWJlciBvZiBkYXRhIGNvZGV3b3JkcywgYW5kIHRoZSBudW1iZXIgb2YgdGltZXMgYSBibG9jayB3aXRoIHRoZXNlCgkgKiBwYXJhbWV0ZXJzIGlzIHVzZWQgY29uc2VjdXRpdmVseSBpbiB0aGUgUVIgY29kZSB2ZXJzaW9uJ3MgZm9ybWF0LjwvcD4KCSAqLwoJdmFyIEVDQiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFQ0IoY291bnQgLyppbnQqLywgZGF0YUNvZGV3b3JkcyAvKmludCovKSB7CgkgICAgICAgIHRoaXMuY291bnQgPSBjb3VudDsKCSAgICAgICAgdGhpcy5kYXRhQ29kZXdvcmRzID0gZGF0YUNvZGV3b3JkczsKCSAgICB9CgkgICAgRUNCLnByb3RvdHlwZS5nZXRDb3VudCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY291bnQ7CgkgICAgfTsKCSAgICBFQ0IucHJvdG90eXBlLmdldERhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICByZXR1cm4gRUNCOwoJfSgpKTsKCUVDQiQxLmRlZmF1bHQgPSBFQ0I7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX3ZhbHVlcyQ0ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFZlcnNpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBCaXRNYXRyaXhfMSQzID0gQml0TWF0cml4JDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSQxID0gRm9ybWF0SW5mb3JtYXRpb24kMTsKCXZhciBFQ0Jsb2Nrc18xID0gRUNCbG9ja3MkMTsKCXZhciBFQ0JfMSA9IEVDQiQxOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDIgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQyID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIFNlZSBJU08gMTgwMDQ6MjAwNiBBbm5leCBECgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFZlcnNpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gVmVyc2lvbih2ZXJzaW9uTnVtYmVyIC8qaW50Ki8sIGFsaWdubWVudFBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmVyc2lvbk51bWJlciA9IHZlcnNpb25OdW1iZXI7CgkgICAgICAgIHRoaXMuYWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBhbGlnbm1lbnRQYXR0ZXJuQ2VudGVyczsKCSAgICAgICAgdGhpcy5lY0Jsb2NrcyA9IGVjQmxvY2tzOwoJICAgICAgICB2YXIgdG90YWwgPSAwOwoJICAgICAgICB2YXIgZWNDb2Rld29yZHMgPSBlY0Jsb2Nrc1swXS5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIHZhciBlY2JBcnJheSA9IGVjQmxvY2tzWzBdLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY2JBcnJheV8xID0gX192YWx1ZXMkNChlY2JBcnJheSksIGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpOyAhZWNiQXJyYXlfMV8xLmRvbmU7IGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVjQmxvY2sgPSBlY2JBcnJheV8xXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdG90YWwgKz0gZWNCbG9jay5nZXRDb3VudCgpICogKGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpICsgZWNDb2Rld29yZHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoZWNiQXJyYXlfMV8xICYmICFlY2JBcnJheV8xXzEuZG9uZSAmJiAoX2EgPSBlY2JBcnJheV8xLnJldHVybikpIF9hLmNhbGwoZWNiQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy50b3RhbENvZGV3b3JkcyA9IHRvdGFsOwoJICAgIH0KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5nZXRWZXJzaW9uTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0VG90YWxDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRvdGFsQ29kZXdvcmRzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDE3ICsgNCAqIHRoaXMudmVyc2lvbk51bWJlcjsKCSAgICB9OwoJICAgIFZlcnNpb24ucHJvdG90eXBlLmdldEVDQmxvY2tzRm9yTGV2ZWwgPSBmdW5jdGlvbiAoZWNMZXZlbCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0Jsb2Nrc1tlY0xldmVsLmdldFZhbHVlKCldOwoJICAgICAgICAvLyBUWVBFU0NSSVBUUE9SVDogb3JpZ2luYWwgd2FzIHVzaW5nIG9yZGluYWwsIGFuZCB1c2luZyB0aGUgb3JkZXIgb2YgbGV2ZWxzIGFzIGRlZmluZWQgaW4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwgZW51bSAoTE1RSCkKCSAgICAgICAgLy8gSSB3aWxsIHVzZSB0aGUgZGlyZWN0IHZhbHVlIGZyb20gRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXMgZW51bSB3aGljaCBpbiB0eXBlc2NyaXB0IGdvZXMgdG8gYSBudW1iZXIKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkRlZHVjZXMgdmVyc2lvbiBpbmZvcm1hdGlvbiBwdXJlbHkgZnJvbSBRUiBDb2RlIGRpbWVuc2lvbnMuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gaW4gbW9kdWxlcwoJICAgICAqIEByZXR1cm4gVmVyc2lvbiBmb3IgYSBRUiBDb2RlIG9mIHRoYXQgZGltZW5zaW9uCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCAxIG1vZCA0CgkgICAgICovCgkgICAgVmVyc2lvbi5nZXRQcm92aXNpb25hbFZlcnNpb25Gb3JEaW1lbnNpb24gPSBmdW5jdGlvbiAoZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiAlIDQgIT09IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VmVyc2lvbkZvck51bWJlcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlciA9IGZ1bmN0aW9uICh2ZXJzaW9uTnVtYmVyIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPCAxIHx8IHZlcnNpb25OdW1iZXIgPiA0MCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDIuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBWZXJzaW9uLlZFUlNJT05TW3ZlcnNpb25OdW1iZXIgLSAxXTsKCSAgICB9OwoJICAgIFZlcnNpb24uZGVjb2RlVmVyc2lvbkluZm9ybWF0aW9uID0gZnVuY3Rpb24gKHZlcnNpb25CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGJlc3REaWZmZXJlbmNlID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHZhciBiZXN0VmVyc2lvbiA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgVmVyc2lvbi5WRVJTSU9OX0RFQ09ERV9JTkZPLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgdGFyZ2V0VmVyc2lvbiA9IFZlcnNpb24uVkVSU0lPTl9ERUNPREVfSU5GT1tpXTsKCSAgICAgICAgICAgIC8vIERvIHRoZSB2ZXJzaW9uIGluZm8gYml0cyBtYXRjaCBleGFjdGx5PyBkb25lLgoJICAgICAgICAgICAgaWYgKHRhcmdldFZlcnNpb24gPT09IHZlcnNpb25CaXRzKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlcihpICsgNyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBPdGhlcndpc2Ugc2VlIGlmIHRoaXMgaXMgdGhlIGNsb3Nlc3QgdG8gYSByZWFsIHZlcnNpb24gaW5mbyBiaXQgc3RyaW5nCgkgICAgICAgICAgICAvLyB3ZSBoYXZlIHNlZW4gc28gZmFyCgkgICAgICAgICAgICB2YXIgYml0c0RpZmZlcmVuY2UgPSBGb3JtYXRJbmZvcm1hdGlvbl8xJDEuZGVmYXVsdC5udW1CaXRzRGlmZmVyaW5nKHZlcnNpb25CaXRzLCB0YXJnZXRWZXJzaW9uKTsKCSAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgYmVzdFZlcnNpb24gPSBpICsgNzsKCSAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFdlIGNhbiB0b2xlcmF0ZSB1cCB0byAzIGJpdHMgb2YgZXJyb3Igc2luY2Ugbm8gdHdvIHZlcnNpb24gaW5mbyBjb2Rld29yZHMgd2lsbAoJICAgICAgICAvLyBkaWZmZXIgaW4gbGVzcyB0aGFuIDggYml0cy4KCSAgICAgICAgaWYgKGJlc3REaWZmZXJlbmNlIDw9IDMpIHsKCSAgICAgICAgICAgIHJldHVybiBWZXJzaW9uLmdldFZlcnNpb25Gb3JOdW1iZXIoYmVzdFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGRpZG4ndCBmaW5kIGEgY2xvc2UgZW5vdWdoIG1hdGNoLCBmYWlsCgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIElTTyAxODAwNDoyMDA2IEFubmV4IEUKCSAgICAgKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5idWlsZEZ1bmN0aW9uUGF0dGVybiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpOwoJICAgICAgICB2YXIgYml0TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDMuZGVmYXVsdChkaW1lbnNpb24pOwoJICAgICAgICAvLyBUb3AgbGVmdCBmaW5kZXIgcGF0dGVybiArIHNlcGFyYXRvciArIGZvcm1hdAoJICAgICAgICBiaXRNYXRyaXguc2V0UmVnaW9uKDAsIDAsIDksIDkpOwoJICAgICAgICAvLyBUb3AgcmlnaHQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbihkaW1lbnNpb24gLSA4LCAwLCA4LCA5KTsKCSAgICAgICAgLy8gQm90dG9tIGxlZnQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSA4LCA5LCA4KTsKCSAgICAgICAgLy8gQWxpZ25tZW50IHBhdHRlcm5zCgkgICAgICAgIHZhciBtYXggPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHgrKykgewoJICAgICAgICAgICAgdmFyIGkgPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzW3hdIC0gMjsKCSAgICAgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgbWF4OyB5KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoKHggPT09IDAgJiYgKHkgPT09IDAgfHwgeSA9PT0gbWF4IC0gMSkpIHx8ICh4ID09PSBtYXggLSAxICYmIHkgPT09IDApKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE5vIGFsaWdubWVudCBwYXR0ZXJucyBuZWFyIHRoZSB0aHJlZSBmaW5kZXIgcGF0dGVybnMKCSAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24odGhpcy5hbGlnbm1lbnRQYXR0ZXJuQ2VudGVyc1t5XSAtIDIsIGksIDUsIDUpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFZlcnRpY2FsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oNiwgOSwgMSwgZGltZW5zaW9uIC0gMTcpOwoJICAgICAgICAvLyBIb3Jpem9udGFsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oOSwgNiwgZGltZW5zaW9uIC0gMTcsIDEpOwoJICAgICAgICBpZiAodGhpcy52ZXJzaW9uTnVtYmVyID4gNikgewoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCB0b3AgcmlnaHQKCSAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oZGltZW5zaW9uIC0gMTEsIDAsIDMsIDYpOwoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCBib3R0b20gbGVmdAoJICAgICAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSAxMSwgNiwgMyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICcnICsgdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgQW5uZXggRC4KCSAgICAgICAqIEVsZW1lbnQgaSByZXByZXNlbnRzIHRoZSByYXcgdmVyc2lvbiBiaXRzIHRoYXQgc3BlY2lmeSB2ZXJzaW9uIGkgKyA3CgkgICAgICAgKi8KCSAgICBWZXJzaW9uLlZFUlNJT05fREVDT0RFX0lORk8gPSBJbnQzMkFycmF5LmZyb20oWwoJICAgICAgICAweDA3Qzk0LCAweDA4NUJDLCAweDA5QTk5LCAweDBBNEQzLCAweDBCQkY2LAoJICAgICAgICAweDBDNzYyLCAweDBEODQ3LCAweDBFNjBELCAweDBGOTI4LCAweDEwQjc4LAoJICAgICAgICAweDExNDVELCAweDEyQTE3LCAweDEzNTMyLCAweDE0OUE2LCAweDE1NjgzLAoJICAgICAgICAweDE2OEM5LCAweDE3N0VDLCAweDE4RUM0LCAweDE5MUUxLCAweDFBRkFCLAoJICAgICAgICAweDFCMDhFLCAweDFDQzFBLCAweDFEMzNGLCAweDFFRDc1LCAweDFGMjUwLAoJICAgICAgICAweDIwOUQ1LCAweDIxNkYwLCAweDIyOEJBLCAweDIzNzlGLCAweDI0QjBCLAoJICAgICAgICAweDI1NDJFLCAweDI2QTY0LCAweDI3NTQxLCAweDI4QzY5CgkgICAgXSk7CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgNi41LjEgVGFibGUgOQoJICAgICAgICovCgkgICAgVmVyc2lvbi5WRVJTSU9OUyA9IFsKCSAgICAgICAgbmV3IFZlcnNpb24oMSwgbmV3IEludDMyQXJyYXkoMCksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOSkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMiwgSW50MzJBcnJheS5mcm9tKFs2LCAxOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDEwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMywgSW50MzJBcnJheS5mcm9tKFs2LCAyMl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE1LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1NSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA4MCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA5KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCA0MykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTIpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDYsIEludDMyQXJyYXkuZnJvbShbNiwgMzRdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDcsIEludDMyQXJyYXkuZnJvbShbNiwgMjIsIDM4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDc4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDMxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNCkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNCwgNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMzgpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzOSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxOCksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE5KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDksIEludDMyQXJyYXkuZnJvbShbNiwgMjYsIDQ2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAzNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDM3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTAsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDUwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDY4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxOSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDIwKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDExLCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA4MSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDUxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTIsIEludDMyQXJyYXkuZnJvbShbNiwgMzIsIDU4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDkyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMzYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDEzLCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2Ml0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMzcpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDEyLCAxMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDYsIDY2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA0MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDQxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDE3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNSwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDgsIDcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDg3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgODgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgNDEpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNiwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDk4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0NikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTkpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyMCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTcsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU0LCA3OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxMDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE4LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NiwgODJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIwKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDQzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxOSwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE5LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1OCwgODZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTE0KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDQ0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDQ1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDE3LCAyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDE0KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMCwgSW50MzJBcnJheS5mcm9tKFs2LCAzNCwgNjIsIDkwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDEwNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0MSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIxLCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1MCwgNzIsIDk0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDIpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIyLCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1MCwgNzQsIDk4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDExMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMywgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIxKSwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI0LCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1NCwgODAsIDEwNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTcpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMwLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE3KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyNSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMTA2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTA3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMjYsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzMsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI3LCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2MiwgOTAsIDExOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0LCA5OCwgMTIyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDIsIDEyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTYpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjEsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgzNywgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTIsIDc4LCAxMDQsIDEzMF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCA0NyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjMsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjUsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTYsIDgyLCAxMDgsIDEzNF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxMywgMTE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQyLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDI4LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzIsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYwLCA4NiwgMTEyLCAxMzhdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzUsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDM1LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzMsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0LCAxNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzQsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYyLCA5MCwgMTE4LCAxNDZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNDQsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NCwgNzgsIDEwMiwgMTI2LCAxNTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDEyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMiwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgNDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzYsIEludDMyQXJyYXkuZnJvbShbNiwgMjQsIDUwLCA3NiwgMTAyLCAxMjgsIDE1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMjEpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDY0LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzcsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDU0LCA4MCwgMTA2LCAxMzIsIDE1OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIzKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDI5LCA0NiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCA0NykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0OSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjQsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNDYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzOCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTAsIDEzNiwgMTYyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE4LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzIsIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ4LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM5LCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1NCwgODIsIDExMCwgMTM4LCAxNjZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjAsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCg0MCwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNjcsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig0MCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTgsIDg2LCAxMTQsIDE0MiwgMTcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxMTgpLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyMCwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCg2MSwgMTYpKSkKCSAgICBdOwoJICAgIHJldHVybiBWZXJzaW9uOwoJfSgpKTsKCVZlcnNpb24kMS5kZWZhdWx0ID0gVmVyc2lvbjsKCgl2YXIgRGF0YU1hc2sgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5EYXRhTWFza1ZhbHVlcyA9IHZvaWQgMDsKCXZhciBEYXRhTWFza1ZhbHVlczsKCShmdW5jdGlvbiAoRGF0YU1hc2tWYWx1ZXMpIHsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAwMCJdID0gMF0gPSAiREFUQV9NQVNLXzAwMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18wMDEiXSA9IDFdID0gIkRBVEFfTUFTS18wMDEiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMDEwIl0gPSAyXSA9ICJEQVRBX01BU0tfMDEwIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAxMSJdID0gM10gPSAiREFUQV9NQVNLXzAxMSI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMDAiXSA9IDRdID0gIkRBVEFfTUFTS18xMDAiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMTAxIl0gPSA1XSA9ICJEQVRBX01BU0tfMTAxIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzExMCJdID0gNl0gPSAiREFUQV9NQVNLXzExMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMTEiXSA9IDddID0gIkRBVEFfTUFTS18xMTEiOwoJfSkoRGF0YU1hc2tWYWx1ZXMgPSBleHBvcnRzLkRhdGFNYXNrVmFsdWVzIHx8IChleHBvcnRzLkRhdGFNYXNrVmFsdWVzID0ge30pKTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGRhdGEgbWFza3MgZm9yIHRoZSBkYXRhIGJpdHMgaW4gYSBRUiBjb2RlLCBwZXIgSVNPIDE4MDA0OjIwMDYgNi44LiBJbXBsZW1lbnRhdGlvbnMKCSAqIG9mIHRoaXMgY2xhc3MgY2FuIHVuLW1hc2sgYSByYXcgQml0TWF0cml4LiBGb3Igc2ltcGxpY2l0eSwgdGhleSB3aWxsIHVubWFzayB0aGUgZW50aXJlIEJpdE1hdHJpeCwKCSAqIGluY2x1ZGluZyBhcmVhcyB1c2VkIGZvciBmaW5kZXIgcGF0dGVybnMsIHRpbWluZyBwYXR0ZXJucywgZXRjLiBUaGVzZSBhcmVhcyBzaG91bGQgYmUgdW51c2VkCgkgKiBhZnRlciB0aGUgcG9pbnQgdGhleSBhcmUgdW5tYXNrZWQgYW55d2F5LjwvcD4KCSAqCgkgKiA8cD5Ob3RlIHRoYXQgdGhlIGRpYWdyYW0gaW4gc2VjdGlvbiA2LjguMSBpcyBtaXNsZWFkaW5nIHNpbmNlIGl0IGluZGljYXRlcyB0aGF0IGkgaXMgY29sdW1uIHBvc2l0aW9uCgkgKiBhbmQgaiBpcyByb3cgcG9zaXRpb24uIEluIGZhY3QsIGFzIHRoZSB0ZXh0IHNheXMsIGkgaXMgcm93IHBvc2l0aW9uIGFuZCBqIGlzIGNvbHVtbiBwb3NpdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFNYXNrID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIFNlZSBJU08gMTgwMDQ6MjAwNiA2LjguMQoJICAgIGZ1bmN0aW9uIERhdGFNYXNrKHZhbHVlLCBpc01hc2tlZCkgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuaXNNYXNrZWQgPSBpc01hc2tlZDsKCSAgICB9CgkgICAgLy8gRW5kIG9mIGVudW0gY29uc3RhbnRzLgoJICAgIC8qKgoJICAgICAqIDxwPkltcGxlbWVudGF0aW9ucyBvZiB0aGlzIG1ldGhvZCByZXZlcnNlIHRoZSBkYXRhIG1hc2tpbmcgcHJvY2VzcyBhcHBsaWVkIHRvIGEgUVIgQ29kZSBhbmQKCSAgICAgKiBtYWtlIGl0cyBiaXRzIHJlYWR5IHRvIHJlYWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGJpdHMgcmVwcmVzZW50YXRpb24gb2YgUVIgQ29kZSBiaXRzCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gb2YgUVIgQ29kZSwgcmVwcmVzZW50ZWQgYnkgYml0cywgYmVpbmcgdW5tYXNrZWQKCSAgICAgKi8KCSAgICBEYXRhTWFzay5wcm90b3R5cGUudW5tYXNrQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGRpbWVuc2lvbiAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZGltZW5zaW9uOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5pc01hc2tlZChpLCBqKSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLmZsaXAoaiwgaSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBEYXRhTWFzay52YWx1ZXMgPSBuZXcgTWFwKFsKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDAwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeCArIHkpIG1vZCAyID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDAwLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMCwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoKGkgKyBqKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeCBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMDEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgJiAweDAxKSA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMDEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoIHkgbW9kIDMgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuIGogJSAzID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKHggKyB5KSBtb2QgMyA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAxMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgKyBqKSAlIDMgPT09IDA7IH0pXSwKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDEwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeC8yICsgeS8zKSBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMCwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMDAsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKChNYXRoLmZsb29yKGkgLyAyKSArIE1hdGguZmxvb3IoaiAvIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeHkgbW9kIDIgKyB4eSBtb2QgMyA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2ID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTAxLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMSwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoaSAqIGopICUgNiA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMTEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoICh4eSBtb2QgMiArIHh5IG1vZCAzKSBtb2QgMiA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2IDwgMwoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSAqIGopICUgNikgPCAzOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKCh4K3kpbW9kIDIgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKiBlcXVpdmFsZW50bHksIHN1Y2ggdGhhdCAoeCArIHkgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTEsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTExLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSArIGogKyAoKGkgKiBqKSAlIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgXSk7CgkgICAgcmV0dXJuIERhdGFNYXNrOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IERhdGFNYXNrOwoKCX0oRGF0YU1hc2spKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdE1hdHJpeFBhcnNlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgVmVyc2lvbl8xJDEgPSBWZXJzaW9uJDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSA9IEZvcm1hdEluZm9ybWF0aW9uJDE7Cgl2YXIgRGF0YU1hc2tfMSA9IERhdGFNYXNrOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCS8qKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJpdE1hdHJpeFBhcnNlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYml0TWF0cml4IHtAbGluayBCaXRNYXRyaXh9IHRvIHBhcnNlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCA+PSAyMSBhbmQgMSBtb2QgNAoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeFBhcnNlcihiaXRNYXRyaXgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IGJpdE1hdHJpeC5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiA8IDIxIHx8IChkaW1lbnNpb24gJiAweDAzKSAhPT0gMSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0TWF0cml4ID0gYml0TWF0cml4OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5SZWFkcyBmb3JtYXQgaW5mb3JtYXRpb24gZnJvbSBvbmUgb2YgaXRzIHR3byBsb2NhdGlvbnMgd2l0aGluIHRoZSBRUiBDb2RlLjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEZvcm1hdEluZm9ybWF0aW9ufSBlbmNhcHN1bGF0aW5nIHRoZSBRUiBDb2RlJ3MgZm9ybWF0IGluZm8KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIGZvcm1hdCBpbmZvcm1hdGlvbiBsb2NhdGlvbnMgY2Fubm90IGJlIHBhcnNlZCBhcwoJICAgICAqIHRoZSB2YWxpZCBlbmNvZGluZyBvZiBmb3JtYXQgaW5mb3JtYXRpb24KCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRGb3JtYXRJbmZvcm1hdGlvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgaWYgKHRoaXMucGFyc2VkRm9ybWF0SW5mbyAhPT0gbnVsbCAmJiB0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VkRm9ybWF0SW5mbzsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRvcC1sZWZ0IGZvcm1hdCBpbmZvIGJpdHMKCSAgICAgICAgdmFyIGZvcm1hdEluZm9CaXRzMSA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNjsgaSsrKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoaSwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyAuLiBhbmQgc2tpcCBhIGJpdCBpbiB0aGUgdGltaW5nIHBhdHRlcm4gLi4uCgkgICAgICAgIGZvcm1hdEluZm9CaXRzMSA9IHRoaXMuY29weUJpdCg3LCA4LCBmb3JtYXRJbmZvQml0czEpOwoJICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgZm9ybWF0SW5mb0JpdHMxID0gdGhpcy5jb3B5Qml0KDgsIDcsIGZvcm1hdEluZm9CaXRzMSk7CgkgICAgICAgIC8vIC4uIGFuZCBza2lwIGEgYml0IGluIHRoZSB0aW1pbmcgcGF0dGVybiAuLi4KCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgaiwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRoZSB0b3AtcmlnaHQvYm90dG9tLWxlZnQgcGF0dGVybiB0b28KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgZm9ybWF0SW5mb0JpdHMyID0gMDsKCSAgICAgICAgdmFyIGpNaW4gPSBkaW1lbnNpb24gLSA3OwoJICAgICAgICBmb3IgKHZhciBqID0gZGltZW5zaW9uIC0gMTsgaiA+PSBqTWluOyBqLS0pIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdCg4LCBqLCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIGZvciAodmFyIGkgPSBkaW1lbnNpb24gLSA4OyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdChpLCA4LCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uXzEuZGVmYXVsdC5kZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihmb3JtYXRJbmZvQml0czEsIGZvcm1hdEluZm9CaXRzMik7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZEZvcm1hdEluZm87CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+UmVhZHMgdmVyc2lvbiBpbmZvcm1hdGlvbiBmcm9tIG9uZSBvZiBpdHMgdHdvIGxvY2F0aW9ucyB3aXRoaW4gdGhlIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgVmVyc2lvbn0gZW5jYXBzdWxhdGluZyB0aGUgUVIgQ29kZSdzIHZlcnNpb24KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIHZlcnNpb24gaW5mb3JtYXRpb24gbG9jYXRpb25zIGNhbm5vdCBiZSBwYXJzZWQgYXMKCSAgICAgKiB0aGUgdmFsaWQgZW5jb2Rpbmcgb2YgdmVyc2lvbiBpbmZvcm1hdGlvbgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUucmVhZFZlcnNpb24gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZFZlcnNpb24gIT09IG51bGwgJiYgdGhpcy5wYXJzZWRWZXJzaW9uICE9PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgcHJvdmlzaW9uYWxWZXJzaW9uID0gTWF0aC5mbG9vcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24gPD0gNikgewoJICAgICAgICAgICAgcmV0dXJuIFZlcnNpb25fMSQxLmRlZmF1bHQuZ2V0VmVyc2lvbkZvck51bWJlcihwcm92aXNpb25hbFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJlYWQgdG9wLXJpZ2h0IHZlcnNpb24gaW5mbzogMyB3aWRlIGJ5IDYgdGFsbAoJICAgICAgICB2YXIgdmVyc2lvbkJpdHMgPSAwOwoJICAgICAgICB2YXIgaWpNaW4gPSBkaW1lbnNpb24gLSAxMTsKCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gZGltZW5zaW9uIC0gOTsgaSA+PSBpak1pbjsgaS0tKSB7CgkgICAgICAgICAgICAgICAgdmVyc2lvbkJpdHMgPSB0aGlzLmNvcHlCaXQoaSwgaiwgdmVyc2lvbkJpdHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBmYWlsZWQuIFRyeSBib3R0b20gbGVmdDogNiB3aWRlIGJ5IDMgdGFsbAoJICAgICAgICB2ZXJzaW9uQml0cyA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSA1OyBpID49IDA7IGktLSkgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IGRpbWVuc2lvbiAtIDk7IGogPj0gaWpNaW47IGotLSkgewoJICAgICAgICAgICAgICAgIHZlcnNpb25CaXRzID0gdGhpcy5jb3B5Qml0KGksIGosIHZlcnNpb25CaXRzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5jb3B5Qml0ID0gZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovLCB2ZXJzaW9uQml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBiaXQgPSB0aGlzLmlzTWlycm9yID8gdGhpcy5iaXRNYXRyaXguZ2V0KGosIGkpIDogdGhpcy5iaXRNYXRyaXguZ2V0KGksIGopOwoJICAgICAgICByZXR1cm4gYml0ID8gKHZlcnNpb25CaXRzIDw8IDEpIHwgMHgxIDogdmVyc2lvbkJpdHMgPDwgMTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlJlYWRzIHRoZSBiaXRzIGluIHRoZSB7QGxpbmsgQml0TWF0cml4fSByZXByZXNlbnRpbmcgdGhlIGZpbmRlciBwYXR0ZXJuIGluIHRoZQoJICAgICAqIGNvcnJlY3Qgb3JkZXIgaW4gb3JkZXIgdG8gcmVjb25zdHJ1Y3QgdGhlIGNvZGV3b3JkcyBieXRlcyBjb250YWluZWQgd2l0aGluIHRoZQoJICAgICAqIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBleGFjdCBudW1iZXIgb2YgYnl0ZXMgZXhwZWN0ZWQgaXMgbm90IHJlYWQKCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBmb3JtYXRJbmZvID0gdGhpcy5yZWFkRm9ybWF0SW5mb3JtYXRpb24oKTsKCSAgICAgICAgdmFyIHZlcnNpb24gPSB0aGlzLnJlYWRWZXJzaW9uKCk7CgkgICAgICAgIC8vIEdldCB0aGUgZGF0YSBtYXNrIGZvciB0aGUgZm9ybWF0IHVzZWQgaW4gdGhpcyBRUiBDb2RlLiBUaGlzIHdpbGwgZXhjbHVkZQoJICAgICAgICAvLyBzb21lIGJpdHMgZnJvbSByZWFkaW5nIGFzIHdlIHdpbmQgdGhyb3VnaCB0aGUgYml0IG1hdHJpeC4KCSAgICAgICAgdmFyIGRhdGFNYXNrID0gRGF0YU1hc2tfMS5kZWZhdWx0LnZhbHVlcy5nZXQoZm9ybWF0SW5mby5nZXREYXRhTWFzaygpKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICBkYXRhTWFzay51bm1hc2tCaXRNYXRyaXgodGhpcy5iaXRNYXRyaXgsIGRpbWVuc2lvbik7CgkgICAgICAgIHZhciBmdW5jdGlvblBhdHRlcm4gPSB2ZXJzaW9uLmJ1aWxkRnVuY3Rpb25QYXR0ZXJuKCk7CgkgICAgICAgIHZhciByZWFkaW5nVXAgPSB0cnVlOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkodmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKTsKCSAgICAgICAgdmFyIHJlc3VsdE9mZnNldCA9IDA7CgkgICAgICAgIHZhciBjdXJyZW50Qnl0ZSA9IDA7CgkgICAgICAgIHZhciBiaXRzUmVhZCA9IDA7CgkgICAgICAgIC8vIFJlYWQgY29sdW1ucyBpbiBwYWlycywgZnJvbSByaWdodCB0byBsZWZ0CgkgICAgICAgIGZvciAodmFyIGogPSBkaW1lbnNpb24gLSAxOyBqID4gMDsgaiAtPSAyKSB7CgkgICAgICAgICAgICBpZiAoaiA9PT0gNikgewoJICAgICAgICAgICAgICAgIC8vIFNraXAgd2hvbGUgY29sdW1uIHdpdGggdmVydGljYWwgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgICAgICAgICAgICAvLyBzYXZlcyB0aW1lIGFuZCBtYWtlcyB0aGUgb3RoZXIgY29kZSBwcm9jZWVkIG1vcmUgY2xlYW5seQoJICAgICAgICAgICAgICAgIGotLTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIFJlYWQgYWx0ZXJuYXRpbmdseSBmcm9tIGJvdHRvbSB0byB0b3AgdGhlbiB0b3AgdG8gYm90dG9tCgkgICAgICAgICAgICBmb3IgKHZhciBjb3VudCA9IDA7IGNvdW50IDwgZGltZW5zaW9uOyBjb3VudCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGkgPSByZWFkaW5nVXAgPyBkaW1lbnNpb24gLSAxIC0gY291bnQgOiBjb3VudDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBjb2wgPSAwOyBjb2wgPCAyOyBjb2wrKykgewoJICAgICAgICAgICAgICAgICAgICAvLyBJZ25vcmUgYml0cyBjb3ZlcmVkIGJ5IHRoZSBmdW5jdGlvbiBwYXR0ZXJuCgkgICAgICAgICAgICAgICAgICAgIGlmICghZnVuY3Rpb25QYXR0ZXJuLmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVhZCBhIGJpdAoJICAgICAgICAgICAgICAgICAgICAgICAgYml0c1JlYWQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIDw8PSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYml0TWF0cml4LmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIHw9IDE7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSd2ZSBtYWRlIGEgd2hvbGUgYnl0ZSwgc2F2ZSBpdCBvZmYKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzUmVhZCA9PT0gOCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtyZXN1bHRPZmZzZXQrK10gPSAvKihieXRlKSAqLyBjdXJyZW50Qnl0ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaXRzUmVhZCA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEJ5dGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVhZGluZ1VwID0gIXJlYWRpbmdVcDsgLy8gcmVhZGluZ1VwIF49IHRydWU7IC8vIHJlYWRpbmdVcCA9ICFyZWFkaW5nVXA7IC8vIHN3aXRjaCBkaXJlY3Rpb25zCgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJlc3VsdE9mZnNldCAhPT0gdmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldmVydCB0aGUgbWFzayByZW1vdmFsIGRvbmUgd2hpbGUgcmVhZGluZyB0aGUgY29kZSB3b3Jkcy4gVGhlIGJpdCBtYXRyaXggc2hvdWxkIHJldmVydCB0byBpdHMgb3JpZ2luYWwgc3RhdGUuCgkgICAgICovCgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5yZW1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybjsgLy8gV2UgaGF2ZSBubyBmb3JtYXQgaW5mb3JtYXRpb24sIGFuZCBoYXZlIG5vIGRhdGEgbWFzawoJICAgICAgICB9CgkgICAgICAgIHZhciBkYXRhTWFzayA9IERhdGFNYXNrXzEuZGVmYXVsdC52YWx1ZXNbdGhpcy5wYXJzZWRGb3JtYXRJbmZvLmdldERhdGFNYXNrKCldOwoJICAgICAgICB2YXIgZGltZW5zaW9uID0gdGhpcy5iaXRNYXRyaXguZ2V0SGVpZ2h0KCk7CgkgICAgICAgIGRhdGFNYXNrLnVubWFza0JpdE1hdHJpeCh0aGlzLmJpdE1hdHJpeCwgZGltZW5zaW9uKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFByZXBhcmUgdGhlIHBhcnNlciBmb3IgYSBtaXJyb3JlZCBvcGVyYXRpb24uCgkgICAgICogVGhpcyBmbGFnIGhhcyBlZmZlY3Qgb25seSBvbiB0aGUge0BsaW5rICNyZWFkRm9ybWF0SW5mb3JtYXRpb24oKX0gYW5kIHRoZQoJICAgICAqIHtAbGluayAjcmVhZFZlcnNpb24oKX0uIEJlZm9yZSBwcm9jZWVkaW5nIHdpdGgge0BsaW5rICNyZWFkQ29kZXdvcmRzKCl9IHRoZQoJICAgICAqIHtAbGluayAjbWlycm9yKCl9IG1ldGhvZCBzaG91bGQgYmUgY2FsbGVkLgoJICAgICAqCgkgICAgICogQHBhcmFtIG1pcnJvciBXaGV0aGVyIHRvIHJlYWQgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm9ybWF0aW9uIG1pcnJvcmVkLgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUuc2V0TWlycm9yID0gZnVuY3Rpb24gKGlzTWlycm9yKSB7CgkgICAgICAgIHRoaXMucGFyc2VkVmVyc2lvbiA9IG51bGw7CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IG51bGw7CgkgICAgICAgIHRoaXMuaXNNaXJyb3IgPSBpc01pcnJvcjsKCSAgICB9OwoJICAgIC8qKiBNaXJyb3IgdGhlIGJpdCBtYXRyaXggaW4gb3JkZXIgdG8gYXR0ZW1wdCBhIHNlY29uZCByZWFkaW5nLiAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUubWlycm9yID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgYml0TWF0cml4ID0gdGhpcy5iaXRNYXRyaXg7CgkgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IGJpdE1hdHJpeC5nZXRXaWR0aCgpOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgeSA9IHggKyAxLCBoZWlnaHQgPSBiaXRNYXRyaXguZ2V0SGVpZ2h0KCk7IHkgPCBoZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgICAgIGlmIChiaXRNYXRyaXguZ2V0KHgsIHkpICE9PSBiaXRNYXRyaXguZ2V0KHksIHgpKSB7CgkgICAgICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5mbGlwKHksIHgpOwoJICAgICAgICAgICAgICAgICAgICBiaXRNYXRyaXguZmxpcCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXhQYXJzZXI7Cgl9KCkpOwoJQml0TWF0cml4UGFyc2VyJDEuZGVmYXVsdCA9IEJpdE1hdHJpeFBhcnNlcjsKCgl2YXIgRGF0YUJsb2NrJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGF0YUJsb2NrJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQxID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIGJsb2NrIG9mIGRhdGEgd2l0aGluIGEgUVIgQ29kZS4gUVIgQ29kZXMgbWF5IHNwbGl0IHRoZWlyIGRhdGEgaW50bwoJICogbXVsdGlwbGUgYmxvY2tzLCBlYWNoIG9mIHdoaWNoIGlzIGEgdW5pdCBvZiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3Jkcy4gRWFjaAoJICogaXMgcmVwcmVzZW50ZWQgYnkgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFCbG9jayA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEYXRhQmxvY2sobnVtRGF0YUNvZGV3b3JkcyAvKmludCovLCBjb2Rld29yZHMpIHsKCSAgICAgICAgdGhpcy5udW1EYXRhQ29kZXdvcmRzID0gbnVtRGF0YUNvZGV3b3JkczsKCSAgICAgICAgdGhpcy5jb2Rld29yZHMgPSBjb2Rld29yZHM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIDxwPldoZW4gUVIgQ29kZXMgdXNlIG11bHRpcGxlIGRhdGEgYmxvY2tzLCB0aGV5IGFyZSBhY3R1YWxseSBpbnRlcmxlYXZlZC4KCSAgICAgKiBUaGF0IGlzLCB0aGUgZmlyc3QgYnl0ZSBvZiBkYXRhIGJsb2NrIDEgdG8gbiBpcyB3cml0dGVuLCB0aGVuIHRoZSBzZWNvbmQgYnl0ZXMsIGFuZCBzbyBvbi4gVGhpcwoJICAgICAqIG1ldGhvZCB3aWxsIHNlcGFyYXRlIHRoZSBkYXRhIGludG8gb3JpZ2luYWwgYmxvY2tzLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByYXdDb2Rld29yZHMgYnl0ZXMgYXMgcmVhZCBkaXJlY3RseSBmcm9tIHRoZSBRUiBDb2RlCgkgICAgICogQHBhcmFtIHZlcnNpb24gdmVyc2lvbiBvZiB0aGUgUVIgQ29kZQoJICAgICAqIEBwYXJhbSBlY0xldmVsIGVycm9yLWNvcnJlY3Rpb24gbGV2ZWwgb2YgdGhlIFFSIENvZGUKCSAgICAgKiBAcmV0dXJuIERhdGFCbG9ja3MgY29udGFpbmluZyBvcmlnaW5hbCBieXRlcywgImRlLWludGVybGVhdmVkIiBmcm9tIHJlcHJlc2VudGF0aW9uIGluIHRoZQoJICAgICAqICAgICAgICAgUVIgQ29kZQoJICAgICAqLwoJICAgIERhdGFCbG9jay5nZXREYXRhQmxvY2tzID0gZnVuY3Rpb24gKHJhd0NvZGV3b3JkcywgdmVyc2lvbiwgZWNMZXZlbCkgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgaWYgKHJhd0NvZGV3b3Jkcy5sZW5ndGggIT09IHZlcnNpb24uZ2V0VG90YWxDb2Rld29yZHMoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEZpZ3VyZSBvdXQgdGhlIG51bWJlciBhbmQgc2l6ZSBvZiBkYXRhIGJsb2NrcyB1c2VkIGJ5IHRoaXMgdmVyc2lvbiBhbmQKCSAgICAgICAgLy8gZXJyb3IgY29ycmVjdGlvbiBsZXZlbAoJICAgICAgICB2YXIgZWNCbG9ja3MgPSB2ZXJzaW9uLmdldEVDQmxvY2tzRm9yTGV2ZWwoZWNMZXZlbCk7CgkgICAgICAgIC8vIEZpcnN0IGNvdW50IHRoZSB0b3RhbCBudW1iZXIgb2YgZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIHRvdGFsQmxvY2tzID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tBcnJheSA9IGVjQmxvY2tzLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY0Jsb2NrQXJyYXlfMSA9IF9fdmFsdWVzJDMoZWNCbG9ja0FycmF5KSwgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKTsgIWVjQmxvY2tBcnJheV8xXzEuZG9uZTsgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBlY0Jsb2NrID0gZWNCbG9ja0FycmF5XzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbEJsb2NrcyArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2NrQXJyYXlfMV8xICYmICFlY0Jsb2NrQXJyYXlfMV8xLmRvbmUgJiYgKF9hID0gZWNCbG9ja0FycmF5XzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2NrQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGVzdGFibGlzaCBEYXRhQmxvY2tzIG9mIHRoZSBhcHByb3ByaWF0ZSBzaXplIGFuZCBudW1iZXIgb2YgZGF0YSBjb2Rld29yZHMKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBBcnJheSh0b3RhbEJsb2Nrcyk7CgkgICAgICAgIHZhciBudW1SZXN1bHRCbG9ja3MgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZWNCbG9ja0FycmF5XzIgPSBfX3ZhbHVlcyQzKGVjQmxvY2tBcnJheSksIGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCk7ICFlY0Jsb2NrQXJyYXlfMl8xLmRvbmU7IGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tBcnJheV8yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlY0Jsb2NrLmdldENvdW50KCk7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtRGF0YUNvZGV3b3JkcyA9IGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtQmxvY2tDb2Rld29yZHMgPSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCkgKyBudW1EYXRhQ29kZXdvcmRzOwoJICAgICAgICAgICAgICAgICAgICByZXN1bHRbbnVtUmVzdWx0QmxvY2tzKytdID0gbmV3IERhdGFCbG9jayhudW1EYXRhQ29kZXdvcmRzLCBuZXcgVWludDhBcnJheShudW1CbG9ja0NvZGV3b3JkcykpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGVjQmxvY2tBcnJheV8yXzEgJiYgIWVjQmxvY2tBcnJheV8yXzEuZG9uZSAmJiAoX2IgPSBlY0Jsb2NrQXJyYXlfMi5yZXR1cm4pKSBfYi5jYWxsKGVjQmxvY2tBcnJheV8yKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8yKSB0aHJvdyBlXzIuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICAvLyBBbGwgYmxvY2tzIGhhdmUgdGhlIHNhbWUgYW1vdW50IG9mIGRhdGEsIGV4Y2VwdCB0aGF0IHRoZSBsYXN0IG4KCSAgICAgICAgLy8gKHdoZXJlIG4gbWF5IGJlIDApIGhhdmUgMSBtb3JlIGJ5dGUuIEZpZ3VyZSBvdXQgd2hlcmUgdGhlc2Ugc3RhcnQuCgkgICAgICAgIHZhciBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGxvbmdlckJsb2Nrc1N0YXJ0QXQgPSByZXN1bHQubGVuZ3RoIC0gMTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IGNoZWNrIGxlbmd0aCBpcyBjb3JyZWN0IGhlcmUKCSAgICAgICAgd2hpbGUgKGxvbmdlckJsb2Nrc1N0YXJ0QXQgPj0gMCkgewoJICAgICAgICAgICAgdmFyIG51bUNvZGV3b3JkcyA9IHJlc3VsdFtsb25nZXJCbG9ja3NTdGFydEF0XS5jb2Rld29yZHMubGVuZ3RoOwoJICAgICAgICAgICAgaWYgKG51bUNvZGV3b3JkcyA9PT0gc2hvcnRlckJsb2Nrc1RvdGFsQ29kZXdvcmRzKSB7CgkgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsb25nZXJCbG9ja3NTdGFydEF0LS07CgkgICAgICAgIH0KCSAgICAgICAgbG9uZ2VyQmxvY2tzU3RhcnRBdCsrOwoJICAgICAgICB2YXIgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHMgPSBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgLSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIC8vIFRoZSBsYXN0IGVsZW1lbnRzIG9mIHJlc3VsdCBtYXkgYmUgMSBlbGVtZW50IGxvbmdlcgoJICAgICAgICAvLyBmaXJzdCBmaWxsIG91dCBhcyBtYW55IGVsZW1lbnRzIGFzIGFsbCBvZiB0aGVtIGhhdmUKCSAgICAgICAgdmFyIHJhd0NvZGV3b3Jkc09mZnNldCA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBudW1SZXN1bHRCbG9ja3M7IGorKykgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaV0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIEZpbGwgb3V0IHRoZSBsYXN0IGRhdGEgYmxvY2sgaW4gdGhlIGxvbmdlciBvbmVzCgkgICAgICAgIGZvciAodmFyIGogPSBsb25nZXJCbG9ja3NTdGFydEF0OyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHNdID0gcmF3Q29kZXdvcmRzW3Jhd0NvZGV3b3Jkc09mZnNldCsrXTsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cgYWRkIGluIGVycm9yIGNvcnJlY3Rpb24gYmxvY2tzCgkgICAgICAgIHZhciBtYXggPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IHNob3J0ZXJCbG9ja3NOdW1EYXRhQ29kZXdvcmRzOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgaU9mZnNldCA9IGogPCBsb25nZXJCbG9ja3NTdGFydEF0ID8gaSA6IGkgKyAxOwoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaU9mZnNldF0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldE51bURhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bURhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldENvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29kZXdvcmRzOwoJICAgIH07CgkgICAgcmV0dXJuIERhdGFCbG9jazsKCX0oKSk7CglEYXRhQmxvY2skMS5kZWZhdWx0ID0gRGF0YUJsb2NrOwoKCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEgPSB7fTsKCgl2YXIgQml0U291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdFNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbiB7Ki8KCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIHByb3ZpZGVzIGFuIGVhc3kgYWJzdHJhY3Rpb24gdG8gcmVhZCBiaXRzIGF0IGEgdGltZSBmcm9tIGEgc2VxdWVuY2Ugb2YgYnl0ZXMsIHdoZXJlIHRoZQoJICogbnVtYmVyIG9mIGJpdHMgcmVhZCBpcyBub3Qgb2Z0ZW4gYSBtdWx0aXBsZSBvZiA4LjwvcD4KCSAqCgkgKiA8cD5UaGlzIGNsYXNzIGlzIHRocmVhZC1zYWZlIGJ1dCBub3QgcmVlbnRyYW50IC0tIHVubGVzcyB0aGUgY2FsbGVyIG1vZGlmaWVzIHRoZSBieXRlcyBhcnJheQoJICogaXQgcGFzc2VkIGluLCBpbiB3aGljaCBjYXNlIGFsbCBiZXRzIGFyZSBvZmYuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBCaXRTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJ5dGVzIGJ5dGVzIGZyb20gd2hpY2ggdGhpcyB3aWxsIHJlYWQgYml0cy4gQml0cyB3aWxsIGJlIHJlYWQgZnJvbSB0aGUgZmlyc3QgYnl0ZSBmaXJzdC4KCSAgICAgKiBCaXRzIGFyZSByZWFkIHdpdGhpbiBhIGJ5dGUgZnJvbSBtb3N0LXNpZ25pZmljYW50IHRvIGxlYXN0LXNpZ25pZmljYW50IGJpdC4KCSAgICAgKi8KCSAgICBmdW5jdGlvbiBCaXRTb3VyY2UoYnl0ZXMpIHsKCSAgICAgICAgdGhpcy5ieXRlcyA9IGJ5dGVzOwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSAwOwoJICAgICAgICB0aGlzLmJpdE9mZnNldCA9IDA7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaW5kZXggb2YgbmV4dCBiaXQgaW4gY3VycmVudCBieXRlIHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qml0T2Zmc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRPZmZzZXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgYnl0ZSBpbiBpbnB1dCBieXRlIGFycmF5IHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qnl0ZU9mZnNldCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYnl0ZU9mZnNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBudW1CaXRzIG51bWJlciBvZiBiaXRzIHRvIHJlYWQKCSAgICAgKiBAcmV0dXJuIGludCByZXByZXNlbnRpbmcgdGhlIGJpdHMgcmVhZC4gVGhlIGJpdHMgd2lsbCBhcHBlYXIgYXMgdGhlIGxlYXN0LXNpZ25pZmljYW50CgkgICAgICogICAgICAgICBiaXRzIG9mIHRoZSBpbnQKCSAgICAgKiBAdGhyb3dzIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZiBudW1CaXRzIGlzbid0IGluIFsxLDMyXSBvciBtb3JlIHRoYW4gaXMgYXZhaWxhYmxlCgkgICAgICovCgkgICAgQml0U291cmNlLnByb3RvdHlwZS5yZWFkQml0cyA9IGZ1bmN0aW9uIChudW1CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPCAxIHx8IG51bUJpdHMgPiAzMiB8fCBudW1CaXRzID4gdGhpcy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoJycgKyBudW1CaXRzKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVzdWx0ID0gMDsKCSAgICAgICAgdmFyIGJpdE9mZnNldCA9IHRoaXMuYml0T2Zmc2V0OwoJICAgICAgICB2YXIgYnl0ZU9mZnNldCA9IHRoaXMuYnl0ZU9mZnNldDsKCSAgICAgICAgdmFyIGJ5dGVzID0gdGhpcy5ieXRlczsKCSAgICAgICAgLy8gRmlyc3QsIHJlYWQgcmVtYWluZGVyIGZyb20gY3VycmVudCBieXRlCgkgICAgICAgIGlmIChiaXRPZmZzZXQgPiAwKSB7CgkgICAgICAgICAgICB2YXIgYml0c0xlZnQgPSA4IC0gYml0T2Zmc2V0OwoJICAgICAgICAgICAgdmFyIHRvUmVhZCA9IG51bUJpdHMgPCBiaXRzTGVmdCA/IG51bUJpdHMgOiBiaXRzTGVmdDsKCSAgICAgICAgICAgIHZhciBiaXRzVG9Ob3RSZWFkID0gYml0c0xlZnQgLSB0b1JlYWQ7CgkgICAgICAgICAgICB2YXIgbWFzayA9ICgweEZGID4+ICg4IC0gdG9SZWFkKSkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgIHJlc3VsdCA9IChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQ7CgkgICAgICAgICAgICBudW1CaXRzIC09IHRvUmVhZDsKCSAgICAgICAgICAgIGJpdE9mZnNldCArPSB0b1JlYWQ7CgkgICAgICAgICAgICBpZiAoYml0T2Zmc2V0ID09PSA4KSB7CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0ID0gMDsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTmV4dCByZWFkIHdob2xlIGJ5dGVzCgkgICAgICAgIGlmIChudW1CaXRzID4gMCkgewoJICAgICAgICAgICAgd2hpbGUgKG51bUJpdHMgPj0gOCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCA9IChyZXN1bHQgPDwgOCkgfCAoYnl0ZXNbYnl0ZU9mZnNldF0gJiAweEZGKTsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICAgICAgbnVtQml0cyAtPSA4OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gRmluYWxseSByZWFkIGEgcGFydGlhbCBieXRlCgkgICAgICAgICAgICBpZiAobnVtQml0cyA+IDApIHsKCSAgICAgICAgICAgICAgICB2YXIgYml0c1RvTm90UmVhZCA9IDggLSBudW1CaXRzOwoJICAgICAgICAgICAgICAgIHZhciBtYXNrID0gKDB4RkYgPj4gYml0c1RvTm90UmVhZCkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAocmVzdWx0IDw8IG51bUJpdHMpIHwgKChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQpOwoJICAgICAgICAgICAgICAgIGJpdE9mZnNldCArPSBudW1CaXRzOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0T2Zmc2V0ID0gYml0T2Zmc2V0OwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSBieXRlT2Zmc2V0OwoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB0aGF0IGNhbiBiZSByZWFkIHN1Y2Nlc3NmdWxseQoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuYXZhaWxhYmxlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gOCAqICh0aGlzLmJ5dGVzLmxlbmd0aCAtIHRoaXMuYnl0ZU9mZnNldCkgLSB0aGlzLmJpdE9mZnNldDsKCSAgICB9OwoJICAgIHJldHVybiBCaXRTb3VyY2U7Cgl9KCkpOwoJQml0U291cmNlJDEuZGVmYXVsdCA9IEJpdFNvdXJjZTsKCgl2YXIgRGVjb2RlclJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVyUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBtYXRyaXggb2YgYml0cy4gVGhpcyB0eXBpY2FsbHkKCSAqIGFwcGxpZXMgdG8gMkQgYmFyY29kZSBmb3JtYXRzLiBGb3Igbm93IGl0IGNvbnRhaW5zIHRoZSByYXcgYnl0ZXMgb2J0YWluZWQsCgkgKiBhcyB3ZWxsIGFzIGEgU3RyaW5nIGludGVycHJldGF0aW9uIG9mIHRob3NlIGJ5dGVzLCBpZiBhcHBsaWNhYmxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlclJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocmF3Qnl0ZXM6IFVpbnQ4QXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICAgICAgICAgdGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIExpc3Q8VWludDhBcnJheT4gYnl0ZVNlZ21lbnRzLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIFN0cmluZyBlY0xldmVsKSB7CgkgICAgLy8gICB0aGlzKHJhd0J5dGVzLCB0ZXh0LCBieXRlU2VnbWVudHMsIGVjTGV2ZWwsIC0xLCAtMSkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRGVjb2RlclJlc3VsdChyYXdCeXRlcywgdGV4dCwgYnl0ZVNlZ21lbnRzLCBlY0xldmVsLCBzdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXIsIHN0cnVjdHVyZWRBcHBlbmRQYXJpdHkpIHsKCSAgICAgICAgaWYgKHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9PT0gdm9pZCAwKSB7IHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9IC0xOyB9CgkgICAgICAgIGlmIChzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID09PSB2b2lkIDApIHsgc3RydWN0dXJlZEFwcGVuZFBhcml0eSA9IC0xOyB9CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDsKCSAgICAgICAgdGhpcy5ieXRlU2VnbWVudHMgPSBieXRlU2VnbWVudHM7CgkgICAgICAgIHRoaXMuZWNMZXZlbCA9IGVjTGV2ZWw7CgkgICAgICAgIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyOwoJICAgICAgICB0aGlzLnN0cnVjdHVyZWRBcHBlbmRQYXJpdHkgPSBzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCB8fCByYXdCeXRlcyA9PT0gbnVsbCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiByYXcgYnl0ZXMgcmVwcmVzZW50aW5nIHRoZSByZXN1bHQsIG9yIHtAY29kZSBudWxsfSBpZiBub3QgYXBwbGljYWJsZQoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldE51bUJpdHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bUJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gbnVtQml0cyBvdmVycmlkZXMgdGhlIG51bWJlciBvZiBiaXRzIHRoYXQgYXJlIHZhbGlkIGluIHtAbGluayAjZ2V0UmF3Qnl0ZXMoKX0KCSAgICAgKiBAc2luY2UgMy4zLjAKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXROdW1CaXRzID0gZnVuY3Rpb24gKG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLm51bUJpdHMgPSBudW1CaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0ZXh0IHJlcHJlc2VudGF0aW9uIG9mIHRoZSByZXN1bHQKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRUZXh0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50ZXh0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBsaXN0IG9mIGJ5dGUgc2VnbWVudHMgaW4gdGhlIHJlc3VsdCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0Qnl0ZVNlZ21lbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5ieXRlU2VnbWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG5hbWUgb2YgZXJyb3IgY29ycmVjdGlvbiBsZXZlbCB1c2VkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFQ0xldmVsID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0xldmVsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJyb3JzIGNvcnJlY3RlZCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0RXJyb3JzQ29ycmVjdGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvcnNDb3JyZWN0ZWQ7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcnJvcnNDb3JyZWN0ZWQgPSBmdW5jdGlvbiAoZXJyb3JzQ29ycmVjdGVkIC8qSW50ZWdlciovKSB7CgkgICAgICAgIHRoaXMuZXJyb3JzQ29ycmVjdGVkID0gZXJyb3JzQ29ycmVjdGVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJhc3VyZXMgY29ycmVjdGVkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFcmFzdXJlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJhc3VyZXM7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcmFzdXJlcyA9IGZ1bmN0aW9uIChlcmFzdXJlcyAvKkludGVnZXIqLykgewoJICAgICAgICB0aGlzLmVyYXN1cmVzID0gZXJhc3VyZXM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGFyYml0cmFyeSBhZGRpdGlvbmFsIG1ldGFkYXRhCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0T3RoZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuc2V0T3RoZXIgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdGhpcy5vdGhlciA9IG90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuaGFzU3RydWN0dXJlZEFwcGVuZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc3RydWN0dXJlZEFwcGVuZFBhcml0eSA+PSAwICYmIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID49IDA7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRTdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXI7CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlclJlc3VsdDsKCX0oKSk7CglEZWNvZGVyUmVzdWx0JDEuZGVmYXVsdCA9IERlY29kZXJSZXN1bHQ7CgoJdmFyIE1vZGUgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5Nb2RlVmFsdWVzID0gdm9pZCAwOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgTW9kZVZhbHVlczsKCShmdW5jdGlvbiAoTW9kZVZhbHVlcykgewoJICAgIE1vZGVWYWx1ZXNbTW9kZVZhbHVlc1siVEVSTUlOQVRPUiJdID0gMF0gPSAiVEVSTUlOQVRPUiI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJOVU1FUklDIl0gPSAxXSA9ICJOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkFMUEhBTlVNRVJJQyJdID0gMl0gPSAiQUxQSEFOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIlNUUlVDVFVSRURfQVBQRU5EIl0gPSAzXSA9ICJTVFJVQ1RVUkVEX0FQUEVORCI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJCWVRFIl0gPSA0XSA9ICJCWVRFIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkVDSSJdID0gNV0gPSAiRUNJIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIktBTkpJIl0gPSA2XSA9ICJLQU5KSSI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJGTkMxX0ZJUlNUX1BPU0lUSU9OIl0gPSA3XSA9ICJGTkMxX0ZJUlNUX1BPU0lUSU9OIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkZOQzFfU0VDT05EX1BPU0lUSU9OIl0gPSA4XSA9ICJGTkMxX1NFQ09ORF9QT1NJVElPTiI7CgkgICAgLyoqIFNlZSBHQlQgMTgyODQtMjAwMDsgIkhhbnppIiBpcyBhIHRyYW5zbGl0ZXJhdGlvbiBvZiB0aGlzIG1vZGUgbmFtZS4gKi8KCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkhBTlpJIl0gPSA5XSA9ICJIQU5aSSI7Cgl9KShNb2RlVmFsdWVzID0gZXhwb3J0cy5Nb2RlVmFsdWVzIHx8IChleHBvcnRzLk1vZGVWYWx1ZXMgPSB7fSkpOwoJLyoqCgkgKiA8cD5TZWUgSVNPIDE4MDA0OjIwMDYsIDYuNC4xLCBUYWJsZXMgMiBhbmQgMy4gVGhpcyBlbnVtIGVuY2Fwc3VsYXRlcyB0aGUgdmFyaW91cyBtb2RlcyBpbiB3aGljaAoJICogZGF0YSBjYW4gYmUgZW5jb2RlZCB0byBiaXRzIGluIHRoZSBRUiBjb2RlIHN0YW5kYXJkLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgTW9kZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBNb2RlKHZhbHVlLCBzdHJpbmdWYWx1ZSwgY2hhcmFjdGVyQ291bnRCaXRzRm9yVmVyc2lvbnMsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9ucyA9IGNoYXJhY3RlckNvdW50Qml0c0ZvclZlcnNpb25zOwoJICAgICAgICB0aGlzLmJpdHMgPSBiaXRzOwoJICAgICAgICBNb2RlLkZPUl9CSVRTLnNldChiaXRzLCB0aGlzKTsKCSAgICAgICAgTW9kZS5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgZm91ciBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSBkYXRhIG1vZGUKCSAgICAgKiBAcmV0dXJuIE1vZGUgZW5jb2RlZCBieSB0aGVzZSBiaXRzCgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYml0cyBkbyBub3QgY29ycmVzcG9uZCB0byBhIGtub3duIG1vZGUKCSAgICAgKi8KCSAgICBNb2RlLmZvckJpdHMgPSBmdW5jdGlvbiAoYml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBtb2RlID0gTW9kZS5GT1JfQklUUy5nZXQoYml0cyk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IG1vZGUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1vZGU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmVyc2lvbiB2ZXJzaW9uIGluIHF1ZXN0aW9uCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB1c2VkLCBpbiB0aGlzIFFSIENvZGUgc3ltYm9sIHtAbGluayBWZXJzaW9ufSwgdG8gZW5jb2RlIHRoZQoJICAgICAqICAgICAgICAgY291bnQgb2YgY2hhcmFjdGVycyB0aGF0IHdpbGwgZm9sbG93IGVuY29kZWQgaW4gdGhpcyBNb2RlCgkgICAgICovCgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Q2hhcmFjdGVyQ291bnRCaXRzID0gZnVuY3Rpb24gKHZlcnNpb24pIHsKCSAgICAgICAgdmFyIHZlcnNpb25OdW1iZXIgPSB2ZXJzaW9uLmdldFZlcnNpb25OdW1iZXIoKTsKCSAgICAgICAgdmFyIG9mZnNldDsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPD0gOSkgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmICh2ZXJzaW9uTnVtYmVyIDw9IDI2KSB7CgkgICAgICAgICAgICBvZmZzZXQgPSAxOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9uc1tvZmZzZXRdOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0VmFsdWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBNb2RlKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlID09PSBvdGhlci52YWx1ZTsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIE1vZGUuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5GT1JfVkFMVUUgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5URVJNSU5BVE9SID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5URVJNSU5BVE9SLCAnVEVSTUlOQVRPUicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDAwKTsgLy8gTm90IHJlYWxseSBhIG1vZGUuLi4KCSAgICBNb2RlLk5VTUVSSUMgPSBuZXcgTW9kZShNb2RlVmFsdWVzLk5VTUVSSUMsICdOVU1FUklDJywgSW50MzJBcnJheS5mcm9tKFsxMCwgMTIsIDE0XSksIDB4MDEpOwoJICAgIE1vZGUuQUxQSEFOVU1FUklDID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5BTFBIQU5VTUVSSUMsICdBTFBIQU5VTUVSSUMnLCBJbnQzMkFycmF5LmZyb20oWzksIDExLCAxM10pLCAweDAyKTsKCSAgICBNb2RlLlNUUlVDVFVSRURfQVBQRU5EID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5TVFJVQ1RVUkVEX0FQUEVORCwgJ1NUUlVDVFVSRURfQVBQRU5EJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDMpOyAvLyBOb3Qgc3VwcG9ydGVkCgkgICAgTW9kZS5CWVRFID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5CWVRFLCAnQllURScsIEludDMyQXJyYXkuZnJvbShbOCwgMTYsIDE2XSksIDB4MDQpOwoJICAgIE1vZGUuRUNJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5FQ0ksICdFQ0knLCBJbnQzMkFycmF5LmZyb20oWzAsIDAsIDBdKSwgMHgwNyk7IC8vIGNoYXJhY3RlciBjb3VudHMgZG9uJ3QgYXBwbHkKCSAgICBNb2RlLktBTkpJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5LQU5KSSwgJ0tBTkpJJywgSW50MzJBcnJheS5mcm9tKFs4LCAxMCwgMTJdKSwgMHgwOCk7CgkgICAgTW9kZS5GTkMxX0ZJUlNUX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX0ZJUlNUX1BPU0lUSU9OLCAnRk5DMV9GSVJTVF9QT1NJVElPTicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDA1KTsKCSAgICBNb2RlLkZOQzFfU0VDT05EX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX1NFQ09ORF9QT1NJVElPTiwgJ0ZOQzFfU0VDT05EX1BPU0lUSU9OJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDkpOwoJICAgIC8qKiBTZWUgR0JUIDE4Mjg0LTIwMDA7ICJIYW56aSIgaXMgYSB0cmFuc2xpdGVyYXRpb24gb2YgdGhpcyBtb2RlIG5hbWUuICovCgkgICAgTW9kZS5IQU5aSSA9IG5ldyBNb2RlKE1vZGVWYWx1ZXMuSEFOWkksICdIQU5aSScsIEludDMyQXJyYXkuZnJvbShbOCwgMTAsIDEyXSksIDB4MEQpOwoJICAgIHJldHVybiBNb2RlOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IE1vZGU7CgoJfShNb2RlKSk7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlLmRlY29kZXIgeyovCgl2YXIgQml0U291cmNlXzEgPSBCaXRTb3VyY2UkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSA9IENoYXJhY3RlclNldEVDSTsKCXZhciBEZWNvZGVyUmVzdWx0XzEgPSBEZWNvZGVyUmVzdWx0JDE7Cgl2YXIgU3RyaW5nVXRpbHNfMSA9IFN0cmluZ1V0aWxzJDE7Cgl2YXIgRm9ybWF0RXhjZXB0aW9uXzEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBTdHJpbmdCdWlsZGVyXzEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgU3RyaW5nRW5jb2RpbmdfMSA9IFN0cmluZ0VuY29kaW5nJDE7Cgl2YXIgTW9kZV8xID0gTW9kZTsKCS8qaW1wb3J0IGphdmEuaW8uVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbjsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlFSIENvZGVzIGNhbiBlbmNvZGUgdGV4dCBhcyBiaXRzIGluIG9uZSBvZiBzZXZlcmFsIG1vZGVzLCBhbmQgY2FuIHVzZSBtdWx0aXBsZSBtb2RlcwoJICogaW4gb25lIFFSIENvZGUuIFRoaXMgY2xhc3MgZGVjb2RlcyB0aGUgYml0cyBiYWNrIGludG8gdGV4dC48L3A+CgkgKgoJICogPHA+U2VlIElTTyAxODAwNDoyMDA2LCA2LjQuMyAtIDYuNC43PC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERlY29kZWRCaXRTdHJlYW1QYXJzZXIoKSB7CgkgICAgfQoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlID0gZnVuY3Rpb24gKGJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cykgewoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRTb3VyY2VfMS5kZWZhdWx0KGJ5dGVzKTsKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBTdHJpbmdCdWlsZGVyXzEuZGVmYXVsdCgpOwoJICAgICAgICB2YXIgYnl0ZVNlZ21lbnRzID0gbmV3IEFycmF5KCk7IC8vIDEKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IEkgZG8gbm90IHVzZSBjb25zdHJ1Y3RvciB3aXRoIHNpemUgMSBhcyBpbiBvcmlnaW5hbCBKYXZhIG1lYW5zIGNhcGFjaXR5IGFuZCB0aGUgYXJyYXkgbGVuZ3RoIGlzIGNoZWNrZWQgYmVsb3cKCSAgICAgICAgdmFyIHN5bWJvbFNlcXVlbmNlID0gLTE7CgkgICAgICAgIHZhciBwYXJpdHlEYXRhID0gLTE7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICB2YXIgY3VycmVudENoYXJhY3RlclNldEVDSSA9IG51bGw7CgkgICAgICAgICAgICB2YXIgZmMxSW5FZmZlY3QgPSBmYWxzZTsKCSAgICAgICAgICAgIHZhciBtb2RlID0gdm9pZCAwOwoJICAgICAgICAgICAgZG8gewoJICAgICAgICAgICAgICAgIC8vIFdoaWxlIHN0aWxsIGFub3RoZXIgc2VnbWVudCB0byByZWFkLi4uCgkgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA0KSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE9LLCBhc3N1bWUgd2UncmUgZG9uZS4gUmVhbGx5LCBhIFRFUk1JTkFUT1IgbW9kZSBzaG91bGQgaGF2ZSBiZWVuIHJlY29yZGVkIGhlcmUKCSAgICAgICAgICAgICAgICAgICAgbW9kZSA9IE1vZGVfMS5kZWZhdWx0LlRFUk1JTkFUT1I7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbW9kZUJpdHMgPSBiaXRzLnJlYWRCaXRzKDQpOwoJICAgICAgICAgICAgICAgICAgICBtb2RlID0gTW9kZV8xLmRlZmF1bHQuZm9yQml0cyhtb2RlQml0cyk7IC8vIG1vZGUgaXMgZW5jb2RlZCBieSA0IGJpdHMKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgc3dpdGNoIChtb2RlKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUjoKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkZOQzFfRklSU1RfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuRk5DMV9TRUNPTkRfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBkbyBsaXR0bGUgd2l0aCBGTkMxIGV4Y2VwdCBhbHRlciB0aGUgcGFyc2VkIHJlc3VsdCBhIGJpdCBhY2NvcmRpbmcgdG8gdGhlIHNwZWMKCSAgICAgICAgICAgICAgICAgICAgICAgIGZjMUluRWZmZWN0ID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LlNUUlVDVFVSRURfQVBQRU5EOgoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCAxNikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXF1ZW5jZSBudW1iZXIgYW5kIHBhcml0eSBpcyBhZGRlZCBsYXRlciB0byB0aGUgcmVzdWx0IG1ldGFkYXRhCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWFkIG5leHQgOCBiaXRzIChzeW1ib2wgc2VxdWVuY2UgIykgYW5kIDggYml0cyAoZGF0YTogcGFyaXR5KSwgdGhlbiBjb250aW51ZQoJICAgICAgICAgICAgICAgICAgICAgICAgc3ltYm9sU2VxdWVuY2UgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgcGFyaXR5RGF0YSA9IGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5FQ0k6CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDb3VudCBkb2Vzbid0IGFwcGx5IHRvIEVDSQoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5wYXJzZUVDSVZhbHVlKGJpdHMpOwoJICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudENoYXJhY3RlclNldEVDSSA9IENoYXJhY3RlclNldEVDSV8xLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlWYWx1ZSh2YWx1ZSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5IQU5aSToKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpcnN0IGhhbmRsZSBIYW56aSBtb2RlIHdoaWNoIGRvZXMgbm90IHN0YXJ0IHdpdGggY2hhcmFjdGVyIGNvdW50CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGluZXNlIG1vZGUgY29udGFpbnMgYSBzdWIgc2V0IGluZGljYXRvciByaWdodCBhZnRlciBtb2RlIGluZGljYXRvcgoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YnNldCA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291bnRIYW56aSA9IGJpdHMucmVhZEJpdHMobW9kZS5nZXRDaGFyYWN0ZXJDb3VudEJpdHModmVyc2lvbikpOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnNldCA9PT0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVIYW56aVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudEhhbnppKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gIk5vcm1hbCIgUVIgY29kZSBtb2RlczoKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhvdyBtYW55IGNoYXJhY3RlcnMgd2lsbCBmb2xsb3csIGVuY29kZWQgaW4gdGhpcyBtb2RlPwoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gYml0cy5yZWFkQml0cyhtb2RlLmdldENoYXJhY3RlckNvdW50Qml0cyh2ZXJzaW9uKSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKG1vZGUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0Lk5VTUVSSUM6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlTnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuQUxQSEFOVU1FUklDOgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgZmMxSW5FZmZlY3QpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkJZVEU6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgY3VycmVudENoYXJhY3RlclNldEVDSSwgYnl0ZVNlZ21lbnRzLCBoaW50cyk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuS0FOSkk6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlS2FuamlTZWdtZW50KGJpdHMsIHJlc3VsdCwgY291bnQpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSB3aGlsZSAobW9kZSAhPT0gTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUik7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlhZSAvKjogSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIGZyb20gcmVhZEJpdHMoKSBjYWxscwoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbmV3IERlY29kZXJSZXN1bHRfMS5kZWZhdWx0KGJ5dGVzLCByZXN1bHQudG9TdHJpbmcoKSwgYnl0ZVNlZ21lbnRzLmxlbmd0aCA9PT0gMCA/IG51bGwgOiBieXRlU2VnbWVudHMsIGVjTGV2ZWwgPT09IG51bGwgPyBudWxsIDogZWNMZXZlbC50b1N0cmluZygpLCBzeW1ib2xTZXF1ZW5jZSwgcGFyaXR5RGF0YSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZWUgc3BlY2lmaWNhdGlvbiBHQlQgMTgyODQtMjAwMAoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlSGFuemlTZWdtZW50ID0gZnVuY3Rpb24gKGJpdHMsIHJlc3VsdCwgY291bnQgLyppbnQqLykgewoJICAgICAgICAvLyBEb24ndCBjcmFzaCB0cnlpbmcgdG8gcmVhZCBtb3JlIGJpdHMgdGhhbiB3ZSBoYXZlIGF2YWlsYWJsZS4KCSAgICAgICAgaWYgKGNvdW50ICogMTMgPiBiaXRzLmF2YWlsYWJsZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhY2ggY2hhcmFjdGVyIHdpbGwgcmVxdWlyZSAyIGJ5dGVzLiBSZWFkIHRoZSBjaGFyYWN0ZXJzIGFzIDItYnl0ZSBwYWlycwoJICAgICAgICAvLyBhbmQgZGVjb2RlIGFzIEdCMjMxMiBhZnRlcndhcmRzCgkgICAgICAgIHZhciBidWZmZXIgPSBuZXcgVWludDhBcnJheSgyICogY291bnQpOwoJICAgICAgICB2YXIgb2Zmc2V0ID0gMDsKCSAgICAgICAgd2hpbGUgKGNvdW50ID4gMCkgewoJICAgICAgICAgICAgLy8gRWFjaCAxMyBiaXRzIGVuY29kZXMgYSAyLWJ5dGUgY2hhcmFjdGVyCgkgICAgICAgICAgICB2YXIgdHdvQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDEzKTsKCSAgICAgICAgICAgIHZhciBhc3NlbWJsZWRUd29CeXRlcyA9ICgoKHR3b0J5dGVzIC8gMHgwNjApIDw8IDgpICYgMHhGRkZGRkZGRikgfCAodHdvQnl0ZXMgJSAweDA2MCk7CgkgICAgICAgICAgICBpZiAoYXNzZW1ibGVkVHdvQnl0ZXMgPCAweDAwM0JGKSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QTFBMSB0byAweEFBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBMUExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QjBBMSB0byAweEZBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBNkExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYnVmZmVyW29mZnNldF0gPSAvKihieXRlKSAqLyAoKGFzc2VtYmxlZFR3b0J5dGVzID4+IDgpICYgMHhGRik7CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0ICsgMV0gPSAvKihieXRlKSAqLyAoYXNzZW1ibGVkVHdvQnl0ZXMgJiAweEZGKTsKCSAgICAgICAgICAgIG9mZnNldCArPSAyOwoJICAgICAgICAgICAgY291bnQtLTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKGJ1ZmZlciwgU3RyaW5nVXRpbHNfMS5kZWZhdWx0LkdCMjMxMikpOwoJICAgICAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IFRPRE86IGltcGxlbWVudCBHQjIzMTIgZGVjb2RlLiBTdHJpbmdWaWV3IGZyb20gTUROIGNvdWxkIGJlIGEgc3RhcnRpbmcgcG9pbnQKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVLYW5qaVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoY291bnQgKiAxMyA+IGJpdHMuYXZhaWxhYmxlKCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRWFjaCBjaGFyYWN0ZXIgd2lsbCByZXF1aXJlIDIgYnl0ZXMuIFJlYWQgdGhlIGNoYXJhY3RlcnMgYXMgMi1ieXRlIHBhaXJzCgkgICAgICAgIC8vIGFuZCBkZWNvZGUgYXMgU2hpZnRfSklTIGFmdGVyd2FyZHMKCSAgICAgICAgdmFyIGJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KDIgKiBjb3VudCk7CgkgICAgICAgIHZhciBvZmZzZXQgPSAwOwoJICAgICAgICB3aGlsZSAoY291bnQgPiAwKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEzIGJpdHMgZW5jb2RlcyBhIDItYnl0ZSBjaGFyYWN0ZXIKCSAgICAgICAgICAgIHZhciB0d29CeXRlcyA9IGJpdHMucmVhZEJpdHMoMTMpOwoJICAgICAgICAgICAgdmFyIGFzc2VtYmxlZFR3b0J5dGVzID0gKCgodHdvQnl0ZXMgLyAweDBDMCkgPDwgOCkgJiAweEZGRkZGRkZGKSB8ICh0d29CeXRlcyAlIDB4MEMwKTsKCSAgICAgICAgICAgIGlmIChhc3NlbWJsZWRUd29CeXRlcyA8IDB4MDFGMDApIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHg4MTQwIHRvIDB4OUZGQyByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MDgxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHhFMDQwIHRvIDB4RUJCRiByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MEMxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0XSA9IC8qKGJ5dGUpICovIChhc3NlbWJsZWRUd29CeXRlcyA+PiA4KTsKCSAgICAgICAgICAgIGJ1ZmZlcltvZmZzZXQgKyAxXSA9IC8qKGJ5dGUpICovIGFzc2VtYmxlZFR3b0J5dGVzOwoJICAgICAgICAgICAgb2Zmc2V0ICs9IDI7CgkgICAgICAgICAgICBjb3VudC0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNoaWZ0X0pJUyBtYXkgbm90IGJlIHN1cHBvcnRlZCBpbiBzb21lIGVudmlyb25tZW50czoKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoU3RyaW5nRW5jb2RpbmdfMS5kZWZhdWx0LmRlY29kZShidWZmZXIsIFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5TSElGVF9KSVMpKTsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBUT0RPOiBpbXBsZW1lbnQgU0hJRlRfSklTIGRlY29kZS4gU3RyaW5nVmlldyBmcm9tIE1ETiBjb3VsZCBiZSBhIHN0YXJ0aW5nIHBvaW50CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IFVuc3VwcG9ydGVkRW5jb2RpbmdFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoaWdub3JlZCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLCBieXRlU2VnbWVudHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoOCAqIGNvdW50ID4gYml0cy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVhZEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoY291bnQpOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKCSAgICAgICAgICAgIHJlYWRCeXRlc1tpXSA9IC8qKGJ5dGUpICovIGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVuY29kaW5nOwoJICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgLy8gVGhlIHNwZWMgaXNuJ3QgY2xlYXIgb24gdGhpcyBtb2RlOyBzZWUKCSAgICAgICAgICAgIC8vIHNlY3Rpb24gNi40LjU6IHQgZG9lcyBub3Qgc2F5IHdoaWNoIGVuY29kaW5nIHRvIGFzc3VtaW5nCgkgICAgICAgICAgICAvLyB1cG9uIGRlY29kaW5nLiBJIGhhdmUgc2VlbiBJU08tODg1OS0xIHVzZWQgYXMgd2VsbCBhcwoJICAgICAgICAgICAgLy8gU2hpZnRfSklTIC0tIHdpdGhvdXQgYW55dGhpbmcgbGlrZSBhbiBFQ0kgZGVzaWduYXRvciB0bwoJICAgICAgICAgICAgLy8gZ2l2ZSBhIGhpbnQuCgkgICAgICAgICAgICBlbmNvZGluZyA9IFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5ndWVzc0VuY29kaW5nKHJlYWRCeXRlcywgaGludHMpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgZW5jb2RpbmcgPSBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLmdldE5hbWUoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKHJlYWRCeXRlcywgZW5jb2RpbmcpKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgICAgICBieXRlU2VnbWVudHMucHVzaChyZWFkQnl0ZXMpOwoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPj0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5BTFBIQU5VTUVSSUNfQ0hBUlMubGVuZ3RoKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLkFMUEhBTlVNRVJJQ19DSEFSU1t2YWx1ZV07CgkgICAgfTsKCSAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBmYzFJbkVmZmVjdCkgewoJICAgICAgICAvLyBSZWFkIHR3byBjaGFyYWN0ZXJzIGF0IGEgdGltZQoJICAgICAgICB2YXIgc3RhcnQgPSByZXN1bHQubGVuZ3RoKCk7CgkgICAgICAgIHdoaWxlIChjb3VudCA+IDEpIHsKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTEpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIG5leHRUd29DaGFyc0JpdHMgPSBiaXRzLnJlYWRCaXRzKDExKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcihuZXh0VHdvQ2hhcnNCaXRzIC8gNDUpKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKG5leHRUd29DaGFyc0JpdHMgJSA0NSkpOwoJICAgICAgICAgICAgY291bnQgLT0gMjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY291bnQgPT09IDEpIHsKCSAgICAgICAgICAgIC8vIHNwZWNpYWwgY2FzZTogb25lIGNoYXJhY3RlciBsZWZ0CgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDYpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcihiaXRzLnJlYWRCaXRzKDYpKSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gU2VlIHNlY3Rpb24gNi40LjguMSwgNi40LjguMgoJICAgICAgICBpZiAoZmMxSW5FZmZlY3QpIHsKCSAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gbWFzc2FnZSB0aGUgcmVzdWx0IGEgYml0IGlmIGluIGFuIEZOQzEgbW9kZToKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IHJlc3VsdC5sZW5ndGgoKTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jaGFyQXQoaSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IHJlc3VsdC5sZW5ndGgoKSAtIDEgJiYgcmVzdWx0LmNoYXJBdChpICsgMSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gJSUgaXMgcmVuZGVyZWQgYXMgJQoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmRlbGV0ZUNoYXJBdChpICsgMSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbiBhbHBoYSBtb2RlLCAlIHNob3VsZCBiZSBjb252ZXJ0ZWQgdG8gRk5DMSBzZXBhcmF0b3IgMHgxRAoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnNldENoYXJBdChpLCBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4MUQpKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVOdW1lcmljU2VnbWVudCA9IGZ1bmN0aW9uIChiaXRzLCByZXN1bHQsIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgLy8gUmVhZCB0aHJlZSBkaWdpdHMgYXQgYSB0aW1lCgkgICAgICAgIHdoaWxlIChjb3VudCA+PSAzKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEwIGJpdHMgZW5jb2RlcyB0aHJlZSBkaWdpdHMKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTApIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIHRocmVlRGlnaXRzQml0cyA9IGJpdHMucmVhZEJpdHMoMTApOwoJICAgICAgICAgICAgaWYgKHRocmVlRGlnaXRzQml0cyA+PSAxMDAwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcih0aHJlZURpZ2l0c0JpdHMgLyAxMDApKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodGhyZWVEaWdpdHNCaXRzIC8gMTApICUgMTApKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIodGhyZWVEaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgICAgIGNvdW50IC09IDM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvdW50ID09PSAyKSB7CgkgICAgICAgICAgICAvLyBUd28gZGlnaXRzIGxlZnQgb3ZlciB0byByZWFkLCBlbmNvZGVkIGluIDcgYml0cwoJICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA3KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciB0d29EaWdpdHNCaXRzID0gYml0cy5yZWFkQml0cyg3KTsKCSAgICAgICAgICAgIGlmICh0d29EaWdpdHNCaXRzID49IDEwMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodHdvRGlnaXRzQml0cyAvIDEwKSkpOwoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcih0d29EaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChjb3VudCA9PT0gMSkgewoJICAgICAgICAgICAgLy8gT25lIGRpZ2l0IGxlZnQgb3ZlciB0byByZWFkCgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIGRpZ2l0Qml0cyA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICBpZiAoZGlnaXRCaXRzID49IDEwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoZGlnaXRCaXRzKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIucGFyc2VFQ0lWYWx1ZSA9IGZ1bmN0aW9uIChiaXRzKSB7CgkgICAgICAgIHZhciBmaXJzdEJ5dGUgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4ODApID09PSAwKSB7CgkgICAgICAgICAgICAvLyBqdXN0IG9uZSBieXRlCgkgICAgICAgICAgICByZXR1cm4gZmlyc3RCeXRlICYgMHg3RjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4QzApID09PSAweDgwKSB7CgkgICAgICAgICAgICAvLyB0d28gYnl0ZXMKCSAgICAgICAgICAgIHZhciBzZWNvbmRCeXRlID0gYml0cy5yZWFkQml0cyg4KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDNGKSA8PCA4KSAmIDB4RkZGRkZGRkYpIHwgc2Vjb25kQnl0ZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4RTApID09PSAweEMwKSB7CgkgICAgICAgICAgICAvLyB0aHJlZSBieXRlcwoJICAgICAgICAgICAgdmFyIHNlY29uZFRoaXJkQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDE2KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDFGKSA8PCAxNikgJiAweEZGRkZGRkZGKSB8IHNlY29uZFRoaXJkQnl0ZXM7CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFNlZSBJU08gMTgwMDQ6MjAwNiwgNi40LjQgVGFibGUgNQoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuQUxQSEFOVU1FUklDX0NIQVJTID0gJzAxMjM0NTY3ODlBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWiAkJSorLS4vOic7CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUID0gMTsKCSAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcjsKCX0oKSk7CglEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEuZGVmYXVsdCA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXI7CgoJdmFyIFFSQ29kZURlY29kZXJNZXRhRGF0YSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDEzIFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShRUkNvZGVEZWNvZGVyTWV0YURhdGEkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiBNZXRhLWRhdGEgY29udGFpbmVyIGZvciBRUiBDb2RlIGRlY29kaW5nLiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBtYXkgYmUgdXNlZCB0byBjb252ZXkgaW5mb3JtYXRpb24gYmFjayB0byB0aGUKCSAqIGRlY29kaW5nIGNhbGxlci4gQ2FsbGVycyBhcmUgZXhwZWN0ZWQgdG8gcHJvY2VzcyB0aGlzLgoJICoKCSAqIEBzZWUgY29tLmdvb2dsZS56eGluZy5jb21tb24uRGVjb2RlclJlc3VsdCNnZXRPdGhlcigpCgkgKi8KCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUVJDb2RlRGVjb2Rlck1ldGFEYXRhKG1pcnJvcmVkKSB7CgkgICAgICAgIHRoaXMubWlycm9yZWQgPSBtaXJyb3JlZDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBRUiBDb2RlIHdhcyBtaXJyb3JlZC4KCSAgICAgKi8KCSAgICBRUkNvZGVEZWNvZGVyTWV0YURhdGEucHJvdG90eXBlLmlzTWlycm9yZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm1pcnJvcmVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbHkgdGhlIHJlc3VsdCBwb2ludHMnIG9yZGVyIGNvcnJlY3Rpb24gZHVlIHRvIG1pcnJvcmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBwb2ludHMgQXJyYXkgb2YgcG9pbnRzIHRvIGFwcGx5IG1pcnJvciBjb3JyZWN0aW9uIHRvLgoJICAgICAqLwoJICAgIFFSQ29kZURlY29kZXJNZXRhRGF0YS5wcm90b3R5cGUuYXBwbHlNaXJyb3JlZENvcnJlY3Rpb24gPSBmdW5jdGlvbiAocG9pbnRzKSB7CgkgICAgICAgIGlmICghdGhpcy5taXJyb3JlZCB8fCBwb2ludHMgPT09IG51bGwgfHwgcG9pbnRzLmxlbmd0aCA8IDMpIHsKCSAgICAgICAgICAgIHJldHVybjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IHBvaW50c1swXTsKCSAgICAgICAgcG9pbnRzWzBdID0gcG9pbnRzWzJdOwoJICAgICAgICBwb2ludHNbMl0gPSBib3R0b21MZWZ0OwoJICAgICAgICAvLyBObyBuZWVkIHRvICdmaXgnIHRvcC1sZWZ0IGFuZCBhbGlnbm1lbnQgcGF0dGVybi4KCSAgICB9OwoJICAgIHJldHVybiBRUkNvZGVEZWNvZGVyTWV0YURhdGE7Cgl9KCkpOwoJUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDEuZGVmYXVsdCA9IFFSQ29kZURlY29kZXJNZXRhRGF0YTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVjb2RlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZWNvZGVyIHsqLwoJdmFyIENoZWNrc3VtRXhjZXB0aW9uXzEgPSBDaGVja3N1bUV4Y2VwdGlvbiQxOwoJdmFyIEJpdE1hdHJpeF8xJDIgPSBCaXRNYXRyaXgkMTsKCXZhciBHZW5lcmljR0ZfMSA9IEdlbmVyaWNHRiQxOwoJdmFyIFJlZWRTb2xvbW9uRGVjb2Rlcl8xID0gUmVlZFNvbG9tb25EZWNvZGVyJDE7Cgl2YXIgQml0TWF0cml4UGFyc2VyXzEgPSBCaXRNYXRyaXhQYXJzZXIkMTsKCXZhciBEYXRhQmxvY2tfMSA9IERhdGFCbG9jayQxOwoJdmFyIERlY29kZWRCaXRTdHJlYW1QYXJzZXJfMSA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxID0gUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoZSBtYWluIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgUVIgQ29kZSBkZWNvZGluZyAtLSBhcyBvcHBvc2VkIHRvIGxvY2F0aW5nIGFuZCBleHRyYWN0aW5nCgkgKiB0aGUgUVIgQ29kZSBmcm9tIGFuIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEZWNvZGVyKCkgewoJICAgICAgICB0aGlzLnJzRGVjb2RlciA9IG5ldyBSZWVkU29sb21vbkRlY29kZXJfMS5kZWZhdWx0KEdlbmVyaWNHRl8xLmRlZmF1bHQuUVJfQ09ERV9GSUVMRF8yNTYpOwoJICAgIH0KCSAgICAvLyBwdWJsaWMgZGVjb2RlKGltYWdlOiBib29sZWFuW11bXSk6IERlY29kZXJSZXN1bHQgLyp0aHJvd3MgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkNvbnZlbmllbmNlIG1ldGhvZCB0aGF0IGNhbiBkZWNvZGUgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEgMkQgYXJyYXkgb2YgYm9vbGVhbnMuCgkgICAgICogInRydWUiIGlzIHRha2VuIHRvIG1lYW4gYSBibGFjayBtb2R1bGUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGJvb2xlYW5zIHJlcHJlc2VudGluZyB3aGl0ZS9ibGFjayBRUiBDb2RlIG1vZHVsZXMKCSAgICAgKiBAcGFyYW0gaGludHMgZGVjb2RpbmcgaGludHMgdGhhdCBzaG91bGQgYmUgdXNlZCB0byBpbmZsdWVuY2UgZGVjb2RpbmcKCSAgICAgKiBAcmV0dXJuIHRleHQgYW5kIGJ5dGVzIGVuY29kZWQgd2l0aGluIHRoZSBRUiBDb2RlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgdGhlIFFSIENvZGUgY2Fubm90IGJlIGRlY29kZWQKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCb29sZWFuQXJyYXkgPSBmdW5jdGlvbiAoaW1hZ2UsIGhpbnRzKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeChCaXRNYXRyaXhfMSQyLmRlZmF1bHQucGFyc2VGcm9tQm9vbGVhbkFycmF5KGltYWdlKSwgaGludHMpOwoJICAgIH07CgkgICAgLy8gcHVibGljIGRlY29kZUJpdE1hdHJpeChiaXRzOiBCaXRNYXRyaXgpOiBEZWNvZGVyUmVzdWx0IC8qdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uLCBGb3JtYXRFeGNlcHRpb24qLyB7CgkgICAgLy8gICByZXR1cm4gZGVjb2RlKGJpdHMsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkRlY29kZXMgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0uIEEgMSBvciAidHJ1ZSIgaXMgdGFrZW4gdG8gbWVhbiBhIGJsYWNrIG1vZHVsZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0cyBib29sZWFucyByZXByZXNlbnRpbmcgd2hpdGUvYmxhY2sgUVIgQ29kZSBtb2R1bGVzCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kaW5nIGhpbnRzIHRoYXQgc2hvdWxkIGJlIHVzZWQgdG8gaW5mbHVlbmNlIGRlY29kaW5nCgkgICAgICogQHJldHVybiB0ZXh0IGFuZCBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBRUiBDb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgRGVjb2Rlci5wcm90b3R5cGUuZGVjb2RlQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIENvbnN0cnVjdCBhIHBhcnNlciBhbmQgcmVhZCB2ZXJzaW9uLCBlcnJvci1jb3JyZWN0aW9uIGxldmVsCgkgICAgICAgIHZhciBwYXJzZXIgPSBuZXcgQml0TWF0cml4UGFyc2VyXzEuZGVmYXVsdChiaXRzKTsKCSAgICAgICAgdmFyIGV4ID0gbnVsbDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKjogRm9ybWF0RXhjZXB0aW9uLCBDaGVja3N1bUV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICBleCA9IGU7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIC8vIFJldmVydCB0aGUgYml0IG1hdHJpeAoJICAgICAgICAgICAgcGFyc2VyLnJlbWFzaygpOwoJICAgICAgICAgICAgLy8gV2lsbCBiZSBhdHRlbXB0aW5nIGEgbWlycm9yZWQgcmVhZGluZyBvZiB0aGUgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm8uCgkgICAgICAgICAgICBwYXJzZXIuc2V0TWlycm9yKHRydWUpOwoJICAgICAgICAgICAgLy8gUHJlZW1wdGl2ZWx5IHJlYWQgdGhlIHZlcnNpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgICAgIC8vIFByZWVtcHRpdmVseSByZWFkIHRoZSBmb3JtYXQgaW5mb3JtYXRpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCk7CgkgICAgICAgICAgICAvKgoJICAgICAgICAgICAgICogU2luY2Ugd2UncmUgaGVyZSwgdGhpcyBtZWFucyB3ZSBoYXZlIHN1Y2Nlc3NmdWxseSBkZXRlY3RlZCBzb21lIGtpbmQKCSAgICAgICAgICAgICAqIG9mIHZlcnNpb24gYW5kIGZvcm1hdCBpbmZvcm1hdGlvbiB3aGVuIG1pcnJvcmVkLiBUaGlzIGlzIGEgZ29vZCBzaWduLAoJICAgICAgICAgICAgICogdGhhdCB0aGUgUVIgY29kZSBtYXkgYmUgbWlycm9yZWQsIGFuZCB3ZSBzaG91bGQgdHJ5IG9uY2UgbW9yZSB3aXRoIGEKCSAgICAgICAgICAgICAqIG1pcnJvcmVkIGNvbnRlbnQuCgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIFByZXBhcmUgZm9yIGEgbWlycm9yZWQgcmVhZGluZy4KCSAgICAgICAgICAgIHBhcnNlci5taXJyb3IoKTsKCSAgICAgICAgICAgIHZhciByZXN1bHQgPSB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgICAgIC8vIFN1Y2Nlc3MhIE5vdGlmeSB0aGUgY2FsbGVyIHRoYXQgdGhlIGNvZGUgd2FzIG1pcnJvcmVkLgoJICAgICAgICAgICAgcmVzdWx0LnNldE90aGVyKG5ldyBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxLmRlZmF1bHQodHJ1ZSkpOwoJICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKkZvcm1hdEV4Y2VwdGlvbiB8IENoZWNrc3VtRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIFRocm93IHRoZSBleGNlcHRpb24gZnJvbSB0aGUgb3JpZ2luYWwgcmVhZGluZwoJICAgICAgICAgICAgaWYgKGV4ICE9PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgZXg7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0aHJvdyBlOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCaXRNYXRyaXhQYXJzZXIgPSBmdW5jdGlvbiAocGFyc2VyLCBoaW50cykgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgdmFyIHZlcnNpb24gPSBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCkuZ2V0RXJyb3JDb3JyZWN0aW9uTGV2ZWwoKTsKCSAgICAgICAgLy8gUmVhZCBjb2Rld29yZHMKCSAgICAgICAgdmFyIGNvZGV3b3JkcyA9IHBhcnNlci5yZWFkQ29kZXdvcmRzKCk7CgkgICAgICAgIC8vIFNlcGFyYXRlIGludG8gZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIGRhdGFCbG9ja3MgPSBEYXRhQmxvY2tfMS5kZWZhdWx0LmdldERhdGFCbG9ja3MoY29kZXdvcmRzLCB2ZXJzaW9uLCBlY0xldmVsKTsKCSAgICAgICAgLy8gQ291bnQgdG90YWwgbnVtYmVyIG9mIGRhdGEgYnl0ZXMKCSAgICAgICAgdmFyIHRvdGFsQnl0ZXMgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZGF0YUJsb2Nrc18xID0gX192YWx1ZXMkMihkYXRhQmxvY2tzKSwgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpOyAhZGF0YUJsb2Nrc18xXzEuZG9uZTsgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRhdGFCbG9jayA9IGRhdGFCbG9ja3NfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIHRvdGFsQnl0ZXMgKz0gZGF0YUJsb2NrLmdldE51bURhdGFDb2Rld29yZHMoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMV8xICYmICFkYXRhQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGRhdGFCbG9ja3NfMS5yZXR1cm4pKSBfYS5jYWxsKGRhdGFCbG9ja3NfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkodG90YWxCeXRlcyk7CgkgICAgICAgIHZhciByZXN1bHRPZmZzZXQgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgLy8gRXJyb3ItY29ycmVjdCBhbmQgY29weSBkYXRhIGJsb2NrcyB0b2dldGhlciBpbnRvIGEgc3RyZWFtIG9mIGJ5dGVzCgkgICAgICAgICAgICBmb3IgKHZhciBkYXRhQmxvY2tzXzIgPSBfX3ZhbHVlcyQyKGRhdGFCbG9ja3MpLCBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCk7ICFkYXRhQmxvY2tzXzJfMS5kb25lOyBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZGF0YUJsb2NrID0gZGF0YUJsb2Nrc18yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdmFyIGNvZGV3b3JkQnl0ZXMgPSBkYXRhQmxvY2suZ2V0Q29kZXdvcmRzKCk7CgkgICAgICAgICAgICAgICAgdmFyIG51bURhdGFDb2Rld29yZHMgPSBkYXRhQmxvY2suZ2V0TnVtRGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgIHRoaXMuY29ycmVjdEVycm9ycyhjb2Rld29yZEJ5dGVzLCBudW1EYXRhQ29kZXdvcmRzKTsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG51bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICByZXN1bHRCeXRlc1tyZXN1bHRPZmZzZXQrK10gPSBjb2Rld29yZEJ5dGVzW2ldOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMl8xICYmICFkYXRhQmxvY2tzXzJfMS5kb25lICYmIChfYiA9IGRhdGFCbG9ja3NfMi5yZXR1cm4pKSBfYi5jYWxsKGRhdGFCbG9ja3NfMik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRGVjb2RlIHRoZSBjb250ZW50cyBvZiB0aGF0IHN0cmVhbSBvZiBieXRlcwoJICAgICAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcl8xLmRlZmF1bHQuZGVjb2RlKHJlc3VsdEJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5HaXZlbiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyByZWNlaXZlZCwgcG9zc2libHkgY29ycnVwdGVkIGJ5IGVycm9ycywgYXR0ZW1wdHMgdG8KCSAgICAgKiBjb3JyZWN0IHRoZSBlcnJvcnMgaW4tcGxhY2UgdXNpbmcgUmVlZC1Tb2xvbW9uIGVycm9yIGNvcnJlY3Rpb24uPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGNvZGV3b3JkQnl0ZXMgZGF0YSBhbmQgZXJyb3IgY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgKiBAcGFyYW0gbnVtRGF0YUNvZGV3b3JkcyBudW1iZXIgb2YgY29kZXdvcmRzIHRoYXQgYXJlIGRhdGEgYnl0ZXMKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5jb3JyZWN0RXJyb3JzID0gZnVuY3Rpb24gKGNvZGV3b3JkQnl0ZXMsIG51bURhdGFDb2Rld29yZHMgLyppbnQqLykgewoJICAgICAgICAvLyBjb25zdCBudW1Db2Rld29yZHMgPSBjb2Rld29yZEJ5dGVzLmxlbmd0aDsKCSAgICAgICAgLy8gRmlyc3QgcmVhZCBpbnRvIGFuIGFycmF5IG9mIGludHMKCSAgICAgICAgdmFyIGNvZGV3b3Jkc0ludHMgPSBuZXcgSW50MzJBcnJheShjb2Rld29yZEJ5dGVzKTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG5vdCByZWFseSBuZWNlc3NhcnkgdG8gdHJhbnNmb3JtIHRvIGludHM/IGNvdWxkIHJlZGVzaWduIGV2ZXJ5dGhpbmcgdG8gd29yayB3aXRoIHVuc2lnbmVkIGJ5dGVzPwoJICAgICAgICAvLyBjb25zdCBjb2Rld29yZHNJbnRzID0gbmV3IEludDMyQXJyYXkobnVtQ29kZXdvcmRzKQoJICAgICAgICAvLyBmb3IgKGxldCBpID0gMDsgaSA8IG51bUNvZGV3b3JkczsgaSsrKSB7CgkgICAgICAgIC8vICAgY29kZXdvcmRzSW50c1tpXSA9IGNvZGV3b3JkQnl0ZXNbaV0gJiAweEZGCgkgICAgICAgIC8vIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHRoaXMucnNEZWNvZGVyLmRlY29kZShjb2Rld29yZHNJbnRzLCBjb2Rld29yZEJ5dGVzLmxlbmd0aCAtIG51bURhdGFDb2Rld29yZHMpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChpZ25vcmVkIC8qOiBSZWVkU29sb21vbkV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQ2hlY2tzdW1FeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29weSBiYWNrIGludG8gYXJyYXkgb2YgYnl0ZXMgLS0gb25seSBuZWVkIHRvIHdvcnJ5IGFib3V0IHRoZSBieXRlcyB0aGF0IHdlcmUgZGF0YQoJICAgICAgICAvLyBXZSBkb24ndCBjYXJlIGFib3V0IGVycm9ycyBpbiB0aGUgZXJyb3ItY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1EYXRhQ29kZXdvcmRzOyBpKyspIHsKCSAgICAgICAgICAgIGNvZGV3b3JkQnl0ZXNbaV0gPSAvKihieXRlKSAqLyBjb2Rld29yZHNJbnRzW2ldOwoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlcjsKCX0oKSk7CglEZWNvZGVyJDEuZGVmYXVsdCA9IERlY29kZXI7CgoJdmFyIERldGVjdG9yJDEgPSB7fTsKCgl2YXIgTWF0aFV0aWxzJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMTIgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KE1hdGhVdGlscyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5kZXRlY3RvciB7Ki8KCS8qKgoJICogR2VuZXJhbCBtYXRoLXJlbGF0ZWQgYW5kIG51bWVyaWMgdXRpbGl0eSBmdW5jdGlvbnMuCgkgKi8KCXZhciBNYXRoVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gTWF0aFV0aWxzKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBFbmRzIHVwIGJlaW5nIGEgYml0IGZhc3RlciB0aGFuIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0uIFRoaXMgbWVyZWx5IHJvdW5kcyBpdHMKCSAgICAgKiBhcmd1bWVudCB0byB0aGUgbmVhcmVzdCBpbnQsIHdoZXJlIHguNSByb3VuZHMgdXAgdG8geCsxLiBTZW1hbnRpY3Mgb2YgdGhpcyBzaG9ydGN1dAoJICAgICAqIGRpZmZlciBzbGlnaHRseSBmcm9tIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0gaW4gdGhhdCBoYWxmIHJvdW5kcyBkb3duIGZvciBuZWdhdGl2ZQoJICAgICAqIHZhbHVlcy4gLTIuNSByb3VuZHMgdG8gLTMsIG5vdCAtMi4gRm9yIHB1cnBvc2VzIGhlcmUgaXQgbWFrZXMgbm8gZGlmZmVyZW5jZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBkIHJlYWwgdmFsdWUgdG8gcm91bmQKCSAgICAgKiBAcmV0dXJuIG5lYXJlc3Qge0Bjb2RlIGludH0KCSAgICAgKi8KCSAgICBNYXRoVXRpbHMucm91bmQgPSBmdW5jdGlvbiAoZCAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE5hTiA9PT0gZCkKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICBpZiAoZCA8PSBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUikKCSAgICAgICAgICAgIHJldHVybiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUjsKCSAgICAgICAgaWYgKGQgPj0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIpCgkgICAgICAgICAgICByZXR1cm4gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHJldHVybiAvKihpbnQpICovIChkICsgKGQgPCAwLjAgPyAtMC41IDogMC41KSkgfCAwOwoJICAgIH07CgkgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG1heWJlIHJlbW92ZSByb3VuZCBtZXRob2QgYW5kIGNhbGwgZGlyZWN0bHkgTWF0aC5yb3VuZCwgaXQgbG9va3MgbGlrZSBpdCBkb2Vzbid0IG1ha2Ugc2Vuc2UgZm9yIGpzCgkgICAgLyoqCgkgICAgICogQHBhcmFtIGFYIHBvaW50IEEgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGFZIHBvaW50IEEgeSBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJYIHBvaW50IEIgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJZIHBvaW50IEIgeSBjb29yZGluYXRlCgkgICAgICogQHJldHVybiBFdWNsaWRlYW4gZGlzdGFuY2UgYmV0d2VlbiBwb2ludHMgQSBhbmQgQgoJICAgICAqLwoJICAgIE1hdGhVdGlscy5kaXN0YW5jZSA9IGZ1bmN0aW9uIChhWCAvKmZsb2F0fGludCovLCBhWSAvKmZsb2F0fGludCovLCBiWCAvKmZsb2F0fGludCovLCBiWSAvKmZsb2F0fGludCovKSB7CgkgICAgICAgIHZhciB4RGlmZiA9IGFYIC0gYlg7CgkgICAgICAgIHZhciB5RGlmZiA9IGFZIC0gYlk7CgkgICAgICAgIHJldHVybiAvKihmbG9hdCkgKi8gTWF0aC5zcXJ0KHhEaWZmICogeERpZmYgKyB5RGlmZiAqIHlEaWZmKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBhWCBwb2ludCBBIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBhWSBwb2ludCBBIHkgY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWCBwb2ludCBCIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWSBwb2ludCBCIHkgY29vcmRpbmF0ZQoJICAgICAqIEByZXR1cm4gRXVjbGlkZWFuIGRpc3RhbmNlIGJldHdlZW4gcG9pbnRzIEEgYW5kIEIKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgc3RhdGljIGRpc3RhbmNlKGFYOiBudW1iZXIgLyppbnQqLywgYVk6IG51bWJlciAvKmludCovLCBiWDogbnVtYmVyIC8qaW50Ki8sIGJZOiBudW1iZXIgLyppbnQqLyk6IGZsb2F0IHsKCSAgICAvLyAgIGNvbnN0IHhEaWZmID0gYVggLSBiWAoJICAgIC8vICAgY29uc3QgeURpZmYgPSBhWSAtIGJZCgkgICAgLy8gICByZXR1cm4gKGZsb2F0KSBNYXRoLnNxcnQoeERpZmYgKiB4RGlmZiArIHlEaWZmICogeURpZmYpOwoJICAgIC8vIH0KCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYXJyYXkgdmFsdWVzIHRvIHN1bQoJICAgICAqIEByZXR1cm4gc3VtIG9mIHZhbHVlcyBpbiBhcnJheQoJICAgICAqLwoJICAgIE1hdGhVdGlscy5zdW0gPSBmdW5jdGlvbiAoYXJyYXkpIHsKCSAgICAgICAgdmFyIGNvdW50ID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gYXJyYXkubGVuZ3RoOyBpICE9PSBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgYSA9IGFycmF5W2ldOwoJICAgICAgICAgICAgY291bnQgKz0gYTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY291bnQ7CgkgICAgfTsKCSAgICByZXR1cm4gTWF0aFV0aWxzOwoJfSgpKTsKCU1hdGhVdGlscyQxLmRlZmF1bHQgPSBNYXRoVXRpbHM7CgoJdmFyIERldGVjdG9yUmVzdWx0JDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERldGVjdG9yUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGV0ZWN0aW5nIGEgYmFyY29kZSBpbiBhbiBpbWFnZS4gVGhpcyBpbmNsdWRlcyB0aGUgcmF3CgkgKiBtYXRyaXggb2YgYmxhY2svd2hpdGUgcGl4ZWxzIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGJhcmNvZGUsIGFuZCBwb3NzaWJseSBwb2ludHMgb2YgaW50ZXJlc3QKCSAqIGluIHRoZSBpbWFnZSwgbGlrZSB0aGUgbG9jYXRpb24gb2YgZmluZGVyIHBhdHRlcm5zIG9yIGNvcm5lcnMgb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGV0ZWN0b3JSZXN1bHQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gRGV0ZWN0b3JSZXN1bHQoYml0cywgcG9pbnRzKSB7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIHRoaXMucG9pbnRzID0gcG9pbnRzOwoJICAgIH0KCSAgICBEZXRlY3RvclJlc3VsdC5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIERldGVjdG9yUmVzdWx0LnByb3RvdHlwZS5nZXRQb2ludHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnBvaW50czsKCSAgICB9OwoJICAgIHJldHVybiBEZXRlY3RvclJlc3VsdDsKCX0oKSk7CglEZXRlY3RvclJlc3VsdCQxLmRlZmF1bHQgPSBEZXRlY3RvclJlc3VsdDsKCgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSQxID0ge307CgoJdmFyIERlZmF1bHRHcmlkU2FtcGxlciQxID0ge307CgoJdmFyIEdyaWRTYW1wbGVyJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDUgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBJbXBsZW1lbnRhdGlvbnMgb2YgdGhpcyBjbGFzcyBjYW4sIGdpdmVuIGxvY2F0aW9ucyBvZiBmaW5kZXIgcGF0dGVybnMgZm9yIGEgUVIgY29kZSBpbiBhbgoJICogaW1hZ2UsIHNhbXBsZSB0aGUgcmlnaHQgcG9pbnRzIGluIHRoZSBpbWFnZSB0byByZWNvbnN0cnVjdCB0aGUgUVIgY29kZSwgYWNjb3VudGluZyBmb3IKCSAqIHBlcnNwZWN0aXZlIGRpc3RvcnRpb24uIEl0IGlzIGFic3RyYWN0ZWQgc2luY2UgaXQgaXMgcmVsYXRpdmVseSBleHBlbnNpdmUgYW5kIHNob3VsZCBiZSBhbGxvd2VkCgkgKiB0byB0YWtlIGFkdmFudGFnZSBvZiBwbGF0Zm9ybS1zcGVjaWZpYyBvcHRpbWl6ZWQgaW1wbGVtZW50YXRpb25zLCBsaWtlIFN1bidzIEphdmEgQWR2YW5jZWQKCSAqIEltYWdpbmcgbGlicmFyeSwgYnV0IHdoaWNoIG1heSBub3QgYmUgYXZhaWxhYmxlIGluIG90aGVyIGVudmlyb25tZW50cyBzdWNoIGFzIEoyTUUsIGFuZCB2aWNlCgkgKiB2ZXJzYS4KCSAqCgkgKiBUaGUgaW1wbGVtZW50YXRpb24gdXNlZCBjYW4gYmUgY29udHJvbGxlZCBieSBjYWxsaW5nIHtAbGluayAjc2V0R3JpZFNhbXBsZXIoR3JpZFNhbXBsZXIpfQoJICogd2l0aCBhbiBpbnN0YW5jZSBvZiBhIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgdGhpcyBpbnRlcmZhY2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdyaWRTYW1wbGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEdyaWRTYW1wbGVyKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5DaGVja3MgYSBzZXQgb2YgcG9pbnRzIHRoYXQgaGF2ZSBiZWVuIHRyYW5zZm9ybWVkIHRvIHNhbXBsZSBwb2ludHMgb24gYW4gaW1hZ2UgYWdhaW5zdAoJICAgICAqIHRoZSBpbWFnZSdzIGRpbWVuc2lvbnMgdG8gc2VlIGlmIHRoZSBwb2ludCBhcmUgZXZlbiB3aXRoaW4gdGhlIGltYWdlLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHdpbGwgYWN0dWFsbHkgIm51ZGdlIiB0aGUgZW5kcG9pbnRzIGJhY2sgb250byB0aGUgaW1hZ2UgaWYgdGhleSBhcmUgZm91bmQgdG8gYmUKCSAgICAgKiBiYXJlbHkgKGxlc3MgdGhhbiAxIHBpeGVsKSBvZmYgdGhlIGltYWdlLiBUaGlzIGFjY291bnRzIGZvciBpbXBlcmZlY3QgZGV0ZWN0aW9uIG9mIGZpbmRlcgoJICAgICAqIHBhdHRlcm5zIGluIGFuIGltYWdlIHdoZXJlIHRoZSBRUiBDb2RlIHJ1bnMgYWxsIHRoZSB3YXkgdG8gdGhlIGltYWdlIGJvcmRlci48L3A+CgkgICAgICoKCSAgICAgKiA8cD5Gb3IgZWZmaWNpZW5jeSwgdGhlIG1ldGhvZCB3aWxsIGNoZWNrIHBvaW50cyBmcm9tIGVpdGhlciBlbmQgb2YgdGhlIGxpbmUgdW50aWwgb25lIGlzIGZvdW5kCgkgICAgICogdG8gYmUgd2l0aGluIHRoZSBpbWFnZS4gQmVjYXVzZSB0aGUgc2V0IG9mIHBvaW50cyBhcmUgYXNzdW1lZCB0byBiZSBsaW5lYXIsIHRoaXMgaXMgdmFsaWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGltYWdlIGludG8gd2hpY2ggdGhlIHBvaW50cyBzaG91bGQgbWFwCgkgICAgICogQHBhcmFtIHBvaW50cyBhY3R1YWwgcG9pbnRzIGluIHgxLHkxLC4uLix4bix5biBmb3JtCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhbiBlbmRwb2ludCBpcyBsaWVzIG91dHNpZGUgdGhlIGltYWdlIGJvdW5kYXJpZXMKCSAgICAgKi8KCSAgICBHcmlkU2FtcGxlci5jaGVja0FuZE51ZGdlUG9pbnRzID0gZnVuY3Rpb24gKGltYWdlLCBwb2ludHMpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gc3RhcnQgdW50aWwgd2Ugc2VlIHNvbWUgdGhhdCBhcmUgT0s6CgkgICAgICAgIHZhciBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSAwOyBvZmZzZXQgPCBwb2ludHMubGVuZ3RoICYmIG51ZGdlZDsgb2Zmc2V0ICs9IDIpIHsKCSAgICAgICAgICAgIHZhciB4ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0XSk7CgkgICAgICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IocG9pbnRzW29mZnNldCArIDFdKTsKCSAgICAgICAgICAgIGlmICh4IDwgLTEgfHwgeCA+IHdpZHRoIHx8IHkgPCAtMSB8fCB5ID4gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBudWRnZWQgPSBmYWxzZTsKCSAgICAgICAgICAgIGlmICh4ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gMC4wOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmICh4ID09PSB3aWR0aCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gd2lkdGggLSAxOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAoeSA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICBwb2ludHNbb2Zmc2V0ICsgMV0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IGhlaWdodCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gZW5kOgoJICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSBwb2ludHMubGVuZ3RoIC0gMjsgb2Zmc2V0ID49IDAgJiYgbnVkZ2VkOyBvZmZzZXQgLT0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBNYXRoLmZsb29yKHBvaW50c1tvZmZzZXRdKTsKCSAgICAgICAgICAgIHZhciB5ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0ICsgMV0pOwoJICAgICAgICAgICAgaWYgKHggPCAtMSB8fCB4ID4gd2lkdGggfHwgeSA8IC0xIHx8IHkgPiBoZWlnaHQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ1LmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIG51ZGdlZCA9IGZhbHNlOwoJICAgICAgICAgICAgaWYgKHggPT09IC0xKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHggPT09IHdpZHRoKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSB3aWR0aCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmICh5ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IDAuMDsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoeSA9PT0gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldCArIDFdID0gaGVpZ2h0IC0gMTsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXI7Cgl9KCkpOwoJR3JpZFNhbXBsZXIkMS5kZWZhdWx0ID0gR3JpZFNhbXBsZXI7CgoJdmFyIFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGltcGxlbWVudHMgYSBwZXJzcGVjdGl2ZSB0cmFuc2Zvcm0gaW4gdHdvIGRpbWVuc2lvbnMuIEdpdmVuIGZvdXIgc291cmNlIGFuZCBmb3VyCgkgKiBkZXN0aW5hdGlvbiBwb2ludHMsIGl0IHdpbGwgY29tcHV0ZSB0aGUgdHJhbnNmb3JtYXRpb24gaW1wbGllZCBiZXR3ZWVuIHRoZW0uIFRoZSBjb2RlIGlzIGJhc2VkCgkgKiBkaXJlY3RseSB1cG9uIHNlY3Rpb24gMy40LjIgb2YgR2VvcmdlIFdvbGJlcmcncyAiRGlnaXRhbCBJbWFnZSBXYXJwaW5nIjsgc2VlIHBhZ2VzIDU0LTU2LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUGVyc3BlY3RpdmVUcmFuc2Zvcm0oYTExIC8qZmxvYXQqLywgYTIxIC8qZmxvYXQqLywgYTMxIC8qZmxvYXQqLywgYTEyIC8qZmxvYXQqLywgYTIyIC8qZmxvYXQqLywgYTMyIC8qZmxvYXQqLywgYTEzIC8qZmxvYXQqLywgYTIzIC8qZmxvYXQqLywgYTMzIC8qZmxvYXQqLykgewoJICAgICAgICB0aGlzLmExMSA9IGExMTsKCSAgICAgICAgdGhpcy5hMjEgPSBhMjE7CgkgICAgICAgIHRoaXMuYTMxID0gYTMxOwoJICAgICAgICB0aGlzLmExMiA9IGExMjsKCSAgICAgICAgdGhpcy5hMjIgPSBhMjI7CgkgICAgICAgIHRoaXMuYTMyID0gYTMyOwoJICAgICAgICB0aGlzLmExMyA9IGExMzsKCSAgICAgICAgdGhpcy5hMjMgPSBhMjM7CgkgICAgICAgIHRoaXMuYTMzID0gYTMzOwoJICAgIH0KCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsID0gZnVuY3Rpb24gKHgwIC8qZmxvYXQqLywgeTAgLypmbG9hdCovLCB4MSAvKmZsb2F0Ki8sIHkxIC8qZmxvYXQqLywgeDIgLypmbG9hdCovLCB5MiAvKmZsb2F0Ki8sIHgzIC8qZmxvYXQqLywgeTMgLypmbG9hdCovLCB4MHAgLypmbG9hdCovLCB5MHAgLypmbG9hdCovLCB4MXAgLypmbG9hdCovLCB5MXAgLypmbG9hdCovLCB4MnAgLypmbG9hdCovLCB5MnAgLypmbG9hdCovLCB4M3AgLypmbG9hdCovLCB5M3AgLypmbG9hdCovKSB7CgkgICAgICAgIHZhciBxVG9TID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0ucXVhZHJpbGF0ZXJhbFRvU3F1YXJlKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5Myk7CgkgICAgICAgIHZhciBzVG9RID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwcCwgeTBwLCB4MXAsIHkxcCwgeDJwLCB5MnAsIHgzcCwgeTNwKTsKCSAgICAgICAgcmV0dXJuIHNUb1EudGltZXMocVRvUyk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUudHJhbnNmb3JtUG9pbnRzID0gZnVuY3Rpb24gKHBvaW50cykgewoJICAgICAgICB2YXIgbWF4ID0gcG9pbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkgKz0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBwb2ludHNbaV07CgkgICAgICAgICAgICB2YXIgeSA9IHBvaW50c1tpICsgMV07CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSBhMTMgKiB4ICsgYTIzICogeSArIGEzMzsKCSAgICAgICAgICAgIHBvaW50c1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHBvaW50c1tpICsgMV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50cmFuc2Zvcm1Qb2ludHNXaXRoVmFsdWVzID0gZnVuY3Rpb24gKHhWYWx1ZXMsIHlWYWx1ZXMpIHsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgdmFyIG4gPSB4VmFsdWVzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB4ID0geFZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciB5ID0geVZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciBkZW5vbWluYXRvciA9IGExMyAqIHggKyBhMjMgKiB5ICsgYTMzOwoJICAgICAgICAgICAgeFZhbHVlc1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHlWYWx1ZXNbaV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnNxdWFyZVRvUXVhZHJpbGF0ZXJhbCA9IGZ1bmN0aW9uICh4MCAvKmZsb2F0Ki8sIHkwIC8qZmxvYXQqLywgeDEgLypmbG9hdCovLCB5MSAvKmZsb2F0Ki8sIHgyIC8qZmxvYXQqLywgeTIgLypmbG9hdCovLCB4MyAvKmZsb2F0Ki8sIHkzIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgZHgzID0geDAgLSB4MSArIHgyIC0geDM7CgkgICAgICAgIHZhciBkeTMgPSB5MCAtIHkxICsgeTIgLSB5MzsKCSAgICAgICAgaWYgKGR4MyA9PT0gMC4wICYmIGR5MyA9PT0gMC4wKSB7CgkgICAgICAgICAgICAvLyBBZmZpbmUKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCwgeDIgLSB4MSwgeDAsIHkxIC0geTAsIHkyIC0geTEsIHkwLCAwLjAsIDAuMCwgMS4wKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHZhciBkeDEgPSB4MSAtIHgyOwoJICAgICAgICAgICAgdmFyIGR4MiA9IHgzIC0geDI7CgkgICAgICAgICAgICB2YXIgZHkxID0geTEgLSB5MjsKCSAgICAgICAgICAgIHZhciBkeTIgPSB5MyAtIHkyOwoJICAgICAgICAgICAgdmFyIGRlbm9taW5hdG9yID0gZHgxICogZHkyIC0gZHgyICogZHkxOwoJICAgICAgICAgICAgdmFyIGExMyA9IChkeDMgKiBkeTIgLSBkeDIgKiBkeTMpIC8gZGVub21pbmF0b3I7CgkgICAgICAgICAgICB2YXIgYTIzID0gKGR4MSAqIGR5MyAtIGR4MyAqIGR5MSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCArIGExMyAqIHgxLCB4MyAtIHgwICsgYTIzICogeDMsIHgwLCB5MSAtIHkwICsgYTEzICogeTEsIHkzIC0geTAgKyBhMjMgKiB5MywgeTAsIGExMywgYTIzLCAxLjApOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9TcXVhcmUgPSBmdW5jdGlvbiAoeDAgLypmbG9hdCovLCB5MCAvKmZsb2F0Ki8sIHgxIC8qZmxvYXQqLywgeTEgLypmbG9hdCovLCB4MiAvKmZsb2F0Ki8sIHkyIC8qZmxvYXQqLywgeDMgLypmbG9hdCovLCB5MyAvKmZsb2F0Ki8pIHsKCSAgICAgICAgLy8gSGVyZSwgdGhlIGFkam9pbnQgc2VydmVzIGFzIHRoZSBpbnZlcnNlOgoJICAgICAgICByZXR1cm4gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5MykuYnVpbGRBZGpvaW50KCk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUuYnVpbGRBZGpvaW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBBZGpvaW50IGlzIHRoZSB0cmFuc3Bvc2Ugb2YgdGhlIGNvZmFjdG9yIG1hdHJpeDoKCSAgICAgICAgcmV0dXJuIG5ldyBQZXJzcGVjdGl2ZVRyYW5zZm9ybSh0aGlzLmEyMiAqIHRoaXMuYTMzIC0gdGhpcy5hMjMgKiB0aGlzLmEzMiwgdGhpcy5hMjMgKiB0aGlzLmEzMSAtIHRoaXMuYTIxICogdGhpcy5hMzMsIHRoaXMuYTIxICogdGhpcy5hMzIgLSB0aGlzLmEyMiAqIHRoaXMuYTMxLCB0aGlzLmExMyAqIHRoaXMuYTMyIC0gdGhpcy5hMTIgKiB0aGlzLmEzMywgdGhpcy5hMTEgKiB0aGlzLmEzMyAtIHRoaXMuYTEzICogdGhpcy5hMzEsIHRoaXMuYTEyICogdGhpcy5hMzEgLSB0aGlzLmExMSAqIHRoaXMuYTMyLCB0aGlzLmExMiAqIHRoaXMuYTIzIC0gdGhpcy5hMTMgKiB0aGlzLmEyMiwgdGhpcy5hMTMgKiB0aGlzLmEyMSAtIHRoaXMuYTExICogdGhpcy5hMjMsIHRoaXMuYTExICogdGhpcy5hMjIgLSB0aGlzLmExMiAqIHRoaXMuYTIxKTsKCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50aW1lcyA9IGZ1bmN0aW9uIChvdGhlcikgewoJICAgICAgICByZXR1cm4gbmV3IFBlcnNwZWN0aXZlVHJhbnNmb3JtKHRoaXMuYTExICogb3RoZXIuYTExICsgdGhpcy5hMjEgKiBvdGhlci5hMTIgKyB0aGlzLmEzMSAqIG90aGVyLmExMywgdGhpcy5hMTEgKiBvdGhlci5hMjEgKyB0aGlzLmEyMSAqIG90aGVyLmEyMiArIHRoaXMuYTMxICogb3RoZXIuYTIzLCB0aGlzLmExMSAqIG90aGVyLmEzMSArIHRoaXMuYTIxICogb3RoZXIuYTMyICsgdGhpcy5hMzEgKiBvdGhlci5hMzMsIHRoaXMuYTEyICogb3RoZXIuYTExICsgdGhpcy5hMjIgKiBvdGhlci5hMTIgKyB0aGlzLmEzMiAqIG90aGVyLmExMywgdGhpcy5hMTIgKiBvdGhlci5hMjEgKyB0aGlzLmEyMiAqIG90aGVyLmEyMiArIHRoaXMuYTMyICogb3RoZXIuYTIzLCB0aGlzLmExMiAqIG90aGVyLmEzMSArIHRoaXMuYTIyICogb3RoZXIuYTMyICsgdGhpcy5hMzIgKiBvdGhlci5hMzMsIHRoaXMuYTEzICogb3RoZXIuYTExICsgdGhpcy5hMjMgKiBvdGhlci5hMTIgKyB0aGlzLmEzMyAqIG90aGVyLmExMywgdGhpcy5hMTMgKiBvdGhlci5hMjEgKyB0aGlzLmEyMyAqIG90aGVyLmEyMiArIHRoaXMuYTMzICogb3RoZXIuYTIzLCB0aGlzLmExMyAqIG90aGVyLmEzMSArIHRoaXMuYTIzICogb3RoZXIuYTMyICsgdGhpcy5hMzMgKiBvdGhlci5hMzMpOwoJICAgIH07CgkgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoJfSgpKTsKCVBlcnNwZWN0aXZlVHJhbnNmb3JtJDEuZGVmYXVsdCA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVmYXVsdEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEdyaWRTYW1wbGVyXzEgPSBHcmlkU2FtcGxlciQxOwoJdmFyIEJpdE1hdHJpeF8xJDEgPSBCaXRNYXRyaXgkMTsKCXZhciBQZXJzcGVjdGl2ZVRyYW5zZm9ybV8xJDEgPSBQZXJzcGVjdGl2ZVRyYW5zZm9ybSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEkNCA9IE5vdEZvdW5kRXhjZXB0aW9uJDE7CgkvKioKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWZhdWx0R3JpZFNhbXBsZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDIoRGVmYXVsdEdyaWRTYW1wbGVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIERlZmF1bHRHcmlkU2FtcGxlcigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgRGVmYXVsdEdyaWRTYW1wbGVyLnByb3RvdHlwZS5zYW1wbGVHcmlkID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgcDFUb1ggLypmbG9hdCovLCBwMVRvWSAvKmZsb2F0Ki8sIHAyVG9YIC8qZmxvYXQqLywgcDJUb1kgLypmbG9hdCovLCBwM1RvWCAvKmZsb2F0Ki8sIHAzVG9ZIC8qZmxvYXQqLywgcDRUb1ggLypmbG9hdCovLCBwNFRvWSAvKmZsb2F0Ki8sIHAxRnJvbVggLypmbG9hdCovLCBwMUZyb21ZIC8qZmxvYXQqLywgcDJGcm9tWCAvKmZsb2F0Ki8sIHAyRnJvbVkgLypmbG9hdCovLCBwM0Zyb21YIC8qZmxvYXQqLywgcDNGcm9tWSAvKmZsb2F0Ki8sIHA0RnJvbVggLypmbG9hdCovLCBwNEZyb21ZIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSQxLmRlZmF1bHQucXVhZHJpbGF0ZXJhbFRvUXVhZHJpbGF0ZXJhbChwMVRvWCwgcDFUb1ksIHAyVG9YLCBwMlRvWSwgcDNUb1gsIHAzVG9ZLCBwNFRvWCwgcDRUb1ksIHAxRnJvbVgsIHAxRnJvbVksIHAyRnJvbVgsIHAyRnJvbVksIHAzRnJvbVgsIHAzRnJvbVksIHA0RnJvbVgsIHA0RnJvbVkpOwoJICAgICAgICByZXR1cm4gdGhpcy5zYW1wbGVHcmlkV2l0aFRyYW5zZm9ybShpbWFnZSwgZGltZW5zaW9uWCwgZGltZW5zaW9uWSwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBEZWZhdWx0R3JpZFNhbXBsZXIucHJvdG90eXBlLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgdHJhbnNmb3JtKSB7CgkgICAgICAgIGlmIChkaW1lbnNpb25YIDw9IDAgfHwgZGltZW5zaW9uWSA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMSQxLmRlZmF1bHQoZGltZW5zaW9uWCwgZGltZW5zaW9uWSk7CgkgICAgICAgIHZhciBwb2ludHMgPSBuZXcgRmxvYXQzMkFycmF5KDIgKiBkaW1lbnNpb25YKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBkaW1lbnNpb25ZOyB5KyspIHsKCSAgICAgICAgICAgIHZhciBtYXggPSBwb2ludHMubGVuZ3RoOwoJICAgICAgICAgICAgdmFyIGlWYWx1ZSA9IHkgKyAwLjU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1heDsgeCArPSAyKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW3hdID0gKHggLyAyKSArIDAuNTsKCSAgICAgICAgICAgICAgICBwb2ludHNbeCArIDFdID0gaVZhbHVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdHJhbnNmb3JtLnRyYW5zZm9ybVBvaW50cyhwb2ludHMpOwoJICAgICAgICAgICAgLy8gUXVpY2sgY2hlY2sgdG8gc2VlIGlmIHBvaW50cyB0cmFuc2Zvcm1lZCB0byBzb21ldGhpbmcgaW5zaWRlIHRoZSBpbWFnZQoJICAgICAgICAgICAgLy8gc3VmZmljaWVudCB0byBjaGVjayB0aGUgZW5kcG9pbnRzCgkgICAgICAgICAgICBHcmlkU2FtcGxlcl8xLmRlZmF1bHQuY2hlY2tBbmROdWRnZVBvaW50cyhpbWFnZSwgcG9pbnRzKTsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHggKz0gMikgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KE1hdGguZmxvb3IocG9pbnRzW3hdKSwgTWF0aC5mbG9vcihwb2ludHNbeCArIDFdKSkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJsYWNrKC1pc2gpIHBpeGVsCgkgICAgICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4IC8gMiwgeSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoYWlvb2JlIC8qOiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgICAgIC8vIFRoaXMgZmVlbHMgd3JvbmcsIGJ1dCwgc29tZXRpbWVzIGlmIHRoZSBmaW5kZXIgcGF0dGVybnMgYXJlIG1pc2lkZW50aWZpZWQsIHRoZSByZXN1bHRpbmcKCSAgICAgICAgICAgICAgICAvLyB0cmFuc2Zvcm0gZ2V0cyAidHdpc3RlZCIgc3VjaCB0aGF0IGl0IG1hcHMgYSBzdHJhaWdodCBsaW5lIG9mIHBvaW50cyB0byBhIHNldCBvZiBwb2ludHMKCSAgICAgICAgICAgICAgICAvLyB3aG9zZSBlbmRwb2ludHMgYXJlIGluIGJvdW5kcywgYnV0IG90aGVycyBhcmUgbm90LiBUaGVyZSBpcyBwcm9iYWJseSBzb21lIG1hdGhlbWF0aWNhbAoJICAgICAgICAgICAgICAgIC8vIHdheSB0byBkZXRlY3QgdGhpcyBhYm91dCB0aGUgdHJhbnNmb3JtYXRpb24gdGhhdCBJIGRvbid0IGtub3cgeWV0LgoJICAgICAgICAgICAgICAgIC8vIFRoaXMgcmVzdWx0cyBpbiBhbiB1Z2x5IHJ1bnRpbWUgZXhjZXB0aW9uIGRlc3BpdGUgb3VyIGNsZXZlciBjaGVja3MgYWJvdmUgLS0gY2FuJ3QgaGF2ZQoJICAgICAgICAgICAgICAgIC8vIHRoYXQuIFdlIGNvdWxkIGNoZWNrIGVhY2ggcG9pbnQncyBjb29yZGluYXRlcyBidXQgdGhhdCBmZWVscyBkdXBsaWNhdGl2ZS4gV2Ugc2V0dGxlIGZvcgoJICAgICAgICAgICAgICAgIC8vIGNhdGNoaW5nIGFuZCB3cmFwcGluZyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24uCgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNC5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICByZXR1cm4gRGVmYXVsdEdyaWRTYW1wbGVyOwoJfShHcmlkU2FtcGxlcl8xLmRlZmF1bHQpKTsKCURlZmF1bHRHcmlkU2FtcGxlciQxLmRlZmF1bHQgPSBEZWZhdWx0R3JpZFNhbXBsZXI7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVySW5zdGFuY2UkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIERlZmF1bHRHcmlkU2FtcGxlcl8xID0gRGVmYXVsdEdyaWRTYW1wbGVyJDE7Cgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBHcmlkU2FtcGxlckluc3RhbmNlKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBTZXRzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiBHcmlkU2FtcGxlciB1c2VkIGJ5IHRoZSBsaWJyYXJ5LiBPbmUgZ2xvYmFsCgkgICAgICogaW5zdGFuY2UgaXMgc3RvcmVkLCB3aGljaCBtYXkgc291bmQgcHJvYmxlbWF0aWMuIEJ1dCwgdGhlIGltcGxlbWVudGF0aW9uIHByb3ZpZGVkCgkgICAgICogb3VnaHQgdG8gYmUgYXBwcm9wcmlhdGUgZm9yIHRoZSBlbnRpcmUgcGxhdGZvcm0sIGFuZCBhbGwgdXNlcyBvZiB0aGlzIGxpYnJhcnkKCSAgICAgKiBpbiB0aGUgd2hvbGUgbGlmZXRpbWUgb2YgdGhlIEpWTS4gRm9yIGluc3RhbmNlLCBhbiBBbmRyb2lkIGFjdGl2aXR5IGNhbiBzd2FwIGluCgkgICAgICogYW4gaW1wbGVtZW50YXRpb24gdGhhdCB0YWtlcyBhZHZhbnRhZ2Ugb2YgbmF0aXZlIHBsYXRmb3JtIGxpYnJhcmllcy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBuZXdHcmlkU2FtcGxlciBUaGUgcGxhdGZvcm0tc3BlY2lmaWMgb2JqZWN0IHRvIGluc3RhbGwuCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5zZXRHcmlkU2FtcGxlciA9IGZ1bmN0aW9uIChuZXdHcmlkU2FtcGxlcikgewoJICAgICAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3R3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSBjdXJyZW50IGltcGxlbWVudGF0aW9uIG9mIEdyaWRTYW1wbGVyCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5nZXRJbnN0YW5jZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIEdyaWRTYW1wbGVySW5zdGFuY2UuZ3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3IERlZmF1bHRHcmlkU2FtcGxlcl8xLmRlZmF1bHQoKTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXJJbnN0YW5jZTsKCX0oKSk7CglHcmlkU2FtcGxlckluc3RhbmNlJDEuZGVmYXVsdCA9IEdyaWRTYW1wbGVySW5zdGFuY2U7CgoJdmFyIFJlc3VsdFBvaW50JDEgPSB7fTsKCgl2YXIgRmxvYXQkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGbG9hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIFBvbnlmaWxsIGZvciBKYXZhJ3MgRmxvYXQgY2xhc3MuCgkgKi8KCXZhciBGbG9hdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBGbG9hdCgpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogU2luY1RTIGhhcyBubyBkaWZmZXJlbmNlIGJldHdlZW4gaW50IGFuZCBmbG9hdCwgdGhlcmUncyBhbGwgbnVtYmVycywKCSAgICAgKiB0aGlzIGlzIHVzZWQgb25seSB0byBwb2x5ZmlsbCBKYXZhIGNvZGUuCgkgICAgICovCgkgICAgRmxvYXQuZmxvYXRUb0ludEJpdHMgPSBmdW5jdGlvbiAoZikgewoJICAgICAgICByZXR1cm4gZjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFRoZSBmbG9hdCBtYXggdmFsdWUgaW4gSlMgaXMgdGhlIG51bWJlciBtYXggdmFsdWUuCgkgICAgICovCgkgICAgRmxvYXQuTUFYX1ZBTFVFID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgcmV0dXJuIEZsb2F0OwoJfSgpKTsKCUZsb2F0JDEuZGVmYXVsdCA9IEZsb2F0OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVzdWx0UG9pbnQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCXZhciBNYXRoVXRpbHNfMSQxID0gTWF0aFV0aWxzJDE7Cgl2YXIgRmxvYXRfMSA9IEZsb2F0JDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHBvaW50IG9mIGludGVyZXN0IGluIGFuIGltYWdlIGNvbnRhaW5pbmcgYSBiYXJjb2RlLiBUeXBpY2FsbHksIHRoaXMKCSAqIHdvdWxkIGJlIHRoZSBsb2NhdGlvbiBvZiBhIGZpbmRlciBwYXR0ZXJuIG9yIHRoZSBjb3JuZXIgb2YgdGhlIGJhcmNvZGUsIGZvciBleGFtcGxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0UG9pbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUmVzdWx0UG9pbnQoeCwgeSkgewoJICAgICAgICB0aGlzLnggPSB4OwoJICAgICAgICB0aGlzLnkgPSB5OwoJICAgIH0KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUuZ2V0WCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMueDsKCSAgICB9OwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5nZXRZID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy55OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgUmVzdWx0UG9pbnQpIHsKCSAgICAgICAgICAgIHZhciBvdGhlclBvaW50ID0gb3RoZXI7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy54ID09PSBvdGhlclBvaW50LnggJiYgdGhpcy55ID09PSBvdGhlclBvaW50Lnk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogRmxvYXRfMS5kZWZhdWx0LmZsb2F0VG9JbnRCaXRzKHRoaXMueCkgKyBGbG9hdF8xLmRlZmF1bHQuZmxvYXRUb0ludEJpdHModGhpcy55KTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiAnKCcgKyB0aGlzLnggKyAnLCcgKyB0aGlzLnkgKyAnKSc7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBPcmRlcnMgYW4gYXJyYXkgb2YgdGhyZWUgUmVzdWx0UG9pbnRzIGluIGFuIG9yZGVyIFtBLEIsQ10gc3VjaCB0aGF0IEFCIGlzIGxlc3MgdGhhbiBBQwoJICAgICAqIGFuZCBCQyBpcyBsZXNzIHRoYW4gQUMsIGFuZCB0aGUgYW5nbGUgYmV0d2VlbiBCQyBhbmQgQkEgaXMgbGVzcyB0aGFuIDE4MCBkZWdyZWVzLgoJICAgICAqCgkgICAgICogQHBhcmFtIHBhdHRlcm5zIGFycmF5IG9mIHRocmVlIHtAY29kZSBSZXN1bHRQb2ludH0gdG8gb3JkZXIKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5vcmRlckJlc3RQYXR0ZXJucyA9IGZ1bmN0aW9uIChwYXR0ZXJucykgewoJICAgICAgICAvLyBGaW5kIGRpc3RhbmNlcyBiZXR3ZWVuIHBhdHRlcm4gY2VudGVycwoJICAgICAgICB2YXIgemVyb09uZURpc3RhbmNlID0gdGhpcy5kaXN0YW5jZShwYXR0ZXJuc1swXSwgcGF0dGVybnNbMV0pOwoJICAgICAgICB2YXIgb25lVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzFdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciB6ZXJvVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzBdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciBwb2ludEE7CgkgICAgICAgIHZhciBwb2ludEI7CgkgICAgICAgIHZhciBwb2ludEM7CgkgICAgICAgIC8vIEFzc3VtZSBvbmUgY2xvc2VzdCB0byBvdGhlciB0d28gaXMgQjsgQSBhbmQgQyB3aWxsIGp1c3QgYmUgZ3Vlc3NlcyBhdCBmaXJzdAoJICAgICAgICBpZiAob25lVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlICYmIG9uZVR3b0Rpc3RhbmNlID49IHplcm9Ud29EaXN0YW5jZSkgewoJICAgICAgICAgICAgcG9pbnRCID0gcGF0dGVybnNbMF07CgkgICAgICAgICAgICBwb2ludEEgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QyA9IHBhdHRlcm5zWzJdOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHplcm9Ud29EaXN0YW5jZSA+PSBvbmVUd29EaXN0YW5jZSAmJiB6ZXJvVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlKSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMl07CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1syXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMV07CgkgICAgICAgIH0KCSAgICAgICAgLy8gVXNlIGNyb3NzIHByb2R1Y3QgdG8gZmlndXJlIG91dCB3aGV0aGVyIEEgYW5kIEMgYXJlIGNvcnJlY3Qgb3IgZmxpcHBlZC4KCSAgICAgICAgLy8gVGhpcyBhc2tzIHdoZXRoZXIgQkMgeCBCQSBoYXMgYSBwb3NpdGl2ZSB6IGNvbXBvbmVudCwgd2hpY2ggaXMgdGhlIGFycmFuZ2VtZW50CgkgICAgICAgIC8vIHdlIHdhbnQgZm9yIEEsIEIsIEMuIElmIGl0J3MgbmVnYXRpdmUsIHRoZW4gd2UndmUgZ290IGl0IGZsaXBwZWQgYXJvdW5kIGFuZAoJICAgICAgICAvLyBzaG91bGQgc3dhcCBBIGFuZCBDLgoJICAgICAgICBpZiAodGhpcy5jcm9zc1Byb2R1Y3RaKHBvaW50QSwgcG9pbnRCLCBwb2ludEMpIDwgMC4wKSB7CgkgICAgICAgICAgICB2YXIgdGVtcCA9IHBvaW50QTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBvaW50QzsKCSAgICAgICAgICAgIHBvaW50QyA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgcGF0dGVybnNbMF0gPSBwb2ludEE7CgkgICAgICAgIHBhdHRlcm5zWzFdID0gcG9pbnRCOwoJICAgICAgICBwYXR0ZXJuc1syXSA9IHBvaW50QzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBwYXR0ZXJuMSBmaXJzdCBwYXR0ZXJuCgkgICAgICogQHBhcmFtIHBhdHRlcm4yIHNlY29uZCBwYXR0ZXJuCgkgICAgICogQHJldHVybiBkaXN0YW5jZSBiZXR3ZWVuIHR3byBwb2ludHMKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5kaXN0YW5jZSA9IGZ1bmN0aW9uIChwYXR0ZXJuMSwgcGF0dGVybjIpIHsKCSAgICAgICAgcmV0dXJuIE1hdGhVdGlsc18xJDEuZGVmYXVsdC5kaXN0YW5jZShwYXR0ZXJuMS54LCBwYXR0ZXJuMS55LCBwYXR0ZXJuMi54LCBwYXR0ZXJuMi55KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHogY29tcG9uZW50IG9mIHRoZSBjcm9zcyBwcm9kdWN0IGJldHdlZW4gdmVjdG9ycyBCQyBhbmQgQkEuCgkgICAgICovCgkgICAgUmVzdWx0UG9pbnQuY3Jvc3NQcm9kdWN0WiA9IGZ1bmN0aW9uIChwb2ludEEsIHBvaW50QiwgcG9pbnRDKSB7CgkgICAgICAgIHZhciBiWCA9IHBvaW50Qi54OwoJICAgICAgICB2YXIgYlkgPSBwb2ludEIueTsKCSAgICAgICAgcmV0dXJuICgocG9pbnRDLnggLSBiWCkgKiAocG9pbnRBLnkgLSBiWSkpIC0gKChwb2ludEMueSAtIGJZKSAqIChwb2ludEEueCAtIGJYKSk7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0UG9pbnQ7Cgl9KCkpOwoJUmVzdWx0UG9pbnQkMS5kZWZhdWx0ID0gUmVzdWx0UG9pbnQ7CgoJdmFyIEFsaWdubWVudFBhdHRlcm5GaW5kZXIkMSA9IHt9OwoKCXZhciBBbGlnbm1lbnRQYXR0ZXJuJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyQxID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFsaWdubWVudFBhdHRlcm4kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgUmVzdWx0UG9pbnRfMSQzID0gUmVzdWx0UG9pbnQkMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGFuIGFsaWdubWVudCBwYXR0ZXJuLCB3aGljaCBhcmUgdGhlIHNtYWxsZXIgc3F1YXJlIHBhdHRlcm5zIGZvdW5kIGluCgkgKiBhbGwgYnV0IHRoZSBzaW1wbGVzdCBRUiBDb2Rlcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEFsaWdubWVudFBhdHRlcm4gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDEoQWxpZ25tZW50UGF0dGVybiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZXJtaW5lcyBpZiB0aGlzIGFsaWdubWVudCBwYXR0ZXJuICJhYm91dCBlcXVhbHMiIGFuIGFsaWdubWVudCBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhbiBhdmVyYWdlIG9mIHRoZSB0d28uCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybi5wcm90b3R5cGUuY29tYmluZUVzdGltYXRlID0gZnVuY3Rpb24gKGkgLypmbG9hdCovLCBqIC8qZmxvYXQqLywgbmV3TW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIGNvbWJpbmVkWCA9ICh0aGlzLmdldFgoKSArIGopIC8gMi4wOwoJICAgICAgICB2YXIgY29tYmluZWRZID0gKHRoaXMuZ2V0WSgpICsgaSkgLyAyLjA7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplICsgbmV3TW9kdWxlU2l6ZSkgLyAyLjA7CgkgICAgICAgIHJldHVybiBuZXcgQWxpZ25tZW50UGF0dGVybihjb21iaW5lZFgsIGNvbWJpbmVkWSwgY29tYmluZWRNb2R1bGVTaXplKTsKCSAgICB9OwoJICAgIHJldHVybiBBbGlnbm1lbnRQYXR0ZXJuOwoJfShSZXN1bHRQb2ludF8xJDMuZGVmYXVsdCkpOwoJQWxpZ25tZW50UGF0dGVybiQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX192YWx1ZXMkMSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuXzEgPSBBbGlnbm1lbnRQYXR0ZXJuJDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQzID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBhbGlnbm1lbnQgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBBbGlnbm1lbnQgcGF0dGVybnMgbG9vayBsaWtlIGZpbmRlcgoJICogcGF0dGVybnMgYnV0IGFyZSBzbWFsbGVyIGFuZCBhcHBlYXIgYXQgcmVndWxhciBpbnRlcnZhbHMgdGhyb3VnaG91dCB0aGUgaW1hZ2UuPC9wPgoJICoKCSAqIDxwPkF0IHRoZSBtb21lbnQgdGhpcyBvbmx5IGxvb2tzIGZvciB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAqCgkgKiA8cD5UaGlzIGlzIG1vc3RseSBhIHNpbXBsaWZpZWQgY29weSBvZiB7QGxpbmsgRmluZGVyUGF0dGVybkZpbmRlcn0uIEl0IGlzIGNvcGllZCwKCSAqIHBhc3RlZCBhbmQgc3RyaXBwZWQgZG93biBoZXJlIGZvciBtYXhpbXVtIHBlcmZvcm1hbmNlIGJ1dCBkb2VzIHVuZm9ydHVuYXRlbHkgZHVwbGljYXRlCgkgKiBzb21lIGNvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8qKgoJICAgICAqIDxwPkNyZWF0ZXMgYSBmaW5kZXIgdGhhdCB3aWxsIGxvb2sgaW4gYSBwb3J0aW9uIG9mIHRoZSB3aG9sZSBpbWFnZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gaW1hZ2UgaW1hZ2UgdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIHN0YXJ0WCBsZWZ0IGNvbHVtbiBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSBzdGFydFkgdG9wIHJvdyBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSB3aWR0aCB3aWR0aCBvZiByZWdpb24gdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIGhlaWdodCBoZWlnaHQgb2YgcmVnaW9uIHRvIHNlYXJjaAoJICAgICAqIEBwYXJhbSBtb2R1bGVTaXplIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBzbyBmYXIKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyKGltYWdlLCBzdGFydFggLyppbnQqLywgc3RhcnRZIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBtb2R1bGVTaXplIC8qZmxvYXQqLywgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMuc3RhcnRYID0gc3RhcnRYOwoJICAgICAgICB0aGlzLnN0YXJ0WSA9IHN0YXJ0WTsKCSAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoOwoJICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgdGhpcy5tb2R1bGVTaXplID0gbW9kdWxlU2l6ZTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICAgICAgdGhpcy5wb3NzaWJsZUNlbnRlcnMgPSBbXTsgLy8gbmV3IEFycmF5PGFueT4oNSkpCgkgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBhcnJheSBpbml0aWFsaXphdGlvbiB3aXRob3V0IHNpemUgYXMgdGhlIGxlbmd0aCBpcyBjaGVja2VkIGJlbG93CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSgzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+VGhpcyBtZXRob2QgYXR0ZW1wdHMgdG8gZmluZCB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuIGluIHRoZSBpbWFnZS4gSXQgaXMgYSBiaXQgbWVzc3kgc2luY2UKCSAgICAgKiBpdCdzIHByZXR0eSBwZXJmb3JtYW5jZS1jcml0aWNhbCBhbmQgc28gaXMgd3JpdHRlbiB0byBiZSBmYXN0IGZvcmVtb3N0LjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBub3QgZm91bmQKCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgc3RhcnRYID0gdGhpcy5zdGFydFg7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmhlaWdodDsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIG1heEogPSBzdGFydFggKyB3aWR0aDsKCSAgICAgICAgdmFyIG1pZGRsZUkgPSB0aGlzLnN0YXJ0WSArIChoZWlnaHQgLyAyKTsKCSAgICAgICAgLy8gV2UgYXJlIGxvb2tpbmcgZm9yIGJsYWNrL3doaXRlL2JsYWNrIG1vZHVsZXMgaW4gMToxOjEgcmF0aW8KCSAgICAgICAgLy8gdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIHNlZW4gc28gZmFyCgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoMyk7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIGZvciAodmFyIGlHZW4gPSAwOyBpR2VuIDwgaGVpZ2h0OyBpR2VuKyspIHsKCSAgICAgICAgICAgIC8vIFNlYXJjaCBmcm9tIG1pZGRsZSBvdXR3YXJkcwoJICAgICAgICAgICAgdmFyIGkgPSBtaWRkbGVJICsgKChpR2VuICYgMHgwMSkgPT09IDAgPyBNYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSA6IC1NYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSk7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICB2YXIgaiA9IHN0YXJ0WDsKCSAgICAgICAgICAgIC8vIEJ1cm4gb2ZmIGxlYWRpbmcgd2hpdGUgcGl4ZWxzIGJlZm9yZSBhbnl0aGluZyBlbHNlOyBpZiB3ZSBzdGFydCBpbiB0aGUgbWlkZGxlIG9mCgkgICAgICAgICAgICAvLyBhIHdoaXRlIHJ1biwgaXQgZG9lc24ndCBtYWtlIHNlbnNlIHRvIGNvdW50IGl0cyBsZW5ndGgsIHNpbmNlIHdlIGRvbid0IGtub3cgaWYgdGhlCgkgICAgICAgICAgICAvLyB3aGl0ZSBydW4gY29udGludWVkIHRvIHRoZSBsZWZ0IG9mIHRoZSBzdGFydCBwb2ludAoJICAgICAgICAgICAgd2hpbGUgKGogPCBtYXhKICYmICFpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgY3VycmVudFN0YXRlID0gMDsKCSAgICAgICAgICAgIHdoaWxlIChqIDwgbWF4SikgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMV0rKzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsgLy8gQ291bnRpbmcgd2hpdGUgcGl4ZWxzCgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFN0YXRlID09PSAyKSB7IC8vIEEgd2lubmVyPwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZvdW5kUGF0dGVybkNyb3NzKHN0YXRlQ291bnQpKSB7IC8vIFllcwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBqKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gc3RhdGVDb3VudFsyXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gMTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsrK2N1cnJlbnRTdGF0ZV0rKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAodGhpcy5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSkgewoJICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIG1heEopOwoJICAgICAgICAgICAgICAgIGlmIChjb25maXJtZWQgIT09IG51bGwpIHsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBub3RoaW5nIHdlIHNhdyB3YXMgb2JzZXJ2ZWQgYW5kIGNvbmZpcm1lZCB0d2ljZS4gSWYgd2UgaGFkCgkgICAgICAgIC8vIGFueSBndWVzcyBhdCBhbGwsIHJldHVybiBpdC4KCSAgICAgICAgaWYgKHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aCAhPT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucG9zc2libGVDZW50ZXJzWzBdOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogR2l2ZW4gYSBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCBzZWVuIGFuZCBhbiBlbmQgcG9zaXRpb24sCgkgICAgICogZmlndXJlcyB0aGUgbG9jYXRpb24gb2YgdGhlIGNlbnRlciBvZiB0aGlzIGJsYWNrL3doaXRlL2JsYWNrIHJ1bi4KCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCwgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIChlbmQgLSBzdGF0ZUNvdW50WzJdKSAtIHN0YXRlQ291bnRbMV0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8xIHJhdGlvcwoJICAgICAqICAgICAgICAgdXNlZCBieSBhbGlnbm1lbnQgcGF0dGVybnMgdG8gYmUgY29uc2lkZXJlZCBhIG1hdGNoCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMubW9kdWxlU2l6ZTsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFtpXSkgPj0gbWF4VmFyaWFuY2UpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5BZnRlciBhIGhvcml6b250YWwgc2NhbiBmaW5kcyBhIHBvdGVudGlhbCBhbGlnbm1lbnQgcGF0dGVybiwgdGhpcyBtZXRob2QKCSAgICAgKiAiY3Jvc3MtY2hlY2tzIiBieSBzY2FubmluZyBkb3duIHZlcnRpY2FsbHkgdGhyb3VnaCB0aGUgY2VudGVyIG9mIHRoZSBwb3NzaWJsZQoJICAgICAqIGFsaWdubWVudCBwYXR0ZXJuIHRvIHNlZSBpZiB0aGUgc2FtZSBwcm9wb3J0aW9uIGlzIGRldGVjdGVkLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydEkgcm93IHdoZXJlIGFuIGFsaWdubWVudCBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYW4gYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBhbGlnbm1lbnQgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAvLyBTdGFydCBjb3VudGluZyB1cCBmcm9tIGNlbnRlcgoJICAgICAgICB2YXIgaSA9IHN0YXJ0STsKCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbMF0gPD0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMF0rKzsKCSAgICAgICAgICAgIGktLTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFswXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIC8vIE5vdyBhbHNvIGNvdW50IGRvd24gZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IHN0YXJ0SSArIDE7CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbMV0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA8IG1heEkgJiYgIWltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzJdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzJdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMl0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSAyICogb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkgPyBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaSkgOiBOYU47CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5UaGlzIGlzIGNhbGxlZCB3aGVuIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4uIEl0IHdpbGwKCSAgICAgKiBjcm9zcyBjaGVjayB3aXRoIGEgdmVydGljYWwgc2NhbiwgYW5kIGlmIHN1Y2Nlc3NmdWwsIHdpbGwgc2VlIGlmIHRoaXMgcGF0dGVybiBoYWQgYmVlbgoJICAgICAqIGZvdW5kIG9uIGEgcHJldmlvdXMgaG9yaXpvbnRhbCBzY2FuLiBJZiBzbywgd2UgY29uc2lkZXIgaXQgY29uZmlybWVkIGFuZCBjb25jbHVkZSB3ZSBoYXZlCgkgICAgICogZm91bmQgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGF0ZUNvdW50IHJlYWRpbmcgc3RhdGUgbW9kdWxlIGNvdW50cyBmcm9tIGhvcml6b250YWwgc2NhbgoJICAgICAqIEBwYXJhbSBpIHJvdyB3aGVyZSBhbGlnbm1lbnQgcGF0dGVybiBtYXkgYmUgZm91bmQKCSAgICAgKiBAcGFyYW0gaiBlbmQgb2YgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4gaW4gcm93CgkgICAgICogQHJldHVybiB7QGxpbmsgQWxpZ25tZW50UGF0dGVybn0gaWYgd2UgaGF2ZSBmb3VuZCB0aGUgc2FtZSBwYXR0ZXJuIHR3aWNlLCBvciBudWxsIGlmIG5vdAoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmhhbmRsZVBvc3NpYmxlQ2VudGVyID0gZnVuY3Rpb24gKHN0YXRlQ291bnQsIGkgLyppbnQqLywgaiAvKmludCovKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICB2YXIgY2VudGVySiA9IEFsaWdubWVudFBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKTsKCSAgICAgICAgdmFyIGNlbnRlckkgPSB0aGlzLmNyb3NzQ2hlY2tWZXJ0aWNhbChpLCAvKihpbnQpICovIGNlbnRlckosIDIgKiBzdGF0ZUNvdW50WzFdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IChzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0pIC8gMy4wOwoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBfYiA9IF9fdmFsdWVzJDEodGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgICAgIHZhciBjZW50ZXIgPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICAgICAgLy8gTG9vayBmb3IgYWJvdXQgdGhlIHNhbWUgY2VudGVyIGFuZCBtb2R1bGUgc2l6ZToKCSAgICAgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5hYm91dEVxdWFscyhlc3RpbWF0ZWRNb2R1bGVTaXplLCBjZW50ZXJJLCBjZW50ZXJKKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNlbnRlci5jb21iaW5lRXN0aW1hdGUoY2VudGVySSwgY2VudGVySiwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKF9jICYmICFfYy5kb25lICYmIChfYSA9IF9iLnJldHVybikpIF9hLmNhbGwoX2IpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBIYWRuJ3QgZm91bmQgdGhpcyBiZWZvcmU7IHNhdmUgaXQKCSAgICAgICAgICAgIHZhciBwb2ludCA9IG5ldyBBbGlnbm1lbnRQYXR0ZXJuXzEuZGVmYXVsdChjZW50ZXJKLCBjZW50ZXJJLCBlc3RpbWF0ZWRNb2R1bGVTaXplKTsKCSAgICAgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzLnB1c2gocG9pbnQpOwoJICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjay5mb3VuZFBvc3NpYmxlUmVzdWx0UG9pbnQocG9pbnQpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgcmV0dXJuIEFsaWdubWVudFBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJQWxpZ25tZW50UGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyOwoKCXZhciBGaW5kZXJQYXR0ZXJuRmluZGVyJDEgPSB7fTsKCgl2YXIgRmluZGVyUGF0dGVybiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRmluZGVyUGF0dGVybiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZXRlY3RvciB7Ki8KCXZhciBSZXN1bHRQb2ludF8xJDIgPSBSZXN1bHRQb2ludCQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBmaW5kZXIgcGF0dGVybiwgd2hpY2ggYXJlIHRoZSB0aHJlZSBzcXVhcmUgcGF0dGVybnMgZm91bmQgaW4KCSAqIHRoZSBjb3JuZXJzIG9mIFFSIENvZGVzLiBJdCBhbHNvIGVuY2Fwc3VsYXRlcyBhIGNvdW50IG9mIHNpbWlsYXIgZmluZGVyIHBhdHRlcm5zLAoJICogYXMgYSBjb252ZW5pZW5jZSB0byB0aGUgZmluZGVyJ3MgYm9va2tlZXBpbmcuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBGaW5kZXJQYXR0ZXJuID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyhGaW5kZXJQYXR0ZXJuLCBfc3VwZXIpOwoJICAgIC8vIEZpbmRlclBhdHRlcm4ocG9zWDogbnVtYmVyLypmbG9hdCovLCBwb3NZOiBudW1iZXIvKmZsb2F0Ki8sIGVzdGltYXRlZE1vZHVsZVNpemU6IG51bWJlci8qZmxvYXQqLykgewoJICAgIC8vICAgdGhpcyhwb3NYLCBwb3NZLCBlc3RpbWF0ZWRNb2R1bGVTaXplLCAxKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBGaW5kZXJQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8sIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIF90aGlzLmNvdW50ID0gY291bnQ7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNvdW50KSB7CgkgICAgICAgICAgICBfdGhpcy5jb3VudCA9IDE7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybi5wcm90b3R5cGUuZ2V0Q291bnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvdW50OwoJICAgIH07CgkgICAgLyoKCSAgICB2b2lkIGluY3JlbWVudENvdW50KCkgewoJICAgICAgdGhpcy5jb3VudCsrCgkgICAgfQoJICAgICAqLwoJICAgIC8qKgoJICAgICAqIDxwPkRldGVybWluZXMgaWYgdGhpcyBmaW5kZXIgcGF0dGVybiAiYWJvdXQgZXF1YWxzIiBhIGZpbmRlciBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhIHdlaWdodGVkIGF2ZXJhZ2UKCSAgICAgKiBiYXNlZCBvbiBjb3VudC4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5jb21iaW5lRXN0aW1hdGUgPSBmdW5jdGlvbiAoaSAvKmZsb2F0Ki8sIGogLypmbG9hdCovLCBuZXdNb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgY29tYmluZWRDb3VudCA9IHRoaXMuY291bnQgKyAxOwoJICAgICAgICB2YXIgY29tYmluZWRYID0gKHRoaXMuY291bnQgKiB0aGlzLmdldFgoKSArIGopIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgdmFyIGNvbWJpbmVkWSA9ICh0aGlzLmNvdW50ICogdGhpcy5nZXRZKCkgKyBpKSAvIGNvbWJpbmVkQ291bnQ7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5jb3VudCAqIHRoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSArIG5ld01vZHVsZVNpemUpIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgcmV0dXJuIG5ldyBGaW5kZXJQYXR0ZXJuKGNvbWJpbmVkWCwgY29tYmluZWRZLCBjb21iaW5lZE1vZHVsZVNpemUsIGNvbWJpbmVkQ291bnQpOwoJICAgIH07CgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm47Cgl9KFJlc3VsdFBvaW50XzEkMi5kZWZhdWx0KSk7CglGaW5kZXJQYXR0ZXJuJDEuZGVmYXVsdCA9IEZpbmRlclBhdHRlcm47CgoJdmFyIEZpbmRlclBhdHRlcm5JbmZvJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5JbmZvJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGluZm9ybWF0aW9uIGFib3V0IGZpbmRlciBwYXR0ZXJucyBpbiBhbiBpbWFnZSwgaW5jbHVkaW5nIHRoZSBsb2NhdGlvbiBvZgoJICogdGhlIHRocmVlIGZpbmRlciBwYXR0ZXJucywgYW5kIHRoZWlyIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5JbmZvID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZpbmRlclBhdHRlcm5JbmZvKHBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHRoaXMuYm90dG9tTGVmdCA9IHBhdHRlcm5DZW50ZXJzWzBdOwoJICAgICAgICB0aGlzLnRvcExlZnQgPSBwYXR0ZXJuQ2VudGVyc1sxXTsKCSAgICAgICAgdGhpcy50b3BSaWdodCA9IHBhdHRlcm5DZW50ZXJzWzJdOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuSW5mby5wcm90b3R5cGUuZ2V0Qm90dG9tTGVmdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYm90dG9tTGVmdDsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5JbmZvLnByb3RvdHlwZS5nZXRUb3BMZWZ0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BMZWZ0OwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkluZm8ucHJvdG90eXBlLmdldFRvcFJpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BSaWdodDsKCSAgICB9OwoJICAgIHJldHVybiBGaW5kZXJQYXR0ZXJuSW5mbzsKCX0oKSk7CglGaW5kZXJQYXR0ZXJuSW5mbyQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuSW5mbzsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5GaW5kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQyID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBSZXN1bHRQb2ludF8xJDEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIEZpbmRlclBhdHRlcm5fMSA9IEZpbmRlclBhdHRlcm4kMTsKCXZhciBGaW5kZXJQYXR0ZXJuSW5mb18xID0gRmluZGVyUGF0dGVybkluZm8kMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDIgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyppbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbXBhcmF0b3I7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBmaW5kZXIgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBGaW5kZXIgcGF0dGVybnMgYXJlIHRoZSBzcXVhcmUKCSAqIG1hcmtlcnMgYXQgdGhyZWUgY29ybmVycyBvZiBhIFFSIENvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5GaW5kZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogPHA+Q3JlYXRlcyBhIGZpbmRlciB0aGF0IHdpbGwgc2VhcmNoIHRoZSBpbWFnZSBmb3IgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBpbWFnZSBpbWFnZSB0byBzZWFyY2gKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoaW1hZ2U6IEJpdE1hdHJpeCkgewoJICAgIC8vICAgdGhpcyhpbWFnZSwgbnVsbCkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRmluZGVyUGF0dGVybkZpbmRlcihpbWFnZSwgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayA9IHJlc3VsdFBvaW50Q2FsbGJhY2s7CgkgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzID0gW107CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSg1KTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICB9CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0SW1hZ2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmltYWdlOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0UG9zc2libGVDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKGhpbnRzKSB7CgkgICAgICAgIHZhciB0cnlIYXJkZXIgPSAoaGludHMgIT09IG51bGwgJiYgaGludHMgIT09IHVuZGVmaW5lZCkgJiYgdW5kZWZpbmVkICE9PSBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQyLmRlZmF1bHQuVFJZX0hBUkRFUik7CgkgICAgICAgIHZhciBwdXJlQmFyY29kZSA9IChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkKSAmJiB1bmRlZmluZWQgIT09IGhpbnRzLmdldChEZWNvZGVIaW50VHlwZV8xJDIuZGVmYXVsdC5QVVJFX0JBUkNPREUpOwoJICAgICAgICB2YXIgaW1hZ2UgPSB0aGlzLmltYWdlOwoJICAgICAgICB2YXIgbWF4SSA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgbWF4SiA9IGltYWdlLmdldFdpZHRoKCk7CgkgICAgICAgIC8vIFdlIGFyZSBsb29raW5nIGZvciBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIGluCgkgICAgICAgIC8vIDE6MTozOjE6MSByYXRpbzsgdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBzdWNoIG1vZHVsZXMgc2VlbiBzbyBmYXIKCSAgICAgICAgLy8gTGV0J3MgYXNzdW1lIHRoYXQgdGhlIG1heGltdW0gdmVyc2lvbiBRUiBDb2RlIHdlIHN1cHBvcnQgdGFrZXMgdXAgMS80IHRoZSBoZWlnaHQgb2YgdGhlCgkgICAgICAgIC8vIGltYWdlLCBhbmQgdGhlbiBhY2NvdW50IGZvciB0aGUgY2VudGVyIGJlaW5nIDMgbW9kdWxlcyBpbiBzaXplLiBUaGlzIGdpdmVzIHRoZSBzbWFsbGVzdAoJICAgICAgICAvLyBudW1iZXIgb2YgcGl4ZWxzIHRoZSBjZW50ZXIgY291bGQgYmUsIHNvIHNraXAgdGhpcyBvZnRlbi4gV2hlbiB0cnlpbmcgaGFyZGVyLCBsb29rIGZvciBhbGwKCSAgICAgICAgLy8gUVIgdmVyc2lvbnMgcmVnYXJkbGVzcyBvZiBob3cgZGVuc2UgdGhleSBhcmUuCgkgICAgICAgIHZhciBpU2tpcCA9IE1hdGguZmxvb3IoKDMgKiBtYXhJKSAvICg0ICogRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUykpOwoJICAgICAgICBpZiAoaVNraXAgPCBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQIHx8IHRyeUhhcmRlcikgewoJICAgICAgICAgICAgaVNraXAgPSBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkb25lID0gZmFsc2U7CgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoNSk7CgkgICAgICAgIGZvciAodmFyIGkgPSBpU2tpcCAtIDE7IGkgPCBtYXhJICYmICFkb25lOyBpICs9IGlTa2lwKSB7CgkgICAgICAgICAgICAvLyBHZXQgYSByb3cgb2YgYmxhY2svd2hpdGUgdmFsdWVzCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0gPSAwOwoJICAgICAgICAgICAgdmFyIGN1cnJlbnRTdGF0ZSA9IDA7CgkgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG1heEo7IGorKykgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMSkgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMCkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50U3RhdGUgPT09IDQpIHsgLy8gQSB3aW5uZXI/CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsgLy8gWWVzCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIGosIHB1cmVCYXJjb2RlKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RhcnQgZXhhbWluaW5nIGV2ZXJ5IG90aGVyIGxpbmUuIENoZWNraW5nIGVhY2ggbGluZSB0dXJuZWQgb3V0IHRvIGJlIHRvbwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXhwZW5zaXZlIGFuZCBkaWRuJ3QgaW1wcm92ZSBwZXJmb3JtYW5jZS4KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlTa2lwID0gMjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQgPT09IHRydWUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcm93U2tpcCA9IHRoaXMuZmluZFJvd1NraXAoKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm93U2tpcCA+IHN0YXRlQ291bnRbMl0pIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2tpcCByb3dzIGJldHdlZW4gcm93IG9mIGxvd2VyIGNvbmZpcm1lZCBjZW50ZXIKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5kIHRvcCBvZiBwcmVzdW1lZCB0aGlyZCBjb25maXJtZWQgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJ1dCBiYWNrIHVwIGEgYml0IHRvIGdldCBhIGZ1bGwgY2hhbmNlIG9mIGRldGVjdGluZwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpdCwgZW50aXJlIHdpZHRoIG9mIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTa2lwIGJ5IHJvd1NraXAsIGJ1dCBiYWNrIG9mZiBieSBzdGF0ZUNvdW50WzJdIChzaXplIG9mIGxhc3QgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9mIHBhdHRlcm4gd2Ugc2F3KSB0byBiZSBjb25zZXJ2YXRpdmUsIGFuZCBhbHNvIGJhY2sgb2ZmIGJ5IGlTa2lwIHdoaWNoCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlzIGFib3V0IHRvIGJlIHJlLWFkZGVkCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgKz0gcm93U2tpcCAtIHN0YXRlQ291bnRbMl0gLSBpU2tpcDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaiA9IG1heEogLSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IHN0YXRlQ291bnRbM107CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gc3RhdGVDb3VudFs0XTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAzOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2xlYXIgc3RhdGUgdG8gc3RhcnQgbG9va2luZyBhZ2FpbgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBObywgc2hpZnQgY291bnRzIGJhY2sgYnkgdHdvCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gc3RhdGVDb3VudFszXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IHN0YXRlQ291bnRbNF07CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFN0YXRlID0gMzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WysrY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBtYXhKLCBwdXJlQmFyY29kZSk7CgkgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICBpU2tpcCA9IHN0YXRlQ291bnRbMF07CgkgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGEgdGhpcmQgb25lCgkgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBhdHRlcm5JbmZvID0gdGhpcy5zZWxlY3RCZXN0UGF0dGVybnMoKTsKCSAgICAgICAgUmVzdWx0UG9pbnRfMSQxLmRlZmF1bHQub3JkZXJCZXN0UGF0dGVybnMocGF0dGVybkluZm8pOwoJICAgICAgICByZXR1cm4gbmV3IEZpbmRlclBhdHRlcm5JbmZvXzEuZGVmYXVsdChwYXR0ZXJuSW5mbyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBHaXZlbiBhIGNvdW50IG9mIGJsYWNrL3doaXRlL2JsYWNrL3doaXRlL2JsYWNrIHBpeGVscyBqdXN0IHNlZW4gYW5kIGFuIGVuZCBwb3NpdGlvbiwKCSAgICAgKiBmaWd1cmVzIHRoZSBsb2NhdGlvbiBvZiB0aGUgY2VudGVyIG9mIHRoaXMgcnVuLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZCA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBlbmQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gKGVuZCAtIHN0YXRlQ291bnRbNF0gLSBzdGF0ZUNvdW50WzNdKSAtIHN0YXRlQ291bnRbMl0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8zLzEvMSByYXRpb3MKCSAgICAgKiAgICAgICAgIHVzZWQgYnkgZmluZGVyIHBhdHRlcm5zIHRvIGJlIGNvbnNpZGVyZWQgYSBtYXRjaAoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHsKCSAgICAgICAgICAgIHZhciBjb3VudCA9IHN0YXRlQ291bnRbaV07CgkgICAgICAgICAgICBpZiAoY291bnQgPT09IDApIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gY291bnQ7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvdGFsTW9kdWxlU2l6ZSA8IDcpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIDcuMDsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgLy8gQWxsb3cgbGVzcyB0aGFuIDUwJSB2YXJpYW5jZSBmcm9tIDEtMS0zLTEtMSBwcm9wb3J0aW9ucwoJICAgICAgICByZXR1cm4gTWF0aC5hYnMobW9kdWxlU2l6ZSAtIHN0YXRlQ291bnRbMF0pIDwgbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzFdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicygzLjAgKiBtb2R1bGVTaXplIC0gc3RhdGVDb3VudFsyXSkgPCAzICogbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzNdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFs0XSkgPCBtYXhWYXJpYW5jZTsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgY3Jvc3NDaGVja1N0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFswXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzFdID0gMDsKCSAgICAgICAgY3Jvc3NDaGVja1N0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFszXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgcmV0dXJuIGNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQWZ0ZXIgYSB2ZXJ0aWNhbCBhbmQgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jcm9zcy1jcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gZGlhZ29uYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnRJIHJvdyB3aGVyZSBhIGZpbmRlciBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYSBmaW5kZXIgcGF0dGVybgoJICAgICAqIEBwYXJhbSBtYXhDb3VudCBtYXhpbXVtIHJlYXNvbmFibGUgbnVtYmVyIG9mIG1vZHVsZXMgdGhhdCBzaG91bGQgYmUKCSAgICAgKiAgb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcGFyYW0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgVGhlIG9yaWdpbmFsIHN0YXRlIGNvdW50IHRvdGFsLgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZiBwcm9wb3J0aW9ucyBhcmUgd2l0aGluZyBleHBlY3RlZCBsaW1pdHMKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrRGlhZ29uYWwgPSBmdW5jdGlvbiAoc3RhcnRJIC8qaW50Ki8sIGNlbnRlckogLyppbnQqLywgbWF4Q291bnQgLyppbnQqLywgb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgLyppbnQqLykgewoJICAgICAgICB2YXIgc3RhdGVDb3VudCA9IHRoaXMuZ2V0Q3Jvc3NDaGVja1N0YXRlQ291bnQoKTsKCSAgICAgICAgLy8gU3RhcnQgY291bnRpbmcgdXAsIGxlZnQgZnJvbSBjZW50ZXIgZmluZGluZyBibGFjayBjZW50ZXIgbWFzcwoJICAgICAgICB2YXIgaSA9IDA7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHdoaWxlIChzdGFydEkgPj0gaSAmJiBjZW50ZXJKID49IGkgJiYgaW1hZ2UuZ2V0KGNlbnRlckogLSBpLCBzdGFydEkgLSBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgPCBpIHx8IGNlbnRlckogPCBpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyB3aGl0ZSBzcGFjZQoJICAgICAgICB3aGlsZSAoc3RhcnRJID49IGkgJiYgY2VudGVySiA+PSBpICYmICFpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgYWxyZWFkeSB0b28gbWFueSBtb2R1bGVzIGluIHRoaXMgc3RhdGUgb3IgcmFuIG9mZiB0aGUgZWRnZToKCSAgICAgICAgaWYgKHN0YXJ0SSA8IGkgfHwgY2VudGVySiA8IGkgfHwgc3RhdGVDb3VudFsxXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyBibGFjayBib3JkZXIKCSAgICAgICAgd2hpbGUgKHN0YXJ0SSA+PSBpICYmIGNlbnRlckogPj0gaSAmJiBpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMF0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtYXhJID0gaW1hZ2UuZ2V0SGVpZ2h0KCk7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biwgcmlnaHQgZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IDE7CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgaW1hZ2UuZ2V0KGNlbnRlckogKyBpLCBzdGFydEkgKyBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJhbiBvZmYgdGhlIGVkZ2U/CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgIWltYWdlLmdldChjZW50ZXJKICsgaSwgc3RhcnRJICsgaSkgJiYKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKHN0YXJ0SSArIGkgPCBtYXhJICYmIGNlbnRlckogKyBpIDwgbWF4SiAmJiBpbWFnZS5nZXQoY2VudGVySiArIGksIHN0YXJ0SSArIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGZvdW5kIGEgZmluZGVyLXBhdHRlcm4tbGlrZSBzZWN0aW9uLCBidXQgaXRzIHNpemUgaXMgbW9yZSB0aGFuIDEwMCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgcmV0dXJuIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA8IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAmJgoJICAgICAgICAgICAgRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkFmdGVyIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gdmVydGljYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXJ0SSByb3cgd2hlcmUgYSBmaW5kZXIgcGF0dGVybiB3YXMgZGV0ZWN0ZWQKCSAgICAgKiBAcGFyYW0gY2VudGVySiBjZW50ZXIgb2YgdGhlIHNlY3Rpb24gdGhhdCBhcHBlYXJzIHRvIGNyb3NzIGEgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIC8vIFN0YXJ0IGNvdW50aW5nIHVwIGZyb20gY2VudGVyCgkgICAgICAgIHZhciBpID0gc3RhcnRJOwoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmICFpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biBmcm9tIGNlbnRlcgoJICAgICAgICBpID0gc3RhcnRJICsgMTsKCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJKSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbM10gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB3ZSBmb3VuZCBhIGZpbmRlci1wYXR0ZXJuLWxpa2Ugc2VjdGlvbiwgYnV0IGl0cyBzaXplIGlzIG1vcmUgdGhhbiA0MCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF07CgkgICAgICAgIGlmICg1ICogTWF0aC5hYnMoc3RhdGVDb3VudFRvdGFsIC0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpID49IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBpKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkxpa2Uge0BsaW5rICNjcm9zc0NoZWNrVmVydGljYWwoaW50LCBpbnQsIGludCwgaW50KX0sIGFuZCBpbiBmYWN0IGlzIGJhc2ljYWxseSBpZGVudGljYWwsCgkgICAgICogZXhjZXB0IGl0IHJlYWRzIGhvcml6b250YWxseSBpbnN0ZWFkIG9mIHZlcnRpY2FsbHkuIFRoaXMgaXMgdXNlZCB0byBjcm9zcy1jcm9zcwoJICAgICAqIGNoZWNrIGEgdmVydGljYWwgY3Jvc3MgY2hlY2sgYW5kIGxvY2F0ZSB0aGUgcmVhbCBjZW50ZXIgb2YgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrSG9yaXpvbnRhbCA9IGZ1bmN0aW9uIChzdGFydEogLyppbnQqLywgY2VudGVySSAvKmludCovLCBtYXhDb3VudCAvKmludCovLCBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAvKmludCovKSB7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIHZhciBqID0gc3RhcnRKOwoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmIGltYWdlLmdldChqLCBjZW50ZXJJKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmICFpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGogPj0gMCAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgaiA9IHN0YXJ0SiArIDE7CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMl0rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA8IG1heEogJiYgIWltYWdlLmdldChqLCBjZW50ZXJJKSAmJiBzdGF0ZUNvdW50WzNdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFs0XSA8IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdKys7CgkgICAgICAgICAgICBqKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbNF0gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgd2UgZm91bmQgYSBmaW5kZXItcGF0dGVybi1saWtlIHNlY3Rpb24sIGJ1dCBpdHMgc2l6ZSBpcyBzaWduaWZpY2FudGx5IGRpZmZlcmVudCB0aGFuCgkgICAgICAgIC8vIHRoZSBvcmlnaW5hbCwgYXNzdW1lIGl0J3MgYSBmYWxzZSBwb3NpdGl2ZQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdICsgc3RhdGVDb3VudFszXSArCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgaXMgY2FsbGVkIHdoZW4gYSBob3Jpem9udGFsIHNjYW4gZmluZHMgYSBwb3NzaWJsZSBhbGlnbm1lbnQgcGF0dGVybi4gSXQgd2lsbAoJICAgICAqIGNyb3NzIGNoZWNrIHdpdGggYSB2ZXJ0aWNhbCBzY2FuLCBhbmQgaWYgc3VjY2Vzc2Z1bCwgd2lsbCwgYWgsIGNyb3NzLWNyb3NzLWNoZWNrCgkgICAgICogd2l0aCBhbm90aGVyIGhvcml6b250YWwgc2Nhbi4gVGhpcyBpcyBuZWVkZWQgcHJpbWFyaWx5IHRvIGxvY2F0ZSB0aGUgcmVhbCBob3Jpem9udGFsCgkgICAgICogY2VudGVyIG9mIHRoZSBwYXR0ZXJuIGluIGNhc2VzIG9mIGV4dHJlbWUgc2tldy4KCSAgICAgKiBBbmQgdGhlbiB3ZSBjcm9zcy1jcm9zcy1jcm9zcyBjaGVjayB3aXRoIGFub3RoZXIgZGlhZ29uYWwgc2Nhbi48L3A+CgkgICAgICoKCSAgICAgKiA8cD5JZiB0aGF0IHN1Y2NlZWRzIHRoZSBmaW5kZXIgcGF0dGVybiBsb2NhdGlvbiBpcyBhZGRlZCB0byBhIGxpc3QgdGhhdCB0cmFja3MKCSAgICAgKiB0aGUgbnVtYmVyIG9mIHRpbWVzIGVhY2ggbG9jYXRpb24gaGFzIGJlZW4gbmVhcmx5LW1hdGNoZWQgYXMgYSBmaW5kZXIgcGF0dGVybi4KCSAgICAgKiBFYWNoIGFkZGl0aW9uYWwgZmluZCBpcyBtb3JlIGV2aWRlbmNlIHRoYXQgdGhlIGxvY2F0aW9uIGlzIGluIGZhY3QgYSBmaW5kZXIKCSAgICAgKiBwYXR0ZXJuIGNlbnRlcgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXRlQ291bnQgcmVhZGluZyBzdGF0ZSBtb2R1bGUgY291bnRzIGZyb20gaG9yaXpvbnRhbCBzY2FuCgkgICAgICogQHBhcmFtIGkgcm93IHdoZXJlIGZpbmRlciBwYXR0ZXJuIG1heSBiZSBmb3VuZAoJICAgICAqIEBwYXJhbSBqIGVuZCBvZiBwb3NzaWJsZSBmaW5kZXIgcGF0dGVybiBpbiByb3cKCSAgICAgKiBAcGFyYW0gcHVyZUJhcmNvZGUgdHJ1ZSBpZiBpbiAicHVyZSBiYXJjb2RlIiBtb2RlCgkgICAgICogQHJldHVybiB0cnVlIGlmIGEgZmluZGVyIHBhdHRlcm4gY2FuZGlkYXRlIHdhcyBmb3VuZCB0aGlzIHRpbWUKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYW5kbGVQb3NzaWJsZUNlbnRlciA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBpIC8qaW50Ki8sIGogLyppbnQqLywgcHVyZUJhcmNvZGUpIHsKCSAgICAgICAgdmFyIHN0YXRlQ291bnRUb3RhbCA9IHN0YXRlQ291bnRbMF0gKyBzdGF0ZUNvdW50WzFdICsgc3RhdGVDb3VudFsyXSArIHN0YXRlQ291bnRbM10gKwoJICAgICAgICAgICAgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgdmFyIGNlbnRlckogPSBGaW5kZXJQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaik7CgkgICAgICAgIHZhciBjZW50ZXJJID0gdGhpcy5jcm9zc0NoZWNrVmVydGljYWwoaSwgLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCBzdGF0ZUNvdW50WzJdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICAvLyBSZS1jcm9zcyBjaGVjawoJICAgICAgICAgICAgY2VudGVySiA9IHRoaXMuY3Jvc3NDaGVja0hvcml6b250YWwoLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCAvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIHN0YXRlQ291bnRbMl0sIHN0YXRlQ291bnRUb3RhbCk7CgkgICAgICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckopICYmCgkgICAgICAgICAgICAgICAgKCFwdXJlQmFyY29kZSB8fCB0aGlzLmNyb3NzQ2hlY2tEaWFnb25hbCgvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIC8qKGludCkgKi8gTWF0aC5mbG9vcihjZW50ZXJKKSwgc3RhdGVDb3VudFsyXSwgc3RhdGVDb3VudFRvdGFsKSkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IHN0YXRlQ291bnRUb3RhbCAvIDcuMDsKCSAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXJzID0gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwLCBsZW5ndGhfMSA9IHBvc3NpYmxlQ2VudGVycy5sZW5ndGg7IGluZGV4IDwgbGVuZ3RoXzE7IGluZGV4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IHBvc3NpYmxlQ2VudGVyc1tpbmRleF07CgkgICAgICAgICAgICAgICAgICAgIC8vIExvb2sgZm9yIGFib3V0IHRoZSBzYW1lIGNlbnRlciBhbmQgbW9kdWxlIHNpemU6CgkgICAgICAgICAgICAgICAgICAgIGlmIChjZW50ZXIuYWJvdXRFcXVhbHMoZXN0aW1hdGVkTW9kdWxlU2l6ZSwgY2VudGVySSwgY2VudGVySikpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVyc1tpbmRleF0gPSBjZW50ZXIuY29tYmluZUVzdGltYXRlKGNlbnRlckksIGNlbnRlckosIGVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlOwoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKCFmb3VuZCkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9pbnQgPSBuZXcgRmluZGVyUGF0dGVybl8xLmRlZmF1bHQoY2VudGVySiwgY2VudGVySSwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5wdXNoKHBvaW50KTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrLmZvdW5kUG9zc2libGVSZXN1bHRQb2ludChwb2ludCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2Ygcm93cyB3ZSBjb3VsZCBzYWZlbHkgc2tpcCBkdXJpbmcgc2Nhbm5pbmcsIGJhc2VkIG9uIHRoZSBmaXJzdAoJICAgICAqICAgICAgICAgdHdvIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBsb2NhdGVkLiBJbiBzb21lIGNhc2VzIHRoZWlyIHBvc2l0aW9uIHdpbGwKCSAgICAgKiAgICAgICAgIGFsbG93IHVzIHRvIGluZmVyIHRoYXQgdGhlIHRoaXJkIHBhdHRlcm4gbXVzdCBsaWUgYmVsb3cgYSBjZXJ0YWluIHBvaW50IGZhcnRoZXIKCSAgICAgKiAgICAgICAgIGRvd24gaW4gdGhlIGltYWdlLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmZpbmRSb3dTa2lwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKG1heCA8PSAxKSB7CgkgICAgICAgICAgICByZXR1cm4gMDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBudWxsOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9jID0gX2IubmV4dCgpOyAhX2MuZG9uZTsgX2MgPSBfYi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY2VudGVyID0gX2MudmFsdWU7CgkgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3RDb25maXJtZWRDZW50ZXIgPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBjZW50ZXI7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBoYXZlIHR3byBjb25maXJtZWQgY2VudGVycwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gSG93IGZhciBkb3duIGNhbiB3ZSBza2lwIGJlZm9yZSByZXN1bWluZyBsb29raW5nIGZvciB0aGUgbmV4dAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGF0dGVybj8gSW4gdGhlIHdvcnN0IGNhc2UsIG9ubHkgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRpZmZlcmVuY2UgaW4gdGhlIHggLyB5IGNvb3JkaW5hdGVzIG9mIHRoZSB0d28gY2VudGVycy4KCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIGNhc2Ugd2hlcmUgeW91IGZpbmQgdG9wIGxlZnQgbGFzdC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzU2tpcHBlZCA9IHRydWU7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLyooaW50KSAqLyBNYXRoLmZsb29yKChNYXRoLmFicyhmaXJzdENvbmZpcm1lZENlbnRlci5nZXRYKCkgLSBjZW50ZXIuZ2V0WCgpKSAtCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5hYnMoZmlyc3RDb25maXJtZWRDZW50ZXIuZ2V0WSgpIC0gY2VudGVyLmdldFkoKSkpIC8gMik7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChfYyAmJiAhX2MuZG9uZSAmJiAoX2EgPSBfYi5yZXR1cm4pKSBfYS5jYWxsKF9iKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZmYgd2UgaGF2ZSBmb3VuZCBhdCBsZWFzdCAzIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZAoJICAgICAqICAgICAgICAgYXQgbGVhc3Qge0BsaW5rICNDRU5URVJfUVVPUlVNfSB0aW1lcyBlYWNoLCBhbmQsIHRoZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgb2YgdGhlCgkgICAgICogICAgICAgICBjYW5kaWRhdGVzIGlzICJwcmV0dHkgc2ltaWxhciIKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8yLCBfYSwgZV8zLCBfYjsKCSAgICAgICAgdmFyIGNvbmZpcm1lZENvdW50ID0gMDsKCSAgICAgICAgdmFyIHRvdGFsTW9kdWxlU2l6ZSA9IDAuMDsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9jID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZCA9IF9jLm5leHQoKTsgIV9kLmRvbmU7IF9kID0gX2MubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZC52YWx1ZTsKCSAgICAgICAgICAgICAgICBpZiAocGF0dGVybi5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBjb25maXJtZWRDb3VudCsrOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcGF0dGVybi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzJfMSkgeyBlXzIgPSB7IGVycm9yOiBlXzJfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2QgJiYgIV9kLmRvbmUgJiYgKF9hID0gX2MucmV0dXJuKSkgX2EuY2FsbChfYyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvbmZpcm1lZENvdW50IDwgMykgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIE9LLCB3ZSBoYXZlIGF0IGxlYXN0IDMgY29uZmlybWVkIGNlbnRlcnMsIGJ1dCwgaXQncyBwb3NzaWJsZSB0aGF0IG9uZSBpcyBhICJmYWxzZSBwb3NpdGl2ZSIKCSAgICAgICAgLy8gYW5kIHRoYXQgd2UgbmVlZCB0byBrZWVwIGxvb2tpbmcuIFdlIGRldGVjdCB0aGlzIGJ5IGFza2luZyBpZiB0aGUgZXN0aW1hdGVkIG1vZHVsZSBzaXplcwoJICAgICAgICAvLyB2YXJ5IHRvbyBtdWNoLiBXZSBhcmJpdHJhcmlseSBzYXkgdGhhdCB3aGVuIHRoZSB0b3RhbCBkZXZpYXRpb24gZnJvbSBhdmVyYWdlIGV4Y2VlZHMKCSAgICAgICAgLy8gNSUgb2YgdGhlIHRvdGFsIG1vZHVsZSBzaXplIGVzdGltYXRlcywgaXQncyB0b28gbXVjaC4KCSAgICAgICAgdmFyIGF2ZXJhZ2UgPSB0b3RhbE1vZHVsZVNpemUgLyBtYXg7CgkgICAgICAgIHZhciB0b3RhbERldmlhdGlvbiA9IDAuMDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9lID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZiA9IF9lLm5leHQoKTsgIV9mLmRvbmU7IF9mID0gX2UubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZi52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbERldmlhdGlvbiArPSBNYXRoLmFicyhwYXR0ZXJuLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzNfMSkgeyBlXzMgPSB7IGVycm9yOiBlXzNfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2YgJiYgIV9mLmRvbmUgJiYgKF9iID0gX2UucmV0dXJuKSkgX2IuY2FsbChfZSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMykgdGhyb3cgZV8zLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRvdGFsRGV2aWF0aW9uIDw9IDAuMDUgKiB0b3RhbE1vZHVsZVNpemU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSAzIGJlc3Qge0BsaW5rIEZpbmRlclBhdHRlcm59cyBmcm9tIG91ciBsaXN0IG9mIGNhbmRpZGF0ZXMuIFRoZSAiYmVzdCIgYXJlCgkgICAgICogICAgICAgICB0aG9zZSB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZCBhdCBsZWFzdCB7QGxpbmsgI0NFTlRFUl9RVU9SVU19IHRpbWVzLCBhbmQgd2hvc2UgbW9kdWxlCgkgICAgICogICAgICAgICBzaXplIGRpZmZlcnMgZnJvbSB0aGUgYXZlcmFnZSBhbW9uZyB0aG9zZSBwYXR0ZXJucyB0aGUgbGVhc3QKCSAgICAgKiBAdGhyb3dzIE5vdEZvdW5kRXhjZXB0aW9uIGlmIDMgc3VjaCBmaW5kZXIgcGF0dGVybnMgZG8gbm90IGV4aXN0CgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuc2VsZWN0QmVzdFBhdHRlcm5zID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV80LCBfYSwgZV81LCBfYjsKCSAgICAgICAgdmFyIHN0YXJ0U2l6ZSA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKHN0YXJ0U2l6ZSA8IDMpIHsKCSAgICAgICAgICAgIC8vIENvdWxkbid0IGZpbmQgZW5vdWdoIGZpbmRlciBwYXR0ZXJucwoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBvc3NpYmxlQ2VudGVycyA9IHRoaXMucG9zc2libGVDZW50ZXJzOwoJICAgICAgICB2YXIgYXZlcmFnZTsKCSAgICAgICAgLy8gRmlsdGVyIG91dGxpZXIgcG9zc2liaWxpdGllcyB3aG9zZSBtb2R1bGUgc2l6ZSBpcyB0b28gZGlmZmVyZW50CgkgICAgICAgIGlmIChzdGFydFNpemUgPiAzKSB7CgkgICAgICAgICAgICAvLyBCdXQgd2UgY2FuIG9ubHkgYWZmb3JkIHRvIGRvIHNvIGlmIHdlIGhhdmUgYXQgbGVhc3QgNCBwb3NzaWJpbGl0aWVzIHRvIGNob29zZSBmcm9tCgkgICAgICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMC4wOwoJICAgICAgICAgICAgdmFyIHNxdWFyZSA9IDAuMDsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgX2MgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9kID0gX2MubmV4dCgpOyAhX2QuZG9uZTsgX2QgPSBfYy5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IF9kLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB2YXIgc2l6ZSA9IGNlbnRlci5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgICAgIHRvdGFsTW9kdWxlU2l6ZSArPSBzaXplOwoJICAgICAgICAgICAgICAgICAgICBzcXVhcmUgKz0gc2l6ZSAqIHNpemU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgY2F0Y2ggKGVfNF8xKSB7IGVfNCA9IHsgZXJyb3I6IGVfNF8xIH07IH0KCSAgICAgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChfZCAmJiAhX2QuZG9uZSAmJiAoX2EgPSBfYy5yZXR1cm4pKSBfYS5jYWxsKF9jKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzQpIHRocm93IGVfNC5lcnJvcjsgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYXZlcmFnZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIHN0YXJ0U2l6ZTsKCSAgICAgICAgICAgIHZhciBzdGREZXYgPSBNYXRoLnNxcnQoc3F1YXJlIC8gc3RhcnRTaXplIC0gYXZlcmFnZSAqIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzLnNvcnQoCgkgICAgICAgICAgICAvKioKCSAgICAgICAgICAgICAqIDxwPk9yZGVycyBieSBmdXJ0aGVzdCBmcm9tIGF2ZXJhZ2U8L3A+CgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIEZ1cnRoZXN0RnJvbUF2ZXJhZ2VDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICB2YXIgZEEgPSBNYXRoLmFicyhjZW50ZXIyLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgICAgIHZhciBkQiA9IE1hdGguYWJzKGNlbnRlcjEuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSk7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAtMSA6IGRBID4gZEIgPyAxIDogMDsKCSAgICAgICAgICAgIH0pOwoJICAgICAgICAgICAgdmFyIGxpbWl0ID0gTWF0aC5tYXgoMC4yICogYXZlcmFnZSwgc3RkRGV2KTsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcG9zc2libGVDZW50ZXJzLmxlbmd0aCAmJiBwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMzsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBwb3NzaWJsZUNlbnRlcnNbaV07CgkgICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKHBhdHRlcm4uZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSkgPiBsaW1pdCkgewoJICAgICAgICAgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKGksIDEpOwoJICAgICAgICAgICAgICAgICAgICBpLS07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGlmIChwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMykgewoJICAgICAgICAgICAgLy8gVGhyb3cgYXdheSBhbGwgYnV0IHRob3NlIGZpcnN0IHNpemUgY2FuZGlkYXRlIHBvaW50cyB3ZSBmb3VuZC4KCSAgICAgICAgICAgIHZhciB0b3RhbE1vZHVsZVNpemUgPSAwLjA7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGZvciAodmFyIHBvc3NpYmxlQ2VudGVyc18xID0gX192YWx1ZXMocG9zc2libGVDZW50ZXJzKSwgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKTsgIXBvc3NpYmxlQ2VudGVyc18xXzEuZG9uZTsgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXIgPSBwb3NzaWJsZUNlbnRlcnNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcG9zc2libGVDZW50ZXIuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGNhdGNoIChlXzVfMSkgeyBlXzUgPSB7IGVycm9yOiBlXzVfMSB9OyB9CgkgICAgICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgICAgICBpZiAocG9zc2libGVDZW50ZXJzXzFfMSAmJiAhcG9zc2libGVDZW50ZXJzXzFfMS5kb25lICYmIChfYiA9IHBvc3NpYmxlQ2VudGVyc18xLnJldHVybikpIF9iLmNhbGwocG9zc2libGVDZW50ZXJzXzEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfNSkgdGhyb3cgZV81LmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhdmVyYWdlID0gdG90YWxNb2R1bGVTaXplIC8gcG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5zb3J0KAoJICAgICAgICAgICAgLyoqCgkgICAgICAgICAgICAgKiA8cD5PcmRlcnMgYnkge0BsaW5rIEZpbmRlclBhdHRlcm4jZ2V0Q291bnQoKX0sIGRlc2NlbmRpbmcuPC9wPgoJICAgICAgICAgICAgICovCgkgICAgICAgICAgICAvLyBDZW50ZXJDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICBpZiAoY2VudGVyMi5nZXRDb3VudCgpID09PSBjZW50ZXIxLmdldENvdW50KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRBID0gTWF0aC5hYnMoY2VudGVyMi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRCID0gTWF0aC5hYnMoY2VudGVyMS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAxIDogZEEgPiBkQiA/IC0xIDogMDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBjZW50ZXIyLmdldENvdW50KCkgLSBjZW50ZXIxLmdldENvdW50KCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKDMpOyAvLyB0aGlzIGlzIG5vdCByZWFseSBuZWNlc3NhcnkgYXMgd2Ugb25seSByZXR1cm4gZmlyc3QgMyBhbnl3YXkKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gWwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzBdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzFdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzJdCgkgICAgICAgIF07CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLkNFTlRFUl9RVU9SVU0gPSAyOwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuTUlOX1NLSVAgPSAzOyAvLyAxIHBpeGVsL21vZHVsZSB0aW1lcyAzIG1vZHVsZXMvY2VudGVyCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUyA9IDU3OyAvLyBzdXBwb3J0IHVwIHRvIHZlcnNpb24gMTAgZm9yIG1vYmlsZSBjbGllbnRzCgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJRmluZGVyUGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuRmluZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV0ZWN0b3IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIE1hdGhVdGlsc18xID0gTWF0aFV0aWxzJDE7Cgl2YXIgRGV0ZWN0b3JSZXN1bHRfMSA9IERldGVjdG9yUmVzdWx0JDE7CgkvLyBpbXBvcnQgR3JpZFNhbXBsZXIgZnJvbSAnLi4vLi4vY29tbW9uL0dyaWRTYW1wbGVyJzsKCXZhciBHcmlkU2FtcGxlckluc3RhbmNlXzEgPSBHcmlkU2FtcGxlckluc3RhbmNlJDE7Cgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtJDE7Cgl2YXIgRGVjb2RlSGludFR5cGVfMSQxID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdFBvaW50XzEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIFZlcnNpb25fMSA9IFZlcnNpb24kMTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyXzEgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDE7Cgl2YXIgRmluZGVyUGF0dGVybkZpbmRlcl8xID0gRmluZGVyUGF0dGVybkZpbmRlciQxOwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgbG9naWMgdGhhdCBjYW4gZGV0ZWN0IGEgUVIgQ29kZSBpbiBhbiBpbWFnZSwgZXZlbiBpZiB0aGUgUVIgQ29kZQoJICogaXMgcm90YXRlZCBvciBza2V3ZWQsIG9yIHBhcnRpYWxseSBvYnNjdXJlZC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERldGVjdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERldGVjdG9yKGltYWdlKSB7CgkgICAgICAgIHRoaXMuaW1hZ2UgPSBpbWFnZTsKCSAgICB9CgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLmdldEltYWdlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5pbWFnZTsKCSAgICB9OwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5nZXRSZXN1bHRQb2ludENhbGxiYWNrID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBkZXRlY3QoKTogRGV0ZWN0b3JSZXN1bHQgLyp0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZXRlY3QobnVsbCkKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGhpbnRzIG9wdGlvbmFsIGhpbnRzIHRvIGRldGVjdG9yCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5kZXRlY3QgPSBmdW5jdGlvbiAoaGludHMpIHsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gKGhpbnRzID09PSBudWxsIHx8IGhpbnRzID09PSB1bmRlZmluZWQpID8gbnVsbCA6CgkgICAgICAgICAgICAvKihSZXN1bHRQb2ludENhbGxiYWNrKSAqLyBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQxLmRlZmF1bHQuTkVFRF9SRVNVTFRfUE9JTlRfQ0FMTEJBQ0spOwoJICAgICAgICB2YXIgZmluZGVyID0gbmV3IEZpbmRlclBhdHRlcm5GaW5kZXJfMS5kZWZhdWx0KHRoaXMuaW1hZ2UsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHZhciBpbmZvID0gZmluZGVyLmZpbmQoaGludHMpOwoJICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzRmluZGVyUGF0dGVybkluZm8oaW5mbyk7CgkgICAgfTsKCSAgICBEZXRlY3Rvci5wcm90b3R5cGUucHJvY2Vzc0ZpbmRlclBhdHRlcm5JbmZvID0gZnVuY3Rpb24gKGluZm8pIHsKCSAgICAgICAgdmFyIHRvcExlZnQgPSBpbmZvLmdldFRvcExlZnQoKTsKCSAgICAgICAgdmFyIHRvcFJpZ2h0ID0gaW5mby5nZXRUb3BSaWdodCgpOwoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IGluZm8uZ2V0Qm90dG9tTGVmdCgpOwoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMuY2FsY3VsYXRlTW9kdWxlU2l6ZSh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCk7CgkgICAgICAgIGlmIChtb2R1bGVTaXplIDwgMS4wKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ05vIHBhdHRlcm4gZm91bmQgaW4gcHJvY2Nlc3MgZmluZGVyLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkaW1lbnNpb24gPSBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHByb3Zpc2lvbmFsVmVyc2lvbiA9IFZlcnNpb25fMS5kZWZhdWx0LmdldFByb3Zpc2lvbmFsVmVyc2lvbkZvckRpbWVuc2lvbihkaW1lbnNpb24pOwoJICAgICAgICB2YXIgbW9kdWxlc0JldHdlZW5GUENlbnRlcnMgPSBwcm92aXNpb25hbFZlcnNpb24uZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpIC0gNzsKCSAgICAgICAgdmFyIGFsaWdubWVudFBhdHRlcm4gPSBudWxsOwoJICAgICAgICAvLyBBbnl0aGluZyBhYm92ZSB2ZXJzaW9uIDEgaGFzIGFuIGFsaWdubWVudCBwYXR0ZXJuCgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24uZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMoKS5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICAvLyBHdWVzcyB3aGVyZSBhICJib3R0b20gcmlnaHQiIGZpbmRlciBwYXR0ZXJuIHdvdWxkIGhhdmUgYmVlbgoJICAgICAgICAgICAgdmFyIGJvdHRvbVJpZ2h0WCA9IHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpICsgYm90dG9tTGVmdC5nZXRYKCk7CgkgICAgICAgICAgICB2YXIgYm90dG9tUmlnaHRZID0gdG9wUmlnaHQuZ2V0WSgpIC0gdG9wTGVmdC5nZXRZKCkgKyBib3R0b21MZWZ0LmdldFkoKTsKCSAgICAgICAgICAgIC8vIEVzdGltYXRlIHRoYXQgYWxpZ25tZW50IHBhdHRlcm4gaXMgY2xvc2VyIGJ5IDMgbW9kdWxlcwoJICAgICAgICAgICAgLy8gZnJvbSAiYm90dG9tIHJpZ2h0IiB0byBrbm93biB0b3AgbGVmdCBsb2NhdGlvbgoJICAgICAgICAgICAgdmFyIGNvcnJlY3Rpb25Ub1RvcExlZnQgPSAxLjAgLSAzLjAgLyBtb2R1bGVzQmV0d2VlbkZQQ2VudGVyczsKCSAgICAgICAgICAgIHZhciBlc3RBbGlnbm1lbnRYID0gLyooaW50KSAqLyBNYXRoLmZsb29yKHRvcExlZnQuZ2V0WCgpICsgY29ycmVjdGlvblRvVG9wTGVmdCAqIChib3R0b21SaWdodFggLSB0b3BMZWZ0LmdldFgoKSkpOwoJICAgICAgICAgICAgdmFyIGVzdEFsaWdubWVudFkgPSAvKihpbnQpICovIE1hdGguZmxvb3IodG9wTGVmdC5nZXRZKCkgKyBjb3JyZWN0aW9uVG9Ub3BMZWZ0ICogKGJvdHRvbVJpZ2h0WSAtIHRvcExlZnQuZ2V0WSgpKSk7CgkgICAgICAgICAgICAvLyBLaW5kIG9mIGFyYml0cmFyeSAtLSBleHBhbmQgc2VhcmNoIHJhZGl1cyBiZWZvcmUgZ2l2aW5nIHVwCgkgICAgICAgICAgICBmb3IgKHZhciBpID0gNDsgaSA8PSAxNjsgaSA8PD0gMSkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGFsaWdubWVudFBhdHRlcm4gPSB0aGlzLmZpbmRBbGlnbm1lbnRJblJlZ2lvbihtb2R1bGVTaXplLCBlc3RBbGlnbm1lbnRYLCBlc3RBbGlnbm1lbnRZLCBpKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGNhdGNoIChyZSAvKk5vdEZvdW5kRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCEocmUgaW5zdGFuY2VvZiBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IHJlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIC8vIHRyeSBuZXh0IHJvdW5kCgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gSWYgd2UgZGlkbid0IGZpbmQgYWxpZ25tZW50IHBhdHRlcm4uLi4gd2VsbCB0cnkgYW55d2F5IHdpdGhvdXQgaXQKCSAgICAgICAgfQoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gRGV0ZWN0b3IuY3JlYXRlVHJhbnNmb3JtKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBhbGlnbm1lbnRQYXR0ZXJuLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgYml0cyA9IERldGVjdG9yLnNhbXBsZUdyaWQodGhpcy5pbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgcG9pbnRzOwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgcG9pbnRzID0gW2JvdHRvbUxlZnQsIHRvcExlZnQsIHRvcFJpZ2h0XTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHBvaW50cyA9IFtib3R0b21MZWZ0LCB0b3BMZWZ0LCB0b3BSaWdodCwgYWxpZ25tZW50UGF0dGVybl07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBEZXRlY3RvclJlc3VsdF8xLmRlZmF1bHQoYml0cywgcG9pbnRzKTsKCSAgICB9OwoJICAgIERldGVjdG9yLmNyZWF0ZVRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCwgYWxpZ25tZW50UGF0dGVybiwgZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGRpbU1pbnVzVGhyZWUgPSBkaW1lbnNpb24gLSAzLjU7CgkgICAgICAgIHZhciBib3R0b21SaWdodFg7IC8qZmxvYXQqLwoJICAgICAgICB2YXIgYm90dG9tUmlnaHRZOyAvKmZsb2F0Ki8KCSAgICAgICAgdmFyIHNvdXJjZUJvdHRvbVJpZ2h0WDsgLypmbG9hdCovCgkgICAgICAgIHZhciBzb3VyY2VCb3R0b21SaWdodFk7IC8qZmxvYXQqLwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiAhPT0gbnVsbCkgewoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gYWxpZ25tZW50UGF0dGVybi5nZXRYKCk7CgkgICAgICAgICAgICBib3R0b21SaWdodFkgPSBhbGlnbm1lbnRQYXR0ZXJuLmdldFkoKTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WCA9IGRpbU1pbnVzVGhyZWUgLSAzLjA7CgkgICAgICAgICAgICBzb3VyY2VCb3R0b21SaWdodFkgPSBzb3VyY2VCb3R0b21SaWdodFg7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBEb24ndCBoYXZlIGFuIGFsaWdubWVudCBwYXR0ZXJuLCBqdXN0IG1ha2UgdXAgdGhlIGJvdHRvbS1yaWdodCBwb2ludAoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gKHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpKSArIGJvdHRvbUxlZnQuZ2V0WCgpOwoJICAgICAgICAgICAgYm90dG9tUmlnaHRZID0gKHRvcFJpZ2h0LmdldFkoKSAtIHRvcExlZnQuZ2V0WSgpKSArIGJvdHRvbUxlZnQuZ2V0WSgpOwoJICAgICAgICAgICAgc291cmNlQm90dG9tUmlnaHRYID0gZGltTWludXNUaHJlZTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WSA9IGRpbU1pbnVzVGhyZWU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtXzEuZGVmYXVsdC5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsKDMuNSwgMy41LCBkaW1NaW51c1RocmVlLCAzLjUsIHNvdXJjZUJvdHRvbVJpZ2h0WCwgc291cmNlQm90dG9tUmlnaHRZLCAzLjUsIGRpbU1pbnVzVGhyZWUsIHRvcExlZnQuZ2V0WCgpLCB0b3BMZWZ0LmdldFkoKSwgdG9wUmlnaHQuZ2V0WCgpLCB0b3BSaWdodC5nZXRZKCksIGJvdHRvbVJpZ2h0WCwgYm90dG9tUmlnaHRZLCBib3R0b21MZWZ0LmdldFgoKSwgYm90dG9tTGVmdC5nZXRZKCkpOwoJICAgIH07CgkgICAgRGV0ZWN0b3Iuc2FtcGxlR3JpZCA9IGZ1bmN0aW9uIChpbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24gLyppbnQqLykgewoJICAgICAgICB2YXIgc2FtcGxlciA9IEdyaWRTYW1wbGVySW5zdGFuY2VfMS5kZWZhdWx0LmdldEluc3RhbmNlKCk7CgkgICAgICAgIHJldHVybiBzYW1wbGVyLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtKGltYWdlLCBkaW1lbnNpb24sIGRpbWVuc2lvbiwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkNvbXB1dGVzIHRoZSBkaW1lbnNpb24gKG51bWJlciBvZiBtb2R1bGVzIG9uIGEgc2l6ZSkgb2YgdGhlIFFSIENvZGUgYmFzZWQgb24gdGhlIHBvc2l0aW9uCgkgICAgICogb2YgdGhlIGZpbmRlciBwYXR0ZXJucyBhbmQgZXN0aW1hdGVkIG1vZHVsZSBzaXplLjwvcD4KCSAgICAgKi8KCSAgICBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uID0gZnVuY3Rpb24gKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdGx0ckNlbnRlcnNEaW1lbnNpb24gPSBNYXRoVXRpbHNfMS5kZWZhdWx0LnJvdW5kKFJlc3VsdFBvaW50XzEuZGVmYXVsdC5kaXN0YW5jZSh0b3BMZWZ0LCB0b3BSaWdodCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHRsYmxDZW50ZXJzRGltZW5zaW9uID0gTWF0aFV0aWxzXzEuZGVmYXVsdC5yb3VuZChSZXN1bHRQb2ludF8xLmRlZmF1bHQuZGlzdGFuY2UodG9wTGVmdCwgYm90dG9tTGVmdCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IE1hdGguZmxvb3IoKHRsdHJDZW50ZXJzRGltZW5zaW9uICsgdGxibENlbnRlcnNEaW1lbnNpb24pIC8gMikgKyA3OwoJICAgICAgICBzd2l0Y2ggKGRpbWVuc2lvbiAmIDB4MDMpIHsgLy8gbW9kIDQKCSAgICAgICAgICAgIGNhc2UgMDoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24rKzsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIC8vIDE/IGRvIG5vdGhpbmcKCSAgICAgICAgICAgIGNhc2UgMjoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24tLTsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIGNhc2UgMzoKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ0RpbWVuc2lvbnMgY291bGQgYmUgbm90IGZvdW5kLicpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBkaW1lbnNpb247CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5Db21wdXRlcyBhbiBhdmVyYWdlIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBiYXNlZCBvbiBlc3RpbWF0ZWQgZGVyaXZlZCBmcm9tIHRoZSBwb3NpdGlvbnMKCSAgICAgKiBvZiB0aGUgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB0b3BMZWZ0IGRldGVjdGVkIHRvcC1sZWZ0IGZpbmRlciBwYXR0ZXJuIGNlbnRlcgoJICAgICAqIEBwYXJhbSB0b3BSaWdodCBkZXRlY3RlZCB0b3AtcmlnaHQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHBhcmFtIGJvdHRvbUxlZnQgZGV0ZWN0ZWQgYm90dG9tLWxlZnQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHJldHVybiBlc3RpbWF0ZWQgbW9kdWxlIHNpemUKCSAgICAgKi8KCSAgICBEZXRlY3Rvci5wcm90b3R5cGUuY2FsY3VsYXRlTW9kdWxlU2l6ZSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCkgewoJICAgICAgICAvLyBUYWtlIHRoZSBhdmVyYWdlCgkgICAgICAgIHJldHVybiAodGhpcy5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5KHRvcExlZnQsIHRvcFJpZ2h0KSArCgkgICAgICAgICAgICB0aGlzLmNhbGN1bGF0ZU1vZHVsZVNpemVPbmVXYXkodG9wTGVmdCwgYm90dG9tTGVmdCkpIC8gMi4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RXN0aW1hdGVzIG1vZHVsZSBzaXplIGJhc2VkIG9uIHR3byBmaW5kZXIgcGF0dGVybnMgLS0gaXQgdXNlcwoJICAgICAqIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuQm90aFdheXMoaW50LCBpbnQsIGludCwgaW50KX0gdG8gZmlndXJlIHRoZQoJICAgICAqIHdpZHRoIG9mIGVhY2gsIG1lYXN1cmluZyBhbG9uZyB0aGUgYXhpcyBiZXR3ZWVuIHRoZWlyIGNlbnRlcnMuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5ID0gZnVuY3Rpb24gKHBhdHRlcm4sIG90aGVyUGF0dGVybikgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZUVzdDEgPSB0aGlzLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzKC8qKGludCkgKi8gTWF0aC5mbG9vcihwYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRZKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRZKCkpKTsKCSAgICAgICAgdmFyIG1vZHVsZVNpemVFc3QyID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW5Cb3RoV2F5cygvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFkoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKHBhdHRlcm4uZ2V0WSgpKSk7CgkgICAgICAgIGlmIChpc05hTihtb2R1bGVTaXplRXN0MSkpIHsKCSAgICAgICAgICAgIHJldHVybiBtb2R1bGVTaXplRXN0MiAvIDcuMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaXNOYU4obW9kdWxlU2l6ZUVzdDIpKSB7CgkgICAgICAgICAgICByZXR1cm4gbW9kdWxlU2l6ZUVzdDEgLyA3LjA7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQXZlcmFnZSB0aGVtLCBhbmQgZGl2aWRlIGJ5IDcgc2luY2Ugd2UndmUgY291bnRlZCB0aGUgd2lkdGggb2YgMyBibGFjayBtb2R1bGVzLAoJICAgICAgICAvLyBhbmQgMSB3aGl0ZSBhbmQgMSBibGFjayBtb2R1bGUgb24gZWl0aGVyIHNpZGUuIEVyZ28sIGRpdmlkZSBzdW0gYnkgMTQuCgkgICAgICAgIHJldHVybiAobW9kdWxlU2l6ZUVzdDEgKyBtb2R1bGVTaXplRXN0MikgLyAxNC4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuKGludCwgaW50LCBpbnQsIGludCl9OyBjb21wdXRlcyB0aGUgdG90YWwgd2lkdGggb2YKCSAgICAgKiBhIGZpbmRlciBwYXR0ZXJuIGJ5IGxvb2tpbmcgZm9yIGEgYmxhY2std2hpdGUtYmxhY2sgcnVuIGZyb20gdGhlIGNlbnRlciBpbiB0aGUgZGlyZWN0aW9uCgkgICAgICogb2YgYW5vdGhlciBwb2ludCAoYW5vdGhlciBmaW5kZXIgcGF0dGVybiBjZW50ZXIpLCBhbmQgaW4gdGhlIG9wcG9zaXRlIGRpcmVjdGlvbiB0b28uCgkgICAgICovCgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzID0gZnVuY3Rpb24gKGZyb21YIC8qaW50Ki8sIGZyb21ZIC8qaW50Ki8sIHRvWCAvKmludCovLCB0b1kgLyppbnQqLykgewoJICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCB0b1gsIHRvWSk7CgkgICAgICAgIC8vIE5vdyBjb3VudCBvdGhlciB3YXkgLS0gZG9uJ3QgcnVuIG9mZiBpbWFnZSB0aG91Z2ggb2YgY291cnNlCgkgICAgICAgIHZhciBzY2FsZSA9IDEuMDsKCSAgICAgICAgdmFyIG90aGVyVG9YID0gZnJvbVggLSAodG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAob3RoZXJUb1ggPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21YIC8gLyooZmxvYXQpICovIChmcm9tWCAtIG90aGVyVG9YKTsKCSAgICAgICAgICAgIG90aGVyVG9YID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWCA+PSB0aGlzLmltYWdlLmdldFdpZHRoKCkpIHsKCSAgICAgICAgICAgIHNjYWxlID0gKHRoaXMuaW1hZ2UuZ2V0V2lkdGgoKSAtIDEgLSBmcm9tWCkgLyAvKihmbG9hdCkgKi8gKG90aGVyVG9YIC0gZnJvbVgpOwoJICAgICAgICAgICAgb3RoZXJUb1ggPSB0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlclRvWSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihmcm9tWSAtICh0b1kgLSBmcm9tWSkgKiBzY2FsZSk7CgkgICAgICAgIHNjYWxlID0gMS4wOwoJICAgICAgICBpZiAob3RoZXJUb1kgPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21ZIC8gLyooZmxvYXQpICovIChmcm9tWSAtIG90aGVyVG9ZKTsKCSAgICAgICAgICAgIG90aGVyVG9ZID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWSA+PSB0aGlzLmltYWdlLmdldEhlaWdodCgpKSB7CgkgICAgICAgICAgICBzY2FsZSA9ICh0aGlzLmltYWdlLmdldEhlaWdodCgpIC0gMSAtIGZyb21ZKSAvIC8qKGZsb2F0KSAqLyAob3RoZXJUb1kgLSBmcm9tWSk7CgkgICAgICAgICAgICBvdGhlclRvWSA9IHRoaXMuaW1hZ2UuZ2V0SGVpZ2h0KCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIG90aGVyVG9YID0gLyooaW50KSAqLyBNYXRoLmZsb29yKGZyb21YICsgKG90aGVyVG9YIC0gZnJvbVgpICogc2NhbGUpOwoJICAgICAgICByZXN1bHQgKz0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCBvdGhlclRvWCwgb3RoZXJUb1kpOwoJICAgICAgICAvLyBNaWRkbGUgcGl4ZWwgaXMgZG91YmxlLWNvdW50ZWQgdGhpcyB3YXk7IHN1YnRyYWN0IDEKCSAgICAgICAgcmV0dXJuIHJlc3VsdCAtIDEuMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHRyYWNlcyBhIGxpbmUgZnJvbSBhIHBvaW50IGluIHRoZSBpbWFnZSwgaW4gdGhlIGRpcmVjdGlvbiB0b3dhcmRzIGFub3RoZXIgcG9pbnQuCgkgICAgICogSXQgYmVnaW5zIGluIGEgYmxhY2sgcmVnaW9uLCBhbmQga2VlcHMgZ29pbmcgdW50aWwgaXQgZmluZHMgd2hpdGUsIHRoZW4gYmxhY2ssIHRoZW4gd2hpdGUgYWdhaW4uCgkgICAgICogSXQgcmVwb3J0cyB0aGUgZGlzdGFuY2UgZnJvbSB0aGUgc3RhcnQgdG8gdGhpcyBwb2ludC48L3A+CgkgICAgICoKCSAgICAgKiA8cD5UaGlzIGlzIHVzZWQgd2hlbiBmaWd1cmluZyBvdXQgaG93IHdpZGUgYSBmaW5kZXIgcGF0dGVybiBpcywgd2hlbiB0aGUgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBtYXkgYmUgc2tld2VkIG9yIHJvdGF0ZWQuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4gPSBmdW5jdGlvbiAoZnJvbVggLyppbnQqLywgZnJvbVkgLyppbnQqLywgdG9YIC8qaW50Ki8sIHRvWSAvKmludCovKSB7CgkgICAgICAgIC8vIE1pbGQgdmFyaWFudCBvZiBCcmVzZW5oYW0ncyBhbGdvcml0aG0KCSAgICAgICAgLy8gc2VlIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQnJlc2VuaGFtJ3NfbGluZV9hbGdvcml0aG0KCSAgICAgICAgdmFyIHN0ZWVwID0gTWF0aC5hYnModG9ZIC0gZnJvbVkpID4gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAoc3RlZXApIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZnJvbVg7CgkgICAgICAgICAgICBmcm9tWCA9IGZyb21ZOwoJICAgICAgICAgICAgZnJvbVkgPSB0ZW1wOwoJICAgICAgICAgICAgdGVtcCA9IHRvWDsKCSAgICAgICAgICAgIHRvWCA9IHRvWTsKCSAgICAgICAgICAgIHRvWSA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGR4ID0gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICB2YXIgZHkgPSBNYXRoLmFicyh0b1kgLSBmcm9tWSk7CgkgICAgICAgIHZhciBlcnJvciA9IC1keCAvIDI7CgkgICAgICAgIHZhciB4c3RlcCA9IGZyb21YIDwgdG9YID8gMSA6IC0xOwoJICAgICAgICB2YXIgeXN0ZXAgPSBmcm9tWSA8IHRvWSA/IDEgOiAtMTsKCSAgICAgICAgLy8gSW4gYmxhY2sgcGl4ZWxzLCBsb29raW5nIGZvciB3aGl0ZSwgZmlyc3Qgb3Igc2Vjb25kIHRpbWUuCgkgICAgICAgIHZhciBzdGF0ZSA9IDA7CgkgICAgICAgIC8vIExvb3AgdXAgdW50aWwgeCA9PSB0b1gsIGJ1dCBub3QgYmV5b25kCgkgICAgICAgIHZhciB4TGltaXQgPSB0b1ggKyB4c3RlcDsKCSAgICAgICAgZm9yICh2YXIgeCA9IGZyb21YLCB5ID0gZnJvbVk7IHggIT09IHhMaW1pdDsgeCArPSB4c3RlcCkgewoJICAgICAgICAgICAgdmFyIHJlYWxYID0gc3RlZXAgPyB5IDogeDsKCSAgICAgICAgICAgIHZhciByZWFsWSA9IHN0ZWVwID8geCA6IHk7CgkgICAgICAgICAgICAvLyBEb2VzIGN1cnJlbnQgcGl4ZWwgbWVhbiB3ZSBoYXZlIG1vdmVkIHdoaXRlIHRvIGJsYWNrIG9yIHZpY2UgdmVyc2E/CgkgICAgICAgICAgICAvLyBTY2FubmluZyBibGFjayBpbiBzdGF0ZSAwLDIgYW5kIHdoaXRlIGluIHN0YXRlIDEsIHNvIGlmIHdlIGZpbmQgdGhlIHdyb25nCgkgICAgICAgICAgICAvLyBjb2xvciwgYWR2YW5jZSB0byBuZXh0IHN0YXRlIG9yIGVuZCBpZiB3ZSBhcmUgaW4gc3RhdGUgMiBhbHJlYWR5CgkgICAgICAgICAgICBpZiAoKHN0YXRlID09PSAxKSA9PT0gdGhpcy5pbWFnZS5nZXQocmVhbFgsIHJlYWxZKSkgewoJICAgICAgICAgICAgICAgIGlmIChzdGF0ZSA9PT0gMikgewoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aFV0aWxzXzEuZGVmYXVsdC5kaXN0YW5jZSh4LCB5LCBmcm9tWCwgZnJvbVkpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBzdGF0ZSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZXJyb3IgKz0gZHk7CgkgICAgICAgICAgICBpZiAoZXJyb3IgPiAwKSB7CgkgICAgICAgICAgICAgICAgaWYgKHkgPT09IHRvWSkgewoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgeSArPSB5c3RlcDsKCSAgICAgICAgICAgICAgICBlcnJvciAtPSBkeDsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBGb3VuZCBibGFjay13aGl0ZS1ibGFjazsgZ2l2ZSB0aGUgYmVuZWZpdCBvZiB0aGUgZG91YnQgdGhhdCB0aGUgbmV4dCBwaXhlbCBvdXRzaWRlIHRoZSBpbWFnZQoJICAgICAgICAvLyBpcyAid2hpdGUiIHNvIHRoaXMgbGFzdCBwb2ludCBhdCAodG9YK3hTdGVwLHRvWSkgaXMgdGhlIHJpZ2h0IGVuZGluZy4gVGhpcyBpcyByZWFsbHkgYQoJICAgICAgICAvLyBzbWFsbCBhcHByb3hpbWF0aW9uOyAodG9YK3hTdGVwLHRvWSt5U3RlcCkgbWlnaHQgYmUgcmVhbGx5IGNvcnJlY3QuIElnbm9yZSB0aGlzLgoJICAgICAgICBpZiAoc3RhdGUgPT09IDIpIHsKCSAgICAgICAgICAgIHJldHVybiBNYXRoVXRpbHNfMS5kZWZhdWx0LmRpc3RhbmNlKHRvWCArIHhzdGVwLCB0b1ksIGZyb21YLCBmcm9tWSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gZWxzZSB3ZSBkaWRuJ3QgZmluZCBldmVuIGJsYWNrLXdoaXRlLWJsYWNrOyBubyBlc3RpbWF0ZSBpcyByZWFsbHkgcG9zc2libGUKCSAgICAgICAgcmV0dXJuIE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkF0dGVtcHRzIHRvIGxvY2F0ZSBhbiBhbGlnbm1lbnQgcGF0dGVybiBpbiBhIGxpbWl0ZWQgcmVnaW9uIG9mIHRoZSBpbWFnZSwgd2hpY2ggaXMKCSAgICAgKiBndWVzc2VkIHRvIGNvbnRhaW4gaXQuIFRoaXMgbWV0aG9kIHVzZXMge0BsaW5rIEFsaWdubWVudFBhdHRlcm59LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBvdmVyYWxsRXN0TW9kdWxlU2l6ZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgc28gZmFyCgkgICAgICogQHBhcmFtIGVzdEFsaWdubWVudFggeCBjb29yZGluYXRlIG9mIGNlbnRlciBvZiBhcmVhIHByb2JhYmx5IGNvbnRhaW5pbmcgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gZXN0QWxpZ25tZW50WSB5IGNvb3JkaW5hdGUgb2YgYWJvdmUKCSAgICAgKiBAcGFyYW0gYWxsb3dhbmNlRmFjdG9yIG51bWJlciBvZiBwaXhlbHMgaW4gYWxsIGRpcmVjdGlvbnMgdG8gc2VhcmNoIGZyb20gdGhlIGNlbnRlcgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kLCBvciBudWxsIG90aGVyd2lzZQoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgYW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnMgZHVyaW5nIGRldGVjdGlvbgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5maW5kQWxpZ25tZW50SW5SZWdpb24gPSBmdW5jdGlvbiAob3ZlcmFsbEVzdE1vZHVsZVNpemUgLypmbG9hdCovLCBlc3RBbGlnbm1lbnRYIC8qaW50Ki8sIGVzdEFsaWdubWVudFkgLyppbnQqLywgYWxsb3dhbmNlRmFjdG9yIC8qZmxvYXQqLykgewoJICAgICAgICAvLyBMb29rIGZvciBhbiBhbGlnbm1lbnQgcGF0dGVybiAoMyBtb2R1bGVzIGluIHNpemUpIGFyb3VuZCB3aGVyZSBpdAoJICAgICAgICAvLyBzaG91bGQgYmUKCSAgICAgICAgdmFyIGFsbG93YW5jZSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihhbGxvd2FuY2VGYWN0b3IgKiBvdmVyYWxsRXN0TW9kdWxlU2l6ZSk7CgkgICAgICAgIHZhciBhbGlnbm1lbnRBcmVhTGVmdFggPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRYIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFSaWdodFggPSBNYXRoLm1pbih0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxLCBlc3RBbGlnbm1lbnRYICsgYWxsb3dhbmNlKTsKCSAgICAgICAgaWYgKGFsaWdubWVudEFyZWFSaWdodFggLSBhbGlnbm1lbnRBcmVhTGVmdFggPCBvdmVyYWxsRXN0TW9kdWxlU2l6ZSAqIDMpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgnQWxpZ25tZW50IHRvcCBleGNlZWRzIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS4nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYWxpZ25tZW50QXJlYVRvcFkgPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRZIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFCb3R0b21ZID0gTWF0aC5taW4odGhpcy5pbWFnZS5nZXRIZWlnaHQoKSAtIDEsIGVzdEFsaWdubWVudFkgKyBhbGxvd2FuY2UpOwoJICAgICAgICBpZiAoYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSA8IG92ZXJhbGxFc3RNb2R1bGVTaXplICogMykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMS5kZWZhdWx0KCdBbGlnbm1lbnQgYm90dG9tIGV4Y2VlZHMgZXN0aW1hdGVkIG1vZHVsZSBzaXplLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhbGlnbm1lbnRGaW5kZXIgPSBuZXcgQWxpZ25tZW50UGF0dGVybkZpbmRlcl8xLmRlZmF1bHQodGhpcy5pbWFnZSwgYWxpZ25tZW50QXJlYUxlZnRYLCBhbGlnbm1lbnRBcmVhVG9wWSwgYWxpZ25tZW50QXJlYVJpZ2h0WCAtIGFsaWdubWVudEFyZWFMZWZ0WCwgYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSwgb3ZlcmFsbEVzdE1vZHVsZVNpemUsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHJldHVybiBhbGlnbm1lbnRGaW5kZXIuZmluZCgpOwoJICAgIH07CgkgICAgcmV0dXJuIERldGVjdG9yOwoJfSgpKTsKCURldGVjdG9yJDEuZGVmYXVsdCA9IERldGVjdG9yOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUVJDb2RlUmVhZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlIHsqLwoJdmFyIEJhcmNvZGVGb3JtYXRfMSA9IEJhcmNvZGVGb3JtYXQkMTsKCXZhciBCaXRNYXRyaXhfMSA9IEJpdE1hdHJpeCQxOwoJdmFyIERlY29kZUhpbnRUeXBlXzEgPSBEZWNvZGVIaW50VHlwZSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdF8xID0gUmVzdWx0JDE7Cgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlXzEgPSBSZXN1bHRNZXRhZGF0YVR5cGUkMTsKCS8vIGltcG9ydCBEZXRlY3RvclJlc3VsdCBmcm9tICcuLi9jb21tb24vRGV0ZWN0b3JSZXN1bHQnOwoJdmFyIERlY29kZXJfMSA9IERlY29kZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSA9IFFSQ29kZURlY29kZXJNZXRhRGF0YSQxOwoJdmFyIERldGVjdG9yXzEgPSBEZXRlY3RvciQxOwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5NYXA7Ki8KCS8qKgoJICogVGhpcyBpbXBsZW1lbnRhdGlvbiBjYW4gZGV0ZWN0IGFuZCBkZWNvZGUgUVIgQ29kZXMgaW4gYW4gaW1hZ2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFFSQ29kZVJlYWRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBRUkNvZGVSZWFkZXIoKSB7CgkgICAgICAgIHRoaXMuZGVjb2RlciA9IG5ldyBEZWNvZGVyXzEuZGVmYXVsdCgpOwoJICAgIH0KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmdldERlY29kZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBMb2NhdGVzIGFuZCBkZWNvZGVzIGEgUVIgY29kZSBpbiBhbiBpbWFnZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gYSByZXByZXNlbnRpbmc6IHN0cmluZyB0aGUgY29udGVudCBlbmNvZGVkIGJ5IHRoZSBRUiBjb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhIFFSIGNvZGUgY2Fubm90IGJlIGZvdW5kCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgYSBRUiBjb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIC8vIHB1YmxpYyBkZWNvZGUoaW1hZ2U6IEJpbmFyeUJpdG1hcCk6IFJlc3VsdCAvKnRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiwgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiAqLyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5kZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmRlY29kZSA9IGZ1bmN0aW9uIChpbWFnZSwgaGludHMpIHsKCSAgICAgICAgdmFyIGRlY29kZXJSZXN1bHQ7CgkgICAgICAgIHZhciBwb2ludHM7CgkgICAgICAgIGlmIChoaW50cyAhPT0gdW5kZWZpbmVkICYmIGhpbnRzICE9PSBudWxsICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEuZGVmYXVsdC5QVVJFX0JBUkNPREUpKSB7CgkgICAgICAgICAgICB2YXIgYml0cyA9IFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMoaW1hZ2UuZ2V0QmxhY2tNYXRyaXgoKSk7CgkgICAgICAgICAgICBkZWNvZGVyUmVzdWx0ID0gdGhpcy5kZWNvZGVyLmRlY29kZUJpdE1hdHJpeChiaXRzLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGRldGVjdG9yUmVzdWx0ID0gbmV3IERldGVjdG9yXzEuZGVmYXVsdChpbWFnZS5nZXRCbGFja01hdHJpeCgpKS5kZXRlY3QoaGludHMpOwoJICAgICAgICAgICAgZGVjb2RlclJlc3VsdCA9IHRoaXMuZGVjb2Rlci5kZWNvZGVCaXRNYXRyaXgoZGV0ZWN0b3JSZXN1bHQuZ2V0Qml0cygpLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBkZXRlY3RvclJlc3VsdC5nZXRQb2ludHMoKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB0aGUgY29kZSB3YXMgbWlycm9yZWQ6IHN3YXAgdGhlIGJvdHRvbS1sZWZ0IGFuZCB0aGUgdG9wLXJpZ2h0IHBvaW50cy4KCSAgICAgICAgaWYgKGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKSBpbnN0YW5jZW9mIFFSQ29kZURlY29kZXJNZXRhRGF0YV8xLmRlZmF1bHQpIHsKCSAgICAgICAgICAgIGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKS5hcHBseU1pcnJvcmVkQ29ycmVjdGlvbihwb2ludHMpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgUmVzdWx0XzEuZGVmYXVsdChkZWNvZGVyUmVzdWx0LmdldFRleHQoKSwgZGVjb2RlclJlc3VsdC5nZXRSYXdCeXRlcygpLCB1bmRlZmluZWQsIHBvaW50cywgQmFyY29kZUZvcm1hdF8xLmRlZmF1bHQuUVJfQ09ERSwgdW5kZWZpbmVkKTsKCSAgICAgICAgdmFyIGJ5dGVTZWdtZW50cyA9IGRlY29kZXJSZXN1bHQuZ2V0Qnl0ZVNlZ21lbnRzKCk7CgkgICAgICAgIGlmIChieXRlU2VnbWVudHMgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkJZVEVfU0VHTUVOVFMsIGJ5dGVTZWdtZW50cyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBkZWNvZGVyUmVzdWx0LmdldEVDTGV2ZWwoKTsKCSAgICAgICAgaWYgKGVjTGV2ZWwgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwsIGVjTGV2ZWwpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChkZWNvZGVyUmVzdWx0Lmhhc1N0cnVjdHVyZWRBcHBlbmQoKSkgewoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UsIGRlY29kZXJSZXN1bHQuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyKCkpOwoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfUEFSSVRZLCBkZWNvZGVyUmVzdWx0LmdldFN0cnVjdHVyZWRBcHBlbmRQYXJpdHkoKSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBkbyBub3RoaW5nCgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBUaGlzIG1ldGhvZCBkZXRlY3RzIGEgY29kZSBpbiBhICJwdXJlIiBpbWFnZSAtLSB0aGF0IGlzLCBwdXJlIG1vbm9jaHJvbWUgaW1hZ2UKCSAgICAgKiB3aGljaCBjb250YWlucyBvbmx5IGFuIHVucm90YXRlZCwgdW5za2V3ZWQsIGltYWdlIG9mIGEgY29kZSwgd2l0aCBzb21lIHdoaXRlIGJvcmRlcgoJICAgICAqIGFyb3VuZCBpdC4gVGhpcyBpcyBhIHNwZWNpYWxpemVkIG1ldGhvZCB0aGF0IHdvcmtzIGV4Y2VwdGlvbmFsbHkgZmFzdCBpbiB0aGlzIHNwZWNpYWwKCSAgICAgKiBjYXNlLgoJICAgICAqCgkgICAgICogQHNlZSBjb20uZ29vZ2xlLnp4aW5nLmRhdGFtYXRyaXguRGF0YU1hdHJpeFJlYWRlciNleHRyYWN0UHVyZUJpdHMoQml0TWF0cml4KQoJICAgICAqLwoJICAgIFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMgPSBmdW5jdGlvbiAoaW1hZ2UpIHsKCSAgICAgICAgdmFyIGxlZnRUb3BCbGFjayA9IGltYWdlLmdldFRvcExlZnRPbkJpdCgpOwoJICAgICAgICB2YXIgcmlnaHRCb3R0b21CbGFjayA9IGltYWdlLmdldEJvdHRvbVJpZ2h0T25CaXQoKTsKCSAgICAgICAgaWYgKGxlZnRUb3BCbGFjayA9PT0gbnVsbCB8fCByaWdodEJvdHRvbUJsYWNrID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1vZHVsZVNpemUgPSB0aGlzLm1vZHVsZVNpemUobGVmdFRvcEJsYWNrLCBpbWFnZSk7CgkgICAgICAgIHZhciB0b3AgPSBsZWZ0VG9wQmxhY2tbMV07CgkgICAgICAgIHZhciBib3R0b20gPSByaWdodEJvdHRvbUJsYWNrWzFdOwoJICAgICAgICB2YXIgbGVmdCA9IGxlZnRUb3BCbGFja1swXTsKCSAgICAgICAgdmFyIHJpZ2h0ID0gcmlnaHRCb3R0b21CbGFja1swXTsKCSAgICAgICAgLy8gU2FuaXR5IGNoZWNrIQoJICAgICAgICBpZiAobGVmdCA+PSByaWdodCB8fCB0b3AgPj0gYm90dG9tKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJvdHRvbSAtIHRvcCAhPT0gcmlnaHQgLSBsZWZ0KSB7CgkgICAgICAgICAgICAvLyBTcGVjaWFsIGNhc2UsIHdoZXJlIGJvdHRvbS1yaWdodCBtb2R1bGUgd2Fzbid0IGJsYWNrIHNvIHdlIGZvdW5kIHNvbWV0aGluZyBlbHNlIGluIHRoZSBsYXN0IHJvdwoJICAgICAgICAgICAgLy8gQXNzdW1lIGl0J3MgYSBzcXVhcmUsIHNvIHVzZSBoZWlnaHQgYXMgdGhlIHdpZHRoCgkgICAgICAgICAgICByaWdodCA9IGxlZnQgKyAoYm90dG9tIC0gdG9wKTsKCSAgICAgICAgICAgIGlmIChyaWdodCA+PSBpbWFnZS5nZXRXaWR0aCgpKSB7CgkgICAgICAgICAgICAgICAgLy8gQWJvcnQgaWYgdGhhdCB3b3VsZCBub3QgbWFrZSBzZW5zZSAtLSBvZmYgaW1hZ2UKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1hdHJpeFdpZHRoID0gTWF0aC5yb3VuZCgocmlnaHQgLSBsZWZ0ICsgMSkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIG1hdHJpeEhlaWdodCA9IE1hdGgucm91bmQoKGJvdHRvbSAtIHRvcCArIDEpIC8gbW9kdWxlU2l6ZSk7CgkgICAgICAgIGlmIChtYXRyaXhXaWR0aCA8PSAwIHx8IG1hdHJpeEhlaWdodCA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG1hdHJpeEhlaWdodCAhPT0gbWF0cml4V2lkdGgpIHsKCSAgICAgICAgICAgIC8vIE9ubHkgcG9zc2libHkgZGVjb2RlIHNxdWFyZSByZWdpb25zCgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gUHVzaCBpbiB0aGUgImJvcmRlciIgYnkgaGFsZiB0aGUgbW9kdWxlIHdpZHRoIHNvIHRoYXQgd2Ugc3RhcnQKCSAgICAgICAgLy8gc2FtcGxpbmcgaW4gdGhlIG1pZGRsZSBvZiB0aGUgbW9kdWxlLiBKdXN0IGluIGNhc2UgdGhlIGltYWdlIGlzIGEKCSAgICAgICAgLy8gbGl0dGxlIG9mZiwgdGhpcyB3aWxsIGhlbHAgcmVjb3Zlci4KCSAgICAgICAgdmFyIG51ZGdlID0gLyooaW50KSAqLyBNYXRoLmZsb29yKG1vZHVsZVNpemUgLyAyLjApOwoJICAgICAgICB0b3AgKz0gbnVkZ2U7CgkgICAgICAgIGxlZnQgKz0gbnVkZ2U7CgkgICAgICAgIC8vIEJ1dCBjYXJlZnVsIHRoYXQgdGhpcyBkb2VzIG5vdCBzYW1wbGUgb2ZmIHRoZSBlZGdlCgkgICAgICAgIC8vICJyaWdodCIgaXMgdGhlIGZhcnRoZXN0LXJpZ2h0IHZhbGlkIHBpeGVsIGxvY2F0aW9uIC0tIHJpZ2h0KzEgaXMgbm90IG5lY2Vzc2FyaWx5CgkgICAgICAgIC8vIFRoaXMgaXMgcG9zaXRpdmUgYnkgaG93IG11Y2ggdGhlIGlubmVyIHggbG9vcCBiZWxvdyB3b3VsZCBiZSB0b28gbGFyZ2UKCSAgICAgICAgdmFyIG51ZGdlZFRvb0ZhclJpZ2h0ID0gbGVmdCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4V2lkdGggLSAxKSAqIG1vZHVsZVNpemUpIC0gcmlnaHQ7CgkgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IDApIHsKCSAgICAgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsZWZ0IC09IG51ZGdlZFRvb0ZhclJpZ2h0OwoJICAgICAgICB9CgkgICAgICAgIC8vIFNlZSBsb2dpYyBhYm92ZQoJICAgICAgICB2YXIgbnVkZ2VkVG9vRmFyRG93biA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4SGVpZ2h0IC0gMSkgKiBtb2R1bGVTaXplKSAtIGJvdHRvbTsKCSAgICAgICAgaWYgKG51ZGdlZFRvb0ZhckRvd24gPiAwKSB7CgkgICAgICAgICAgICBpZiAobnVkZ2VkVG9vRmFyRG93biA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3AgLT0gbnVkZ2VkVG9vRmFyRG93bjsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cganVzdCByZWFkIG9mZiB0aGUgYml0cwoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMS5kZWZhdWx0KG1hdHJpeFdpZHRoLCBtYXRyaXhIZWlnaHQpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IG1hdHJpeEhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgaU9mZnNldCA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcih5ICogbW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1hdHJpeFdpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KGxlZnQgKyAvKihpbnQpICovIE1hdGguZmxvb3IoeCAqIG1vZHVsZVNpemUpLCBpT2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIubW9kdWxlU2l6ZSA9IGZ1bmN0aW9uIChsZWZ0VG9wQmxhY2ssIGltYWdlKSB7CgkgICAgICAgIHZhciBoZWlnaHQgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHggPSBsZWZ0VG9wQmxhY2tbMF07CgkgICAgICAgIHZhciB5ID0gbGVmdFRvcEJsYWNrWzFdOwoJICAgICAgICB2YXIgaW5CbGFjayA9IHRydWU7CgkgICAgICAgIHZhciB0cmFuc2l0aW9ucyA9IDA7CgkgICAgICAgIHdoaWxlICh4IDwgd2lkdGggJiYgeSA8IGhlaWdodCkgewoJICAgICAgICAgICAgaWYgKGluQmxhY2sgIT09IGltYWdlLmdldCh4LCB5KSkgewoJICAgICAgICAgICAgICAgIGlmICgrK3RyYW5zaXRpb25zID09PSA1KSB7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBpbkJsYWNrID0gIWluQmxhY2s7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB4Kys7CgkgICAgICAgICAgICB5Kys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHggPT09IHdpZHRoIHx8IHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiAoeCAtIGxlZnRUb3BCbGFja1swXSkgLyA3LjA7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTID0gbmV3IEFycmF5KCk7CgkgICAgcmV0dXJuIFFSQ29kZVJlYWRlcjsKCX0oKSk7Cgl2YXIgX2RlZmF1bHQgPSBRUkNvZGVSZWFkZXIkMS5kZWZhdWx0ID0gUVJDb2RlUmVhZGVyOwoKCXZhciB0b0dyYXlzY2FsZUJ1ZmZlciA9IGZ1bmN0aW9uIHRvR3JheXNjYWxlQnVmZmVyKGltYWdlQnVmZmVyLCB3aWR0aCwgaGVpZ2h0KSB7CgkgIHZhciBncmF5c2NhbGVCdWZmZXIgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkod2lkdGggKiBoZWlnaHQpOwoKCSAgZm9yICh2YXIgaSA9IDAsIGogPSAwLCBsZW5ndGhfMSA9IGltYWdlQnVmZmVyLmxlbmd0aDsgaSA8IGxlbmd0aF8xOyBpICs9IDQsIGorKykgewoJICAgIHZhciBncmF5ID0gdm9pZCAwOwoJICAgIHZhciBhbHBoYSA9IGltYWdlQnVmZmVyW2kgKyAzXTsgLy8gVGhlIGNvbG9yIG9mIGZ1bGx5LXRyYW5zcGFyZW50IHBpeGVscyBpcyBpcnJlbGV2YW50LiBUaGV5IGFyZSBvZnRlbiwgdGVjaG5pY2FsbHksIGZ1bGx5LXRyYW5zcGFyZW50CgkgICAgLy8gYmxhY2sgKDAgYWxwaGEsIGFuZCB0aGVuIDAgUkdCKS4gVGhleSBhcmUgb2Z0ZW4gdXNlZCwgb2YgY291cnNlIGFzIHRoZSAid2hpdGUiIGFyZWEgaW4gYQoJICAgIC8vIGJhcmNvZGUgaW1hZ2UuIEZvcmNlIGFueSBzdWNoIHBpeGVsIHRvIGJlIHdoaXRlOgoKCSAgICBpZiAoYWxwaGEgPT09IDApIHsKCSAgICAgIGdyYXkgPSAweEZGOwoJICAgIH0gZWxzZSB7CgkgICAgICB2YXIgcGl4ZWxSID0gaW1hZ2VCdWZmZXJbaV07CgkgICAgICB2YXIgcGl4ZWxHID0gaW1hZ2VCdWZmZXJbaSArIDFdOwoJICAgICAgdmFyIHBpeGVsQiA9IGltYWdlQnVmZmVyW2kgKyAyXTsgLy8gLjI5OVIgKyAwLjU4N0cgKyAwLjExNEIgKFlVVi9ZSVEgZm9yIFBBTCBhbmQgTlRTQyksCgkgICAgICAvLyAoMzA2KlIpID4+IDEwIGlzIGFwcHJveGltYXRlbHkgZXF1YWwgdG8gUiowLjI5OSwgYW5kIHNvIG9uLgoJICAgICAgLy8gMHgyMDAgPj4gMTAgaXMgMC41LCBpdCBpbXBsZW1lbnRzIHJvdW5kaW5nLgoKCSAgICAgIGdyYXkgPSAzMDYgKiBwaXhlbFIgKyA2MDEgKiBwaXhlbEcgKyAxMTcgKiBwaXhlbEIgKyAweDIwMCA+PiAxMDsKCSAgICB9CgoJICAgIGdyYXlzY2FsZUJ1ZmZlcltqXSA9IGdyYXk7CgkgIH0KCgkgIHJldHVybiBncmF5c2NhbGVCdWZmZXI7Cgl9OwoKCXZhciByZWFkZXIgPSBuZXcgX2RlZmF1bHQoKTsKCXNlbGYuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChlKSB7CgkgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzCgkgIHRyeSB7CgkgICAgdmFyIGx1bWluYW5jZXMgPSB0b0dyYXlzY2FsZUJ1ZmZlcihlLmRhdGEuZGF0YSwgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgbHVtaW5hbmNlU291cmNlID0gbmV3IF9kZWZhdWx0JDEobHVtaW5hbmNlcywgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgaHlicmlkQmluYXJpemVyID0gbmV3IF9kZWZhdWx0JDIobHVtaW5hbmNlU291cmNlKTsKCSAgICB2YXIgYmluYXJ5Qml0bWFwID0gbmV3IF9kZWZhdWx0JDMoaHlicmlkQmluYXJpemVyKTsKCSAgICB2YXIgZGVjb2RlZCA9IHJlYWRlci5kZWNvZGUoYmluYXJ5Qml0bWFwKTsKCSAgICBwb3N0TWVzc2FnZShkZWNvZGVkKTsKCSAgfSBjYXRjaCAoZXJyKSB7CgkgICAgcG9zdE1lc3NhZ2UobnVsbCk7CgkgIH0KCX0pOwoKfSkoKTsKCg==",null,!1),P=["constraints","onError","onLoad","onScan","resolution","qrArea"];function O(g,e){var t=Object.keys(g);if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(g);e&&(I=I.filter((function(e){return Object.getOwnPropertyDescriptor(g,e).enumerable}))),t.push.apply(t,I)}return t}function q(g){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?O(Object(t),!0).forEach((function(e){n(g,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(t)):O(Object(t)).forEach((function(e){Object.defineProperty(g,e,Object.getOwnPropertyDescriptor(t,e))}))}return g}var _=function(){return new T},$=function(g){g&&(g.getVideoTracks&&g.getAudioTracks?(g.getVideoTracks().forEach((function(e){g.removeTrack(e),e.stop()})),g.getAudioTracks().forEach((function(e){g.removeTrack(e),e.stop()}))):g.stop())},gg=function(g){var e=g.constraints,n=g.onError,C=g.onLoad,l=g.onScan,a=g.resolution,o=g.qrArea,i=s(g,P),c=t.useRef(null),A=t.useRef(null),d=t.useRef(document.createElement("canvas")),u=t.useRef(null),m=t.useRef(),h=r(t.useState(null),2),b=h[0],Z=h[1],p=t.useRef(!1),G=t.useRef();t.useEffect((function(){G.current=_();var g=G.current;return g.onmessage=function(g){l&&l(g.data?q(q({},g.data),{},{canvas:d.current}):null),p.current=!1},function(){g.terminate()}}),[l]);var y=JSON.stringify(o),B=t.useCallback((function(){var g=JSON.parse(y),e=G.current,t=A.current&&A.current.readyState===A.current.HAVE_ENOUGH_DATA;if(!p.current&&t){p.current=!0;var I,n=A.current.videoWidth,C=A.current.videoHeight,l=n>C?n:C,o=Math.floor(a/l*100)/100;C=Math.floor(o*C),n=Math.floor(o*n),d.current.width=n,d.current.height=C,u.current=d.current.getContext("2d"),u.current.drawImage(A.current,0,0,n,C),I=g&&2===g.length&&g[0]>0&&g[1]>0?u.current.getImageData(Math.floor((n-g[0])/2),Math.floor((C-g[1])/2),g[0],g[1]):u.current.getImageData(0,0,n,C),e.postMessage(I)}m.current=requestAnimationFrame(B)}),[a,y]),S=JSON.stringify(e);return t.useEffect((function(){var g=JSON.parse(S),e=!0;return navigator.mediaDevices.getUserMedia(g).then((function(g){if(e){c.current=g;try{A.current&&(A.current.srcObject=g,A.current.setAttribute("playsinline",!0))}catch(t){Z(window.URL.createObjectURL(g))}C&&C(),m.current=requestAnimationFrame(B)}else $(g)})).catch((function(g){return e?n(g):null})),function(){cancelAnimationFrame(m.current),e=!1,$(c.current),b&&window.URL.revokeObjectURL(b)}}),[B,S,n,C,b]),t.createElement("video",I({autoPlay:!0,playsInline:!0,src:b,ref:A},i))};return gg.propTypes={constraints:U.object,onError:U.func.isRequired,onLoad:U.func,onScan:U.func.isRequired,resolution:U.number,qrArea:U.array},gg.defaultProps={constraints:{audio:!1,video:!0},resolution:640,qrArea:[]},gg}(t(5043))}},e={};function t(I){var n=e[I];if(void 0!==n)return n.exports;var C=e[I]={exports:{}};return g[I].call(C.exports,C,C.exports,t),C.exports}t.m=g,t.n=g=>{var e=g&&g.__esModule?()=>g.default:()=>g;return t.d(e,{a:e}),e},(()=>{var g,e=Object.getPrototypeOf?g=>Object.getPrototypeOf(g):g=>g.__proto__;t.t=function(I,n){if(1&n&&(I=this(I)),8&n)return I;if("object"===typeof I&&I){if(4&n&&I.__esModule)return I;if(16&n&&"function"===typeof I.then)return I}var C=Object.create(null);t.r(C);var l={};g=g||[null,e({}),e([]),e(e)];for(var a=2&n&&I;"object"==typeof a&&!~g.indexOf(a);a=e(a))Object.getOwnPropertyNames(a).forEach((g=>l[g]=()=>I[g]));return l.default=()=>I,t.d(C,l),C}})(),t.d=(g,e)=>{for(var I in e)t.o(e,I)&&!t.o(g,I)&&Object.defineProperty(g,I,{enumerable:!0,get:e[I]})},t.f={},t.e=g=>Promise.all(Object.keys(t.f).reduce(((e,I)=>(t.f[I](g,e),e)),[])),t.u=g=>"static/js/"+g+"."+{12:"5836bcd6",85:"2368528e",204:"3821466f"}[g]+".chunk.js",t.miniCssF=g=>{},t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(g){if("object"===typeof window)return window}}(),t.o=(g,e)=>Object.prototype.hasOwnProperty.call(g,e),(()=>{var g={},e="astro-bsm-oracle-ivanstamas:";t.l=(I,n,C,l)=>{if(g[I])g[I].push(n);else{var a,o;if(void 0!==C)for(var i=document.getElementsByTagName("script"),r=0;r<i.length;r++){var c=i[r];if(c.getAttribute("src")==I||c.getAttribute("data-webpack")==e+C){a=c;break}}a||(o=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,t.nc&&a.setAttribute("nonce",t.nc),a.setAttribute("data-webpack",e+C),a.src=I),g[I]=[n];var s=(e,t)=>{a.onerror=a.onload=null,clearTimeout(A);var n=g[I];if(delete g[I],a.parentNode&&a.parentNode.removeChild(a),n&&n.forEach((g=>g(t))),e)return e(t)},A=setTimeout(s.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=s.bind(null,a.onerror),a.onload=s.bind(null,a.onload),o&&document.head.appendChild(a)}}})(),t.r=g=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(g,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(g,"__esModule",{value:!0})},t.p="/",(()=>{var g={792:0};t.f.j=(e,I)=>{var n=t.o(g,e)?g[e]:void 0;if(0!==n)if(n)I.push(n[2]);else{var C=new Promise(((t,I)=>n=g[e]=[t,I]));I.push(n[2]=C);var l=t.p+t.u(e),a=new Error;t.l(l,(I=>{if(t.o(g,e)&&(0!==(n=g[e])&&(g[e]=void 0),n)){var C=I&&("load"===I.type?"missing":I.type),l=I&&I.target&&I.target.src;a.message="Loading chunk "+e+" failed.\n("+C+": "+l+")",a.name="ChunkLoadError",a.type=C,a.request=l,n[1](a)}}),"chunk-"+e,e)}};var e=(e,I)=>{var n,C,l=I[0],a=I[1],o=I[2],i=0;if(l.some((e=>0!==g[e]))){for(n in a)t.o(a,n)&&(t.m[n]=a[n]);if(o)o(t)}for(e&&e(I);i<l.length;i++)C=l[i],t.o(g,C)&&g[C]&&g[C][0](),g[C]=0},I=self.webpackChunkastro_bsm_oracle_ivanstamas=self.webpackChunkastro_bsm_oracle_ivanstamas||[];I.forEach(e.bind(null,0)),I.push=e.bind(null,I.push.bind(I))})(),(()=>{"use strict";var g={};t.r(g),t.d(g,{hasBrowserEnv:()=>xe,hasStandardBrowserEnv:()=>ze,hasStandardBrowserWebWorkerEnv:()=>Ee,navigator:()=>Le,origin:()=>Me});var e,I=t(5043),n=t.t(I,2),C=t(4391),l=t(7950),a=t.t(l,2);function o(){return o=Object.assign?Object.assign.bind():function(g){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var I in t)Object.prototype.hasOwnProperty.call(t,I)&&(g[I]=t[I])}return g},o.apply(this,arguments)}!function(g){g.Pop="POP",g.Push="PUSH",g.Replace="REPLACE"}(e||(e={}));const i="popstate";function r(g,e){if(!1===g||null===g||"undefined"===typeof g)throw new Error(e)}function c(g,e){if(!g){"undefined"!==typeof console&&console.warn(e);try{throw new Error(e)}catch(t){}}}function s(g,e){return{usr:g.state,key:g.key,idx:e}}function A(g,e,t,I){return void 0===t&&(t=null),o({pathname:"string"===typeof g?g:g.pathname,search:"",hash:""},"string"===typeof e?u(e):e,{state:t,key:e&&e.key||I||Math.random().toString(36).substr(2,8)})}function d(g){let{pathname:e="/",search:t="",hash:I=""}=g;return t&&"?"!==t&&(e+="?"===t.charAt(0)?t:"?"+t),I&&"#"!==I&&(e+="#"===I.charAt(0)?I:"#"+I),e}function u(g){let e={};if(g){let t=g.indexOf("#");t>=0&&(e.hash=g.substr(t),g=g.substr(0,t));let I=g.indexOf("?");I>=0&&(e.search=g.substr(I),g=g.substr(0,I)),g&&(e.pathname=g)}return e}function m(g,t,I,n){void 0===n&&(n={});let{window:C=document.defaultView,v5Compat:l=!1}=n,a=C.history,c=e.Pop,u=null,m=h();function h(){return(a.state||{idx:null}).idx}function b(){c=e.Pop;let g=h(),t=null==g?null:g-m;m=g,u&&u({action:c,location:p.location,delta:t})}function Z(g){let e="null"!==C.location.origin?C.location.origin:C.location.href,t="string"===typeof g?g:d(g);return t=t.replace(/ $/,"%20"),r(e,"No window.location.(origin|href) available to create URL for href: "+t),new URL(t,e)}null==m&&(m=0,a.replaceState(o({},a.state,{idx:m}),""));let p={get action(){return c},get location(){return g(C,a)},listen(g){if(u)throw new Error("A history only accepts one active listener");return C.addEventListener(i,b),u=g,()=>{C.removeEventListener(i,b),u=null}},createHref:g=>t(C,g),createURL:Z,encodeLocation(g){let e=Z(g);return{pathname:e.pathname,search:e.search,hash:e.hash}},push:function(g,t){c=e.Push;let n=A(p.location,g,t);I&&I(n,g),m=h()+1;let o=s(n,m),i=p.createHref(n);try{a.pushState(o,"",i)}catch(r){if(r instanceof DOMException&&"DataCloneError"===r.name)throw r;C.location.assign(i)}l&&u&&u({action:c,location:p.location,delta:1})},replace:function(g,t){c=e.Replace;let n=A(p.location,g,t);I&&I(n,g),m=h();let C=s(n,m),o=p.createHref(n);a.replaceState(C,"",o),l&&u&&u({action:c,location:p.location,delta:0})},go:g=>a.go(g)};return p}var h;!function(g){g.data="data",g.deferred="deferred",g.redirect="redirect",g.error="error"}(h||(h={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function b(g,e,t){return void 0===t&&(t="/"),Z(g,e,t,!1)}function Z(g,e,t,I){let n=Y(("string"===typeof e?u(e):e).pathname||"/",t);if(null==n)return null;let C=p(g);!function(g){g.sort(((g,e)=>g.score!==e.score?e.score-g.score:function(g,e){let t=g.length===e.length&&g.slice(0,-1).every(((g,t)=>g===e[t]));return t?g[g.length-1]-e[e.length-1]:0}(g.routesMeta.map((g=>g.childrenIndex)),e.routesMeta.map((g=>g.childrenIndex)))))}(C);let l=null;for(let a=0;null==l&&a<C.length;++a){let g=J(n);l=X(C[a],g,I)}return l}function p(g,e,t,I){void 0===e&&(e=[]),void 0===t&&(t=[]),void 0===I&&(I="");let n=(g,n,C)=>{let l={relativePath:void 0===C?g.path||"":C,caseSensitive:!0===g.caseSensitive,childrenIndex:n,route:g};l.relativePath.startsWith("/")&&(r(l.relativePath.startsWith(I),'Absolute route path "'+l.relativePath+'" nested under path "'+I+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),l.relativePath=l.relativePath.slice(I.length));let a=K([I,l.relativePath]),o=t.concat(l);g.children&&g.children.length>0&&(r(!0!==g.index,'Index routes must not have child routes. Please remove all child routes from route path "'+a+'".'),p(g.children,e,o,a)),(null!=g.path||g.index)&&e.push({path:a,score:R(a,g.index),routesMeta:o})};return g.forEach(((g,e)=>{var t;if(""!==g.path&&null!=(t=g.path)&&t.includes("?"))for(let I of G(g.path))n(g,e,I);else n(g,e)})),e}function G(g){let e=g.split("/");if(0===e.length)return[];let[t,...I]=e,n=t.endsWith("?"),C=t.replace(/\?$/,"");if(0===I.length)return n?[C,""]:[C];let l=G(I.join("/")),a=[];return a.push(...l.map((g=>""===g?C:[C,g].join("/")))),n&&a.push(...l),a.map((e=>g.startsWith("/")&&""===e?"/":e))}const y=/^:[\w-]+$/,B=3,S=2,f=1,W=10,V=-2,v=g=>"*"===g;function R(g,e){let t=g.split("/"),I=t.length;return t.some(v)&&(I+=V),e&&(I+=S),t.filter((g=>!v(g))).reduce(((g,e)=>g+(y.test(e)?B:""===e?f:W)),I)}function X(g,e,t){void 0===t&&(t=!1);let{routesMeta:I}=g,n={},C="/",l=[];for(let a=0;a<I.length;++a){let g=I[a],o=a===I.length-1,i="/"===C?e:e.slice(C.length)||"/",r=k({path:g.relativePath,caseSensitive:g.caseSensitive,end:o},i),c=g.route;if(!r&&o&&t&&!I[I.length-1].route.index&&(r=k({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},i)),!r)return null;Object.assign(n,r.params),l.push({params:n,pathname:K([C,r.pathname]),pathnameBase:x(K([C,r.pathnameBase])),route:c}),"/"!==r.pathnameBase&&(C=K([C,r.pathnameBase]))}return l}function k(g,e){"string"===typeof g&&(g={path:g,caseSensitive:!1,end:!0});let[t,I]=function(g,e,t){void 0===e&&(e=!1);void 0===t&&(t=!0);c("*"===g||!g.endsWith("*")||g.endsWith("/*"),'Route path "'+g+'" will be treated as if it were "'+g.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+g.replace(/\*$/,"/*")+'".');let I=[],n="^"+g.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((g,e,t)=>(I.push({paramName:e,isOptional:null!=t}),t?"/?([^\\/]+)?":"/([^\\/]+)")));g.endsWith("*")?(I.push({paramName:"*"}),n+="*"===g||"/*"===g?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?n+="\\/*$":""!==g&&"/"!==g&&(n+="(?:(?=\\/|$))");let C=new RegExp(n,e?void 0:"i");return[C,I]}(g.path,g.caseSensitive,g.end),n=e.match(t);if(!n)return null;let C=n[0],l=C.replace(/(.)\/+$/,"$1"),a=n.slice(1);return{params:I.reduce(((g,e,t)=>{let{paramName:I,isOptional:n}=e;if("*"===I){let g=a[t]||"";l=C.slice(0,C.length-g.length).replace(/(.)\/+$/,"$1")}const o=a[t];return g[I]=n&&!o?void 0:(o||"").replace(/%2F/g,"/"),g}),{}),pathname:C,pathnameBase:l,pattern:g}}function J(g){try{return g.split("/").map((g=>decodeURIComponent(g).replace(/\//g,"%2F"))).join("/")}catch(e){return c(!1,'The URL path "'+g+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+e+")."),g}}function Y(g,e){if("/"===e)return g;if(!g.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,I=g.charAt(t);return I&&"/"!==I?null:g.slice(t)||"/"}function w(g,e,t,I){return"Cannot include a '"+g+"' character in a manually specified `to."+e+"` field ["+JSON.stringify(I)+"].  Please separate it out to the `to."+t+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function N(g){return g.filter(((g,e)=>0===e||g.route.path&&g.route.path.length>0))}function H(g,e){let t=N(g);return e?t.map(((g,e)=>e===t.length-1?g.pathname:g.pathnameBase)):t.map((g=>g.pathnameBase))}function F(g,e,t,I){let n;void 0===I&&(I=!1),"string"===typeof g?n=u(g):(n=o({},g),r(!n.pathname||!n.pathname.includes("?"),w("?","pathname","search",n)),r(!n.pathname||!n.pathname.includes("#"),w("#","pathname","hash",n)),r(!n.search||!n.search.includes("#"),w("#","search","hash",n)));let C,l=""===g||""===n.pathname,a=l?"/":n.pathname;if(null==a)C=t;else{let g=e.length-1;if(!I&&a.startsWith("..")){let e=a.split("/");for(;".."===e[0];)e.shift(),g-=1;n.pathname=e.join("/")}C=g>=0?e[g]:"/"}let i=function(g,e){void 0===e&&(e="/");let{pathname:t,search:I="",hash:n=""}="string"===typeof g?u(g):g,C=t?t.startsWith("/")?t:function(g,e){let t=e.replace(/\/+$/,"").split("/");return g.split("/").forEach((g=>{".."===g?t.length>1&&t.pop():"."!==g&&t.push(g)})),t.length>1?t.join("/"):"/"}(t,e):e;return{pathname:C,search:L(I),hash:z(n)}}(n,C),c=a&&"/"!==a&&a.endsWith("/"),s=(l||"."===a)&&t.endsWith("/");return i.pathname.endsWith("/")||!c&&!s||(i.pathname+="/"),i}const K=g=>g.join("/").replace(/\/\/+/g,"/"),x=g=>g.replace(/\/+$/,"").replace(/^\/*/,"/"),L=g=>g&&"?"!==g?g.startsWith("?")?g:"?"+g:"",z=g=>g&&"#"!==g?g.startsWith("#")?g:"#"+g:"";Error;function E(g){return null!=g&&"number"===typeof g.status&&"string"===typeof g.statusText&&"boolean"===typeof g.internal&&"data"in g}const M=["post","put","patch","delete"],U=(new Set(M),["get",...M]);new Set(U),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function j(){return j=Object.assign?Object.assign.bind():function(g){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var I in t)Object.prototype.hasOwnProperty.call(t,I)&&(g[I]=t[I])}return g},j.apply(this,arguments)}const Q=I.createContext(null);const D=I.createContext(null);const T=I.createContext(null);const P=I.createContext(null);const O=I.createContext({outlet:null,matches:[],isDataRoute:!1});const q=I.createContext(null);function _(){return null!=I.useContext(P)}function $(){return _()||r(!1),I.useContext(P).location}function gg(g){I.useContext(T).static||I.useLayoutEffect(g)}function eg(){let{isDataRoute:g}=I.useContext(O);return g?function(){let{router:g}=cg(ig.UseNavigateStable),e=Ag(rg.UseNavigateStable),t=I.useRef(!1);return gg((()=>{t.current=!0})),I.useCallback((function(I,n){void 0===n&&(n={}),t.current&&("number"===typeof I?g.navigate(I):g.navigate(I,j({fromRouteId:e},n)))}),[g,e])}():function(){_()||r(!1);let g=I.useContext(Q),{basename:e,future:t,navigator:n}=I.useContext(T),{matches:C}=I.useContext(O),{pathname:l}=$(),a=JSON.stringify(H(C,t.v7_relativeSplatPath)),o=I.useRef(!1);return gg((()=>{o.current=!0})),I.useCallback((function(t,I){if(void 0===I&&(I={}),!o.current)return;if("number"===typeof t)return void n.go(t);let C=F(t,JSON.parse(a),l,"path"===I.relative);null==g&&"/"!==e&&(C.pathname="/"===C.pathname?e:K([e,C.pathname])),(I.replace?n.replace:n.push)(C,I.state,I)}),[e,n,a,l,g])}()}function tg(g,e){let{relative:t}=void 0===e?{}:e,{future:n}=I.useContext(T),{matches:C}=I.useContext(O),{pathname:l}=$(),a=JSON.stringify(H(C,n.v7_relativeSplatPath));return I.useMemo((()=>F(g,JSON.parse(a),l,"path"===t)),[g,a,l,t])}function Ig(g,t,n,C){_()||r(!1);let{navigator:l,static:a}=I.useContext(T),{matches:o}=I.useContext(O),i=o[o.length-1],c=i?i.params:{},s=(i&&i.pathname,i?i.pathnameBase:"/");i&&i.route;let A,d=$();if(t){var m;let g="string"===typeof t?u(t):t;"/"===s||(null==(m=g.pathname)?void 0:m.startsWith(s))||r(!1),A=g}else A=d;let h=A.pathname||"/",Z=h;if("/"!==s){let g=s.replace(/^\//,"").split("/");Z="/"+h.replace(/^\//,"").split("/").slice(g.length).join("/")}let p=!a&&n&&n.matches&&n.matches.length>0?n.matches:b(g,{pathname:Z});let G=og(p&&p.map((g=>Object.assign({},g,{params:Object.assign({},c,g.params),pathname:K([s,l.encodeLocation?l.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:"/"===g.pathnameBase?s:K([s,l.encodeLocation?l.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])}))),o,n,C);return t&&G?I.createElement(P.Provider,{value:{location:j({pathname:"/",search:"",hash:"",state:null,key:"default"},A),navigationType:e.Pop}},G):G}function ng(){let g=function(){var g;let e=I.useContext(q),t=sg(rg.UseRouteError),n=Ag(rg.UseRouteError);if(void 0!==e)return e;return null==(g=t.errors)?void 0:g[n]}(),e=E(g)?g.status+" "+g.statusText:g instanceof Error?g.message:JSON.stringify(g),t=g instanceof Error?g.stack:null,n="rgba(200,200,200, 0.5)",C={padding:"0.5rem",backgroundColor:n};return I.createElement(I.Fragment,null,I.createElement("h2",null,"Unexpected Application Error!"),I.createElement("h3",{style:{fontStyle:"italic"}},e),t?I.createElement("pre",{style:C},t):null,null)}const Cg=I.createElement(ng,null);class lg extends I.Component{constructor(g){super(g),this.state={location:g.location,revalidation:g.revalidation,error:g.error}}static getDerivedStateFromError(g){return{error:g}}static getDerivedStateFromProps(g,e){return e.location!==g.location||"idle"!==e.revalidation&&"idle"===g.revalidation?{error:g.error,location:g.location,revalidation:g.revalidation}:{error:void 0!==g.error?g.error:e.error,location:e.location,revalidation:g.revalidation||e.revalidation}}componentDidCatch(g,e){console.error("React Router caught the following error during render",g,e)}render(){return void 0!==this.state.error?I.createElement(O.Provider,{value:this.props.routeContext},I.createElement(q.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ag(g){let{routeContext:e,match:t,children:n}=g,C=I.useContext(Q);return C&&C.static&&C.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(C.staticContext._deepestRenderedBoundaryId=t.route.id),I.createElement(O.Provider,{value:e},n)}function og(g,e,t,n){var C;if(void 0===e&&(e=[]),void 0===t&&(t=null),void 0===n&&(n=null),null==g){var l;if(!t)return null;if(t.errors)g=t.matches;else{if(!(null!=(l=n)&&l.v7_partialHydration&&0===e.length&&!t.initialized&&t.matches.length>0))return null;g=t.matches}}let a=g,o=null==(C=t)?void 0:C.errors;if(null!=o){let g=a.findIndex((g=>g.route.id&&void 0!==(null==o?void 0:o[g.route.id])));g>=0||r(!1),a=a.slice(0,Math.min(a.length,g+1))}let i=!1,c=-1;if(t&&n&&n.v7_partialHydration)for(let I=0;I<a.length;I++){let g=a[I];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(c=I),g.route.id){let{loaderData:e,errors:I}=t,n=g.route.loader&&void 0===e[g.route.id]&&(!I||void 0===I[g.route.id]);if(g.route.lazy||n){i=!0,a=c>=0?a.slice(0,c+1):[a[0]];break}}}return a.reduceRight(((g,n,C)=>{let l,r=!1,s=null,A=null;var d;t&&(l=o&&n.route.id?o[n.route.id]:void 0,s=n.route.errorElement||Cg,i&&(c<0&&0===C?(d="route-fallback",!1||dg[d]||(dg[d]=!0),r=!0,A=null):c===C&&(r=!0,A=n.route.hydrateFallbackElement||null)));let u=e.concat(a.slice(0,C+1)),m=()=>{let e;return e=l?s:r?A:n.route.Component?I.createElement(n.route.Component,null):n.route.element?n.route.element:g,I.createElement(ag,{match:n,routeContext:{outlet:g,matches:u,isDataRoute:null!=t},children:e})};return t&&(n.route.ErrorBoundary||n.route.errorElement||0===C)?I.createElement(lg,{location:t.location,revalidation:t.revalidation,component:s,error:l,children:m(),routeContext:{outlet:null,matches:u,isDataRoute:!0}}):m()}),null)}var ig=function(g){return g.UseBlocker="useBlocker",g.UseRevalidator="useRevalidator",g.UseNavigateStable="useNavigate",g}(ig||{}),rg=function(g){return g.UseBlocker="useBlocker",g.UseLoaderData="useLoaderData",g.UseActionData="useActionData",g.UseRouteError="useRouteError",g.UseNavigation="useNavigation",g.UseRouteLoaderData="useRouteLoaderData",g.UseMatches="useMatches",g.UseRevalidator="useRevalidator",g.UseNavigateStable="useNavigate",g.UseRouteId="useRouteId",g}(rg||{});function cg(g){let e=I.useContext(Q);return e||r(!1),e}function sg(g){let e=I.useContext(D);return e||r(!1),e}function Ag(g){let e=function(){let g=I.useContext(O);return g||r(!1),g}(),t=e.matches[e.matches.length-1];return t.route.id||r(!1),t.route.id}const dg={};function ug(g,e){null==g||g.v7_startTransition,void 0===(null==g?void 0:g.v7_relativeSplatPath)&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}n.startTransition;function mg(g){r(!1)}function hg(g){let{basename:t="/",children:n=null,location:C,navigationType:l=e.Pop,navigator:a,static:o=!1,future:i}=g;_()&&r(!1);let c=t.replace(/^\/*/,"/"),s=I.useMemo((()=>({basename:c,navigator:a,static:o,future:j({v7_relativeSplatPath:!1},i)})),[c,i,a,o]);"string"===typeof C&&(C=u(C));let{pathname:A="/",search:d="",hash:m="",state:h=null,key:b="default"}=C,Z=I.useMemo((()=>{let g=Y(A,c);return null==g?null:{location:{pathname:g,search:d,hash:m,state:h,key:b},navigationType:l}}),[c,A,d,m,h,b,l]);return null==Z?null:I.createElement(T.Provider,{value:s},I.createElement(P.Provider,{children:n,value:Z}))}function bg(g){let{children:e,location:t}=g;return Ig(Zg(e),t)}new Promise((()=>{}));I.Component;function Zg(g,e){void 0===e&&(e=[]);let t=[];return I.Children.forEach(g,((g,n)=>{if(!I.isValidElement(g))return;let C=[...e,n];if(g.type===I.Fragment)return void t.push.apply(t,Zg(g.props.children,C));g.type!==mg&&r(!1),g.props.index&&g.props.children&&r(!1);let l={id:g.props.id||C.join("-"),caseSensitive:g.props.caseSensitive,element:g.props.element,Component:g.props.Component,index:g.props.index,path:g.props.path,loader:g.props.loader,action:g.props.action,errorElement:g.props.errorElement,ErrorBoundary:g.props.ErrorBoundary,hasErrorBoundary:null!=g.props.ErrorBoundary||null!=g.props.errorElement,shouldRevalidate:g.props.shouldRevalidate,handle:g.props.handle,lazy:g.props.lazy};g.props.children&&(l.children=Zg(g.props.children,C)),t.push(l)})),t}function pg(){return pg=Object.assign?Object.assign.bind():function(g){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var I in t)Object.prototype.hasOwnProperty.call(t,I)&&(g[I]=t[I])}return g},pg.apply(this,arguments)}function Gg(g,e){if(null==g)return{};var t,I,n={},C=Object.keys(g);for(I=0;I<C.length;I++)t=C[I],e.indexOf(t)>=0||(n[t]=g[t]);return n}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const yg=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(ui){}new Map;const Bg=n.startTransition;a.flushSync,n.useId;function Sg(g){let{basename:e,children:t,future:n,window:C}=g,l=I.useRef();var a;null==l.current&&(l.current=(void 0===(a={window:C,v5Compat:!0})&&(a={}),m((function(g,e){let{pathname:t,search:I,hash:n}=g.location;return A("",{pathname:t,search:I,hash:n},e.state&&e.state.usr||null,e.state&&e.state.key||"default")}),(function(g,e){return"string"===typeof e?e:d(e)}),null,a)));let o=l.current,[i,r]=I.useState({action:o.action,location:o.location}),{v7_startTransition:c}=n||{},s=I.useCallback((g=>{c&&Bg?Bg((()=>r(g))):r(g)}),[r,c]);return I.useLayoutEffect((()=>o.listen(s)),[o,s]),I.useEffect((()=>ug(n)),[n]),I.createElement(hg,{basename:e,children:t,location:i.location,navigationType:i.action,navigator:o,future:n})}const fg="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Wg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Vg=I.forwardRef((function(g,e){let t,{onClick:n,relative:C,reloadDocument:l,replace:a,state:o,target:i,to:c,preventScrollReset:s,viewTransition:A}=g,u=Gg(g,yg),{basename:m}=I.useContext(T),h=!1;if("string"===typeof c&&Wg.test(c)&&(t=c,fg))try{let g=new URL(window.location.href),e=c.startsWith("//")?new URL(g.protocol+c):new URL(c),t=Y(e.pathname,m);e.origin===g.origin&&null!=t?c=t+e.search+e.hash:h=!0}catch(ui){}let b=function(g,e){let{relative:t}=void 0===e?{}:e;_()||r(!1);let{basename:n,navigator:C}=I.useContext(T),{hash:l,pathname:a,search:o}=tg(g,{relative:t}),i=a;return"/"!==n&&(i="/"===a?n:K([n,a])),C.createHref({pathname:i,search:o,hash:l})}(c,{relative:C}),Z=function(g,e){let{target:t,replace:n,state:C,preventScrollReset:l,relative:a,viewTransition:o}=void 0===e?{}:e,i=eg(),r=$(),c=tg(g,{relative:a});return I.useCallback((e=>{if(function(g,e){return 0===g.button&&(!e||"_self"===e)&&!function(g){return!!(g.metaKey||g.altKey||g.ctrlKey||g.shiftKey)}(g)}(e,t)){e.preventDefault();let t=void 0!==n?n:d(r)===d(c);i(g,{replace:t,state:C,preventScrollReset:l,relative:a,viewTransition:o})}}),[r,i,c,n,C,t,g,l,a,o])}(c,{replace:a,state:o,target:i,preventScrollReset:s,relative:C,viewTransition:A});return I.createElement("a",pg({},u,{href:t||b,onClick:h||l?n:function(g){n&&n(g),g.defaultPrevented||Z(g)},ref:e,target:i}))}));var vg,Rg;(function(g){g.UseScrollRestoration="useScrollRestoration",g.UseSubmit="useSubmit",g.UseSubmitFetcher="useSubmitFetcher",g.UseFetcher="useFetcher",g.useViewTransitionState="useViewTransitionState"})(vg||(vg={})),function(g){g.UseFetcher="useFetcher",g.UseFetchers="useFetchers",g.UseScrollRestoration="useScrollRestoration"}(Rg||(Rg={}));function Xg(g){return Xg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"==typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},Xg(g)}function kg(g){var e=function(g,e){if("object"!=Xg(g)||!g)return g;var t=g[Symbol.toPrimitive];if(void 0!==t){var I=t.call(g,e||"default");if("object"!=Xg(I))return I;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(g)}(g,"string");return"symbol"==Xg(e)?e:e+""}function Jg(g,e,t){return(e=kg(e))in g?Object.defineProperty(g,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):g[e]=t,g}function Yg(g,e){var t=Object.keys(g);if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(g);e&&(I=I.filter((function(e){return Object.getOwnPropertyDescriptor(g,e).enumerable}))),t.push.apply(t,I)}return t}function wg(g){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?Yg(Object(t),!0).forEach((function(e){Jg(g,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(t)):Yg(Object(t)).forEach((function(e){Object.defineProperty(g,e,Object.getOwnPropertyDescriptor(t,e))}))}return g}function Ng(g,e){return function(){return g.apply(e,arguments)}}const{toString:Hg}=Object.prototype,{getPrototypeOf:Fg}=Object,{iterator:Kg,toStringTag:xg}=Symbol,Lg=(zg=Object.create(null),g=>{const e=Hg.call(g);return zg[e]||(zg[e]=e.slice(8,-1).toLowerCase())});var zg;const Eg=g=>(g=g.toLowerCase(),e=>Lg(e)===g),Mg=g=>e=>typeof e===g,{isArray:Ug}=Array,jg=Mg("undefined");const Qg=Eg("ArrayBuffer");const Dg=Mg("string"),Tg=Mg("function"),Pg=Mg("number"),Og=g=>null!==g&&"object"===typeof g,qg=g=>{if("object"!==Lg(g))return!1;const e=Fg(g);return(null===e||e===Object.prototype||null===Object.getPrototypeOf(e))&&!(xg in g)&&!(Kg in g)},_g=Eg("Date"),$g=Eg("File"),ge=Eg("Blob"),ee=Eg("FileList"),te=Eg("URLSearchParams"),[Ie,ne,Ce,le]=["ReadableStream","Request","Response","Headers"].map(Eg);function ae(g,e){let t,I,{allOwnKeys:n=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==g&&"undefined"!==typeof g)if("object"!==typeof g&&(g=[g]),Ug(g))for(t=0,I=g.length;t<I;t++)e.call(null,g[t],t,g);else{const I=n?Object.getOwnPropertyNames(g):Object.keys(g),C=I.length;let l;for(t=0;t<C;t++)l=I[t],e.call(null,g[l],l,g)}}function oe(g,e){e=e.toLowerCase();const t=Object.keys(g);let I,n=t.length;for(;n-- >0;)if(I=t[n],e===I.toLowerCase())return I;return null}const ie="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,re=g=>!jg(g)&&g!==ie;const ce=(se="undefined"!==typeof Uint8Array&&Fg(Uint8Array),g=>se&&g instanceof se);var se;const Ae=Eg("HTMLFormElement"),de=(g=>{let{hasOwnProperty:e}=g;return(g,t)=>e.call(g,t)})(Object.prototype),ue=Eg("RegExp"),me=(g,e)=>{const t=Object.getOwnPropertyDescriptors(g),I={};ae(t,((t,n)=>{let C;!1!==(C=e(t,n,g))&&(I[n]=C||t)})),Object.defineProperties(g,I)};const he=Eg("AsyncFunction"),be=((g,e)=>{return g?setImmediate:e?(t="axios@".concat(Math.random()),I=[],ie.addEventListener("message",(g=>{let{source:e,data:n}=g;e===ie&&n===t&&I.length&&I.shift()()}),!1),g=>{I.push(g),ie.postMessage(t,"*")}):g=>setTimeout(g);var t,I})("function"===typeof setImmediate,Tg(ie.postMessage)),Ze="undefined"!==typeof queueMicrotask?queueMicrotask.bind(ie):"undefined"!==typeof process&&process.nextTick||be,pe={isArray:Ug,isArrayBuffer:Qg,isBuffer:function(g){return null!==g&&!jg(g)&&null!==g.constructor&&!jg(g.constructor)&&Tg(g.constructor.isBuffer)&&g.constructor.isBuffer(g)},isFormData:g=>{let e;return g&&("function"===typeof FormData&&g instanceof FormData||Tg(g.append)&&("formdata"===(e=Lg(g))||"object"===e&&Tg(g.toString)&&"[object FormData]"===g.toString()))},isArrayBufferView:function(g){let e;return e="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(g):g&&g.buffer&&Qg(g.buffer),e},isString:Dg,isNumber:Pg,isBoolean:g=>!0===g||!1===g,isObject:Og,isPlainObject:qg,isReadableStream:Ie,isRequest:ne,isResponse:Ce,isHeaders:le,isUndefined:jg,isDate:_g,isFile:$g,isBlob:ge,isRegExp:ue,isFunction:Tg,isStream:g=>Og(g)&&Tg(g.pipe),isURLSearchParams:te,isTypedArray:ce,isFileList:ee,forEach:ae,merge:function g(){const{caseless:e}=re(this)&&this||{},t={},I=(I,n)=>{const C=e&&oe(t,n)||n;qg(t[C])&&qg(I)?t[C]=g(t[C],I):qg(I)?t[C]=g({},I):Ug(I)?t[C]=I.slice():t[C]=I};for(let n=0,C=arguments.length;n<C;n++)arguments[n]&&ae(arguments[n],I);return t},extend:function(g,e,t){let{allOwnKeys:I}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return ae(e,((e,I)=>{t&&Tg(e)?g[I]=Ng(e,t):g[I]=e}),{allOwnKeys:I}),g},trim:g=>g.trim?g.trim():g.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:g=>(65279===g.charCodeAt(0)&&(g=g.slice(1)),g),inherits:(g,e,t,I)=>{g.prototype=Object.create(e.prototype,I),g.prototype.constructor=g,Object.defineProperty(g,"super",{value:e.prototype}),t&&Object.assign(g.prototype,t)},toFlatObject:(g,e,t,I)=>{let n,C,l;const a={};if(e=e||{},null==g)return e;do{for(n=Object.getOwnPropertyNames(g),C=n.length;C-- >0;)l=n[C],I&&!I(l,g,e)||a[l]||(e[l]=g[l],a[l]=!0);g=!1!==t&&Fg(g)}while(g&&(!t||t(g,e))&&g!==Object.prototype);return e},kindOf:Lg,kindOfTest:Eg,endsWith:(g,e,t)=>{g=String(g),(void 0===t||t>g.length)&&(t=g.length),t-=e.length;const I=g.indexOf(e,t);return-1!==I&&I===t},toArray:g=>{if(!g)return null;if(Ug(g))return g;let e=g.length;if(!Pg(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=g[e];return t},forEachEntry:(g,e)=>{const t=(g&&g[Kg]).call(g);let I;for(;(I=t.next())&&!I.done;){const t=I.value;e.call(g,t[0],t[1])}},matchAll:(g,e)=>{let t;const I=[];for(;null!==(t=g.exec(e));)I.push(t);return I},isHTMLForm:Ae,hasOwnProperty:de,hasOwnProp:de,reduceDescriptors:me,freezeMethods:g=>{me(g,((e,t)=>{if(Tg(g)&&-1!==["arguments","caller","callee"].indexOf(t))return!1;const I=g[t];Tg(I)&&(e.enumerable=!1,"writable"in e?e.writable=!1:e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")}))}))},toObjectSet:(g,e)=>{const t={},I=g=>{g.forEach((g=>{t[g]=!0}))};return Ug(g)?I(g):I(String(g).split(e)),t},toCamelCase:g=>g.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(g,e,t){return e.toUpperCase()+t})),noop:()=>{},toFiniteNumber:(g,e)=>null!=g&&Number.isFinite(g=+g)?g:e,findKey:oe,global:ie,isContextDefined:re,isSpecCompliantForm:function(g){return!!(g&&Tg(g.append)&&"FormData"===g[xg]&&g[Kg])},toJSONObject:g=>{const e=new Array(10),t=(g,I)=>{if(Og(g)){if(e.indexOf(g)>=0)return;if(!("toJSON"in g)){e[I]=g;const n=Ug(g)?[]:{};return ae(g,((g,e)=>{const C=t(g,I+1);!jg(C)&&(n[e]=C)})),e[I]=void 0,n}}return g};return t(g,0)},isAsyncFn:he,isThenable:g=>g&&(Og(g)||Tg(g))&&Tg(g.then)&&Tg(g.catch),setImmediate:be,asap:Ze,isIterable:g=>null!=g&&Tg(g[Kg])};function Ge(g,e,t,I,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=g,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),I&&(this.request=I),n&&(this.response=n,this.status=n.status?n.status:null)}pe.inherits(Ge,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:pe.toJSONObject(this.config),code:this.code,status:this.status}}});const ye=Ge.prototype,Be={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((g=>{Be[g]={value:g}})),Object.defineProperties(Ge,Be),Object.defineProperty(ye,"isAxiosError",{value:!0}),Ge.from=(g,e,t,I,n,C)=>{const l=Object.create(ye);return pe.toFlatObject(g,l,(function(g){return g!==Error.prototype}),(g=>"isAxiosError"!==g)),Ge.call(l,g.message,e,t,I,n),l.cause=g,l.name=g.name,C&&Object.assign(l,C),l};const Se=Ge;function fe(g){return pe.isPlainObject(g)||pe.isArray(g)}function We(g){return pe.endsWith(g,"[]")?g.slice(0,-2):g}function Ve(g,e,t){return g?g.concat(e).map((function(g,e){return g=We(g),!t&&e?"["+g+"]":g})).join(t?".":""):e}const ve=pe.toFlatObject(pe,{},null,(function(g){return/^is[A-Z]/.test(g)}));const Re=function(g,e,t){if(!pe.isObject(g))throw new TypeError("target must be an object");e=e||new FormData;const I=(t=pe.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(g,e){return!pe.isUndefined(e[g])}))).metaTokens,n=t.visitor||i,C=t.dots,l=t.indexes,a=(t.Blob||"undefined"!==typeof Blob&&Blob)&&pe.isSpecCompliantForm(e);if(!pe.isFunction(n))throw new TypeError("visitor must be a function");function o(g){if(null===g)return"";if(pe.isDate(g))return g.toISOString();if(!a&&pe.isBlob(g))throw new Se("Blob is not supported. Use a Buffer instead.");return pe.isArrayBuffer(g)||pe.isTypedArray(g)?a&&"function"===typeof Blob?new Blob([g]):Buffer.from(g):g}function i(g,t,n){let a=g;if(g&&!n&&"object"===typeof g)if(pe.endsWith(t,"{}"))t=I?t:t.slice(0,-2),g=JSON.stringify(g);else if(pe.isArray(g)&&function(g){return pe.isArray(g)&&!g.some(fe)}(g)||(pe.isFileList(g)||pe.endsWith(t,"[]"))&&(a=pe.toArray(g)))return t=We(t),a.forEach((function(g,I){!pe.isUndefined(g)&&null!==g&&e.append(!0===l?Ve([t],I,C):null===l?t:t+"[]",o(g))})),!1;return!!fe(g)||(e.append(Ve(n,t,C),o(g)),!1)}const r=[],c=Object.assign(ve,{defaultVisitor:i,convertValue:o,isVisitable:fe});if(!pe.isObject(g))throw new TypeError("data must be an object");return function g(t,I){if(!pe.isUndefined(t)){if(-1!==r.indexOf(t))throw Error("Circular reference detected in "+I.join("."));r.push(t),pe.forEach(t,(function(t,C){!0===(!(pe.isUndefined(t)||null===t)&&n.call(e,t,pe.isString(C)?C.trim():C,I,c))&&g(t,I?I.concat(C):[C])})),r.pop()}}(g),e};function Xe(g){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(g).replace(/[!'()~]|%20|%00/g,(function(g){return e[g]}))}function ke(g,e){this._pairs=[],g&&Re(g,this,e)}const Je=ke.prototype;Je.append=function(g,e){this._pairs.push([g,e])},Je.toString=function(g){const e=g?function(e){return g.call(this,e,Xe)}:Xe;return this._pairs.map((function(g){return e(g[0])+"="+e(g[1])}),"").join("&")};const Ye=ke;function we(g){return encodeURIComponent(g).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Ne(g,e,t){if(!e)return g;const I=t&&t.encode||we;pe.isFunction(t)&&(t={serialize:t});const n=t&&t.serialize;let C;if(C=n?n(e,t):pe.isURLSearchParams(e)?e.toString():new Ye(e,t).toString(I),C){const e=g.indexOf("#");-1!==e&&(g=g.slice(0,e)),g+=(-1===g.indexOf("?")?"?":"&")+C}return g}const He=class{constructor(){this.handlers=[]}use(g,e,t){return this.handlers.push({fulfilled:g,rejected:e,synchronous:!!t&&t.synchronous,runWhen:t?t.runWhen:null}),this.handlers.length-1}eject(g){this.handlers[g]&&(this.handlers[g]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(g){pe.forEach(this.handlers,(function(e){null!==e&&g(e)}))}},Fe={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ke={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:Ye,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},xe="undefined"!==typeof window&&"undefined"!==typeof document,Le="object"===typeof navigator&&navigator||void 0,ze=xe&&(!Le||["ReactNative","NativeScript","NS"].indexOf(Le.product)<0),Ee="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,Me=xe&&window.location.href||"http://localhost",Ue=wg(wg({},g),Ke);const je=function(g){function e(g,t,I,n){let C=g[n++];if("__proto__"===C)return!0;const l=Number.isFinite(+C),a=n>=g.length;if(C=!C&&pe.isArray(I)?I.length:C,a)return pe.hasOwnProp(I,C)?I[C]=[I[C],t]:I[C]=t,!l;I[C]&&pe.isObject(I[C])||(I[C]=[]);return e(g,t,I[C],n)&&pe.isArray(I[C])&&(I[C]=function(g){const e={},t=Object.keys(g);let I;const n=t.length;let C;for(I=0;I<n;I++)C=t[I],e[C]=g[C];return e}(I[C])),!l}if(pe.isFormData(g)&&pe.isFunction(g.entries)){const t={};return pe.forEachEntry(g,((g,I)=>{e(function(g){return pe.matchAll(/\w+|\[(\w*)]/g,g).map((g=>"[]"===g[0]?"":g[1]||g[0]))}(g),I,t,0)})),t}return null};const Qe={transitional:Fe,adapter:["xhr","http","fetch"],transformRequest:[function(g,e){const t=e.getContentType()||"",I=t.indexOf("application/json")>-1,n=pe.isObject(g);n&&pe.isHTMLForm(g)&&(g=new FormData(g));if(pe.isFormData(g))return I?JSON.stringify(je(g)):g;if(pe.isArrayBuffer(g)||pe.isBuffer(g)||pe.isStream(g)||pe.isFile(g)||pe.isBlob(g)||pe.isReadableStream(g))return g;if(pe.isArrayBufferView(g))return g.buffer;if(pe.isURLSearchParams(g))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),g.toString();let C;if(n){if(t.indexOf("application/x-www-form-urlencoded")>-1)return function(g,e){return Re(g,new Ue.classes.URLSearchParams,Object.assign({visitor:function(g,e,t,I){return Ue.isNode&&pe.isBuffer(g)?(this.append(e,g.toString("base64")),!1):I.defaultVisitor.apply(this,arguments)}},e))}(g,this.formSerializer).toString();if((C=pe.isFileList(g))||t.indexOf("multipart/form-data")>-1){const e=this.env&&this.env.FormData;return Re(C?{"files[]":g}:g,e&&new e,this.formSerializer)}}return n||I?(e.setContentType("application/json",!1),function(g,e,t){if(pe.isString(g))try{return(e||JSON.parse)(g),pe.trim(g)}catch(ui){if("SyntaxError"!==ui.name)throw ui}return(t||JSON.stringify)(g)}(g)):g}],transformResponse:[function(g){const e=this.transitional||Qe.transitional,t=e&&e.forcedJSONParsing,I="json"===this.responseType;if(pe.isResponse(g)||pe.isReadableStream(g))return g;if(g&&pe.isString(g)&&(t&&!this.responseType||I)){const t=!(e&&e.silentJSONParsing)&&I;try{return JSON.parse(g)}catch(ui){if(t){if("SyntaxError"===ui.name)throw Se.from(ui,Se.ERR_BAD_RESPONSE,this,null,this.response);throw ui}}}return g}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ue.classes.FormData,Blob:Ue.classes.Blob},validateStatus:function(g){return g>=200&&g<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};pe.forEach(["delete","get","head","post","put","patch"],(g=>{Qe.headers[g]={}}));const De=Qe,Te=pe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Pe=Symbol("internals");function Oe(g){return g&&String(g).trim().toLowerCase()}function qe(g){return!1===g||null==g?g:pe.isArray(g)?g.map(qe):String(g)}function _e(g,e,t,I,n){return pe.isFunction(I)?I.call(this,e,t):(n&&(e=t),pe.isString(e)?pe.isString(I)?-1!==e.indexOf(I):pe.isRegExp(I)?I.test(e):void 0:void 0)}class $e{constructor(g){g&&this.set(g)}set(g,e,t){const I=this;function n(g,e,t){const n=Oe(e);if(!n)throw new Error("header name must be a non-empty string");const C=pe.findKey(I,n);(!C||void 0===I[C]||!0===t||void 0===t&&!1!==I[C])&&(I[C||e]=qe(g))}const C=(g,e)=>pe.forEach(g,((g,t)=>n(g,t,e)));if(pe.isPlainObject(g)||g instanceof this.constructor)C(g,e);else if(pe.isString(g)&&(g=g.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(g.trim()))C((g=>{const e={};let t,I,n;return g&&g.split("\n").forEach((function(g){n=g.indexOf(":"),t=g.substring(0,n).trim().toLowerCase(),I=g.substring(n+1).trim(),!t||e[t]&&Te[t]||("set-cookie"===t?e[t]?e[t].push(I):e[t]=[I]:e[t]=e[t]?e[t]+", "+I:I)})),e})(g),e);else if(pe.isObject(g)&&pe.isIterable(g)){let t,I,n={};for(const e of g){if(!pe.isArray(e))throw TypeError("Object iterator must return a key-value pair");n[I=e[0]]=(t=n[I])?pe.isArray(t)?[...t,e[1]]:[t,e[1]]:e[1]}C(n,e)}else null!=g&&n(e,g,t);return this}get(g,e){if(g=Oe(g)){const t=pe.findKey(this,g);if(t){const g=this[t];if(!e)return g;if(!0===e)return function(g){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let I;for(;I=t.exec(g);)e[I[1]]=I[2];return e}(g);if(pe.isFunction(e))return e.call(this,g,t);if(pe.isRegExp(e))return e.exec(g);throw new TypeError("parser must be boolean|regexp|function")}}}has(g,e){if(g=Oe(g)){const t=pe.findKey(this,g);return!(!t||void 0===this[t]||e&&!_e(0,this[t],t,e))}return!1}delete(g,e){const t=this;let I=!1;function n(g){if(g=Oe(g)){const n=pe.findKey(t,g);!n||e&&!_e(0,t[n],n,e)||(delete t[n],I=!0)}}return pe.isArray(g)?g.forEach(n):n(g),I}clear(g){const e=Object.keys(this);let t=e.length,I=!1;for(;t--;){const n=e[t];g&&!_e(0,this[n],n,g,!0)||(delete this[n],I=!0)}return I}normalize(g){const e=this,t={};return pe.forEach(this,((I,n)=>{const C=pe.findKey(t,n);if(C)return e[C]=qe(I),void delete e[n];const l=g?function(g){return g.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((g,e,t)=>e.toUpperCase()+t))}(n):String(n).trim();l!==n&&delete e[n],e[l]=qe(I),t[l]=!0})),this}concat(){for(var g=arguments.length,e=new Array(g),t=0;t<g;t++)e[t]=arguments[t];return this.constructor.concat(this,...e)}toJSON(g){const e=Object.create(null);return pe.forEach(this,((t,I)=>{null!=t&&!1!==t&&(e[I]=g&&pe.isArray(t)?t.join(", "):t)})),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((g=>{let[e,t]=g;return e+": "+t})).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(g){return g instanceof this?g:new this(g)}static concat(g){const e=new this(g);for(var t=arguments.length,I=new Array(t>1?t-1:0),n=1;n<t;n++)I[n-1]=arguments[n];return I.forEach((g=>e.set(g))),e}static accessor(g){const e=(this[Pe]=this[Pe]={accessors:{}}).accessors,t=this.prototype;function I(g){const I=Oe(g);e[I]||(!function(g,e){const t=pe.toCamelCase(" "+e);["get","set","has"].forEach((I=>{Object.defineProperty(g,I+t,{value:function(g,t,n){return this[I].call(this,e,g,t,n)},configurable:!0})}))}(t,g),e[I]=!0)}return pe.isArray(g)?g.forEach(I):I(g),this}}$e.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),pe.reduceDescriptors($e.prototype,((g,e)=>{let{value:t}=g,I=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(g){this[I]=g}}})),pe.freezeMethods($e);const gt=$e;function et(g,e){const t=this||De,I=e||t,n=gt.from(I.headers);let C=I.data;return pe.forEach(g,(function(g){C=g.call(t,C,n.normalize(),e?e.status:void 0)})),n.normalize(),C}function tt(g){return!(!g||!g.__CANCEL__)}function It(g,e,t){Se.call(this,null==g?"canceled":g,Se.ERR_CANCELED,e,t),this.name="CanceledError"}pe.inherits(It,Se,{__CANCEL__:!0});const nt=It;function Ct(g,e,t){const I=t.config.validateStatus;t.status&&I&&!I(t.status)?e(new Se("Request failed with status code "+t.status,[Se.ERR_BAD_REQUEST,Se.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t)):g(t)}const lt=function(g,e){g=g||10;const t=new Array(g),I=new Array(g);let n,C=0,l=0;return e=void 0!==e?e:1e3,function(a){const o=Date.now(),i=I[l];n||(n=o),t[C]=a,I[C]=o;let r=l,c=0;for(;r!==C;)c+=t[r++],r%=g;if(C=(C+1)%g,C===l&&(l=(l+1)%g),o-n<e)return;const s=i&&o-i;return s?Math.round(1e3*c/s):void 0}};const at=function(g,e){let t,I,n=0,C=1e3/e;const l=function(e){let C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();n=C,t=null,I&&(clearTimeout(I),I=null),g.apply(null,e)};return[function(){const g=Date.now(),e=g-n;for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];e>=C?l(o,g):(t=o,I||(I=setTimeout((()=>{I=null,l(t)}),C-e)))},()=>t&&l(t)]},ot=function(g,e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,I=0;const n=lt(50,250);return at((t=>{const C=t.loaded,l=t.lengthComputable?t.total:void 0,a=C-I,o=n(a);I=C;g({loaded:C,total:l,progress:l?C/l:void 0,bytes:a,rate:o||void 0,estimated:o&&l&&C<=l?(l-C)/o:void 0,event:t,lengthComputable:null!=l,[e?"download":"upload"]:!0})}),t)},it=(g,e)=>{const t=null!=g;return[I=>e[0]({lengthComputable:t,total:g,loaded:I}),e[1]]},rt=g=>function(){for(var e=arguments.length,t=new Array(e),I=0;I<e;I++)t[I]=arguments[I];return pe.asap((()=>g(...t)))},ct=Ue.hasStandardBrowserEnv?((g,e)=>t=>(t=new URL(t,Ue.origin),g.protocol===t.protocol&&g.host===t.host&&(e||g.port===t.port)))(new URL(Ue.origin),Ue.navigator&&/(msie|trident)/i.test(Ue.navigator.userAgent)):()=>!0,st=Ue.hasStandardBrowserEnv?{write(g,e,t,I,n,C){const l=[g+"="+encodeURIComponent(e)];pe.isNumber(t)&&l.push("expires="+new Date(t).toGMTString()),pe.isString(I)&&l.push("path="+I),pe.isString(n)&&l.push("domain="+n),!0===C&&l.push("secure"),document.cookie=l.join("; ")},read(g){const e=document.cookie.match(new RegExp("(^|;\\s*)("+g+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(g){this.write(g,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function At(g,e,t){let I=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e);return g&&(I||0==t)?function(g,e){return e?g.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):g}(g,e):e}const dt=g=>g instanceof gt?wg({},g):g;function ut(g,e){e=e||{};const t={};function I(g,e,t,I){return pe.isPlainObject(g)&&pe.isPlainObject(e)?pe.merge.call({caseless:I},g,e):pe.isPlainObject(e)?pe.merge({},e):pe.isArray(e)?e.slice():e}function n(g,e,t,n){return pe.isUndefined(e)?pe.isUndefined(g)?void 0:I(void 0,g,0,n):I(g,e,0,n)}function C(g,e){if(!pe.isUndefined(e))return I(void 0,e)}function l(g,e){return pe.isUndefined(e)?pe.isUndefined(g)?void 0:I(void 0,g):I(void 0,e)}function a(t,n,C){return C in e?I(t,n):C in g?I(void 0,t):void 0}const o={url:C,method:C,data:C,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:a,headers:(g,e,t)=>n(dt(g),dt(e),0,!0)};return pe.forEach(Object.keys(Object.assign({},g,e)),(function(I){const C=o[I]||n,l=C(g[I],e[I],I);pe.isUndefined(l)&&C!==a||(t[I]=l)})),t}const mt=g=>{const e=ut({},g);let t,{data:I,withXSRFToken:n,xsrfHeaderName:C,xsrfCookieName:l,headers:a,auth:o}=e;if(e.headers=a=gt.from(a),e.url=Ne(At(e.baseURL,e.url,e.allowAbsoluteUrls),g.params,g.paramsSerializer),o&&a.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),pe.isFormData(I))if(Ue.hasStandardBrowserEnv||Ue.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(!1!==(t=a.getContentType())){const[g,...e]=t?t.split(";").map((g=>g.trim())).filter(Boolean):[];a.setContentType([g||"multipart/form-data",...e].join("; "))}if(Ue.hasStandardBrowserEnv&&(n&&pe.isFunction(n)&&(n=n(e)),n||!1!==n&&ct(e.url))){const g=C&&l&&st.read(l);g&&a.set(C,g)}return e},ht="undefined"!==typeof XMLHttpRequest&&function(g){return new Promise((function(e,t){const I=mt(g);let n=I.data;const C=gt.from(I.headers).normalize();let l,a,o,i,r,{responseType:c,onUploadProgress:s,onDownloadProgress:A}=I;function d(){i&&i(),r&&r(),I.cancelToken&&I.cancelToken.unsubscribe(l),I.signal&&I.signal.removeEventListener("abort",l)}let u=new XMLHttpRequest;function m(){if(!u)return;const I=gt.from("getAllResponseHeaders"in u&&u.getAllResponseHeaders());Ct((function(g){e(g),d()}),(function(g){t(g),d()}),{data:c&&"text"!==c&&"json"!==c?u.response:u.responseText,status:u.status,statusText:u.statusText,headers:I,config:g,request:u}),u=null}u.open(I.method.toUpperCase(),I.url,!0),u.timeout=I.timeout,"onloadend"in u?u.onloadend=m:u.onreadystatechange=function(){u&&4===u.readyState&&(0!==u.status||u.responseURL&&0===u.responseURL.indexOf("file:"))&&setTimeout(m)},u.onabort=function(){u&&(t(new Se("Request aborted",Se.ECONNABORTED,g,u)),u=null)},u.onerror=function(){t(new Se("Network Error",Se.ERR_NETWORK,g,u)),u=null},u.ontimeout=function(){let e=I.timeout?"timeout of "+I.timeout+"ms exceeded":"timeout exceeded";const n=I.transitional||Fe;I.timeoutErrorMessage&&(e=I.timeoutErrorMessage),t(new Se(e,n.clarifyTimeoutError?Se.ETIMEDOUT:Se.ECONNABORTED,g,u)),u=null},void 0===n&&C.setContentType(null),"setRequestHeader"in u&&pe.forEach(C.toJSON(),(function(g,e){u.setRequestHeader(e,g)})),pe.isUndefined(I.withCredentials)||(u.withCredentials=!!I.withCredentials),c&&"json"!==c&&(u.responseType=I.responseType),A&&([o,r]=ot(A,!0),u.addEventListener("progress",o)),s&&u.upload&&([a,i]=ot(s),u.upload.addEventListener("progress",a),u.upload.addEventListener("loadend",i)),(I.cancelToken||I.signal)&&(l=e=>{u&&(t(!e||e.type?new nt(null,g,u):e),u.abort(),u=null)},I.cancelToken&&I.cancelToken.subscribe(l),I.signal&&(I.signal.aborted?l():I.signal.addEventListener("abort",l)));const h=function(g){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(g);return e&&e[1]||""}(I.url);h&&-1===Ue.protocols.indexOf(h)?t(new Se("Unsupported protocol "+h+":",Se.ERR_BAD_REQUEST,g)):u.send(n||null)}))},bt=(g,e)=>{const{length:t}=g=g?g.filter(Boolean):[];if(e||t){let t,I=new AbortController;const n=function(g){if(!t){t=!0,l();const e=g instanceof Error?g:this.reason;I.abort(e instanceof Se?e:new nt(e instanceof Error?e.message:e))}};let C=e&&setTimeout((()=>{C=null,n(new Se("timeout ".concat(e," of ms exceeded"),Se.ETIMEDOUT))}),e);const l=()=>{g&&(C&&clearTimeout(C),C=null,g.forEach((g=>{g.unsubscribe?g.unsubscribe(n):g.removeEventListener("abort",n)})),g=null)};g.forEach((g=>g.addEventListener("abort",n)));const{signal:a}=I;return a.unsubscribe=()=>pe.asap(l),a}};function Zt(g,e){this.v=g,this.k=e}function pt(g){return function(){return new Gt(g.apply(this,arguments))}}function Gt(g){var e,t;function I(e,t){try{var C=g[e](t),l=C.value,a=l instanceof Zt;Promise.resolve(a?l.v:l).then((function(t){if(a){var o="return"===e?"return":"next";if(!l.k||t.done)return I(o,t);t=g[o](t).value}n(C.done?"return":"normal",t)}),(function(g){I("throw",g)}))}catch(g){n("throw",g)}}function n(g,n){switch(g){case"return":e.resolve({value:n,done:!0});break;case"throw":e.reject(n);break;default:e.resolve({value:n,done:!1})}(e=e.next)?I(e.key,e.arg):t=null}this._invoke=function(g,n){return new Promise((function(C,l){var a={key:g,arg:n,resolve:C,reject:l,next:null};t?t=t.next=a:(e=t=a,I(g,n))}))},"function"!=typeof g.return&&(this.return=void 0)}function yt(g){return new Zt(g,0)}function Bt(g){var e={},t=!1;function I(e,I){return t=!0,I=new Promise((function(t){t(g[e](I))})),{done:!1,value:new Zt(I,1)}}return e["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},e.next=function(g){return t?(t=!1,g):I("next",g)},"function"==typeof g.throw&&(e.throw=function(g){if(t)throw t=!1,g;return I("throw",g)}),"function"==typeof g.return&&(e.return=function(g){return t?(t=!1,g):I("return",g)}),e}function St(g){var e,t,I,n=2;for("undefined"!=typeof Symbol&&(t=Symbol.asyncIterator,I=Symbol.iterator);n--;){if(t&&null!=(e=g[t]))return e.call(g);if(I&&null!=(e=g[I]))return new ft(e.call(g));t="@@asyncIterator",I="@@iterator"}throw new TypeError("Object is not async iterable")}function ft(g){function e(g){if(Object(g)!==g)return Promise.reject(new TypeError(g+" is not an object."));var e=g.done;return Promise.resolve(g.value).then((function(g){return{value:g,done:e}}))}return ft=function(g){this.s=g,this.n=g.next},ft.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(g){var t=this.s.return;return void 0===t?Promise.resolve({value:g,done:!0}):e(t.apply(this.s,arguments))},throw:function(g){var t=this.s.return;return void 0===t?Promise.reject(g):e(t.apply(this.s,arguments))}},new ft(g)}Gt.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Gt.prototype.next=function(g){return this._invoke("next",g)},Gt.prototype.throw=function(g){return this._invoke("throw",g)},Gt.prototype.return=function(g){return this._invoke("return",g)};const Wt=function*(g,e){let t=g.byteLength;if(!e||t<e)return void(yield g);let I,n=0;for(;n<t;)I=n+e,yield g.slice(n,I),n=I},Vt=function(){var g=pt((function*(g,e){var t,I=!1,n=!1;try{for(var C,l=St(vt(g));I=!(C=yield yt(l.next())).done;I=!1){const g=C.value;yield*Bt(St(Wt(g,e)))}}catch(jn){n=!0,t=jn}finally{try{I&&null!=l.return&&(yield yt(l.return()))}finally{if(n)throw t}}}));return function(e,t){return g.apply(this,arguments)}}(),vt=function(){var g=pt((function*(g){if(g[Symbol.asyncIterator])return void(yield*Bt(St(g)));const e=g.getReader();try{for(;;){const{done:g,value:t}=yield yt(e.read());if(g)break;yield t}}finally{yield yt(e.cancel())}}));return function(e){return g.apply(this,arguments)}}(),Rt=(g,e,t,I)=>{const n=Vt(g,e);let C,l=0,a=g=>{C||(C=!0,I&&I(g))};return new ReadableStream({async pull(g){try{const{done:e,value:I}=await n.next();if(e)return a(),void g.close();let C=I.byteLength;if(t){let g=l+=C;t(g)}g.enqueue(new Uint8Array(I))}catch(jn){throw a(jn),jn}},cancel:g=>(a(g),n.return())},{highWaterMark:2})},Xt="function"===typeof fetch&&"function"===typeof Request&&"function"===typeof Response,kt=Xt&&"function"===typeof ReadableStream,Jt=Xt&&("function"===typeof TextEncoder?(Yt=new TextEncoder,g=>Yt.encode(g)):async g=>new Uint8Array(await new Response(g).arrayBuffer()));var Yt;const wt=function(g){try{for(var e=arguments.length,t=new Array(e>1?e-1:0),I=1;I<e;I++)t[I-1]=arguments[I];return!!g(...t)}catch(ui){return!1}},Nt=kt&&wt((()=>{let g=!1;const e=new Request(Ue.origin,{body:new ReadableStream,method:"POST",get duplex(){return g=!0,"half"}}).headers.has("Content-Type");return g&&!e})),Ht=kt&&wt((()=>pe.isReadableStream(new Response("").body))),Ft={stream:Ht&&(g=>g.body)};var Kt;Xt&&(Kt=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((g=>{!Ft[g]&&(Ft[g]=pe.isFunction(Kt[g])?e=>e[g]():(e,t)=>{throw new Se("Response type '".concat(g,"' is not supported"),Se.ERR_NOT_SUPPORT,t)})})));const xt=async(g,e)=>{const t=pe.toFiniteNumber(g.getContentLength());return null==t?(async g=>{if(null==g)return 0;if(pe.isBlob(g))return g.size;if(pe.isSpecCompliantForm(g)){const e=new Request(Ue.origin,{method:"POST",body:g});return(await e.arrayBuffer()).byteLength}return pe.isArrayBufferView(g)||pe.isArrayBuffer(g)?g.byteLength:(pe.isURLSearchParams(g)&&(g+=""),pe.isString(g)?(await Jt(g)).byteLength:void 0)})(e):t},Lt=Xt&&(async g=>{let{url:e,method:t,data:I,signal:n,cancelToken:C,timeout:l,onDownloadProgress:a,onUploadProgress:o,responseType:i,headers:r,withCredentials:c="same-origin",fetchOptions:s}=mt(g);i=i?(i+"").toLowerCase():"text";let A,d=bt([n,C&&C.toAbortSignal()],l);const u=d&&d.unsubscribe&&(()=>{d.unsubscribe()});let m;try{if(o&&Nt&&"get"!==t&&"head"!==t&&0!==(m=await xt(r,I))){let g,t=new Request(e,{method:"POST",body:I,duplex:"half"});if(pe.isFormData(I)&&(g=t.headers.get("content-type"))&&r.setContentType(g),t.body){const[g,e]=it(m,ot(rt(o)));I=Rt(t.body,65536,g,e)}}pe.isString(c)||(c=c?"include":"omit");const n="credentials"in Request.prototype;A=new Request(e,wg(wg({},s),{},{signal:d,method:t.toUpperCase(),headers:r.normalize().toJSON(),body:I,duplex:"half",credentials:n?c:void 0}));let C=await fetch(A);const l=Ht&&("stream"===i||"response"===i);if(Ht&&(a||l&&u)){const g={};["status","statusText","headers"].forEach((e=>{g[e]=C[e]}));const e=pe.toFiniteNumber(C.headers.get("content-length")),[t,I]=a&&it(e,ot(rt(a),!0))||[];C=new Response(Rt(C.body,65536,t,(()=>{I&&I(),u&&u()})),g)}i=i||"text";let h=await Ft[pe.findKey(Ft,i)||"text"](C,g);return!l&&u&&u(),await new Promise(((e,t)=>{Ct(e,t,{data:h,headers:gt.from(C.headers),status:C.status,statusText:C.statusText,config:g,request:A})}))}catch(jn){if(u&&u(),jn&&"TypeError"===jn.name&&/Load failed|fetch/i.test(jn.message))throw Object.assign(new Se("Network Error",Se.ERR_NETWORK,g,A),{cause:jn.cause||jn});throw Se.from(jn,jn&&jn.code,g,A)}}),zt={http:null,xhr:ht,fetch:Lt};pe.forEach(zt,((g,e)=>{if(g){try{Object.defineProperty(g,"name",{value:e})}catch(ui){}Object.defineProperty(g,"adapterName",{value:e})}}));const Et=g=>"- ".concat(g),Mt=g=>pe.isFunction(g)||null===g||!1===g,Ut=g=>{g=pe.isArray(g)?g:[g];const{length:e}=g;let t,I;const n={};for(let C=0;C<e;C++){let e;if(t=g[C],I=t,!Mt(t)&&(I=zt[(e=String(t)).toLowerCase()],void 0===I))throw new Se("Unknown adapter '".concat(e,"'"));if(I)break;n[e||"#"+C]=I}if(!I){const g=Object.entries(n).map((g=>{let[e,t]=g;return"adapter ".concat(e," ")+(!1===t?"is not supported by the environment":"is not available in the build")}));let t=e?g.length>1?"since :\n"+g.map(Et).join("\n"):" "+Et(g[0]):"as no adapter specified";throw new Se("There is no suitable adapter to dispatch the request "+t,"ERR_NOT_SUPPORT")}return I};function jt(g){if(g.cancelToken&&g.cancelToken.throwIfRequested(),g.signal&&g.signal.aborted)throw new nt(null,g)}function Qt(g){jt(g),g.headers=gt.from(g.headers),g.data=et.call(g,g.transformRequest),-1!==["post","put","patch"].indexOf(g.method)&&g.headers.setContentType("application/x-www-form-urlencoded",!1);return Ut(g.adapter||De.adapter)(g).then((function(e){return jt(g),e.data=et.call(g,g.transformResponse,e),e.headers=gt.from(e.headers),e}),(function(e){return tt(e)||(jt(g),e&&e.response&&(e.response.data=et.call(g,g.transformResponse,e.response),e.response.headers=gt.from(e.response.headers))),Promise.reject(e)}))}const Dt="1.9.0",Tt={};["object","boolean","number","function","string","symbol"].forEach(((g,e)=>{Tt[g]=function(t){return typeof t===g||"a"+(e<1?"n ":" ")+g}}));const Pt={};Tt.transitional=function(g,e,t){function I(g,e){return"[Axios v1.9.0] Transitional option '"+g+"'"+e+(t?". "+t:"")}return(t,n,C)=>{if(!1===g)throw new Se(I(n," has been removed"+(e?" in "+e:"")),Se.ERR_DEPRECATED);return e&&!Pt[n]&&(Pt[n]=!0,console.warn(I(n," has been deprecated since v"+e+" and will be removed in the near future"))),!g||g(t,n,C)}},Tt.spelling=function(g){return(e,t)=>(console.warn("".concat(t," is likely a misspelling of ").concat(g)),!0)};const Ot={assertOptions:function(g,e,t){if("object"!==typeof g)throw new Se("options must be an object",Se.ERR_BAD_OPTION_VALUE);const I=Object.keys(g);let n=I.length;for(;n-- >0;){const C=I[n],l=e[C];if(l){const e=g[C],t=void 0===e||l(e,C,g);if(!0!==t)throw new Se("option "+C+" must be "+t,Se.ERR_BAD_OPTION_VALUE)}else if(!0!==t)throw new Se("Unknown option "+C,Se.ERR_BAD_OPTION)}},validators:Tt},qt=Ot.validators;class _t{constructor(g){this.defaults=g||{},this.interceptors={request:new He,response:new He}}async request(g,e){try{return await this._request(g,e)}catch(jn){if(jn instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{jn.stack?t&&!String(jn.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(jn.stack+="\n"+t):jn.stack=t}catch(ui){}}throw jn}}_request(g,e){"string"===typeof g?(e=e||{}).url=g:e=g||{},e=ut(this.defaults,e);const{transitional:t,paramsSerializer:I,headers:n}=e;void 0!==t&&Ot.assertOptions(t,{silentJSONParsing:qt.transitional(qt.boolean),forcedJSONParsing:qt.transitional(qt.boolean),clarifyTimeoutError:qt.transitional(qt.boolean)},!1),null!=I&&(pe.isFunction(I)?e.paramsSerializer={serialize:I}:Ot.assertOptions(I,{encode:qt.function,serialize:qt.function},!0)),void 0!==e.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?e.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:e.allowAbsoluteUrls=!0),Ot.assertOptions(e,{baseUrl:qt.spelling("baseURL"),withXsrfToken:qt.spelling("withXSRFToken")},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let C=n&&pe.merge(n.common,n[e.method]);n&&pe.forEach(["delete","get","head","post","put","patch","common"],(g=>{delete n[g]})),e.headers=gt.concat(C,n);const l=[];let a=!0;this.interceptors.request.forEach((function(g){"function"===typeof g.runWhen&&!1===g.runWhen(e)||(a=a&&g.synchronous,l.unshift(g.fulfilled,g.rejected))}));const o=[];let i;this.interceptors.response.forEach((function(g){o.push(g.fulfilled,g.rejected)}));let r,c=0;if(!a){const g=[Qt.bind(this),void 0];for(g.unshift.apply(g,l),g.push.apply(g,o),r=g.length,i=Promise.resolve(e);c<r;)i=i.then(g[c++],g[c++]);return i}r=l.length;let s=e;for(c=0;c<r;){const g=l[c++],e=l[c++];try{s=g(s)}catch(A){e.call(this,A);break}}try{i=Qt.call(this,s)}catch(A){return Promise.reject(A)}for(c=0,r=o.length;c<r;)i=i.then(o[c++],o[c++]);return i}getUri(g){return Ne(At((g=ut(this.defaults,g)).baseURL,g.url,g.allowAbsoluteUrls),g.params,g.paramsSerializer)}}pe.forEach(["delete","get","head","options"],(function(g){_t.prototype[g]=function(e,t){return this.request(ut(t||{},{method:g,url:e,data:(t||{}).data}))}})),pe.forEach(["post","put","patch"],(function(g){function e(e){return function(t,I,n){return this.request(ut(n||{},{method:g,headers:e?{"Content-Type":"multipart/form-data"}:{},url:t,data:I}))}}_t.prototype[g]=e(),_t.prototype[g+"Form"]=e(!0)}));const $t=_t;class gI{constructor(g){if("function"!==typeof g)throw new TypeError("executor must be a function.");let e;this.promise=new Promise((function(g){e=g}));const t=this;this.promise.then((g=>{if(!t._listeners)return;let e=t._listeners.length;for(;e-- >0;)t._listeners[e](g);t._listeners=null})),this.promise.then=g=>{let e;const I=new Promise((g=>{t.subscribe(g),e=g})).then(g);return I.cancel=function(){t.unsubscribe(e)},I},g((function(g,I,n){t.reason||(t.reason=new nt(g,I,n),e(t.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(g){this.reason?g(this.reason):this._listeners?this._listeners.push(g):this._listeners=[g]}unsubscribe(g){if(!this._listeners)return;const e=this._listeners.indexOf(g);-1!==e&&this._listeners.splice(e,1)}toAbortSignal(){const g=new AbortController,e=e=>{g.abort(e)};return this.subscribe(e),g.signal.unsubscribe=()=>this.unsubscribe(e),g.signal}static source(){let g;const e=new gI((function(e){g=e}));return{token:e,cancel:g}}}const eI=gI;const tI={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(tI).forEach((g=>{let[e,t]=g;tI[t]=e}));const II=tI;const nI=function g(e){const t=new $t(e),I=Ng($t.prototype.request,t);return pe.extend(I,$t.prototype,t,{allOwnKeys:!0}),pe.extend(I,t,null,{allOwnKeys:!0}),I.create=function(t){return g(ut(e,t))},I}(De);nI.Axios=$t,nI.CanceledError=nt,nI.CancelToken=eI,nI.isCancel=tt,nI.VERSION=Dt,nI.toFormData=Re,nI.AxiosError=Se,nI.Cancel=nI.CanceledError,nI.all=function(g){return Promise.all(g)},nI.spread=function(g){return function(e){return g.apply(null,e)}},nI.isAxiosError=function(g){return pe.isObject(g)&&!0===g.isAxiosError},nI.mergeConfig=ut,nI.AxiosHeaders=gt,nI.formToJSON=g=>je(pe.isHTMLForm(g)?new FormData(g):g),nI.getAdapter=Ut,nI.HttpStatusCode=II,nI.default=nI;const CI=nI,lI="/api/v1";var aI=t(579);const oI=()=>{const[g,e]=(0,I.useState)(""),[t,n]=(0,I.useState)(""),[C,l]=(0,I.useState)("Admin"),[a,o]=(0,I.useState)(!1),[i,r]=(0,I.useState)({}),[c,s]=(0,I.useState)(""),A=eg(),d=(0,I.useRef)(null),u=g=>{const{name:e,value:t}=g.target;r(wg(wg({},i),{},{[e]:t}))},m=function(g){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";d.current&&(d.current.textContent=g,d.current.className="success"===e?"success":"error",d.current.style.display="block",setTimeout((()=>{d.current&&(d.current.style.display="none")}),3e3))};return(0,aI.jsxs)("div",{className:"login-container",children:[(0,aI.jsx)("h2",{children:"Login"}),(0,aI.jsx)("div",{ref:d,style:{display:"none",marginBottom:"16px",padding:"10px",borderRadius:"4px",fontWeight:"bold"}}),c&&(0,aI.jsx)("p",{className:"error",children:c}),(0,aI.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),s(""),a)try{await CI.post("".concat(lI,"/auth/create-profile"),{full_name:i.fullName,email:i.email,phone:i.phone,role:C}),m("Profile created successfully. Please wait for admin approval.","success")}catch(jn){m("Error creating profile. Please try again.","error")}else try{const e=await CI.post("".concat(lI,"/auth/login"),{username:g,password:t,role:C});localStorage.setItem("token",e.data.access_token),A("Admin"===C?"/admin-dashboard":"Sales Manager"===C?"/sales-dashboard":"Production Manager"===C?"/production-dashboard":"/marketing-dashboard")}catch(jn){m("Invalid credentials. Please try again.","error")}},children:[(0,aI.jsxs)("div",{children:[(0,aI.jsx)("label",{children:"Role:"}),(0,aI.jsxs)("select",{value:C,onChange:g=>{const e=g.target.value;l(e),o(["Sales Manager","Marketing","Production Manager"].includes(e))},required:!0,children:[(0,aI.jsx)("option",{value:"Admin",children:"Admin"}),(0,aI.jsx)("option",{value:"Sales Manager",children:"Sales Manager"}),(0,aI.jsx)("option",{value:"Production Manager",children:"Production Manager"}),(0,aI.jsx)("option",{value:"Marketing",children:"Marketing"})]})]}),a&&(0,aI.jsxs)("div",{className:"profile-creation",children:[(0,aI.jsx)("h3",{children:"Create Profile"}),(0,aI.jsxs)("div",{children:[(0,aI.jsx)("label",{children:"Full Name:"}),(0,aI.jsx)("input",{type:"text",name:"fullName",value:i.fullName||"",onChange:u,required:!0})]}),(0,aI.jsxs)("div",{children:[(0,aI.jsx)("label",{children:"Email:"}),(0,aI.jsx)("input",{type:"email",name:"email",value:i.email||"",onChange:u,required:!0})]}),(0,aI.jsxs)("div",{children:[(0,aI.jsx)("label",{children:"Phone Number:"}),(0,aI.jsx)("input",{type:"text",name:"phone",value:i.phone||"",onChange:u,required:!0})]})]}),!a&&(0,aI.jsxs)(aI.Fragment,{children:[(0,aI.jsxs)("div",{children:[(0,aI.jsx)("label",{children:"Username:"}),(0,aI.jsx)("input",{type:"text",value:g,onChange:g=>e(g.target.value),required:!0})]}),(0,aI.jsxs)("div",{children:[(0,aI.jsx)("label",{children:"Password:"}),(0,aI.jsx)("input",{type:"password",value:t,onChange:g=>n(g.target.value),required:!0})]})]}),(0,aI.jsx)("button",{type:"submit",children:a?"Create Profile":"Login"})]})]})},iI=()=>{const[g,e]=I.useState(!1),t=(0,I.useRef)(null),n=(0,I.useRef)(null);(0,I.useEffect)((()=>(g?(document.body.classList.add("sidebar-open"),setTimeout((()=>n.current&&n.current.focus()),100)):document.body.classList.remove("sidebar-open"),()=>document.body.classList.remove("sidebar-open"))),[g]),(0,I.useEffect)((()=>{const t=t=>{g&&"Escape"===t.key&&e(!1)};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)}),[g]),(0,I.useEffect)((()=>{let t=null;const I=g=>{1===g.touches.length&&(t=g.touches[0].clientX)},n=I=>{if(!g||null===t)return;I.touches[0].clientX-t<-60&&(e(!1),t=null)};return document.addEventListener("touchstart",I),document.addEventListener("touchmove",n),()=>{document.removeEventListener("touchstart",I),document.removeEventListener("touchmove",n)}}),[g]);const C=()=>e(!g);return(0,aI.jsxs)(aI.Fragment,{children:[(0,aI.jsx)("button",{className:"sidebar-toggle",onClick:C,"aria-label":g?"Close sidebar":"Open sidebar","aria-expanded":g,"aria-controls":"sidebar-nav",style:{left:g?window.innerWidth<=900?window.innerWidth<=600?"90vw":"70vw":"250px":"20px",transition:"left 0.3s"},children:g?(0,aI.jsx)("span",{children:"\u2190"}):(0,aI.jsx)("span",{children:"\u2630"})}),g&&(0,aI.jsx)("div",{className:"sidebar-backdrop","aria-hidden":!g,tabIndex:-1,onClick:C}),(0,aI.jsxs)("nav",{ref:t,className:"sidebar".concat(g?" open":""),id:"sidebar-nav","aria-hidden":!g,tabIndex:g?0:-1,"aria-label":"Sidebar navigation",children:[(0,aI.jsx)("h2",{children:"Navigation"}),(0,aI.jsxs)("ul",{children:[(0,aI.jsx)("li",{children:(0,aI.jsx)(Vg,{to:"/dashboard",ref:n,tabIndex:g?0:-1,onClick:C,children:"Dashboard"})}),(0,aI.jsx)("li",{children:(0,aI.jsx)(Vg,{to:"/registration",tabIndex:g?0:-1,onClick:C,children:"Registration"})}),(0,aI.jsx)("li",{children:(0,aI.jsx)(Vg,{to:"/attendance",tabIndex:g?0:-1,onClick:C,children:"Attendance"})}),(0,aI.jsx)("li",{children:(0,aI.jsx)(Vg,{to:"/sales-inventory",tabIndex:g?0:-1,onClick:C,children:"Sales Inventory"})}),(0,aI.jsx)("li",{children:(0,aI.jsx)(Vg,{to:"/production-inventory",tabIndex:g?0:-1,onClick:C,children:"Production Inventory"})}),(0,aI.jsx)("li",{children:(0,aI.jsx)(Vg,{to:"/factory-inventory",tabIndex:g?0:-1,onClick:C,children:"Factory Inventory"})}),(0,aI.jsx)("li",{children:(0,aI.jsx)(Vg,{to:"/staff-management",tabIndex:g?0:-1,onClick:C,children:"Staff Management"})}),(0,aI.jsx)("li",{children:(0,aI.jsx)(Vg,{to:"/payroll",tabIndex:g?0:-1,onClick:C,children:"Payroll"})}),(0,aI.jsx)("li",{children:(0,aI.jsx)(Vg,{to:"/reports-analysis",tabIndex:g?0:-1,onClick:C,children:"Reports & Analysis"})}),(0,aI.jsx)("li",{children:(0,aI.jsx)(Vg,{to:"/settings",tabIndex:g?0:-1,onClick:C,children:"Settings"})})]})]})]})};var rI,cI=Object.defineProperty,sI=Object.getOwnPropertySymbols,AI=Object.prototype.hasOwnProperty,dI=Object.prototype.propertyIsEnumerable,uI=(g,e,t)=>e in g?cI(g,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):g[e]=t,mI=(g,e)=>{for(var t in e||(e={}))AI.call(e,t)&&uI(g,t,e[t]);if(sI)for(var t of sI(e))dI.call(e,t)&&uI(g,t,e[t]);return g},hI=(g,e)=>{var t={};for(var I in g)AI.call(g,I)&&e.indexOf(I)<0&&(t[I]=g[I]);if(null!=g&&sI)for(var I of sI(g))e.indexOf(I)<0&&dI.call(g,I)&&(t[I]=g[I]);return t};(g=>{const e=class e{constructor(g,t,I,C){if(this.version=g,this.errorCorrectionLevel=t,this.modules=[],this.isFunction=[],g<e.MIN_VERSION||g>e.MAX_VERSION)throw new RangeError("Version value out of range");if(C<-1||C>7)throw new RangeError("Mask value out of range");this.size=4*g+17;let l=[];for(let e=0;e<this.size;e++)l.push(!1);for(let e=0;e<this.size;e++)this.modules.push(l.slice()),this.isFunction.push(l.slice());this.drawFunctionPatterns();const a=this.addEccAndInterleave(I);if(this.drawCodewords(a),-1==C){let g=1e9;for(let e=0;e<8;e++){this.applyMask(e),this.drawFormatBits(e);const t=this.getPenaltyScore();t<g&&(C=e,g=t),this.applyMask(e)}}n(0<=C&&C<=7),this.mask=C,this.applyMask(C),this.drawFormatBits(C),this.isFunction=[]}static encodeText(t,I){const n=g.QrSegment.makeSegments(t);return e.encodeSegments(n,I)}static encodeBinary(t,I){const n=g.QrSegment.makeBytes(t);return e.encodeSegments([n],I)}static encodeSegments(g,I){let C,a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:40,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,c=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if(!(e.MIN_VERSION<=o&&o<=i&&i<=e.MAX_VERSION)||r<-1||r>7)throw new RangeError("Invalid value");for(C=o;;C++){const t=8*e.getNumDataCodewords(C,I),n=l.getTotalBits(g,C);if(n<=t){a=n;break}if(C>=i)throw new RangeError("Data too long")}for(const t of[e.Ecc.MEDIUM,e.Ecc.QUARTILE,e.Ecc.HIGH])c&&a<=8*e.getNumDataCodewords(C,t)&&(I=t);let s=[];for(const e of g){t(e.mode.modeBits,4,s),t(e.numChars,e.mode.numCharCountBits(C),s);for(const g of e.getData())s.push(g)}n(s.length==a);const A=8*e.getNumDataCodewords(C,I);n(s.length<=A),t(0,Math.min(4,A-s.length),s),t(0,(8-s.length%8)%8,s),n(s.length%8==0);for(let e=236;s.length<A;e^=253)t(e,8,s);let d=[];for(;8*d.length<s.length;)d.push(0);return s.forEach(((g,e)=>d[e>>>3]|=g<<7-(7&e))),new e(C,I,d,r)}getModule(g,e){return 0<=g&&g<this.size&&0<=e&&e<this.size&&this.modules[e][g]}getModules(){return this.modules}drawFunctionPatterns(){for(let t=0;t<this.size;t++)this.setFunctionModule(6,t,t%2==0),this.setFunctionModule(t,6,t%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const g=this.getAlignmentPatternPositions(),e=g.length;for(let t=0;t<e;t++)for(let I=0;I<e;I++)0==t&&0==I||0==t&&I==e-1||t==e-1&&0==I||this.drawAlignmentPattern(g[t],g[I]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(g){const e=this.errorCorrectionLevel.formatBits<<3|g;let t=e;for(let I=0;I<10;I++)t=t<<1^1335*(t>>>9);const C=21522^(e<<10|t);n(C>>>15==0);for(let n=0;n<=5;n++)this.setFunctionModule(8,n,I(C,n));this.setFunctionModule(8,7,I(C,6)),this.setFunctionModule(8,8,I(C,7)),this.setFunctionModule(7,8,I(C,8));for(let n=9;n<15;n++)this.setFunctionModule(14-n,8,I(C,n));for(let n=0;n<8;n++)this.setFunctionModule(this.size-1-n,8,I(C,n));for(let n=8;n<15;n++)this.setFunctionModule(8,this.size-15+n,I(C,n));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let g=this.version;for(let t=0;t<12;t++)g=g<<1^7973*(g>>>11);const e=this.version<<12|g;n(e>>>18==0);for(let t=0;t<18;t++){const g=I(e,t),n=this.size-11+t%3,C=Math.floor(t/3);this.setFunctionModule(n,C,g),this.setFunctionModule(C,n,g)}}drawFinderPattern(g,e){for(let t=-4;t<=4;t++)for(let I=-4;I<=4;I++){const n=Math.max(Math.abs(I),Math.abs(t)),C=g+I,l=e+t;0<=C&&C<this.size&&0<=l&&l<this.size&&this.setFunctionModule(C,l,2!=n&&4!=n)}}drawAlignmentPattern(g,e){for(let t=-2;t<=2;t++)for(let I=-2;I<=2;I++)this.setFunctionModule(g+I,e+t,1!=Math.max(Math.abs(I),Math.abs(t)))}setFunctionModule(g,e,t){this.modules[e][g]=t,this.isFunction[e][g]=!0}addEccAndInterleave(g){const t=this.version,I=this.errorCorrectionLevel;if(g.length!=e.getNumDataCodewords(t,I))throw new RangeError("Invalid argument");const C=e.NUM_ERROR_CORRECTION_BLOCKS[I.ordinal][t],l=e.ECC_CODEWORDS_PER_BLOCK[I.ordinal][t],a=Math.floor(e.getNumRawDataModules(t)/8),o=C-a%C,i=Math.floor(a/C);let r=[];const c=e.reedSolomonComputeDivisor(l);for(let n=0,A=0;n<C;n++){let t=g.slice(A,A+i-l+(n<o?0:1));A+=t.length;const I=e.reedSolomonComputeRemainder(t,c);n<o&&t.push(0),r.push(t.concat(I))}let s=[];for(let e=0;e<r[0].length;e++)r.forEach(((g,t)=>{(e!=i-l||t>=o)&&s.push(g[e])}));return n(s.length==a),s}drawCodewords(g){if(g.length!=Math.floor(e.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let t=0;for(let e=this.size-1;e>=1;e-=2){6==e&&(e=5);for(let n=0;n<this.size;n++)for(let C=0;C<2;C++){const l=e-C,a=0==(e+1&2)?this.size-1-n:n;!this.isFunction[a][l]&&t<8*g.length&&(this.modules[a][l]=I(g[t>>>3],7-(7&t)),t++)}}n(t==8*g.length)}applyMask(g){if(g<0||g>7)throw new RangeError("Mask value out of range");for(let e=0;e<this.size;e++)for(let t=0;t<this.size;t++){let I;switch(g){case 0:I=(t+e)%2==0;break;case 1:I=e%2==0;break;case 2:I=t%3==0;break;case 3:I=(t+e)%3==0;break;case 4:I=(Math.floor(t/3)+Math.floor(e/2))%2==0;break;case 5:I=t*e%2+t*e%3==0;break;case 6:I=(t*e%2+t*e%3)%2==0;break;case 7:I=((t+e)%2+t*e%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[e][t]&&I&&(this.modules[e][t]=!this.modules[e][t])}}getPenaltyScore(){let g=0;for(let n=0;n<this.size;n++){let t=!1,I=0,C=[0,0,0,0,0,0,0];for(let l=0;l<this.size;l++)this.modules[n][l]==t?(I++,5==I?g+=e.PENALTY_N1:I>5&&g++):(this.finderPenaltyAddHistory(I,C),t||(g+=this.finderPenaltyCountPatterns(C)*e.PENALTY_N3),t=this.modules[n][l],I=1);g+=this.finderPenaltyTerminateAndCount(t,I,C)*e.PENALTY_N3}for(let n=0;n<this.size;n++){let t=!1,I=0,C=[0,0,0,0,0,0,0];for(let l=0;l<this.size;l++)this.modules[l][n]==t?(I++,5==I?g+=e.PENALTY_N1:I>5&&g++):(this.finderPenaltyAddHistory(I,C),t||(g+=this.finderPenaltyCountPatterns(C)*e.PENALTY_N3),t=this.modules[l][n],I=1);g+=this.finderPenaltyTerminateAndCount(t,I,C)*e.PENALTY_N3}for(let n=0;n<this.size-1;n++)for(let t=0;t<this.size-1;t++){const I=this.modules[n][t];I==this.modules[n][t+1]&&I==this.modules[n+1][t]&&I==this.modules[n+1][t+1]&&(g+=e.PENALTY_N2)}let t=0;for(const e of this.modules)t=e.reduce(((g,e)=>g+(e?1:0)),t);const I=this.size*this.size,C=Math.ceil(Math.abs(20*t-10*I)/I)-1;return n(0<=C&&C<=9),g+=C*e.PENALTY_N4,n(0<=g&&g<=2568888),g}getAlignmentPatternPositions(){if(1==this.version)return[];{const g=Math.floor(this.version/7)+2,e=32==this.version?26:2*Math.ceil((4*this.version+4)/(2*g-2));let t=[6];for(let I=this.size-7;t.length<g;I-=e)t.splice(1,0,I);return t}}static getNumRawDataModules(g){if(g<e.MIN_VERSION||g>e.MAX_VERSION)throw new RangeError("Version number out of range");let t=(16*g+128)*g+64;if(g>=2){const e=Math.floor(g/7)+2;t-=(25*e-10)*e-55,g>=7&&(t-=36)}return n(208<=t&&t<=29648),t}static getNumDataCodewords(g,t){return Math.floor(e.getNumRawDataModules(g)/8)-e.ECC_CODEWORDS_PER_BLOCK[t.ordinal][g]*e.NUM_ERROR_CORRECTION_BLOCKS[t.ordinal][g]}static reedSolomonComputeDivisor(g){if(g<1||g>255)throw new RangeError("Degree out of range");let t=[];for(let e=0;e<g-1;e++)t.push(0);t.push(1);let I=1;for(let n=0;n<g;n++){for(let g=0;g<t.length;g++)t[g]=e.reedSolomonMultiply(t[g],I),g+1<t.length&&(t[g]^=t[g+1]);I=e.reedSolomonMultiply(I,2)}return t}static reedSolomonComputeRemainder(g,t){let I=t.map((g=>0));for(const n of g){const g=n^I.shift();I.push(0),t.forEach(((t,n)=>I[n]^=e.reedSolomonMultiply(t,g)))}return I}static reedSolomonMultiply(g,e){if(g>>>8!=0||e>>>8!=0)throw new RangeError("Byte out of range");let t=0;for(let I=7;I>=0;I--)t=t<<1^285*(t>>>7),t^=(e>>>I&1)*g;return n(t>>>8==0),t}finderPenaltyCountPatterns(g){const e=g[1];n(e<=3*this.size);const t=e>0&&g[2]==e&&g[3]==3*e&&g[4]==e&&g[5]==e;return(t&&g[0]>=4*e&&g[6]>=e?1:0)+(t&&g[6]>=4*e&&g[0]>=e?1:0)}finderPenaltyTerminateAndCount(g,e,t){return g&&(this.finderPenaltyAddHistory(e,t),e=0),e+=this.size,this.finderPenaltyAddHistory(e,t),this.finderPenaltyCountPatterns(t)}finderPenaltyAddHistory(g,e){0==e[0]&&(g+=this.size),e.pop(),e.unshift(g)}};e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]];function t(g,e,t){if(e<0||e>31||g>>>e!=0)throw new RangeError("Value out of range");for(let I=e-1;I>=0;I--)t.push(g>>>I&1)}function I(g,e){return 0!=(g>>>e&1)}function n(g){if(!g)throw new Error("Assertion error")}g.QrCode=e;const C=class g{constructor(g,e,t){if(this.mode=g,this.numChars=e,this.bitData=t,e<0)throw new RangeError("Invalid argument");this.bitData=t.slice()}static makeBytes(e){let I=[];for(const g of e)t(g,8,I);return new g(g.Mode.BYTE,e.length,I)}static makeNumeric(e){if(!g.isNumeric(e))throw new RangeError("String contains non-numeric characters");let I=[];for(let g=0;g<e.length;){const n=Math.min(e.length-g,3);t(parseInt(e.substring(g,g+n),10),3*n+1,I),g+=n}return new g(g.Mode.NUMERIC,e.length,I)}static makeAlphanumeric(e){if(!g.isAlphanumeric(e))throw new RangeError("String contains unencodable characters in alphanumeric mode");let I,n=[];for(I=0;I+2<=e.length;I+=2){let C=45*g.ALPHANUMERIC_CHARSET.indexOf(e.charAt(I));C+=g.ALPHANUMERIC_CHARSET.indexOf(e.charAt(I+1)),t(C,11,n)}return I<e.length&&t(g.ALPHANUMERIC_CHARSET.indexOf(e.charAt(I)),6,n),new g(g.Mode.ALPHANUMERIC,e.length,n)}static makeSegments(e){return""==e?[]:g.isNumeric(e)?[g.makeNumeric(e)]:g.isAlphanumeric(e)?[g.makeAlphanumeric(e)]:[g.makeBytes(g.toUtf8ByteArray(e))]}static makeEci(e){let I=[];if(e<0)throw new RangeError("ECI assignment value out of range");if(e<128)t(e,8,I);else if(e<16384)t(2,2,I),t(e,14,I);else{if(!(e<1e6))throw new RangeError("ECI assignment value out of range");t(6,3,I),t(e,21,I)}return new g(g.Mode.ECI,0,I)}static isNumeric(e){return g.NUMERIC_REGEX.test(e)}static isAlphanumeric(e){return g.ALPHANUMERIC_REGEX.test(e)}getData(){return this.bitData.slice()}static getTotalBits(g,e){let t=0;for(const I of g){const g=I.mode.numCharCountBits(e);if(I.numChars>=1<<g)return 1/0;t+=4+g+I.bitData.length}return t}static toUtf8ByteArray(g){g=encodeURI(g);let e=[];for(let t=0;t<g.length;t++)"%"!=g.charAt(t)?e.push(g.charCodeAt(t)):(e.push(parseInt(g.substring(t+1,t+3),16)),t+=2);return e}};C.NUMERIC_REGEX=/^[0-9]*$/,C.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,C.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let l=C;g.QrSegment=C})(rI||(rI={})),(g=>{let e;(g=>{const e=class{constructor(g,e){this.ordinal=g,this.formatBits=e}};e.LOW=new e(0,1),e.MEDIUM=new e(1,0),e.QUARTILE=new e(2,3),e.HIGH=new e(3,2);g.Ecc=e})(e=g.QrCode||(g.QrCode={}))})(rI||(rI={})),(g=>{let e;(g=>{const e=class{constructor(g,e){this.modeBits=g,this.numBitsCharCount=e}numCharCountBits(g){return this.numBitsCharCount[Math.floor((g+7)/17)]}};e.NUMERIC=new e(1,[10,12,14]),e.ALPHANUMERIC=new e(2,[9,11,13]),e.BYTE=new e(4,[8,16,16]),e.KANJI=new e(8,[8,10,12]),e.ECI=new e(7,[0,0,0]);g.Mode=e})(e=g.QrSegment||(g.QrSegment={}))})(rI||(rI={}));var bI=rI,ZI={L:bI.QrCode.Ecc.LOW,M:bI.QrCode.Ecc.MEDIUM,Q:bI.QrCode.Ecc.QUARTILE,H:bI.QrCode.Ecc.HIGH},pI=128,GI="L",yI="#FFFFFF",BI="#000000",SI=!1,fI=1;function WI(g){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const t=[];return g.forEach((function(g,I){let n=null;g.forEach((function(C,l){if(!C&&null!==n)return t.push("M".concat(n+e," ").concat(I+e,"h").concat(l-n,"v1H").concat(n+e,"z")),void(n=null);if(l!==g.length-1)C&&null===n&&(n=l);else{if(!C)return;null===n?t.push("M".concat(l+e,",").concat(I+e," h1v1H").concat(l+e,"z")):t.push("M".concat(n+e,",").concat(I+e," h").concat(l+1-n,"v1H").concat(n+e,"z"))}}))})),t.join("")}function VI(g,e){return g.slice().map(((g,t)=>t<e.y||t>=e.y+e.h?g:g.map(((g,t)=>(t<e.x||t>=e.x+e.w)&&g))))}function vI(g){let{value:e,level:t,minVersion:n,includeMargin:C,marginSize:l,imageSettings:a,size:o,boostLevel:i}=g,r=I.useMemo((()=>{const g=(Array.isArray(e)?e:[e]).reduce(((g,e)=>(g.push(...bI.QrSegment.makeSegments(e)),g)),[]);return bI.QrCode.encodeSegments(g,ZI[t],n,void 0,void 0,i)}),[e,t,n,i]);const{cells:c,margin:s,numCells:A,calculatedImageSettings:d}=I.useMemo((()=>{let g=r.getModules();const e=function(g,e){return null!=e?Math.max(Math.floor(e),0):g?4:0}(C,l),t=g.length+2*e,I=function(g,e,t,I){if(null==I)return null;const n=g.length+2*t,C=Math.floor(.1*e),l=n/e,a=(I.width||C)*l,o=(I.height||C)*l,i=null==I.x?g.length/2-a/2:I.x*l,r=null==I.y?g.length/2-o/2:I.y*l,c=null==I.opacity?1:I.opacity;let s=null;if(I.excavate){let g=Math.floor(i),e=Math.floor(r);s={x:g,y:e,w:Math.ceil(a+i-g),h:Math.ceil(o+r-e)}}return{x:i,y:r,h:o,w:a,excavation:s,opacity:c,crossOrigin:I.crossOrigin}}(g,o,e,a);return{cells:g,margin:e,numCells:t,calculatedImageSettings:I}}),[r,o,a,C,l]);return{qrcode:r,margin:s,cells:c,numCells:A,calculatedImageSettings:d}}var RI=function(){try{(new Path2D).addPath(new Path2D)}catch(ui){return!1}return!0}(),XI=I.forwardRef((function(g,e){const t=g,{value:n,size:C=pI,level:l=GI,bgColor:a=yI,fgColor:o=BI,includeMargin:i=SI,minVersion:r=fI,boostLevel:c,marginSize:s,imageSettings:A}=t,d=hI(t,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:u}=d,m=hI(d,["style"]),h=null==A?void 0:A.src,b=I.useRef(null),Z=I.useRef(null),p=I.useCallback((g=>{b.current=g,"function"===typeof e?e(g):e&&(e.current=g)}),[e]),[G,y]=I.useState(!1),{margin:B,cells:S,numCells:f,calculatedImageSettings:W}=vI({value:n,level:l,minVersion:r,boostLevel:c,includeMargin:i,marginSize:s,imageSettings:A,size:C});I.useEffect((()=>{if(null!=b.current){const g=b.current,e=g.getContext("2d");if(!e)return;let t=S;const I=Z.current,n=null!=W&&null!==I&&I.complete&&0!==I.naturalHeight&&0!==I.naturalWidth;n&&null!=W.excavation&&(t=VI(S,W.excavation));const l=window.devicePixelRatio||1;g.height=g.width=C*l;const i=C/f*l;e.scale(i,i),e.fillStyle=a,e.fillRect(0,0,f,f),e.fillStyle=o,RI?e.fill(new Path2D(WI(t,B))):S.forEach((function(g,t){g.forEach((function(g,I){g&&e.fillRect(I+B,t+B,1,1)}))})),W&&(e.globalAlpha=W.opacity),n&&e.drawImage(I,W.x+B,W.y+B,W.w,W.h)}})),I.useEffect((()=>{y(!1)}),[h]);const V=mI({height:C,width:C},u);let v=null;return null!=h&&(v=I.createElement("img",{src:h,key:h,style:{display:"none"},onLoad:()=>{y(!0)},ref:Z,crossOrigin:null==W?void 0:W.crossOrigin})),I.createElement(I.Fragment,null,I.createElement("canvas",mI({style:V,height:C,width:C,ref:p,role:"img"},m)),v)}));XI.displayName="QRCodeCanvas";var kI=I.forwardRef((function(g,e){const t=g,{value:n,size:C=pI,level:l=GI,bgColor:a=yI,fgColor:o=BI,includeMargin:i=SI,minVersion:r=fI,boostLevel:c,title:s,marginSize:A,imageSettings:d}=t,u=hI(t,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:m,cells:h,numCells:b,calculatedImageSettings:Z}=vI({value:n,level:l,minVersion:r,boostLevel:c,includeMargin:i,marginSize:A,imageSettings:d,size:C});let p=h,G=null;null!=d&&null!=Z&&(null!=Z.excavation&&(p=VI(h,Z.excavation)),G=I.createElement("image",{href:d.src,height:Z.h,width:Z.w,x:Z.x+m,y:Z.y+m,preserveAspectRatio:"none",opacity:Z.opacity,crossOrigin:Z.crossOrigin}));const y=WI(p,m);return I.createElement("svg",mI({height:C,width:C,viewBox:"0 0 ".concat(b," ").concat(b),ref:e,role:"img"},u),!!s&&I.createElement("title",null,s),I.createElement("path",{fill:a,d:"M0,0 h".concat(b,"v").concat(b,"H0z"),shapeRendering:"crispEdges"}),I.createElement("path",{fill:o,d:y,shapeRendering:"crispEdges"}),G)}));kI.displayName="QRCodeSVG";let JI,YI;const wI=new WeakMap,NI=new WeakMap,HI=new WeakMap,FI=new WeakMap,KI=new WeakMap;let xI={get(g,e,t){if(g instanceof IDBTransaction){if("done"===e)return NI.get(g);if("objectStoreNames"===e)return g.objectStoreNames||HI.get(g);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return EI(g[e])},set:(g,e,t)=>(g[e]=t,!0),has:(g,e)=>g instanceof IDBTransaction&&("done"===e||"store"===e)||e in g};function LI(g){return g!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(YI||(YI=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(g)?function(){for(var e=arguments.length,t=new Array(e),I=0;I<e;I++)t[I]=arguments[I];return g.apply(MI(this),t),EI(wI.get(this))}:function(){for(var e=arguments.length,t=new Array(e),I=0;I<e;I++)t[I]=arguments[I];return EI(g.apply(MI(this),t))}:function(e){for(var t=arguments.length,I=new Array(t>1?t-1:0),n=1;n<t;n++)I[n-1]=arguments[n];const C=g.call(MI(this),e,...I);return HI.set(C,e.sort?e.sort():[e]),EI(C)}}function zI(g){return"function"===typeof g?LI(g):(g instanceof IDBTransaction&&function(g){if(NI.has(g))return;const e=new Promise(((e,t)=>{const I=()=>{g.removeEventListener("complete",n),g.removeEventListener("error",C),g.removeEventListener("abort",C)},n=()=>{e(),I()},C=()=>{t(g.error||new DOMException("AbortError","AbortError")),I()};g.addEventListener("complete",n),g.addEventListener("error",C),g.addEventListener("abort",C)}));NI.set(g,e)}(g),e=g,(JI||(JI=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((g=>e instanceof g))?new Proxy(g,xI):g);var e}function EI(g){if(g instanceof IDBRequest)return function(g){const e=new Promise(((e,t)=>{const I=()=>{g.removeEventListener("success",n),g.removeEventListener("error",C)},n=()=>{e(EI(g.result)),I()},C=()=>{t(g.error),I()};g.addEventListener("success",n),g.addEventListener("error",C)}));return e.then((e=>{e instanceof IDBCursor&&wI.set(e,g)})).catch((()=>{})),KI.set(e,g),e}(g);if(FI.has(g))return FI.get(g);const e=zI(g);return e!==g&&(FI.set(g,e),KI.set(e,g)),e}const MI=g=>KI.get(g);const UI=["get","getKey","getAll","getAllKeys","count"],jI=["put","add","delete","clear"],QI=new Map;function DI(g,e){if(!(g instanceof IDBDatabase)||e in g||"string"!==typeof e)return;if(QI.get(e))return QI.get(e);const t=e.replace(/FromIndex$/,""),I=e!==t,n=jI.includes(t);if(!(t in(I?IDBIndex:IDBObjectStore).prototype)||!n&&!UI.includes(t))return;const C=async function(g){const e=this.transaction(g,n?"readwrite":"readonly");let C=e.store;for(var l=arguments.length,a=new Array(l>1?l-1:0),o=1;o<l;o++)a[o-1]=arguments[o];return I&&(C=C.index(a.shift())),(await Promise.all([C[t](...a),n&&e.done]))[0]};return QI.set(e,C),C}xI=(g=>wg(wg({},g),{},{get:(e,t,I)=>DI(e,t)||g.get(e,t,I),has:(e,t)=>!!DI(e,t)||g.has(e,t)}))(xI);const TI="formData",PI=async()=>{try{return function(g,e){let{blocked:t,upgrade:I,blocking:n,terminated:C}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const l=indexedDB.open(g,e),a=EI(l);return I&&l.addEventListener("upgradeneeded",(g=>{I(EI(l.result),g.oldVersion,g.newVersion,EI(l.transaction),g)})),t&&l.addEventListener("blocked",(g=>t(g.oldVersion,g.newVersion,g))),a.then((g=>{C&&g.addEventListener("close",(()=>C())),n&&g.addEventListener("versionchange",(g=>n(g.oldVersion,g.newVersion,g)))})).catch((()=>{})),a}("AstroBSM",1,{upgrade(g){if(!g.objectStoreNames.contains(TI)){const e=g.createObjectStore(TI,{keyPath:"id",autoIncrement:!0});e.createIndex("name","name",{unique:!1}),e.createIndex("email","email",{unique:!0}),e.createIndex("createdAt","createdAt",{unique:!1})}}})}catch(g){throw console.error("Failed to initialize the database:",g),g}},OI="https://astrobsm-oracle-backend.onrender.com/api/v1",qI=()=>{var g,e,t,n,C,l,a,o,i,r,c,s,A,d,u,m,h,b,Z,p,G,y,B,S,f,W,V,v,R,X,k,J,Y,w,N,H,F,K,x,L,z,E,M,U,j,Q,D,T,P,O,q;const[_,$]=(0,I.useState)({type:"staff",additionalFields:{}}),[gg,eg]=(0,I.useState)(""),[tg,Ig]=(0,I.useState)([]),[ng,Cg]=(0,I.useState)(""),[lg,ag]=(0,I.useState)(!1);(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat(OI,"/suppliers")),e=await g.json();Ig(e)}catch(g){console.error("Error fetching suppliers:",g)}})()}),[]);const og=g=>{const{name:e,value:t}=g.target;$(wg(wg({},_),{},{additionalFields:wg(wg({},_.additionalFields),{},{[e]:t})}))},ig=g=>{const e=new Date(g),t=new Date;let I=t.getFullYear()-e.getFullYear();const n=t.getMonth()-e.getMonth();return(n<0||0===n&&t.getDate()<e.getDate())&&I--,I};return(0,aI.jsxs)("div",{className:"registration-container",children:[(0,aI.jsx)("h1",{children:"Registration"}),(0,aI.jsxs)("form",{onSubmit:async g=>{g.preventDefault(),ag(!0),eg("");try{let g="",t={};const I=_.type,n=_.additionalFields;switch(I){case"staff":g="".concat(OI,"/registration/staff-profile"),t={name:n.staffName,staff_id:n.staffId||"ASTRO".concat(Math.floor(1e3+9e3*Math.random())),dob:n.dob,gender:n.gender,phone:n.phone,address:n.address,bank:n.bankName,account_number:n.accountNumber,hourly_rate:n.hourlyRate?parseFloat(n.hourlyRate):0,role:n.role||"staff",department:n.department,appointment_type:n.appointmentType};break;case"product":g="".concat(OI,"/registration/product"),t={name:n.productName,product_id:n.productId||void 0,description:n.productDescription,uom:n.unitOfMeasure,source:n.source||"",unit_price:n.unitPrice?parseFloat(n.unitPrice):0,reorder_point:n.reorderPoint?parseInt(n.reorderPoint):0,opening_stock:n.openingStockQuantity?parseInt(n.openingStockQuantity):0};break;case"raw_material":g="".concat(OI,"/registration/raw-material"),t={name:n.rawMaterialName,rm_id:n.rawMaterialId||void 0,category:n.category||"",source:n.source||"",uom:n.unitOfMeasure,reorder_point:n.reorderPoint?parseInt(n.reorderPoint):0,unit_cost:n.unitPrice?parseFloat(n.unitPrice):0,opening_stock:n.openingStockQuantity?parseInt(n.openingStockQuantity):0};break;case"customer":g="".concat(OI,"/registration/customer"),t={name:n.customerName,company:n.company||"",phone:n.phoneNumber,address:n.address||""};break;case"warehouse":g="".concat(OI,"/registration/warehouse"),t={name:n.warehouseName,wh_id:n.warehouseId||"WH".concat(Math.floor(1e3+9e3*Math.random())),location:n.location,manager_name:n.manager,manager_phone:n.managerPhone,date_created:(new Date).toISOString().split("T")[0]};break;case"supplier":g="".concat(OI,"/registration/supplier"),t={name:n.supplierName,phone:n.contactPhone,country:n.country||"",state:n.state||""};break;case"distributor":g="".concat(OI,"/registration/distributor"),t={name:n.distributorName,dist_id:n.distributorId||"DIST".concat(Math.floor(1e3+9e3*Math.random())),phone:n.phoneNumber,coverage:n.region,address:n.address||""};break;case"marketer":g="".concat(OI,"/registration/marketer"),t={name:n.marketerName,mark_id:n.marketerId||"MARK".concat(Math.floor(1e3+9e3*Math.random())),coverage:n.region||"",phone:n.phoneNumber,email:n.email||""};break;default:return eg("Invalid registration type."),void ag(!1)}const C=await fetch(g,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});let l,a="";try{l=await C.json()}catch(e){l={},a="Invalid server response."}C.ok?(eg("Registration successful!"),Cg(JSON.stringify(t)),await(async g=>{try{const e=(await PI()).transaction(TI,"readwrite");await e.store.add(g),await e.done}catch(e){throw console.error("Failed to save form data:",e),e}})(t),$({type:"staff",additionalFields:{}}),ag(!1)):(a||(a="Registration failed. Please try again."),l.detail?"string"===typeof l.detail?a=l.detail:Array.isArray(l.detail)?a=l.detail.map((g=>g.msg||JSON.stringify(g))).join("; "):"object"===typeof l.detail&&(a=JSON.stringify(l.detail)):l.message&&(a=l.message),eg(a),ag(!1))}catch(t){let g="An error occurred. Please try again.";t&&t.message&&(g="Network or server error: ".concat(t.message)),eg(g),ag(!1)}},className:"registration-form",children:[(0,aI.jsxs)("label",{children:["Type:",(0,aI.jsxs)("select",{name:"type",value:_.type||"",onChange:g=>{const{name:e,value:t}=g.target;$(wg(wg({},_),{},{[e]:t}))},required:!0,children:[(0,aI.jsx)("option",{value:"",children:"Select Type"}),(0,aI.jsx)("option",{value:"staff",children:"Staff"}),(0,aI.jsx)("option",{value:"product",children:"Product"}),(0,aI.jsx)("option",{value:"raw_material",children:"Raw Material"}),(0,aI.jsx)("option",{value:"customer",children:"Customer"}),(0,aI.jsx)("option",{value:"warehouse",children:"Warehouse"}),(0,aI.jsx)("option",{value:"supplier",children:"Supplier"}),(0,aI.jsx)("option",{value:"distributor",children:"Distributor"}),(0,aI.jsx)("option",{value:"marketer",children:"Marketer"})]})]}),"staff"===_.type&&(0,aI.jsxs)("div",{children:[(0,aI.jsxs)("label",{children:["Staff Name:",(0,aI.jsx)("input",{type:"text",name:"staffName",value:(null===(g=_.additionalFields)||void 0===g?void 0:g.staffName)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["Staff ID (Auto-generated):",(0,aI.jsx)("input",{type:"text",name:"staffId",value:"ASTRO".concat(Math.floor(1e3+9e3*Math.random())),readOnly:!0})]}),(0,aI.jsxs)("label",{children:["Date of Birth:",(0,aI.jsx)("input",{type:"date",name:"dob",value:(null===(e=_.additionalFields)||void 0===e?void 0:e.dob)||"",onChange:g=>{og(g),$((e=>wg(wg({},e),{},{additionalFields:wg(wg({},e.additionalFields),{},{dob:g.target.value,age:ig(g.target.value)})})))},required:!0})]}),(0,aI.jsxs)("label",{children:["Age (Auto-calculated):",(0,aI.jsx)("input",{type:"number",name:"age",value:_.additionalFields.age||"",readOnly:!0})]}),(0,aI.jsxs)("label",{children:["Gender:",(0,aI.jsxs)("select",{name:"gender",value:(null===(t=_.additionalFields)||void 0===t?void 0:t.gender)||"",onChange:og,required:!0,children:[(0,aI.jsx)("option",{value:"",children:"Select Gender"}),(0,aI.jsx)("option",{value:"male",children:"Male"}),(0,aI.jsx)("option",{value:"female",children:"Female"})]})]}),(0,aI.jsxs)("label",{children:["Contact Phone Number:",(0,aI.jsx)("input",{type:"text",name:"phone",value:(null===(n=_.additionalFields)||void 0===n?void 0:n.phone)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["Address:",(0,aI.jsx)("input",{type:"text",name:"address",value:(null===(C=_.additionalFields)||void 0===C?void 0:C.address)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["Bank Name:",(0,aI.jsx)("input",{type:"text",name:"bankName",value:(null===(l=_.additionalFields)||void 0===l?void 0:l.bankName)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["Account Number:",(0,aI.jsx)("input",{type:"text",name:"accountNumber",value:(null===(a=_.additionalFields)||void 0===a?void 0:a.accountNumber)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["Hourly Rate:",(0,aI.jsx)("input",{type:"number",name:"hourlyRate",value:(null===(o=_.additionalFields)||void 0===o?void 0:o.hourlyRate)||"",onChange:og,required:!0,min:"0",step:"0.01"})]}),(0,aI.jsxs)("label",{children:["Department:",(0,aI.jsx)("input",{type:"text",name:"department",value:(null===(i=_.additionalFields)||void 0===i?void 0:i.department)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["Appointment Type:",(0,aI.jsx)("input",{type:"text",name:"appointmentType",value:(null===(r=_.additionalFields)||void 0===r?void 0:r.appointmentType)||"",onChange:og,required:!0})]})]}),"product"===_.type&&(0,aI.jsxs)("div",{children:[(0,aI.jsxs)("label",{children:["Product Name:",(0,aI.jsx)("input",{type:"text",name:"productName",value:(null===(c=_.additionalFields)||void 0===c?void 0:c.productName)||"",onChange:g=>{og(g);const e=g.target.value||"";if(e){const g="PRD".concat(e.replace(/\s+/g,"").toUpperCase().slice(0,6)).concat(Math.floor(1e3+9e3*Math.random()));$((e=>wg(wg({},e),{},{additionalFields:wg(wg({},e.additionalFields),{},{productId:g})})))}else $((g=>wg(wg({},g),{},{additionalFields:wg(wg({},g.additionalFields),{},{productId:""})})))},required:!0})]}),(0,aI.jsxs)("label",{children:["Product ID:",(0,aI.jsx)("input",{type:"text",name:"productId",value:(null===(s=_.additionalFields)||void 0===s?void 0:s.productId)||"",readOnly:!0})]}),(0,aI.jsxs)("label",{children:["Product Description:",(0,aI.jsx)("textarea",{name:"productDescription",value:(null===(A=_.additionalFields)||void 0===A?void 0:A.productDescription)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["Unit of Measure:",(0,aI.jsx)("input",{type:"text",name:"unitOfMeasure",value:(null===(d=_.additionalFields)||void 0===d?void 0:d.unitOfMeasure)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["Source:",(0,aI.jsx)("input",{type:"text",name:"source",value:(null===(u=_.additionalFields)||void 0===u?void 0:u.source)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["Unit Price:",(0,aI.jsx)("input",{type:"number",name:"unitPrice",value:(null===(m=_.additionalFields)||void 0===m?void 0:m.unitPrice)||"",onChange:og,required:!0,min:"0",step:"0.01"})]}),(0,aI.jsxs)("label",{children:["Reorder Point:",(0,aI.jsx)("input",{type:"number",name:"reorderPoint",value:(null===(h=_.additionalFields)||void 0===h?void 0:h.reorderPoint)||"",onChange:og,required:!0,min:"0"})]}),(0,aI.jsxs)("label",{children:["Opening Stock Quantity:",(0,aI.jsx)("input",{type:"number",name:"openingStockQuantity",value:(null===(b=_.additionalFields)||void 0===b?void 0:b.openingStockQuantity)||"",onChange:og,required:!0,min:"0"})]})]}),"raw_material"===_.type&&(0,aI.jsxs)("div",{children:[(0,aI.jsxs)("label",{children:["Raw Material Name:",(0,aI.jsx)("input",{type:"text",name:"rawMaterialName",value:(null===(Z=_.additionalFields)||void 0===Z?void 0:Z.rawMaterialName)||"",onChange:g=>{og(g);const e=g.target.value||"";if(e){const g="RAW".concat(e.replace(/\s+/g,"").toUpperCase().slice(0,6)).concat(Math.floor(1e3+9e3*Math.random()));$((e=>wg(wg({},e),{},{additionalFields:wg(wg({},e.additionalFields),{},{rawMaterialId:g})})))}else $((g=>wg(wg({},g),{},{additionalFields:wg(wg({},g.additionalFields),{},{rawMaterialId:""})})))},required:!0})]}),(0,aI.jsxs)("label",{children:["Raw Material ID:",(0,aI.jsx)("input",{type:"text",name:"rawMaterialId",value:(null===(p=_.additionalFields)||void 0===p?void 0:p.rawMaterialId)||"",readOnly:!0})]}),(0,aI.jsxs)("label",{children:["Category:",(0,aI.jsx)("input",{type:"text",name:"category",value:(null===(G=_.additionalFields)||void 0===G?void 0:G.category)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["Source:",(0,aI.jsx)("input",{type:"text",name:"source",value:(null===(y=_.additionalFields)||void 0===y?void 0:y.source)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["Unit of Measure:",(0,aI.jsx)("input",{type:"text",name:"unitOfMeasure",value:(null===(B=_.additionalFields)||void 0===B?void 0:B.unitOfMeasure)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["Unit Cost:",(0,aI.jsx)("input",{type:"number",name:"unitPrice",value:(null===(S=_.additionalFields)||void 0===S?void 0:S.unitPrice)||"",onChange:og,required:!0,min:"0",step:"0.01"})]}),(0,aI.jsxs)("label",{children:["Reorder Point:",(0,aI.jsx)("input",{type:"number",name:"reorderPoint",value:(null===(f=_.additionalFields)||void 0===f?void 0:f.reorderPoint)||"",onChange:og,required:!0,min:"0"})]}),(0,aI.jsxs)("label",{children:["Opening Stock Quantity:",(0,aI.jsx)("input",{type:"number",name:"openingStockQuantity",value:(null===(W=_.additionalFields)||void 0===W?void 0:W.openingStockQuantity)||"",onChange:og,required:!0,min:"0"})]})]}),"customer"===_.type&&(0,aI.jsxs)("div",{children:[(0,aI.jsxs)("label",{children:["Customer Name:",(0,aI.jsx)("input",{type:"text",name:"customerName",value:(null===(V=_.additionalFields)||void 0===V?void 0:V.customerName)||"",onChange:g=>{og(g);const e=g.target.value||"";if(e){const g="CUS".concat(e.replace(/\s+/g,"").toUpperCase().slice(0,6)).concat(Math.floor(1e3+9e3*Math.random()));$((e=>wg(wg({},e),{},{additionalFields:wg(wg({},e.additionalFields),{},{customerId:g})})))}else $((g=>wg(wg({},g),{},{additionalFields:wg(wg({},g.additionalFields),{},{customerId:""})})))},required:!0})]}),(0,aI.jsxs)("label",{children:["Customer ID:",(0,aI.jsx)("input",{type:"text",name:"customerId",value:(null===(v=_.additionalFields)||void 0===v?void 0:v.customerId)||"",readOnly:!0})]}),(0,aI.jsxs)("label",{children:["Company (Optional):",(0,aI.jsx)("input",{type:"text",name:"company",value:(null===(R=_.additionalFields)||void 0===R?void 0:R.company)||"",onChange:og})]}),(0,aI.jsxs)("label",{children:["Phone Number:",(0,aI.jsx)("input",{type:"text",name:"phoneNumber",value:(null===(X=_.additionalFields)||void 0===X?void 0:X.phoneNumber)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["Address:",(0,aI.jsx)("input",{type:"text",name:"address",value:(null===(k=_.additionalFields)||void 0===k?void 0:k.address)||"",onChange:og})]})]}),"warehouse"===_.type&&(0,aI.jsxs)("div",{children:[(0,aI.jsxs)("label",{children:["Warehouse Name:",(0,aI.jsx)("input",{type:"text",name:"warehouseName",value:(null===(J=_.additionalFields)||void 0===J?void 0:J.warehouseName)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["Warehouse ID (Auto-generated):",(0,aI.jsx)("input",{type:"text",name:"warehouseId",value:(null===(Y=_.additionalFields)||void 0===Y?void 0:Y.warehouseId)||"WH".concat(Math.floor(1e3+9e3*Math.random())),readOnly:!0})]}),(0,aI.jsxs)("label",{children:["Location:",(0,aI.jsx)("input",{type:"text",name:"location",value:(null===(w=_.additionalFields)||void 0===w?void 0:w.location)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["Manager Name:",(0,aI.jsx)("input",{type:"text",name:"manager",value:(null===(N=_.additionalFields)||void 0===N?void 0:N.manager)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["Manager Phone Number:",(0,aI.jsx)("input",{type:"text",name:"managerPhone",value:(null===(H=_.additionalFields)||void 0===H?void 0:H.managerPhone)||"",onChange:og,required:!0})]})]}),"supplier"===_.type&&(0,aI.jsxs)("div",{children:[(0,aI.jsxs)("label",{children:["Supplier Name:",(0,aI.jsx)("input",{type:"text",name:"supplierName",value:(null===(F=_.additionalFields)||void 0===F?void 0:F.supplierName)||"",onChange:g=>{og(g);const e=g.target.value||"";if(e){const g="SUP".concat(e.replace(/\s+/g,"").toUpperCase().slice(0,6)).concat(Math.floor(1e3+9e3*Math.random()));$((e=>wg(wg({},e),{},{additionalFields:wg(wg({},e.additionalFields),{},{supplierId:g})})))}else $((g=>wg(wg({},g),{},{additionalFields:wg(wg({},g.additionalFields),{},{supplierId:""})})))},required:!0})]}),(0,aI.jsxs)("label",{children:["Supplier ID:",(0,aI.jsx)("input",{type:"text",name:"supplierId",value:(null===(K=_.additionalFields)||void 0===K?void 0:K.supplierId)||"",readOnly:!0})]}),(0,aI.jsxs)("label",{children:["Contact Phone Number:",(0,aI.jsx)("input",{type:"text",name:"contactPhone",value:(null===(x=_.additionalFields)||void 0===x?void 0:x.contactPhone)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["Country:",(0,aI.jsx)("input",{type:"text",name:"country",value:(null===(L=_.additionalFields)||void 0===L?void 0:L.country)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["State:",(0,aI.jsx)("input",{type:"text",name:"state",value:(null===(z=_.additionalFields)||void 0===z?void 0:z.state)||"",onChange:og,required:!0})]})]}),"distributor"===_.type&&(0,aI.jsxs)("div",{children:[(0,aI.jsxs)("label",{children:["Distributor Name:",(0,aI.jsx)("input",{type:"text",name:"distributorName",value:(null===(E=_.additionalFields)||void 0===E?void 0:E.distributorName)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["Distributor ID (Auto-generated):",(0,aI.jsx)("input",{type:"text",name:"distributorId",value:(null===(M=_.additionalFields)||void 0===M?void 0:M.distributorId)||"DIST".concat(Math.floor(1e3+9e3*Math.random())),readOnly:!0})]}),(0,aI.jsxs)("label",{children:["Phone Number:",(0,aI.jsx)("input",{type:"text",name:"phoneNumber",value:(null===(U=_.additionalFields)||void 0===U?void 0:U.phoneNumber)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["Coverage (Region):",(0,aI.jsx)("input",{type:"text",name:"region",value:(null===(j=_.additionalFields)||void 0===j?void 0:j.region)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["Address:",(0,aI.jsx)("input",{type:"text",name:"address",value:(null===(Q=_.additionalFields)||void 0===Q?void 0:Q.address)||"",onChange:og})]})]}),"marketer"===_.type&&(0,aI.jsxs)("div",{children:[(0,aI.jsxs)("label",{children:["Marketer Name:",(0,aI.jsx)("input",{type:"text",name:"marketerName",value:(null===(D=_.additionalFields)||void 0===D?void 0:D.marketerName)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["Marketer ID (Auto-generated):",(0,aI.jsx)("input",{type:"text",name:"marketerId",value:(null===(T=_.additionalFields)||void 0===T?void 0:T.marketerId)||"MARK".concat(Math.floor(1e3+9e3*Math.random())),readOnly:!0})]}),(0,aI.jsxs)("label",{children:["Coverage (Region):",(0,aI.jsx)("input",{type:"text",name:"region",value:(null===(P=_.additionalFields)||void 0===P?void 0:P.region)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["Phone Number:",(0,aI.jsx)("input",{type:"text",name:"phoneNumber",value:(null===(O=_.additionalFields)||void 0===O?void 0:O.phoneNumber)||"",onChange:og,required:!0})]}),(0,aI.jsxs)("label",{children:["Email Address:",(0,aI.jsx)("input",{type:"email",name:"email",value:(null===(q=_.additionalFields)||void 0===q?void 0:q.email)||"",onChange:og})]})]}),(0,aI.jsx)("button",{type:"submit",disabled:lg,children:lg?"Registering...":"Register"})]}),gg&&(0,aI.jsx)("div",{className:gg.includes("success")?"success":"error",style:{marginTop:"1rem"},children:gg}),ng&&(0,aI.jsxs)("div",{className:"qr-code",children:[(0,aI.jsx)("h3",{children:"QR Code:"}),(0,aI.jsx)(XI,{value:ng})]})]})},_I=()=>{const[g,e]=(0,I.useState)([]),[t,n]=(0,I.useState)([]);return(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat(lI,"/products")),t=await g.json();Array.isArray(t)?e(t):(console.error("API did not return an array:",t),e([]))}catch(g){console.error("Error fetching products:",g),e([])}})(),(async()=>{try{const g=await fetch("".concat(lI,"/inventory/raw-materials")),e=await g.json();Array.isArray(e)?n(e):(console.error("API did not return an array:",e),n([]))}catch(g){console.error("Error fetching raw materials:",g),n([])}})()}),[]),(0,aI.jsxs)("div",{className:"inventory-container",children:[(0,aI.jsx)("h1",{children:"Inventory"}),(0,aI.jsxs)("div",{className:"inventory-section",children:[(0,aI.jsx)("h2",{children:"Products"}),(0,aI.jsx)("ul",{children:g.map((g=>(0,aI.jsxs)("li",{children:[g.name," - ",g.unit_price]},g.id)))})]}),(0,aI.jsxs)("div",{className:"inventory-section",children:[(0,aI.jsx)("h2",{children:"Raw Materials"}),(0,aI.jsx)("ul",{children:t.map((g=>(0,aI.jsxs)("li",{children:[g.name," - ",g.unit_cost]},g.id)))})]})]})},$I=()=>{const[g,e]=(0,I.useState)({employeeId:"",salary:"",bonus:"",deductions:""}),[t,n]=(0,I.useState)(""),[C,l]=(0,I.useState)(!1),a=eg(),o=t=>{const{name:I,value:n}=t.target;e(wg(wg({},g),{},{[I]:n}))};return(0,aI.jsxs)("div",{className:"payroll-container",children:[(0,aI.jsx)("h1",{children:"Payroll"}),(0,aI.jsxs)("div",{className:"payroll-buttons",children:[(0,aI.jsx)("button",{onClick:()=>a("/salary-console"),className:"payroll-button",children:"Salary Console"}),(0,aI.jsx)("button",{onClick:()=>a("/salary-report"),className:"payroll-button",children:"Salary Report"})]}),(0,aI.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),l(!0),n("");try{const t=await fetch("".concat(lI,"/payroll"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)});let C;try{C=await t.json()}catch(I){C={}}if(t.ok)n("Payroll recorded successfully!"),e({employeeId:"",salary:"",bonus:"",deductions:""});else{let g="Failed to record payroll.";C.detail&&("string"===typeof C.detail?g=C.detail:Array.isArray(C.detail)?g=C.detail.map((g=>g.msg||JSON.stringify(g))).join("; "):"object"===typeof C.detail&&(g=JSON.stringify(C.detail))),n(g)}}catch(C){n("An error occurred. Please try again.")}finally{l(!1)}},className:"payroll-form",children:[(0,aI.jsxs)("label",{children:["Employee ID:",(0,aI.jsx)("input",{type:"text",name:"employeeId",value:g.employeeId,onChange:o,required:!0})]}),(0,aI.jsxs)("label",{children:["Salary:",(0,aI.jsx)("input",{type:"number",name:"salary",value:g.salary,onChange:o,required:!0})]}),(0,aI.jsxs)("label",{children:["Bonus:",(0,aI.jsx)("input",{type:"number",name:"bonus",value:g.bonus,onChange:o})]}),(0,aI.jsxs)("label",{children:["Deductions:",(0,aI.jsx)("input",{type:"number",name:"deductions",value:g.deductions,onChange:o})]}),(0,aI.jsx)("button",{type:"submit",disabled:C,children:C?"Submitting...":"Submit"})]}),t&&(0,aI.jsx)("div",{className:t.includes("success")?"success":"error",style:{marginTop:"1rem"},children:t})]})},gn=()=>{const[g,e]=(0,I.useState)(""),t=eg();return(0,aI.jsxs)("div",{className:"attendance-container",children:[(0,aI.jsx)("h1",{children:"Attendance"}),(0,aI.jsx)("form",{className:"attendance-form"}),g&&(0,aI.jsx)("p",{className:"message",children:g}),(0,aI.jsxs)("div",{className:"attendance-buttons",children:[(0,aI.jsx)("button",{onClick:()=>t("/timed-attendance"),children:"Timed Attendance"}),(0,aI.jsx)("button",{onClick:()=>t("/attendance-record"),children:"Attendance Record"}),(0,aI.jsx)("button",{onClick:()=>t("/attendance-analysis"),children:"Attendance Analysis"})]})]})},en=()=>{const[g,e]=(0,I.useState)({name:"",type:"machine",supplierId:"",cost:0,usefulLife:0,responsibleStaff:""}),[t,n]=(0,I.useState)(""),[C,l]=(0,I.useState)([]);(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat(lI,"/suppliers")),e=await g.json();Array.isArray(e)?l(e):(console.error("Unexpected response format:",e),l([]))}catch(g){console.error("Error fetching suppliers:",g),l([])}})()}),[]);const a=t=>{const{name:I,value:n}=t.target;e(wg(wg({},g),{},{[I]:n}))};return(0,aI.jsxs)("div",{className:"factory-inventory-container",children:[(0,aI.jsx)("h1",{children:"Factory Inventory"}),(0,aI.jsxs)("div",{className:"inventory-buttons",children:[(0,aI.jsx)(Vg,{to:"/factory-inventory/device-intake",className:"awesome-button",children:"Device Intake"}),(0,aI.jsx)(Vg,{to:"/factory-inventory/device-list",className:"awesome-button",children:"Device List"}),(0,aI.jsx)(Vg,{to:"/factory-inventory/device-maintenance-log",className:"awesome-button",children:"Device Maintenance Log"}),(0,aI.jsx)(Vg,{to:"/factory-inventory/device-fault-reporting",className:"awesome-button",children:"Device Fault Reporting"})]}),(0,aI.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=await fetch("".concat(lI,"/factory-inventory"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)}),t=await e.json();n(t.message||"Factory inventory recorded successfully!")}catch(t){n("An error occurred. Please try again.")}},className:"factory-inventory-form",children:[(0,aI.jsxs)("label",{children:["Name:",(0,aI.jsx)("input",{type:"text",name:"name",value:g.name,onChange:a,required:!0})]}),(0,aI.jsxs)("label",{children:["Type:",(0,aI.jsxs)("select",{name:"type",value:g.type,onChange:a,children:[(0,aI.jsx)("option",{value:"machine",children:"Machine"}),(0,aI.jsx)("option",{value:"tool",children:"Tool"})]})]}),(0,aI.jsxs)("label",{children:["Supplier:",(0,aI.jsx)("select",{name:"supplierId",value:g.supplierId,onChange:a,children:C.map((g=>(0,aI.jsx)("option",{value:g.id,children:g.name},g.id)))})]}),(0,aI.jsxs)("label",{children:["Cost:",(0,aI.jsx)("input",{type:"number",name:"cost",value:g.cost,onChange:a,required:!0})]}),(0,aI.jsxs)("label",{children:["Useful Life (years):",(0,aI.jsx)("input",{type:"number",name:"usefulLife",value:g.usefulLife,onChange:a,required:!0})]}),(0,aI.jsxs)("label",{children:["Responsible Staff:",(0,aI.jsx)("input",{type:"text",name:"responsibleStaff",value:g.responsibleStaff,onChange:a,required:!0})]}),(0,aI.jsx)("button",{type:"submit",children:"Submit Factory Inventory"})]}),t&&(0,aI.jsx)("p",{className:"message",children:t})]})},tn=()=>{const[g,e]=(0,I.useState)(""),[t,n]=(0,I.useState)(""),[C,l]=(0,I.useState)(""),[a,o]=(0,I.useState)(""),i=(0,I.useRef)(null),[r,c]=(0,I.useState)(!1),[s,A]=(0,I.useState)({}),[d,u]=(0,I.useState)(!0),m=eg(),h={admin:"Admin",sales:"Sales",manager:"Manager",production_manager:"Production_Manager",marketing:"Marketing"},b=g=>{const{name:e,value:t}=g.target;A(wg(wg({},s),{},{[e]:t}))},Z=function(g){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";i.current&&(i.current.textContent=g,i.current.className="success"===e?"success":"error",i.current.style.display="block",setTimeout((()=>{i.current&&(i.current.style.display="none")}),3e3))};return(0,aI.jsx)("div",{style:{backgroundImage:"url('/pharmacy-dispensary.jpg')",backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center",height:"100vh"},className:"login-page",children:(0,aI.jsxs)("div",{className:"login-container",children:[(0,aI.jsx)("h1",{children:"Welcome to AstroBSM-Oracle"}),(0,aI.jsx)("div",{ref:i,style:{display:"none",marginBottom:"16px",padding:"10px",borderRadius:"4px",fontWeight:"bold"}}),r&&(0,aI.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,aI.jsx)("button",{type:"button",className:d?"":"active",onClick:()=>u(!0),children:"I have login credentials"}),(0,aI.jsx)("button",{type:"button",className:d?"":"active",onClick:()=>u(!1),style:{marginLeft:"10px"},children:"I am a new user (Create Profile)"})]}),(0,aI.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),o(""),!r||d)try{const e=await fetch("".concat(lI,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:g,password:t,role:h[C]||C})});if(e.ok){const g=await e.json();localStorage.setItem("token",g.access_token),"admin"===C?m("/dashboard"):"sales"===C?m("/sales-dashboard"):"manager"===C?m("/manager-dashboard"):"production_manager"===C?m("/production-dashboard"):"marketing"===C&&m("/marketing-dashboard")}else{const g=await e.json();o(g.detail||"Login failed."),Z(g.detail||"Login failed.","error")}}catch(jn){o("An error occurred. Please try again later."),Z("An error occurred. Please try again later.","error")}else try{if(!(await fetch("".concat(lI,"/auth/create-profile"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_name:s.fullName,email:s.email,phone:s.phone,role:h[C]||C})})).ok)throw new Error("Error creating profile. Please try again.");Z("Profile created successfully. Please wait for admin approval.","success")}catch(jn){Z("Error creating profile. Please try again.","error")}},children:[(!r||d)&&(0,aI.jsxs)(aI.Fragment,{children:[(0,aI.jsx)("input",{type:"text",placeholder:"Username",className:"login-input",value:g,onChange:g=>e(g.target.value)}),(0,aI.jsx)("input",{type:"password",placeholder:"Password",className:"login-input",value:t,onChange:g=>n(g.target.value)})]}),(0,aI.jsxs)("select",{className:"login-select",value:C,onChange:g=>{const e=g.target.value;l(e),c("admin"!==e&&""!==e),u(!0)},children:[(0,aI.jsx)("option",{value:"",children:"Select Role"}),(0,aI.jsx)("option",{value:"admin",children:"Admin"}),(0,aI.jsx)("option",{value:"sales",children:"Sales"}),(0,aI.jsx)("option",{value:"manager",children:"Manager"}),(0,aI.jsx)("option",{value:"production_manager",children:"Production Manager"}),(0,aI.jsx)("option",{value:"marketing",children:"Marketing"})]}),r&&!d&&(0,aI.jsxs)("div",{className:"profile-creation",children:[(0,aI.jsx)("h3",{children:"Create Profile"}),(0,aI.jsx)("input",{type:"text",name:"fullName",placeholder:"Full Name",className:"login-input",value:s.fullName||"",onChange:b,required:!0}),(0,aI.jsx)("input",{type:"email",name:"email",placeholder:"Email",className:"login-input",value:s.email||"",onChange:b,required:!0}),(0,aI.jsx)("input",{type:"text",name:"phone",placeholder:"Phone Number",className:"login-input",value:s.phone||"",onChange:b,required:!0})]}),a&&(0,aI.jsx)("p",{className:"error-message",children:a}),(0,aI.jsx)("button",{type:"submit",className:"login-button",children:r&&!d?"Create Profile":"Login"})]})]})})},In=()=>{const[g,e]=(0,I.useState)([]),[t,n]=(0,I.useState)([]),[C,l]=(0,I.useState)({productId:"",quantity:"",intakeDate:"",expiryDate:"",staffId:""}),[a,o]=(0,I.useState)(""),[i,r]=(0,I.useState)(!1);(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("http://localhost:8000/api/v1/products"),t=await g.json();e(t)}catch(g){console.error("Error fetching products:",g)}})(),(async()=>{try{const g=await fetch("http://localhost:8000/api/v1/staff"),e=await g.json();n(e)}catch(g){console.error("Error fetching staff:",g)}})()}),[]);const c=g=>{const{name:e,value:t}=g.target;l(wg(wg({},C),{},{[e]:t}))};return(0,aI.jsxs)("div",{className:"stock-intake-container",children:[(0,aI.jsx)("h1",{children:"Product Stock Intake"}),(0,aI.jsxs)("form",{onSubmit:async g=>{g.preventDefault(),r(!0),o("");try{const g=await fetch("http://localhost:8000/api/v1/stock-intake",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)});let t;try{t=await g.json()}catch(e){t={}}if(g.ok)o("Stock intake recorded successfully!"),l({productId:"",quantity:"",intakeDate:"",expiryDate:"",staffId:""});else{let g="Failed to record stock intake.";t.detail&&("string"===typeof t.detail?g=t.detail:Array.isArray(t.detail)?g=t.detail.map((g=>g.msg||JSON.stringify(g))).join("; "):"object"===typeof t.detail&&(g=JSON.stringify(t.detail))),o(g)}}catch(t){o("An error occurred. Please try again.")}finally{r(!1)}},className:"stock-intake-form",children:[(0,aI.jsxs)("label",{children:["Select Product:",(0,aI.jsxs)("select",{name:"productId",value:C.productId,onChange:c,required:!0,children:[(0,aI.jsx)("option",{value:"",children:"--Select Product--"}),g.map((g=>(0,aI.jsx)("option",{value:g.id,children:g.name},g.id)))]})]}),(0,aI.jsxs)("label",{children:["Quantity:",(0,aI.jsx)("input",{type:"number",name:"quantity",value:C.quantity,onChange:c,required:!0})]}),(0,aI.jsxs)("label",{children:["Date of Intake:",(0,aI.jsx)("input",{type:"date",name:"intakeDate",value:C.intakeDate,onChange:c,required:!0})]}),(0,aI.jsxs)("label",{children:["Expiry Date:",(0,aI.jsx)("input",{type:"date",name:"expiryDate",value:C.expiryDate,onChange:c,required:!0})]}),(0,aI.jsxs)("label",{children:["Intake Staff:",(0,aI.jsxs)("select",{name:"staffId",value:C.staffId,onChange:c,required:!0,children:[(0,aI.jsx)("option",{value:"",children:"--Select Staff--"}),t.map((g=>(0,aI.jsx)("option",{value:g.id,children:g.name},g.id)))]})]}),(0,aI.jsx)("button",{type:"submit",disabled:i,children:i?"Submitting...":"Submit"})]}),a&&(0,aI.jsx)("div",{className:a.includes("success")?"success":"error",style:{marginTop:"1rem"},children:a})]})},nn=()=>(0,aI.jsxs)("div",{className:"stock-level-container",children:[(0,aI.jsx)("h1",{children:"Stock Level"}),(0,aI.jsx)("p",{children:"Dynamic table for stock levels will be implemented here."})]}),Cn=()=>(0,aI.jsxs)("div",{className:"grant-access-container",children:[(0,aI.jsx)("h1",{children:"Grant Access Privileges"}),(0,aI.jsx)("p",{children:"Form for granting access privileges will be implemented here."})]});var ln=t(9309),an=t.n(ln);const on=()=>{const[g,e]=(0,I.useState)("time-in"),[t,n]=(0,I.useState)(""),[C,l]=(0,I.useState)(""),[a,o]=(0,I.useState)(!1),[i,r]=(0,I.useState)(""),[c,s]=(0,I.useState)([]);(0,I.useEffect)((()=>{fetch("http://localhost:8000/api/v1/staff").then((g=>g.json())).then((g=>s(g))).catch((g=>console.error("Failed to fetch staff:",g)))}),[]);return(0,aI.jsxs)("div",{className:"timed-attendance-container",children:[(0,aI.jsx)("h1",{children:"Timed Attendance"}),(0,aI.jsxs)("label",{children:["Select Staff:",(0,aI.jsxs)("select",{value:C,onChange:g=>{l(g.target.value)},children:[(0,aI.jsx)("option",{value:"",children:"-- Select Staff --"}),c.map((g=>(0,aI.jsxs)("option",{value:g.id,children:[g.name," (",g.staff_id,")"]},g.id)))]})]}),(0,aI.jsxs)("label",{children:["Select Action:",(0,aI.jsxs)("select",{value:g,onChange:g=>e(g.target.value),children:[(0,aI.jsx)("option",{value:"time-in",children:"Time-In"}),(0,aI.jsx)("option",{value:"time-out",children:"Time-Out"})]})]}),(0,aI.jsxs)("div",{className:"attendance-buttons",children:[(0,aI.jsx)("button",{onClick:()=>{o(!0)},children:"Scan QR Code"}),(0,aI.jsx)("button",{onClick:()=>{n("Facial scan completed successfully for ".concat(g,"."))},children:"Facial Scan"})]}),a&&(0,aI.jsx)(an(),{delay:300,onError:g=>{console.error(g),n("Error scanning QR code.")},onScan:e=>{e&&(r(e),o(!1),n("expected_qr_code"===e?"QR code matched successfully for ".concat(g,"."):"QR code does not match any records."))},style:{width:"100%"}}),t&&(0,aI.jsx)("p",{className:"message",children:t})]})},rn=()=>(0,aI.jsxs)("div",{className:"attendance-record-container",children:[(0,aI.jsx)("h1",{children:"Attendance Record"}),(0,aI.jsx)("p",{children:"Real-time updated attendance records will be displayed here, including hours worked per day for each staff member."})]}),cn=()=>(0,aI.jsxs)("div",{className:"attendance-analysis-container",children:[(0,aI.jsx)("h1",{children:"Attendance Analysis"}),(0,aI.jsxs)("table",{className:"awesome-table",children:[(0,aI.jsx)("thead",{children:(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("th",{children:"Date"}),(0,aI.jsx)("th",{children:"Punctuality"}),(0,aI.jsx)("th",{children:"Days Missed"}),(0,aI.jsx)("th",{children:"Extra Time Worked"})]})}),(0,aI.jsx)("tbody",{})]})]}),sn="https://astrobsm-oracle-backend.onrender.com/api/v1",An=()=>{const[g,e]=(0,I.useState)([]),[t,n]=(0,I.useState)([]),[C,l]=(0,I.useState)([]),[a,o]=(0,I.useState)({productId:"",quantity:"",intakeDate:"",expiryDate:"",staffId:"",warehouseId:""}),[i,r]=(0,I.useState)(""),[c,s]=(0,I.useState)(!1);(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat(sn,"/products")),t=await g.json();Array.isArray(t)?e(t):(console.error("API did not return an array:",t),e([]))}catch(g){console.error("Error fetching products:",g),e([])}})(),(async()=>{try{const g=await fetch("".concat(sn,"/staff")),e=await g.json();Array.isArray(e)?n(e):(console.error("API did not return an array:",e),n([]))}catch(g){console.error("Error fetching staff:",g),n([])}})(),(async()=>{try{const g=await fetch("".concat(sn,"/warehouses")),e=await g.json();Array.isArray(e)?l(e):l([])}catch(g){l([])}})()}),[]);const A=g=>{const{name:e,value:t}=g.target;o(wg(wg({},a),{},{[e]:t}))};return(0,aI.jsxs)("div",{className:"product-stock-intake-container",children:[(0,aI.jsx)("h1",{children:"Product Stock Intake"}),(0,aI.jsxs)("form",{onSubmit:async g=>{g.preventDefault(),s(!0),r("");try{const g=await fetch("".concat(sn,"/product-stock-intake"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});let t;try{t=await g.json()}catch(e){t={}}if(g.ok)r("string"===typeof t.message?t.message:"Product stock intake recorded successfully!"),o({productId:"",quantity:"",intakeDate:"",expiryDate:"",staffId:"",warehouseId:""}),window.dispatchEvent(new Event("stockLevelUpdated"));else{let g="Failed to record product stock intake.";t.detail&&("string"===typeof t.detail?g=t.detail:Array.isArray(t.detail)?g=t.detail.map((g=>g.msg||JSON.stringify(g))).join("; "):"object"===typeof t.detail&&(g=JSON.stringify(t.detail))),r(g)}}catch(t){r("An error occurred. Please try again.")}finally{s(!1)}},className:"product-stock-intake-form",children:[(0,aI.jsxs)("label",{children:["Select Product:",(0,aI.jsxs)("select",{name:"productId",value:a.productId,onChange:A,required:!0,children:[(0,aI.jsx)("option",{value:"",children:"--Select Product--"}),g.map((g=>(0,aI.jsx)("option",{value:g.id,children:g.name},g.id)))]})]}),(0,aI.jsxs)("label",{children:["Quantity:",(0,aI.jsx)("input",{type:"number",name:"quantity",value:a.quantity,onChange:A,required:!0})]}),(0,aI.jsxs)("label",{children:["Date of Intake:",(0,aI.jsx)("input",{type:"date",name:"intakeDate",value:a.intakeDate,onChange:A,required:!0})]}),(0,aI.jsxs)("label",{children:["Expiry Date:",(0,aI.jsx)("input",{type:"date",name:"expiryDate",value:a.expiryDate,onChange:A,required:!0})]}),(0,aI.jsxs)("label",{children:["Intake Staff:",(0,aI.jsxs)("select",{name:"staffId",value:a.staffId,onChange:A,required:!0,children:[(0,aI.jsx)("option",{value:"",children:"--Select Staff--"}),t.map((g=>(0,aI.jsx)("option",{value:g.id,children:g.name},g.id)))]})]}),(0,aI.jsxs)("label",{children:["Warehouse:",(0,aI.jsxs)("select",{name:"warehouseId",value:a.warehouseId||"",onChange:A,required:!0,children:[(0,aI.jsx)("option",{value:"",children:"--Select Warehouse--"}),C.map((g=>(0,aI.jsxs)("option",{value:g.id,children:[g.name," (",g.location,")"]},g.id)))]})]}),(0,aI.jsx)("button",{type:"submit",disabled:c,children:c?"Submitting...":"Submit"})]}),i&&(0,aI.jsx)("div",{className:i.includes("success")?"success":"error",style:{marginTop:"1rem"},children:i})]})},dn=()=>{const[g,e]=(0,I.useState)([]),[t,n]=(0,I.useState)(!0),[C,l]=(0,I.useState)(null),a=(0,I.useRef)(),o=async()=>{try{const g=await CI.get("".concat("https://astrobsm-oracle-backend.onrender.com/api/v1","/inventory/stock-level"));e(g.data),l(null)}catch(jn){l("Could not fetch stock levels.")}finally{n(!1)}};(0,I.useEffect)((()=>{o(),a.current=setInterval(o,1e4);const g=()=>o();return window.addEventListener("stockLevelUpdated",g),()=>{clearInterval(a.current),window.removeEventListener("stockLevelUpdated",g)}}),[]);return t?(0,aI.jsx)("div",{children:"Loading..."}):C?(0,aI.jsx)("div",{className:"error",children:C}):(0,aI.jsxs)("div",{className:"product-stock-level-container",children:[(0,aI.jsx)("h1",{children:"Product Stock Levels"}),(0,aI.jsx)("button",{className:"refresh-btn",onClick:()=>{n(!0),o()},children:"Refresh Now"}),(0,aI.jsxs)("table",{className:"stock-table",children:[(0,aI.jsx)("thead",{children:(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("th",{children:"Product"}),(0,aI.jsx)("th",{children:"Warehouse"}),(0,aI.jsx)("th",{children:"Available Quantity"}),(0,aI.jsx)("th",{children:"Reorder Point"})]})}),(0,aI.jsx)("tbody",{children:g.map((g=>(0,aI.jsxs)("tr",{className:g.available_quantity<=g.reorder_point?"low-stock":"",children:[(0,aI.jsx)("td",{children:g.productName||g.name}),(0,aI.jsx)("td",{children:g.warehouse_name||g.warehouseName||g.warehouseId||"-"}),(0,aI.jsx)("td",{children:g.available_quantity}),(0,aI.jsx)("td",{children:g.reorder_point})]},g.id+"-"+(g.warehouse_name||g.warehouseId||""))))})]})]})};var un=t(7545),mn=Uint8Array,hn=Uint16Array,bn=Int32Array,Zn=new mn([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),pn=new mn([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Gn=new mn([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),yn=function(g,e){for(var t=new hn(31),I=0;I<31;++I)t[I]=e+=1<<g[I-1];var n=new bn(t[30]);for(I=1;I<30;++I)for(var C=t[I];C<t[I+1];++C)n[C]=C-t[I]<<5|I;return{b:t,r:n}},Bn=yn(Zn,2),Sn=Bn.b,fn=Bn.r;Sn[28]=258,fn[258]=28;for(var Wn=yn(pn,0),Vn=Wn.b,vn=Wn.r,Rn=new hn(32768),Xn=0;Xn<32768;++Xn){var kn=(43690&Xn)>>1|(21845&Xn)<<1;kn=(61680&(kn=(52428&kn)>>2|(13107&kn)<<2))>>4|(3855&kn)<<4,Rn[Xn]=((65280&kn)>>8|(255&kn)<<8)>>1}var Jn=function(g,e,t){for(var I=g.length,n=0,C=new hn(e);n<I;++n)g[n]&&++C[g[n]-1];var l,a=new hn(e);for(n=1;n<e;++n)a[n]=a[n-1]+C[n-1]<<1;if(t){l=new hn(1<<e);var o=15-e;for(n=0;n<I;++n)if(g[n])for(var i=n<<4|g[n],r=e-g[n],c=a[g[n]-1]++<<r,s=c|(1<<r)-1;c<=s;++c)l[Rn[c]>>o]=i}else for(l=new hn(I),n=0;n<I;++n)g[n]&&(l[n]=Rn[a[g[n]-1]++]>>15-g[n]);return l},Yn=new mn(288);for(Xn=0;Xn<144;++Xn)Yn[Xn]=8;for(Xn=144;Xn<256;++Xn)Yn[Xn]=9;for(Xn=256;Xn<280;++Xn)Yn[Xn]=7;for(Xn=280;Xn<288;++Xn)Yn[Xn]=8;var wn=new mn(32);for(Xn=0;Xn<32;++Xn)wn[Xn]=5;var Nn=Jn(Yn,9,0),Hn=Jn(Yn,9,1),Fn=Jn(wn,5,0),Kn=Jn(wn,5,1),xn=function(g){for(var e=g[0],t=1;t<g.length;++t)g[t]>e&&(e=g[t]);return e},Ln=function(g,e,t){var I=e/8|0;return(g[I]|g[I+1]<<8)>>(7&e)&t},zn=function(g,e){var t=e/8|0;return(g[t]|g[t+1]<<8|g[t+2]<<16)>>(7&e)},En=function(g){return(g+7)/8|0},Mn=function(g,e,t){return(null==e||e<0)&&(e=0),(null==t||t>g.length)&&(t=g.length),new mn(g.subarray(e,t))},Un=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],jn=function(g,e,t){var I=new Error(e||Un[g]);if(I.code=g,Error.captureStackTrace&&Error.captureStackTrace(I,jn),!t)throw I;return I},Qn=function(g,e,t,I){var n=g.length,C=I?I.length:0;if(!n||e.f&&!e.l)return t||new mn(0);var l=!t,a=l||2!=e.i,o=e.i;l&&(t=new mn(3*n));var i=function(g){var e=t.length;if(g>e){var I=new mn(Math.max(2*e,g));I.set(t),t=I}},r=e.f||0,c=e.p||0,s=e.b||0,A=e.l,d=e.d,u=e.m,m=e.n,h=8*n;do{if(!A){r=Ln(g,c,1);var b=Ln(g,c+1,3);if(c+=3,!b){var Z=g[(X=En(c)+4)-4]|g[X-3]<<8,p=X+Z;if(p>n){o&&jn(0);break}a&&i(s+Z),t.set(g.subarray(X,p),s),e.b=s+=Z,e.p=c=8*p,e.f=r;continue}if(1==b)A=Hn,d=Kn,u=9,m=5;else if(2==b){var G=Ln(g,c,31)+257,y=Ln(g,c+10,15)+4,B=G+Ln(g,c+5,31)+1;c+=14;for(var S=new mn(B),f=new mn(19),W=0;W<y;++W)f[Gn[W]]=Ln(g,c+3*W,7);c+=3*y;var V=xn(f),v=(1<<V)-1,R=Jn(f,V,1);for(W=0;W<B;){var X,k=R[Ln(g,c,v)];if(c+=15&k,(X=k>>4)<16)S[W++]=X;else{var J=0,Y=0;for(16==X?(Y=3+Ln(g,c,3),c+=2,J=S[W-1]):17==X?(Y=3+Ln(g,c,7),c+=3):18==X&&(Y=11+Ln(g,c,127),c+=7);Y--;)S[W++]=J}}var w=S.subarray(0,G),N=S.subarray(G);u=xn(w),m=xn(N),A=Jn(w,u,1),d=Jn(N,m,1)}else jn(1);if(c>h){o&&jn(0);break}}a&&i(s+131072);for(var H=(1<<u)-1,F=(1<<m)-1,K=c;;K=c){var x=(J=A[zn(g,c)&H])>>4;if((c+=15&J)>h){o&&jn(0);break}if(J||jn(2),x<256)t[s++]=x;else{if(256==x){K=c,A=null;break}var L=x-254;if(x>264){var z=Zn[W=x-257];L=Ln(g,c,(1<<z)-1)+Sn[W],c+=z}var E=d[zn(g,c)&F],M=E>>4;E||jn(3),c+=15&E;N=Vn[M];if(M>3){z=pn[M];N+=zn(g,c)&(1<<z)-1,c+=z}if(c>h){o&&jn(0);break}a&&i(s+131072);var U=s+L;if(s<N){var j=C-N,Q=Math.min(N,U);for(j+s<0&&jn(3);s<Q;++s)t[s]=I[j+s]}for(;s<U;++s)t[s]=t[s-N]}}e.l=A,e.p=K,e.b=s,e.f=r,A&&(r=1,e.m=u,e.d=d,e.n=m)}while(!r);return s!=t.length&&l?Mn(t,0,s):t.subarray(0,s)},Dn=function(g,e,t){t<<=7&e;var I=e/8|0;g[I]|=t,g[I+1]|=t>>8},Tn=function(g,e,t){t<<=7&e;var I=e/8|0;g[I]|=t,g[I+1]|=t>>8,g[I+2]|=t>>16},Pn=function(g,e){for(var t=[],I=0;I<g.length;++I)g[I]&&t.push({s:I,f:g[I]});var n=t.length,C=t.slice();if(!n)return{t:tC,l:0};if(1==n){var l=new mn(t[0].s+1);return l[t[0].s]=1,{t:l,l:1}}t.sort((function(g,e){return g.f-e.f})),t.push({s:-1,f:25001});var a=t[0],o=t[1],i=0,r=1,c=2;for(t[0]={s:-1,f:a.f+o.f,l:a,r:o};r!=n-1;)a=t[t[i].f<t[c].f?i++:c++],o=t[i!=r&&t[i].f<t[c].f?i++:c++],t[r++]={s:-1,f:a.f+o.f,l:a,r:o};var s=C[0].s;for(I=1;I<n;++I)C[I].s>s&&(s=C[I].s);var A=new hn(s+1),d=On(t[r-1],A,0);if(d>e){I=0;var u=0,m=d-e,h=1<<m;for(C.sort((function(g,e){return A[e.s]-A[g.s]||g.f-e.f}));I<n;++I){var b=C[I].s;if(!(A[b]>e))break;u+=h-(1<<d-A[b]),A[b]=e}for(u>>=m;u>0;){var Z=C[I].s;A[Z]<e?u-=1<<e-A[Z]++-1:++I}for(;I>=0&&u;--I){var p=C[I].s;A[p]==e&&(--A[p],++u)}d=e}return{t:new mn(A),l:d}},On=function(g,e,t){return-1==g.s?Math.max(On(g.l,e,t+1),On(g.r,e,t+1)):e[g.s]=t},qn=function(g){for(var e=g.length;e&&!g[--e];);for(var t=new hn(++e),I=0,n=g[0],C=1,l=function(g){t[I++]=g},a=1;a<=e;++a)if(g[a]==n&&a!=e)++C;else{if(!n&&C>2){for(;C>138;C-=138)l(32754);C>2&&(l(C>10?C-11<<5|28690:C-3<<5|12305),C=0)}else if(C>3){for(l(n),--C;C>6;C-=6)l(8304);C>2&&(l(C-3<<5|8208),C=0)}for(;C--;)l(n);C=1,n=g[a]}return{c:t.subarray(0,I),n:e}},_n=function(g,e){for(var t=0,I=0;I<e.length;++I)t+=g[I]*e[I];return t},$n=function(g,e,t){var I=t.length,n=En(e+2);g[n]=255&I,g[n+1]=I>>8,g[n+2]=255^g[n],g[n+3]=255^g[n+1];for(var C=0;C<I;++C)g[n+C+4]=t[C];return 8*(n+4+I)},gC=function(g,e,t,I,n,C,l,a,o,i,r){Dn(e,r++,t),++n[256];for(var c=Pn(n,15),s=c.t,A=c.l,d=Pn(C,15),u=d.t,m=d.l,h=qn(s),b=h.c,Z=h.n,p=qn(u),G=p.c,y=p.n,B=new hn(19),S=0;S<b.length;++S)++B[31&b[S]];for(S=0;S<G.length;++S)++B[31&G[S]];for(var f=Pn(B,7),W=f.t,V=f.l,v=19;v>4&&!W[Gn[v-1]];--v);var R,X,k,J,Y=i+5<<3,w=_n(n,Yn)+_n(C,wn)+l,N=_n(n,s)+_n(C,u)+l+14+3*v+_n(B,W)+2*B[16]+3*B[17]+7*B[18];if(o>=0&&Y<=w&&Y<=N)return $n(e,r,g.subarray(o,o+i));if(Dn(e,r,1+(N<w)),r+=2,N<w){R=Jn(s,A,0),X=s,k=Jn(u,m,0),J=u;var H=Jn(W,V,0);Dn(e,r,Z-257),Dn(e,r+5,y-1),Dn(e,r+10,v-4),r+=14;for(S=0;S<v;++S)Dn(e,r+3*S,W[Gn[S]]);r+=3*v;for(var F=[b,G],K=0;K<2;++K){var x=F[K];for(S=0;S<x.length;++S){var L=31&x[S];Dn(e,r,H[L]),r+=W[L],L>15&&(Dn(e,r,x[S]>>5&127),r+=x[S]>>12)}}}else R=Nn,X=Yn,k=Fn,J=wn;for(S=0;S<a;++S){var z=I[S];if(z>255){Tn(e,r,R[(L=z>>18&31)+257]),r+=X[L+257],L>7&&(Dn(e,r,z>>23&31),r+=Zn[L]);var E=31&z;Tn(e,r,k[E]),r+=J[E],E>3&&(Tn(e,r,z>>5&8191),r+=pn[E])}else Tn(e,r,R[z]),r+=X[z]}return Tn(e,r,R[256]),r+X[256]},eC=new bn([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),tC=new mn(0),IC=function(g,e,t,I,n,C){var l=C.z||g.length,a=new mn(I+l+5*(1+Math.ceil(l/7e3))+n),o=a.subarray(I,a.length-n),i=C.l,r=7&(C.r||0);if(e){r&&(o[0]=C.r>>3);for(var c=eC[e-1],s=c>>13,A=8191&c,d=(1<<t)-1,u=C.p||new hn(32768),m=C.h||new hn(d+1),h=Math.ceil(t/3),b=2*h,Z=function(e){return(g[e]^g[e+1]<<h^g[e+2]<<b)&d},p=new bn(25e3),G=new hn(288),y=new hn(32),B=0,S=0,f=C.i||0,W=0,V=C.w||0,v=0;f+2<l;++f){var R=Z(f),X=32767&f,k=m[R];if(u[X]=k,m[R]=X,V<=f){var J=l-f;if((B>7e3||W>24576)&&(J>423||!i)){r=gC(g,o,0,p,G,y,S,W,v,f-v,r),W=B=S=0,v=f;for(var Y=0;Y<286;++Y)G[Y]=0;for(Y=0;Y<30;++Y)y[Y]=0}var w=2,N=0,H=A,F=X-k&32767;if(J>2&&R==Z(f-F))for(var K=Math.min(s,J)-1,x=Math.min(32767,f),L=Math.min(258,J);F<=x&&--H&&X!=k;){if(g[f+w]==g[f+w-F]){for(var z=0;z<L&&g[f+z]==g[f+z-F];++z);if(z>w){if(w=z,N=F,z>K)break;var E=Math.min(F,z-2),M=0;for(Y=0;Y<E;++Y){var U=f-F+Y&32767,j=U-u[U]&32767;j>M&&(M=j,k=U)}}}F+=(X=k)-(k=u[X])&32767}if(N){p[W++]=268435456|fn[w]<<18|vn[N];var Q=31&fn[w],D=31&vn[N];S+=Zn[Q]+pn[D],++G[257+Q],++y[D],V=f+w,++B}else p[W++]=g[f],++G[g[f]]}}for(f=Math.max(f,V);f<l;++f)p[W++]=g[f],++G[g[f]];r=gC(g,o,i,p,G,y,S,W,v,f-v,r),i||(C.r=7&r|o[r/8|0]<<3,r-=7,C.h=m,C.p=u,C.i=f,C.w=V)}else{for(f=C.w||0;f<l+i;f+=65535){var T=f+65535;T>=l&&(o[r/8|0]=i,T=l),r=$n(o,r+1,g.subarray(f,T))}C.i=l}return Mn(a,0,I+En(r)+n)},nC=function(){var g=1,e=0;return{p:function(t){for(var I=g,n=e,C=0|t.length,l=0;l!=C;){for(var a=Math.min(l+2655,C);l<a;++l)n+=I+=t[l];I=(65535&I)+15*(I>>16),n=(65535&n)+15*(n>>16)}g=I,e=n},d:function(){return(255&(g%=65521))<<24|(65280&g)<<8|(255&(e%=65521))<<8|e>>8}}},CC=function(g,e,t,I,n){if(!n&&(n={l:1},e.dictionary)){var C=e.dictionary.subarray(-32768),l=new mn(C.length+g.length);l.set(C),l.set(g,C.length),g=l,n.w=C.length}return IC(g,null==e.level?6:e.level,null==e.mem?n.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(g.length)))):20:12+e.mem,t,I,n)},lC=function(g,e,t){for(;t;++e)g[e]=t,t>>>=8},aC=function(g,e){var t=e.level,I=0==t?0:t<6?1:9==t?3:2;if(g[0]=120,g[1]=I<<6|(e.dictionary&&32),g[1]|=31-(g[0]<<8|g[1])%31,e.dictionary){var n=nC();n.p(e.dictionary),lC(g,2,n.d())}},oC=function(g,e){return(8!=(15&g[0])||g[0]>>4>7||(g[0]<<8|g[1])%31)&&jn(6,"invalid zlib data"),(g[1]>>5&1)==+!e&&jn(6,"invalid zlib data: "+(32&g[1]?"need":"unexpected")+" dictionary"),2+(g[1]>>3&4)};function iC(g,e){e||(e={});var t=nC();t.p(g);var I=CC(g,e,e.dictionary?6:2,4);return aC(I,e),lC(I,I.length-4,t.d()),I}function rC(g,e){return Qn(g.subarray(oC(g,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}var cC="undefined"!=typeof TextDecoder&&new TextDecoder;try{cC.decode(tC,{stream:!0})}catch(ui){}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout;var sC=function(){return"undefined"!=typeof window?window:"undefined"!=typeof t.g?t.g:"undefined"!=typeof self?self:this}();function AC(){sC.console&&"function"==typeof sC.console.log&&sC.console.log.apply(sC.console,arguments)}var dC={log:AC,warn:function(g){sC.console&&("function"==typeof sC.console.warn?sC.console.warn.apply(sC.console,arguments):AC.call(null,arguments))},error:function(g){sC.console&&("function"==typeof sC.console.error?sC.console.error.apply(sC.console,arguments):AC(g))}};function uC(g,e,t){var I=new XMLHttpRequest;I.open("GET",g),I.responseType="blob",I.onload=function(){pC(I.response,e,t)},I.onerror=function(){dC.error("could not download file")},I.send()}function mC(g){var e=new XMLHttpRequest;e.open("HEAD",g,!1);try{e.send()}catch(g){}return e.status>=200&&e.status<=299}function hC(g){try{g.dispatchEvent(new MouseEvent("click"))}catch(t){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),g.dispatchEvent(e)}}var bC,ZC,pC=sC.saveAs||("object"!==("undefined"==typeof window?"undefined":(0,un.A)(window))||window!==sC?function(){}:"undefined"!=typeof HTMLAnchorElement&&"download"in HTMLAnchorElement.prototype?function(g,e,t){var I=sC.URL||sC.webkitURL,n=document.createElement("a");e=e||g.name||"download",n.download=e,n.rel="noopener","string"==typeof g?(n.href=g,n.origin!==location.origin?mC(n.href)?uC(g,e,t):hC(n,n.target="_blank"):hC(n)):(n.href=I.createObjectURL(g),setTimeout((function(){I.revokeObjectURL(n.href)}),4e4),setTimeout((function(){hC(n)}),0))}:"msSaveOrOpenBlob"in navigator?function(g,e,t){if(e=e||g.name||"download","string"==typeof g)if(mC(g))uC(g,e,t);else{var I=document.createElement("a");I.href=g,I.target="_blank",setTimeout((function(){hC(I)}))}else navigator.msSaveOrOpenBlob(function(g,e){return void 0===e?e={autoBom:!1}:"object"!==(0,un.A)(e)&&(dC.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(g.type)?new Blob([String.fromCharCode(65279),g],{type:g.type}):g}(g,t),e)}:function(g,e,t,I){if((I=I||open("","_blank"))&&(I.document.title=I.document.body.innerText="downloading..."),"string"==typeof g)return uC(g,e,t);var n="application/octet-stream"===g.type,C=/constructor/i.test(sC.HTMLElement)||sC.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||n&&C)&&"object"===("undefined"==typeof FileReader?"undefined":(0,un.A)(FileReader))){var a=new FileReader;a.onloadend=function(){var g=a.result;g=l?g:g.replace(/^data:[^;]*;/,"data:attachment/file;"),I?I.location.href=g:location=g,I=null},a.readAsDataURL(g)}else{var o=sC.URL||sC.webkitURL,i=o.createObjectURL(g);I?I.location=i:location.href=i,I=null,setTimeout((function(){o.revokeObjectURL(i)}),4e4)}});function GC(g){var e;g=g||"",this.ok=!1,"#"==g.charAt(0)&&(g=g.substr(1,6)),g={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[g=(g=g.replace(/ /g,"")).toLowerCase()]||g;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(g){return[parseInt(g[1]),parseInt(g[2]),parseInt(g[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(g){return[parseInt(g[1],16),parseInt(g[2],16),parseInt(g[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(g){return[parseInt(g[1]+g[1],16),parseInt(g[2]+g[2],16),parseInt(g[3]+g[3],16)]}}],I=0;I<t.length;I++){var n=t[I].re,C=t[I].process,l=n.exec(g);l&&(e=C(l),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var g=this.r.toString(16),e=this.g.toString(16),t=this.b.toString(16);return 1==g.length&&(g="0"+g),1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),"#"+g+e+t}}function yC(g,e){var t=g[0],I=g[1],n=g[2],C=g[3];t=SC(t,I,n,C,e[0],7,-680876936),C=SC(C,t,I,n,e[1],12,-389564586),n=SC(n,C,t,I,e[2],17,606105819),I=SC(I,n,C,t,e[3],22,-1044525330),t=SC(t,I,n,C,e[4],7,-176418897),C=SC(C,t,I,n,e[5],12,1200080426),n=SC(n,C,t,I,e[6],17,-1473231341),I=SC(I,n,C,t,e[7],22,-45705983),t=SC(t,I,n,C,e[8],7,1770035416),C=SC(C,t,I,n,e[9],12,-1958414417),n=SC(n,C,t,I,e[10],17,-42063),I=SC(I,n,C,t,e[11],22,-1990404162),t=SC(t,I,n,C,e[12],7,1804603682),C=SC(C,t,I,n,e[13],12,-40341101),n=SC(n,C,t,I,e[14],17,-1502002290),t=fC(t,I=SC(I,n,C,t,e[15],22,1236535329),n,C,e[1],5,-165796510),C=fC(C,t,I,n,e[6],9,-1069501632),n=fC(n,C,t,I,e[11],14,643717713),I=fC(I,n,C,t,e[0],20,-373897302),t=fC(t,I,n,C,e[5],5,-701558691),C=fC(C,t,I,n,e[10],9,38016083),n=fC(n,C,t,I,e[15],14,-660478335),I=fC(I,n,C,t,e[4],20,-405537848),t=fC(t,I,n,C,e[9],5,568446438),C=fC(C,t,I,n,e[14],9,-1019803690),n=fC(n,C,t,I,e[3],14,-187363961),I=fC(I,n,C,t,e[8],20,1163531501),t=fC(t,I,n,C,e[13],5,-1444681467),C=fC(C,t,I,n,e[2],9,-51403784),n=fC(n,C,t,I,e[7],14,1735328473),t=WC(t,I=fC(I,n,C,t,e[12],20,-1926607734),n,C,e[5],4,-378558),C=WC(C,t,I,n,e[8],11,-2022574463),n=WC(n,C,t,I,e[11],16,1839030562),I=WC(I,n,C,t,e[14],23,-35309556),t=WC(t,I,n,C,e[1],4,-1530992060),C=WC(C,t,I,n,e[4],11,1272893353),n=WC(n,C,t,I,e[7],16,-155497632),I=WC(I,n,C,t,e[10],23,-1094730640),t=WC(t,I,n,C,e[13],4,681279174),C=WC(C,t,I,n,e[0],11,-358537222),n=WC(n,C,t,I,e[3],16,-722521979),I=WC(I,n,C,t,e[6],23,76029189),t=WC(t,I,n,C,e[9],4,-640364487),C=WC(C,t,I,n,e[12],11,-421815835),n=WC(n,C,t,I,e[15],16,530742520),t=VC(t,I=WC(I,n,C,t,e[2],23,-995338651),n,C,e[0],6,-198630844),C=VC(C,t,I,n,e[7],10,1126891415),n=VC(n,C,t,I,e[14],15,-1416354905),I=VC(I,n,C,t,e[5],21,-57434055),t=VC(t,I,n,C,e[12],6,1700485571),C=VC(C,t,I,n,e[3],10,-1894986606),n=VC(n,C,t,I,e[10],15,-1051523),I=VC(I,n,C,t,e[1],21,-2054922799),t=VC(t,I,n,C,e[8],6,1873313359),C=VC(C,t,I,n,e[15],10,-30611744),n=VC(n,C,t,I,e[6],15,-1560198380),I=VC(I,n,C,t,e[13],21,1309151649),t=VC(t,I,n,C,e[4],6,-145523070),C=VC(C,t,I,n,e[11],10,-1120210379),n=VC(n,C,t,I,e[2],15,718787259),I=VC(I,n,C,t,e[9],21,-343485551),g[0]=NC(t,g[0]),g[1]=NC(I,g[1]),g[2]=NC(n,g[2]),g[3]=NC(C,g[3])}function BC(g,e,t,I,n,C){return e=NC(NC(e,g),NC(I,C)),NC(e<<n|e>>>32-n,t)}function SC(g,e,t,I,n,C,l){return BC(e&t|~e&I,g,e,n,C,l)}function fC(g,e,t,I,n,C,l){return BC(e&I|t&~I,g,e,n,C,l)}function WC(g,e,t,I,n,C,l){return BC(e^t^I,g,e,n,C,l)}function VC(g,e,t,I,n,C,l){return BC(t^(e|~I),g,e,n,C,l)}function vC(g){var e,t=g.length,I=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=g.length;e+=64)yC(I,RC(g.substring(e-64,e)));g=g.substring(e-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<g.length;e++)n[e>>2]|=g.charCodeAt(e)<<(e%4<<3);if(n[e>>2]|=128<<(e%4<<3),e>55)for(yC(I,n),e=0;e<16;e++)n[e]=0;return n[14]=8*t,yC(I,n),I}function RC(g){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=g.charCodeAt(e)+(g.charCodeAt(e+1)<<8)+(g.charCodeAt(e+2)<<16)+(g.charCodeAt(e+3)<<24);return t}bC=sC.atob.bind(sC),ZC=sC.btoa.bind(sC);var XC="0123456789abcdef".split("");function kC(g){for(var e="",t=0;t<4;t++)e+=XC[g>>8*t+4&15]+XC[g>>8*t&15];return e}function JC(g){return String.fromCharCode(255&g,(65280&g)>>8,(16711680&g)>>16,(4278190080&g)>>24)}function YC(g){return vC(g).map(JC).join("")}var wC="5d41402abc4b2a76b9719d911017c592"!=function(g){for(var e=0;e<g.length;e++)g[e]=kC(g[e]);return g.join("")}(vC("hello"));function NC(g,e){if(wC){var t=(65535&g)+(65535&e);return(g>>16)+(e>>16)+(t>>16)<<16|65535&t}return g+e&4294967295}function HC(g,e){var t,I,n,C;if(g!==t){for(var l=(n=g,C=1+(256/g.length|0),new Array(C+1).join(n)),a=[],o=0;o<256;o++)a[o]=o;var i=0;for(o=0;o<256;o++){var r=a[o];i=(i+r+l.charCodeAt(o))%256,a[o]=a[i],a[i]=r}t=g,I=a}else a=I;var c=e.length,s=0,A=0,d="";for(o=0;o<c;o++)A=(A+(r=a[s=(s+1)%256]))%256,a[s]=a[A],a[A]=r,l=a[(a[s]+a[A])%256],d+=String.fromCharCode(e.charCodeAt(o)^l);return d}var FC={print:4,modify:8,copy:16,"annot-forms":32};function KC(g,e,t,I){this.v=1,this.r=2;var n=192;g.forEach((function(g){if(void 0!==FC.perm)throw new Error("Invalid permission: "+g);n+=FC[g]})),this.padding="(\xbfN^Nu\x8aAd\0NV\xff\xfa\x01\b..\0\xb6\xd0h>\x80/\f\xa9\xfedSiz";var C=(e+this.padding).substr(0,32),l=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(C,l),this.P=-(1+(255^n)),this.encryptionKey=YC(C+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(I)).substr(0,5),this.U=HC(this.encryptionKey,this.padding)}function xC(g){if(/[^\u0000-\u00ff]/.test(g))throw new Error("Invalid PDF Name Object: "+g+", Only accept ASCII characters.");for(var e="",t=g.length,I=0;I<t;I++){var n=g.charCodeAt(I);e+=n<33||35===n||37===n||40===n||41===n||47===n||60===n||62===n||91===n||93===n||123===n||125===n||n>126?"#"+("0"+n.toString(16)).slice(-2):g[I]}return e}function LC(g){if("object"!==(0,un.A)(g))throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(g,t,I){if(I=I||!1,"string"!=typeof g||"function"!=typeof t||"boolean"!=typeof I)throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(g)||(e[g]={});var n=Math.random().toString(35);return e[g][n]=[t,!!I],n},this.unsubscribe=function(g){for(var t in e)if(e[t][g])return delete e[t][g],0===Object.keys(e[t]).length&&delete e[t],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var I=Array.prototype.slice.call(arguments,1),n=[];for(var C in e[t]){var l=e[t][C];try{l[0].apply(g,I)}catch(t){sC.console&&dC.error("jsPDF PubSub Error",t.message,t)}l[1]&&n.push(C)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function zC(g){if(!(this instanceof zC))return new zC(g);var e="opacity,stroke-opacity".split(",");for(var t in g)g.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=g[t]);this.id="",this.objectNumber=-1}function EC(g,e){this.gState=g,this.matrix=e,this.id="",this.objectNumber=-1}function MC(g,e,t,I,n){if(!(this instanceof MC))return new MC(g,e,t,I,n);this.type="axial"===g?2:3,this.coords=e,this.colors=t,EC.call(this,I,n)}function UC(g,e,t,I,n){if(!(this instanceof UC))return new UC(g,e,t,I,n);this.boundingBox=g,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,EC.call(this,I,n)}function jC(g){var e,t="string"==typeof arguments[0]?arguments[0]:"p",I=arguments[1],n=arguments[2],C=arguments[3],l=[],a=1,o=16,i="S",r=null;"object"===(0,un.A)(g=g||{})&&(t=g.orientation,I=g.unit||I,n=g.format||n,C=g.compress||g.compressPdf||C,null!==(r=g.encryption||null)&&(r.userPassword=r.userPassword||"",r.ownerPassword=r.ownerPassword||"",r.userPermissions=r.userPermissions||[]),a="number"==typeof g.userUnit?Math.abs(g.userUnit):1,void 0!==g.precision&&(e=g.precision),void 0!==g.floatPrecision&&(o=g.floatPrecision),i=g.defaultPathOperation||"S"),l=g.filters||(!0===C?["FlateEncode"]:l),I=I||"mm",t=(""+(t||"P")).toLowerCase();var c=g.putOnlyUsedFonts||!1,s={},A={internal:{},__private__:{}};A.__private__.PubSub=LC;var d="1.3",u=A.__private__.getPdfVersion=function(){return d};A.__private__.setPdfVersion=function(g){d=g};var m={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};A.__private__.getPageFormats=function(){return m};var h=A.__private__.getPageFormat=function(g){return m[g]};n=n||"a4";var b="compat",Z="advanced",p=b;function G(){this.saveGraphicsState(),q(new kg(sg,0,0,-sg,0,it()*sg).toString()+" cm"),this.setFontSize(this.getFontSize()/sg),i="n",p=Z}function y(){this.restoreGraphicsState(),i="S",p=b}var B=A.__private__.combineFontStyleAndFontWeight=function(g,e){if("bold"==g&&"normal"==e||"bold"==g&&400==e||"normal"==g&&"italic"==e||"bold"==g&&"italic"==e)throw new Error("Invalid Combination of fontweight and fontstyle");return e&&(g=400==e||"normal"===e?"italic"===g?"italic":"normal":700!=e&&"bold"!==e||"normal"!==g?(700==e?"bold":e)+""+g:"bold"),g};A.advancedAPI=function(g){var e=p===b;return e&&G.call(this),"function"!=typeof g||(g(this),e&&y.call(this)),this},A.compatAPI=function(g){var e=p===Z;return e&&y.call(this),"function"!=typeof g||(g(this),e&&G.call(this)),this},A.isAdvancedAPI=function(){return p===Z};var S,f=function(g){if(p!==Z)throw new Error(g+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},W=A.roundToPrecision=A.__private__.roundToPrecision=function(g,t){var I=e||t;if(isNaN(g)||isNaN(I))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return g.toFixed(I).replace(/0+$/,"")};S=A.hpf=A.__private__.hpf="number"==typeof o?function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.hpf");return W(g,o)}:"smart"===o?function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.hpf");return W(g,g>-1&&g<1?16:5)}:function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.hpf");return W(g,16)};var V=A.f2=A.__private__.f2=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.f2");return W(g,2)},v=A.__private__.f3=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.f3");return W(g,3)},R=A.scale=A.__private__.scale=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.scale");return p===b?g*sg:p===Z?g:void 0},X=function(g){return R(function(g){return p===b?it()-g:p===Z?g:void 0}(g))};A.__private__.setPrecision=A.setPrecision=function(g){"number"==typeof parseInt(g,10)&&(e=parseInt(g,10))};var k,J="00000000000000000000000000000000",Y=A.__private__.getFileId=function(){return J},w=A.__private__.setFileId=function(g){return J=void 0!==g&&/^[a-fA-F0-9]{32}$/.test(g)?g.toUpperCase():J.split("").map((function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))})).join(""),null!==r&&(Ze=new KC(r.userPermissions,r.userPassword,r.ownerPassword,J)),J};A.setFileId=function(g){return w(g),this},A.getFileId=function(){return Y()};var N=A.__private__.convertDateToPDFDate=function(g){var e=g.getTimezoneOffset(),t=e<0?"+":"-",I=Math.floor(Math.abs(e/60)),n=Math.abs(e%60),C=[t,L(I),"'",L(n),"'"].join("");return["D:",g.getFullYear(),L(g.getMonth()+1),L(g.getDate()),L(g.getHours()),L(g.getMinutes()),L(g.getSeconds()),C].join("")},H=A.__private__.convertPDFDateToDate=function(g){var e=parseInt(g.substr(2,4),10),t=parseInt(g.substr(6,2),10)-1,I=parseInt(g.substr(8,2),10),n=parseInt(g.substr(10,2),10),C=parseInt(g.substr(12,2),10),l=parseInt(g.substr(14,2),10);return new Date(e,t,I,n,C,l,0)},F=A.__private__.setCreationDate=function(g){var e;if(void 0===g&&(g=new Date),g instanceof Date)e=N(g);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(g))throw new Error("Invalid argument passed to jsPDF.setCreationDate");e=g}return k=e},K=A.__private__.getCreationDate=function(g){var e=k;return"jsDate"===g&&(e=H(k)),e};A.setCreationDate=function(g){return F(g),this},A.getCreationDate=function(g){return K(g)};var x,L=A.__private__.padd2=function(g){return("0"+parseInt(g)).slice(-2)},z=A.__private__.padd2Hex=function(g){return("00"+(g=g.toString())).substr(g.length)},E=0,M=[],U=[],j=0,Q=[],D=[],T=!1,P=U;A.__private__.setCustomOutputDestination=function(g){T=!0,P=g};var O=function(g){T||(P=g)};A.__private__.resetCustomOutputDestination=function(){T=!1,P=U};var q=A.__private__.out=function(g){return g=g.toString(),j+=g.length+1,P.push(g),P},_=A.__private__.write=function(g){return q(1===arguments.length?g.toString():Array.prototype.join.call(arguments," "))},$=A.__private__.getArrayBuffer=function(g){for(var e=g.length,t=new ArrayBuffer(e),I=new Uint8Array(t);e--;)I[e]=g.charCodeAt(e);return t},gg=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];A.__private__.getStandardFonts=function(){return gg};var eg=g.fontSize||16;A.__private__.setFontSize=A.setFontSize=function(g){return eg=p===Z?g/sg:g,this};var tg,Ig=A.__private__.getFontSize=A.getFontSize=function(){return p===b?eg:eg*sg},ng=g.R2L||!1;A.__private__.setR2L=A.setR2L=function(g){return ng=g,this},A.__private__.getR2L=A.getR2L=function(){return ng};var Cg,lg=A.__private__.setZoomMode=function(g){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(g))tg=g;else if(isNaN(g)){if(-1===[void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(g))throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+g+'" is not recognized.');tg=g}else tg=parseInt(g,10)};A.__private__.getZoomMode=function(){return tg};var ag,og=A.__private__.setPageMode=function(g){if(-1==[void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(g))throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+g+'" is not recognized.');Cg=g};A.__private__.getPageMode=function(){return Cg};var ig=A.__private__.setLayoutMode=function(g){if(-1==[void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(g))throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+g+'" is not recognized.');ag=g};A.__private__.getLayoutMode=function(){return ag},A.__private__.setDisplayMode=A.setDisplayMode=function(g,e,t){return lg(g),ig(e),og(t),this};var rg={title:"",subject:"",author:"",keywords:"",creator:""};A.__private__.getDocumentProperty=function(g){if(-1===Object.keys(rg).indexOf(g))throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return rg[g]},A.__private__.getDocumentProperties=function(){return rg},A.__private__.setDocumentProperties=A.setProperties=A.setDocumentProperties=function(g){for(var e in rg)rg.hasOwnProperty(e)&&g[e]&&(rg[e]=g[e]);return this},A.__private__.setDocumentProperty=function(g,e){if(-1===Object.keys(rg).indexOf(g))throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return rg[g]=e};var cg,sg,Ag,dg,ug,mg={},hg={},bg=[],Zg={},pg={},Gg={},yg={},Bg=null,Sg=0,fg=[],Wg=new LC(A),Vg=g.hotfixes||[],vg={},Rg={},Xg=[],kg=function g(e,t,I,n,C,l){if(!(this instanceof g))return new g(e,t,I,n,C,l);isNaN(e)&&(e=1),isNaN(t)&&(t=0),isNaN(I)&&(I=0),isNaN(n)&&(n=1),isNaN(C)&&(C=0),isNaN(l)&&(l=0),this._matrix=[e,t,I,n,C,l]};Object.defineProperty(kg.prototype,"sx",{get:function(){return this._matrix[0]},set:function(g){this._matrix[0]=g}}),Object.defineProperty(kg.prototype,"shy",{get:function(){return this._matrix[1]},set:function(g){this._matrix[1]=g}}),Object.defineProperty(kg.prototype,"shx",{get:function(){return this._matrix[2]},set:function(g){this._matrix[2]=g}}),Object.defineProperty(kg.prototype,"sy",{get:function(){return this._matrix[3]},set:function(g){this._matrix[3]=g}}),Object.defineProperty(kg.prototype,"tx",{get:function(){return this._matrix[4]},set:function(g){this._matrix[4]=g}}),Object.defineProperty(kg.prototype,"ty",{get:function(){return this._matrix[5]},set:function(g){this._matrix[5]=g}}),Object.defineProperty(kg.prototype,"a",{get:function(){return this._matrix[0]},set:function(g){this._matrix[0]=g}}),Object.defineProperty(kg.prototype,"b",{get:function(){return this._matrix[1]},set:function(g){this._matrix[1]=g}}),Object.defineProperty(kg.prototype,"c",{get:function(){return this._matrix[2]},set:function(g){this._matrix[2]=g}}),Object.defineProperty(kg.prototype,"d",{get:function(){return this._matrix[3]},set:function(g){this._matrix[3]=g}}),Object.defineProperty(kg.prototype,"e",{get:function(){return this._matrix[4]},set:function(g){this._matrix[4]=g}}),Object.defineProperty(kg.prototype,"f",{get:function(){return this._matrix[5]},set:function(g){this._matrix[5]=g}}),Object.defineProperty(kg.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(kg.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(kg.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(kg.prototype,"isIdentity",{get:function(){return 1===this.sx&&0===this.shy&&0===this.shx&&1===this.sy&&0===this.tx&&0===this.ty}}),kg.prototype.join=function(g){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(S).join(g)},kg.prototype.multiply=function(g){var e=g.sx*this.sx+g.shy*this.shx,t=g.sx*this.shy+g.shy*this.sy,I=g.shx*this.sx+g.sy*this.shx,n=g.shx*this.shy+g.sy*this.sy,C=g.tx*this.sx+g.ty*this.shx+this.tx,l=g.tx*this.shy+g.ty*this.sy+this.ty;return new kg(e,t,I,n,C,l)},kg.prototype.decompose=function(){var g=this.sx,e=this.shy,t=this.shx,I=this.sy,n=this.tx,C=this.ty,l=Math.sqrt(g*g+e*e),a=(g/=l)*t+(e/=l)*I;t-=g*a,I-=e*a;var o=Math.sqrt(t*t+I*I);return a/=o,g*(I/=o)<e*(t/=o)&&(g=-g,e=-e,a=-a,l=-l),{scale:new kg(l,0,0,o,0,0),translate:new kg(1,0,0,1,n,C),rotate:new kg(g,e,-e,g,0,0),skew:new kg(1,0,a,1,0,0)}},kg.prototype.toString=function(g){return this.join(" ")},kg.prototype.inversed=function(){var g=this.sx,e=this.shy,t=this.shx,I=this.sy,n=this.tx,C=this.ty,l=1/(g*I-e*t),a=I*l,o=-e*l,i=-t*l,r=g*l;return new kg(a,o,i,r,-a*n-i*C,-o*n-r*C)},kg.prototype.applyToPoint=function(g){var e=g.x*this.sx+g.y*this.shx+this.tx,t=g.x*this.shy+g.y*this.sy+this.ty;return new tt(e,t)},kg.prototype.applyToRectangle=function(g){var e=this.applyToPoint(g),t=this.applyToPoint(new tt(g.x+g.w,g.y+g.h));return new It(e.x,e.y,t.x-e.x,t.y-e.y)},kg.prototype.clone=function(){var g=this.sx,e=this.shy,t=this.shx,I=this.sy,n=this.tx,C=this.ty;return new kg(g,e,t,I,n,C)},A.Matrix=kg;var Jg=A.matrixMult=function(g,e){return e.multiply(g)},Yg=new kg(1,0,0,1,0,0);A.unitMatrix=A.identityMatrix=Yg;var wg=function(g,e){if(!pg[g]){var t=(e instanceof MC?"Sh":"P")+(Object.keys(Zg).length+1).toString(10);e.id=t,pg[g]=t,Zg[t]=e,Wg.publish("addPattern",e)}};A.ShadingPattern=MC,A.TilingPattern=UC,A.addShadingPattern=function(g,e){return f("addShadingPattern()"),wg(g,e),this},A.beginTilingPattern=function(g){f("beginTilingPattern()"),Ct(g.boundingBox[0],g.boundingBox[1],g.boundingBox[2]-g.boundingBox[0],g.boundingBox[3]-g.boundingBox[1],g.matrix)},A.endTilingPattern=function(g,e){f("endTilingPattern()"),e.stream=D[x].join("\n"),wg(g,e),Wg.publish("endTilingPattern",e),Xg.pop().restore()};var Ng,Hg=A.__private__.newObject=function(){var g=Fg();return Kg(g,!0),g},Fg=A.__private__.newObjectDeferred=function(){return E++,M[E]=function(){return j},E},Kg=function(g,e){return e="boolean"==typeof e&&e,M[g]=j,e&&q(g+" 0 obj"),g},xg=A.__private__.newAdditionalObject=function(){var g={objId:Fg(),content:""};return Q.push(g),g},Lg=Fg(),zg=Fg(),Eg=A.__private__.decodeColorString=function(g){var e=g.split(" ");if(2!==e.length||"g"!==e[1]&&"G"!==e[1])5!==e.length||"k"!==e[4]&&"K"!==e[4]||(e=[(1-e[0])*(1-e[3]),(1-e[1])*(1-e[3]),(1-e[2])*(1-e[3]),"r"]);else{var t=parseFloat(e[0]);e=[t,t,t,"r"]}for(var I="#",n=0;n<3;n++)I+=("0"+Math.floor(255*parseFloat(e[n])).toString(16)).slice(-2);return I},Mg=A.__private__.encodeColorString=function(g){var e;"string"==typeof g&&(g={ch1:g});var t=g.ch1,I=g.ch2,n=g.ch3,C=g.ch4,l="draw"===g.pdfColorType?["G","RG","K"]:["g","rg","k"];if("string"==typeof t&&"#"!==t.charAt(0)){var a=new GC(t);if(a.ok)t=a.toHex();else if(!/^\d*\.?\d*$/.test(t))throw new Error('Invalid color "'+t+'" passed to jsPDF.encodeColorString.')}if("string"==typeof t&&/^#[0-9A-Fa-f]{3}$/.test(t)&&(t="#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]),"string"==typeof t&&/^#[0-9A-Fa-f]{6}$/.test(t)){var o=parseInt(t.substr(1),16);t=o>>16&255,I=o>>8&255,n=255&o}if(void 0===I||void 0===C&&t===I&&I===n)if("string"==typeof t)e=t+" "+l[0];else if(2===g.precision)e=V(t/255)+" "+l[0];else e=v(t/255)+" "+l[0];else if(void 0===C||"object"===(0,un.A)(C)){if(C&&!isNaN(C.a)&&0===C.a)return["1.","1.","1.",l[1]].join(" ");if("string"==typeof t)e=[t,I,n,l[1]].join(" ");else if(2===g.precision)e=[V(t/255),V(I/255),V(n/255),l[1]].join(" ");else e=[v(t/255),v(I/255),v(n/255),l[1]].join(" ")}else if("string"==typeof t)e=[t,I,n,C,l[2]].join(" ");else if(2===g.precision)e=[V(t),V(I),V(n),V(C),l[2]].join(" ");else e=[v(t),v(I),v(n),v(C),l[2]].join(" ");return e},Ug=A.__private__.getFilters=function(){return l},jg=A.__private__.putStream=function(g){var e=(g=g||{}).data||"",t=g.filters||Ug(),I=g.alreadyAppliedFilters||[],n=g.addLength1||!1,C=e.length,l=g.objectId,a=function(g){return g};if(null!==r&&void 0===l)throw new Error("ObjectId must be passed to putStream for file encryption");null!==r&&(a=Ze.encryptor(l,0));var o={};!0===t&&(t=["FlateEncode"]);var i=g.additionalKeyValues||[],c=(o=void 0!==jC.API.processDataByFilters?jC.API.processDataByFilters(e,t):{data:e,reverseChain:[]}).reverseChain+(Array.isArray(I)?I.join(" "):I.toString());if(0!==o.data.length&&(i.push({key:"Length",value:o.data.length}),!0===n&&i.push({key:"Length1",value:C})),0!=c.length)if(c.split("/").length-1==1)i.push({key:"Filter",value:c});else{i.push({key:"Filter",value:"["+c+"]"});for(var s=0;s<i.length;s+=1)if("DecodeParms"===i[s].key){for(var A=[],d=0;d<o.reverseChain.split("/").length-1;d+=1)A.push("null");A.push(i[s].value),i[s].value="["+A.join(" ")+"]"}}q("<<");for(var u=0;u<i.length;u++)q("/"+i[u].key+" "+i[u].value);q(">>"),0!==o.data.length&&(q("stream"),q(a(o.data)),q("endstream"))},Qg=A.__private__.putPage=function(g){var e=g.number,t=g.data,I=g.objId,n=g.contentsObjId;Kg(I,!0),q("<</Type /Page"),q("/Parent "+g.rootDictionaryObjId+" 0 R"),q("/Resources "+g.resourceDictionaryObjId+" 0 R"),q("/MediaBox ["+parseFloat(S(g.mediaBox.bottomLeftX))+" "+parseFloat(S(g.mediaBox.bottomLeftY))+" "+S(g.mediaBox.topRightX)+" "+S(g.mediaBox.topRightY)+"]"),null!==g.cropBox&&q("/CropBox ["+S(g.cropBox.bottomLeftX)+" "+S(g.cropBox.bottomLeftY)+" "+S(g.cropBox.topRightX)+" "+S(g.cropBox.topRightY)+"]"),null!==g.bleedBox&&q("/BleedBox ["+S(g.bleedBox.bottomLeftX)+" "+S(g.bleedBox.bottomLeftY)+" "+S(g.bleedBox.topRightX)+" "+S(g.bleedBox.topRightY)+"]"),null!==g.trimBox&&q("/TrimBox ["+S(g.trimBox.bottomLeftX)+" "+S(g.trimBox.bottomLeftY)+" "+S(g.trimBox.topRightX)+" "+S(g.trimBox.topRightY)+"]"),null!==g.artBox&&q("/ArtBox ["+S(g.artBox.bottomLeftX)+" "+S(g.artBox.bottomLeftY)+" "+S(g.artBox.topRightX)+" "+S(g.artBox.topRightY)+"]"),"number"==typeof g.userUnit&&1!==g.userUnit&&q("/UserUnit "+g.userUnit),Wg.publish("putPage",{objId:I,pageContext:fg[e],pageNumber:e,page:t}),q("/Contents "+n+" 0 R"),q(">>"),q("endobj");var C=t.join("\n");return p===Z&&(C+="\nQ"),Kg(n,!0),jg({data:C,filters:Ug(),objectId:n}),q("endobj"),I},Dg=A.__private__.putPages=function(){var g,e,t=[];for(g=1;g<=Sg;g++)fg[g].objId=Fg(),fg[g].contentsObjId=Fg();for(g=1;g<=Sg;g++)t.push(Qg({number:g,data:D[g],objId:fg[g].objId,contentsObjId:fg[g].contentsObjId,mediaBox:fg[g].mediaBox,cropBox:fg[g].cropBox,bleedBox:fg[g].bleedBox,trimBox:fg[g].trimBox,artBox:fg[g].artBox,userUnit:fg[g].userUnit,rootDictionaryObjId:Lg,resourceDictionaryObjId:zg}));Kg(Lg,!0),q("<</Type /Pages");var I="/Kids [";for(e=0;e<Sg;e++)I+=t[e]+" 0 R ";q(I+"]"),q("/Count "+Sg),q(">>"),q("endobj"),Wg.publish("postPutPages")},Tg=function(g){Wg.publish("putFont",{font:g,out:q,newObject:Hg,putStream:jg}),!0!==g.isAlreadyPutted&&(g.objectNumber=Hg(),q("<<"),q("/Type /Font"),q("/BaseFont /"+xC(g.postScriptName)),q("/Subtype /Type1"),"string"==typeof g.encoding&&q("/Encoding /"+g.encoding),q("/FirstChar 32"),q("/LastChar 255"),q(">>"),q("endobj"))},Pg=function(g){g.objectNumber=Hg();var e=[];e.push({key:"Type",value:"/XObject"}),e.push({key:"Subtype",value:"/Form"}),e.push({key:"BBox",value:"["+[S(g.x),S(g.y),S(g.x+g.width),S(g.y+g.height)].join(" ")+"]"}),e.push({key:"Matrix",value:"["+g.matrix.toString()+"]"});var t=g.pages[1].join("\n");jg({data:t,additionalKeyValues:e,objectId:g.objectNumber}),q("endobj")},Og=function(g,e){e||(e=21);var t=Hg(),I=function(g,e){var t,I=[],n=1/(e-1);for(t=0;t<1;t+=n)I.push(t);if(I.push(1),0!=g[0].offset){var C={offset:0,color:g[0].color};g.unshift(C)}if(1!=g[g.length-1].offset){var l={offset:1,color:g[g.length-1].color};g.push(l)}for(var a="",o=0,i=0;i<I.length;i++){for(t=I[i];t>g[o+1].offset;)o++;var r=g[o].offset,c=(t-r)/(g[o+1].offset-r),s=g[o].color,A=g[o+1].color;a+=z(Math.round((1-c)*s[0]+c*A[0]).toString(16))+z(Math.round((1-c)*s[1]+c*A[1]).toString(16))+z(Math.round((1-c)*s[2]+c*A[2]).toString(16))}return a.trim()}(g.colors,e),n=[];n.push({key:"FunctionType",value:"0"}),n.push({key:"Domain",value:"[0.0 1.0]"}),n.push({key:"Size",value:"["+e+"]"}),n.push({key:"BitsPerSample",value:"8"}),n.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),n.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),jg({data:I,additionalKeyValues:n,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:t}),q("endobj"),g.objectNumber=Hg(),q("<< /ShadingType "+g.type),q("/ColorSpace /DeviceRGB");var C="/Coords ["+S(parseFloat(g.coords[0]))+" "+S(parseFloat(g.coords[1]))+" ";2===g.type?C+=S(parseFloat(g.coords[2]))+" "+S(parseFloat(g.coords[3])):C+=S(parseFloat(g.coords[2]))+" "+S(parseFloat(g.coords[3]))+" "+S(parseFloat(g.coords[4]))+" "+S(parseFloat(g.coords[5])),q(C+="]"),g.matrix&&q("/Matrix ["+g.matrix.toString()+"]"),q("/Function "+t+" 0 R"),q("/Extend [true true]"),q(">>"),q("endobj")},qg=function(g,e){var t=Fg(),I=Hg();e.push({resourcesOid:t,objectOid:I}),g.objectNumber=I;var n=[];n.push({key:"Type",value:"/Pattern"}),n.push({key:"PatternType",value:"1"}),n.push({key:"PaintType",value:"1"}),n.push({key:"TilingType",value:"1"}),n.push({key:"BBox",value:"["+g.boundingBox.map(S).join(" ")+"]"}),n.push({key:"XStep",value:S(g.xStep)}),n.push({key:"YStep",value:S(g.yStep)}),n.push({key:"Resources",value:t+" 0 R"}),g.matrix&&n.push({key:"Matrix",value:"["+g.matrix.toString()+"]"}),jg({data:g.stream,additionalKeyValues:n,objectId:g.objectNumber}),q("endobj")},_g=function(g){for(var e in g.objectNumber=Hg(),q("<<"),g)switch(e){case"opacity":q("/ca "+V(g[e]));break;case"stroke-opacity":q("/CA "+V(g[e]))}q(">>"),q("endobj")},$g=function(g){Kg(g.resourcesOid,!0),q("<<"),q("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var g in q("/Font <<"),mg)mg.hasOwnProperty(g)&&(!1===c||!0===c&&s.hasOwnProperty(g))&&q("/"+g+" "+mg[g].objectNumber+" 0 R");q(">>")}(),function(){if(Object.keys(Zg).length>0){for(var g in q("/Shading <<"),Zg)Zg.hasOwnProperty(g)&&Zg[g]instanceof MC&&Zg[g].objectNumber>=0&&q("/"+g+" "+Zg[g].objectNumber+" 0 R");Wg.publish("putShadingPatternDict"),q(">>")}}(),function(g){if(Object.keys(Zg).length>0){for(var e in q("/Pattern <<"),Zg)Zg.hasOwnProperty(e)&&Zg[e]instanceof A.TilingPattern&&Zg[e].objectNumber>=0&&Zg[e].objectNumber<g&&q("/"+e+" "+Zg[e].objectNumber+" 0 R");Wg.publish("putTilingPatternDict"),q(">>")}}(g.objectOid),function(){if(Object.keys(Gg).length>0){var g;for(g in q("/ExtGState <<"),Gg)Gg.hasOwnProperty(g)&&Gg[g].objectNumber>=0&&q("/"+g+" "+Gg[g].objectNumber+" 0 R");Wg.publish("putGStateDict"),q(">>")}}(),function(){for(var g in q("/XObject <<"),vg)vg.hasOwnProperty(g)&&vg[g].objectNumber>=0&&q("/"+g+" "+vg[g].objectNumber+" 0 R");Wg.publish("putXobjectDict"),q(">>")}(),q(">>"),q("endobj")},ge=function(){var g=[];(function(){for(var g in mg)mg.hasOwnProperty(g)&&(!1===c||!0===c&&s.hasOwnProperty(g))&&Tg(mg[g])})(),function(){var g;for(g in Gg)Gg.hasOwnProperty(g)&&_g(Gg[g])}(),function(){for(var g in vg)vg.hasOwnProperty(g)&&Pg(vg[g])}(),function(g){var e;for(e in Zg)Zg.hasOwnProperty(e)&&(Zg[e]instanceof MC?Og(Zg[e]):Zg[e]instanceof UC&&qg(Zg[e],g))}(g),Wg.publish("putResources"),g.forEach($g),$g({resourcesOid:zg,objectOid:Number.MAX_SAFE_INTEGER}),Wg.publish("postPutResources")},ee=function(g){hg[g.fontName]=hg[g.fontName]||{},hg[g.fontName][g.fontStyle]=g.id},te=function(g,e,t,I,n){var C={id:"F"+(Object.keys(mg).length+1).toString(10),postScriptName:g,fontName:e,fontStyle:t,encoding:I,isStandardFont:n||!1,metadata:{}};return Wg.publish("addFont",{font:C,instance:this}),mg[C.id]=C,ee(C),C.id},Ie=A.__private__.pdfEscape=A.pdfEscape=function(g,e){return function(g,e){var t,I,n,C,l,a,o,i,r;if(n=(e=e||{}).sourceEncoding||"Unicode",l=e.outputEncoding,(e.autoencode||l)&&mg[cg].metadata&&mg[cg].metadata[n]&&mg[cg].metadata[n].encoding&&(C=mg[cg].metadata[n].encoding,!l&&mg[cg].encoding&&(l=mg[cg].encoding),!l&&C.codePages&&(l=C.codePages[0]),"string"==typeof l&&(l=C[l]),l)){for(o=!1,a=[],t=0,I=g.length;t<I;t++)(i=l[g.charCodeAt(t)])?a.push(String.fromCharCode(i)):a.push(g[t]),a[t].charCodeAt(0)>>8&&(o=!0);g=a.join("")}for(t=g.length;void 0===o&&0!==t;)g.charCodeAt(t-1)>>8&&(o=!0),t--;if(!o)return g;for(a=e.noBOM?[]:[254,255],t=0,I=g.length;t<I;t++){if((r=(i=g.charCodeAt(t))>>8)>>8)throw new Error("Character at position "+t+" of string '"+g+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");a.push(r),a.push(i-(r<<8))}return String.fromCharCode.apply(void 0,a)}(g,e).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ne=A.__private__.beginPage=function(g){D[++Sg]=[],fg[Sg]={objId:0,contentsObjId:0,userUnit:Number(a),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(g[0]),topRightY:Number(g[1])}},ae(Sg),O(D[x])},Ce=function(g,e){var I,C,l;switch(t=e||t,"string"==typeof g&&(I=h(g.toLowerCase()),Array.isArray(I)&&(C=I[0],l=I[1])),Array.isArray(g)&&(C=g[0]*sg,l=g[1]*sg),isNaN(C)&&(C=n[0],l=n[1]),(C>14400||l>14400)&&(dC.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),C=Math.min(14400,C),l=Math.min(14400,l)),n=[C,l],t.substr(0,1)){case"l":l>C&&(n=[l,C]);break;case"p":C>l&&(n=[l,C])}ne(n),xe(Fe),q(De),0!==$e&&q($e+" J"),0!==gt&&q(gt+" j"),Wg.publish("addPage",{pageNumber:Sg})},le=function(g){g>0&&g<=Sg&&(D.splice(g,1),fg.splice(g,1),Sg--,x>Sg&&(x=Sg),this.setPage(x))},ae=function(g){g>0&&g<=Sg&&(x=g)},oe=A.__private__.getNumberOfPages=A.getNumberOfPages=function(){return D.length-1},ie=function(g,e,t){var I,n=void 0;return t=t||{},g=void 0!==g?g:mg[cg].fontName,e=void 0!==e?e:mg[cg].fontStyle,I=g.toLowerCase(),void 0!==hg[I]&&void 0!==hg[I][e]?n=hg[I][e]:void 0!==hg[g]&&void 0!==hg[g][e]?n=hg[g][e]:!1===t.disableWarning&&dC.warn("Unable to look up font label for font '"+g+"', '"+e+"'. Refer to getFontList() for available fonts."),n||t.noFallback||null==(n=hg.times[e])&&(n=hg.times.normal),n},re=A.__private__.putInfo=function(){var g=Hg(),e=function(g){return g};for(var t in null!==r&&(e=Ze.encryptor(g,0)),q("<<"),q("/Producer ("+Ie(e("jsPDF "+jC.version))+")"),rg)rg.hasOwnProperty(t)&&rg[t]&&q("/"+t.substr(0,1).toUpperCase()+t.substr(1)+" ("+Ie(e(rg[t]))+")");q("/CreationDate ("+Ie(e(k))+")"),q(">>"),q("endobj")},ce=A.__private__.putCatalog=function(g){var e=(g=g||{}).rootDictionaryObjId||Lg;switch(Hg(),q("<<"),q("/Type /Catalog"),q("/Pages "+e+" 0 R"),tg||(tg="fullwidth"),tg){case"fullwidth":q("/OpenAction [3 0 R /FitH null]");break;case"fullheight":q("/OpenAction [3 0 R /FitV null]");break;case"fullpage":q("/OpenAction [3 0 R /Fit]");break;case"original":q("/OpenAction [3 0 R /XYZ null null 1]");break;default:var t=""+tg;"%"===t.substr(t.length-1)&&(tg=parseInt(tg)/100),"number"==typeof tg&&q("/OpenAction [3 0 R /XYZ null null "+V(tg)+"]")}switch(ag||(ag="continuous"),ag){case"continuous":q("/PageLayout /OneColumn");break;case"single":q("/PageLayout /SinglePage");break;case"two":case"twoleft":q("/PageLayout /TwoColumnLeft");break;case"tworight":q("/PageLayout /TwoColumnRight")}Cg&&q("/PageMode /"+Cg),Wg.publish("putCatalog"),q(">>"),q("endobj")},se=A.__private__.putTrailer=function(){q("trailer"),q("<<"),q("/Size "+(E+1)),q("/Root "+E+" 0 R"),q("/Info "+(E-1)+" 0 R"),null!==r&&q("/Encrypt "+Ze.oid+" 0 R"),q("/ID [ <"+J+"> <"+J+"> ]"),q(">>")},Ae=A.__private__.putHeader=function(){q("%PDF-"+d),q("%\xba\xdf\xac\xe0")},de=A.__private__.putXRef=function(){var g="0000000000";q("xref"),q("0 "+(E+1)),q("0000000000 65535 f ");for(var e=1;e<=E;e++)"function"==typeof M[e]?q((g+M[e]()).slice(-10)+" 00000 n "):void 0!==M[e]?q((g+M[e]).slice(-10)+" 00000 n "):q("0000000000 00000 n ")},ue=A.__private__.buildDocument=function(){E=0,j=0,U=[],M=[],Q=[],Lg=Fg(),zg=Fg(),O(U),Wg.publish("buildDocument"),Ae(),Dg(),function(){Wg.publish("putAdditionalObjects");for(var g=0;g<Q.length;g++){var e=Q[g];Kg(e.objId,!0),q(e.content),q("endobj")}Wg.publish("postPutAdditionalObjects")}(),ge(),null!==r&&(Ze.oid=Hg(),q("<<"),q("/Filter /Standard"),q("/V "+Ze.v),q("/R "+Ze.r),q("/U <"+Ze.toHexString(Ze.U)+">"),q("/O <"+Ze.toHexString(Ze.O)+">"),q("/P "+Ze.P),q(">>"),q("endobj")),re(),ce();var g=j;return de(),se(),q("startxref"),q(""+g),q("%%EOF"),O(D[x]),U.join("\n")},me=A.__private__.getBlob=function(g){return new Blob([$(g)],{type:"application/pdf"})},he=A.output=A.__private__.output=(Ng=function(g,e){switch("string"==typeof(e=e||{})?e={filename:e}:e.filename=e.filename||"generated.pdf",g){case void 0:return ue();case"save":A.save(e.filename);break;case"arraybuffer":return $(ue());case"blob":return me(ue());case"bloburi":case"bloburl":if(void 0!==sC.URL&&"function"==typeof sC.URL.createObjectURL)return sC.URL&&sC.URL.createObjectURL(me(ue()))||void 0;dC.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var t="",I=ue();try{t=ZC(I)}catch(g){t=ZC(unescape(encodeURIComponent(I)))}return"data:application/pdf;filename="+e.filename+";base64,"+t;case"pdfobjectnewwindow":if("[object Window]"===Object.prototype.toString.call(sC)){var n="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",C=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';e.pdfObjectUrl&&(n=e.pdfObjectUrl,C="");var l='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+n+'"'+C+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(e)+");<\/script></body></html>",a=sC.open();return null!==a&&a.document.write(l),a}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if("[object Window]"===Object.prototype.toString.call(sC)){var o='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(e.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+e.filename+'" width="500px" height="400px" /></body></html>',i=sC.open();if(null!==i){i.document.write(o);var r=this;i.document.documentElement.querySelector("#pdfViewer").onload=function(){i.document.title=e.filename,i.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(r.output("bloburl"))}}return i}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if("[object Window]"!==Object.prototype.toString.call(sC))throw new Error("The option dataurlnewwindow just works in a browser-environment.");var c='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",e)+'"></iframe></body></html>',s=sC.open();if(null!==s&&(s.document.write(c),s.document.title=e.filename),s||"undefined"==typeof safari)return s;break;case"datauri":case"dataurl":return sC.document.location.href=this.output("datauristring",e);default:return null}},Ng.foo=function(){try{return Ng.apply(this,arguments)}catch(Ng){var g=Ng.stack||"";~g.indexOf(" at ")&&(g=g.split(" at ")[1]);var e="Error in function "+g.split("\n")[0].split("<")[0]+": "+Ng.message;if(!sC.console)throw new Error(e);sC.console.error(e,Ng),sC.alert&&alert(e)}},Ng.foo.bar=Ng,Ng.foo),be=function(g){return!0===Array.isArray(Vg)&&Vg.indexOf(g)>-1};switch(I){case"pt":sg=1;break;case"mm":sg=72/25.4;break;case"cm":sg=72/2.54;break;case"in":sg=72;break;case"px":sg=1==be("px_scaling")?.75:96/72;break;case"pc":case"em":sg=12;break;case"ex":sg=6;break;default:if("number"!=typeof I)throw new Error("Invalid unit: "+I);sg=I}var Ze=null;F(),w();var pe=A.__private__.getPageInfo=A.getPageInfo=function(g){if(isNaN(g)||g%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:fg[g].objId,pageNumber:g,pageContext:fg[g]}},Ge=A.__private__.getPageInfoByObjId=function(g){if(isNaN(g)||g%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var e in fg)if(fg[e].objId===g)break;return pe(e)},ye=A.__private__.getCurrentPageInfo=A.getCurrentPageInfo=function(){return{objId:fg[x].objId,pageNumber:x,pageContext:fg[x]}};A.addPage=function(){return Ce.apply(this,arguments),this},A.setPage=function(){return ae.apply(this,arguments),O.call(this,D[x]),this},A.insertPage=function(g){return this.addPage(),this.movePage(x,g),this},A.movePage=function(g,e){var t,I;if(g>e){t=D[g],I=fg[g];for(var n=g;n>e;n--)D[n]=D[n-1],fg[n]=fg[n-1];D[e]=t,fg[e]=I,this.setPage(e)}else if(g<e){t=D[g],I=fg[g];for(var C=g;C<e;C++)D[C]=D[C+1],fg[C]=fg[C+1];D[e]=t,fg[e]=I,this.setPage(e)}return this},A.deletePage=function(){return le.apply(this,arguments),this},A.__private__.text=A.text=function(g,e,t,I,n){var C,l,a,o,i,r,c,A,d,u=(I=I||{}).scope||this;if("number"==typeof g&&"number"==typeof e&&("string"==typeof t||Array.isArray(t))){var m=t;t=e,e=g,g=m}if(arguments[3]instanceof kg==0?(a=arguments[4],o=arguments[5],"object"===(0,un.A)(c=arguments[3])&&null!==c||("string"==typeof a&&(o=a,a=null),"string"==typeof c&&(o=c,c=null),"number"==typeof c&&(a=c,c=null),I={flags:c,angle:a,align:o})):(f("The transform parameter of text() with a Matrix value"),d=n),isNaN(e)||isNaN(t)||null==g)throw new Error("Invalid arguments passed to jsPDF.text");if(0===g.length)return u;var h,b="",G="number"==typeof I.lineHeightFactor?I.lineHeightFactor:He,y=u.internal.scaleFactor;function B(g){return g=g.split("\t").join(Array(I.TabLen||9).join(" ")),Ie(g,c)}function W(g){for(var e,t=g.concat(),I=[],n=t.length;n--;)"string"==typeof(e=t.shift())?I.push(e):Array.isArray(g)&&(1===e.length||void 0===e[1]&&void 0===e[2])?I.push(e[0]):I.push([e[0],e[1],e[2]]);return I}function V(g,e){var t;if("string"==typeof g)t=e(g)[0];else if(Array.isArray(g)){for(var I,n,C=g.concat(),l=[],a=C.length;a--;)"string"==typeof(I=C.shift())?l.push(e(I)[0]):Array.isArray(I)&&"string"==typeof I[0]&&(n=e(I[0],I[1],I[2]),l.push([n[0],n[1],n[2]]));t=l}return t}var v=!1,X=!0;if("string"==typeof g)v=!0;else if(Array.isArray(g)){var k=g.concat();l=[];for(var J,Y=k.length;Y--;)("string"!=typeof(J=k.shift())||Array.isArray(J)&&"string"!=typeof J[0])&&(X=!1);v=X}if(!1===v)throw new Error('Type of text must be string or Array. "'+g+'" is not recognized.');"string"==typeof g&&(g=g.match(/[\r?\n]/)?g.split(/\r\n|\r|\n/g):[g]);var w=eg/u.internal.scaleFactor,N=w*(G-1);switch(I.baseline){case"bottom":t-=N;break;case"top":t+=w-N;break;case"hanging":t+=w-2*N;break;case"middle":t+=w/2-N}if((r=I.maxWidth||0)>0&&("string"==typeof g?g=u.splitTextToSize(g,r):"[object Array]"===Object.prototype.toString.call(g)&&(g=g.reduce((function(g,e){return g.concat(u.splitTextToSize(e,r))}),[]))),C={text:g,x:e,y:t,options:I,mutex:{pdfEscape:Ie,activeFontKey:cg,fonts:mg,activeFontSize:eg}},Wg.publish("preProcessText",C),g=C.text,a=(I=C.options).angle,d instanceof kg==0&&a&&"number"==typeof a){a*=Math.PI/180,0===I.rotationDirection&&(a=-a),p===Z&&(a=-a);var H=Math.cos(a),F=Math.sin(a);d=new kg(H,F,-F,H,0,0)}else a&&a instanceof kg&&(d=a);p!==Z||d||(d=Yg),void 0!==(i=I.charSpace||qe)&&(b+=S(R(i))+" Tc\n",this.setCharSpace(this.getCharSpace()||0)),void 0!==(A=I.horizontalScale)&&(b+=S(100*A)+" Tz\n"),I.lang;var K=-1,x=void 0!==I.renderingMode?I.renderingMode:I.stroke,L=u.internal.getCurrentPageInfo().pageContext;switch(x){case 0:case!1:case"fill":K=0;break;case 1:case!0:case"stroke":K=1;break;case 2:case"fillThenStroke":K=2;break;case 3:case"invisible":K=3;break;case 4:case"fillAndAddForClipping":K=4;break;case 5:case"strokeAndAddPathForClipping":K=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":K=6;break;case 7:case"addToPathForClipping":K=7}var z=void 0!==L.usedRenderingMode?L.usedRenderingMode:-1;-1!==K?b+=K+" Tr\n":-1!==z&&(b+="0 Tr\n"),-1!==K&&(L.usedRenderingMode=K),o=I.align||"left";var E,M=eg*G,U=u.internal.pageSize.getWidth(),j=mg[cg];i=I.charSpace||qe,r=I.maxWidth||0,c=Object.assign({autoencode:!0,noBOM:!0},I.flags);var Q=[],D=function(g){return u.getStringUnitWidth(g,{font:j,charSpace:i,fontSize:eg,doKerning:!1})*eg/y};if("[object Array]"===Object.prototype.toString.call(g)){var T;l=W(g),"left"!==o&&(E=l.map(D));var P,O=0;if("right"===o){e-=E[0],g=[],Y=l.length;for(var _=0;_<Y;_++)0===_?(P=Me(e),T=Ue(t)):(P=R(O-E[_]),T=-M),g.push([l[_],P,T]),O=E[_]}else if("center"===o){e-=E[0]/2,g=[],Y=l.length;for(var $=0;$<Y;$++)0===$?(P=Me(e),T=Ue(t)):(P=R((O-E[$])/2),T=-M),g.push([l[$],P,T]),O=E[$]}else if("left"===o){g=[],Y=l.length;for(var gg=0;gg<Y;gg++)g.push(l[gg])}else if("justify"===o&&"Identity-H"===j.encoding){g=[],Y=l.length,r=0!==r?r:U;for(var tg=0,Ig=0;Ig<Y;Ig++)if(T=0===Ig?Ue(t):-M,P=0===Ig?Me(e):tg,Ig<Y-1){var Cg=R((r-E[Ig])/(l[Ig].split(" ").length-1)),lg=l[Ig].split(" ");g.push([lg[0]+" ",P,T]),tg=0;for(var ag=1;ag<lg.length;ag++){var og=(D(lg[ag-1]+" "+lg[ag])-D(lg[ag]))*y+Cg;ag==lg.length-1?g.push([lg[ag],og,0]):g.push([lg[ag]+" ",og,0]),tg-=og}}else g.push([l[Ig],P,T]);g.push(["",tg,0])}else{if("justify"!==o)throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(g=[],Y=l.length,r=0!==r?r:U,Ig=0;Ig<Y;Ig++)T=0===Ig?Ue(t):-M,P=0===Ig?Me(e):0,Ig<Y-1?Q.push(S(R((r-E[Ig])/(l[Ig].split(" ").length-1)))):Q.push(0),g.push([l[Ig],P,T])}}!0===("boolean"==typeof I.R2L?I.R2L:ng)&&(g=V(g,(function(g,e,t){return[g.split("").reverse().join(""),e,t]}))),C={text:g,x:e,y:t,options:I,mutex:{pdfEscape:Ie,activeFontKey:cg,fonts:mg,activeFontSize:eg}},Wg.publish("postProcessText",C),g=C.text,h=C.mutex.isHex||!1;var ig=mg[cg].encoding;"WinAnsiEncoding"!==ig&&"StandardEncoding"!==ig||(g=V(g,(function(g,e,t){return[B(g),e,t]}))),l=W(g),g=[];for(var rg,sg,Ag,dg=Array.isArray(l[0])?1:0,ug="",hg=function(g,e,t){var n="";return t instanceof kg?(t="number"==typeof I.angle?Jg(t,new kg(1,0,0,1,g,e)):Jg(new kg(1,0,0,1,g,e),t),p===Z&&(t=Jg(new kg(1,0,0,-1,0,0),t)),n=t.join(" ")+" Tm\n"):n=S(g)+" "+S(e)+" Td\n",n},bg=0;bg<l.length;bg++){switch(ug="",dg){case 1:Ag=(h?"<":"(")+l[bg][0]+(h?">":")"),rg=parseFloat(l[bg][1]),sg=parseFloat(l[bg][2]);break;case 0:Ag=(h?"<":"(")+l[bg]+(h?">":")"),rg=Me(e),sg=Ue(t)}void 0!==Q&&void 0!==Q[bg]&&(ug=Q[bg]+" Tw\n"),0===bg?g.push(ug+hg(rg,sg,d)+Ag):0===dg?g.push(ug+Ag):1===dg&&g.push(ug+hg(rg,sg,d)+Ag)}g=0===dg?g.join(" Tj\nT* "):g.join(" Tj\n"),g+=" Tj\n";var Zg="BT\n/";return Zg+=cg+" "+eg+" Tf\n",Zg+=S(eg*G)+" TL\n",Zg+=Pe+"\n",Zg+=b,Zg+=g,q(Zg+="ET"),s[cg]=!0,u};var Be=A.__private__.clip=A.clip=function(g){return q("evenodd"===g?"W*":"W"),this};A.clipEvenOdd=function(){return Be("evenodd")},A.__private__.discardPath=A.discardPath=function(){return q("n"),this};var Se=A.__private__.isValidStyle=function(g){var e=!1;return-1!==[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(g)&&(e=!0),e};A.__private__.setDefaultPathOperation=A.setDefaultPathOperation=function(g){return Se(g)&&(i=g),this};var fe=A.__private__.getStyle=A.getStyle=function(g){var e=i;switch(g){case"D":case"S":e="S";break;case"F":e="f";break;case"FD":case"DF":e="B";break;case"f":case"f*":case"B":case"B*":e=g}return e},We=A.close=function(){return q("h"),this};A.stroke=function(){return q("S"),this},A.fill=function(g){return Ve("f",g),this},A.fillEvenOdd=function(g){return Ve("f*",g),this},A.fillStroke=function(g){return Ve("B",g),this},A.fillStrokeEvenOdd=function(g){return Ve("B*",g),this};var Ve=function(g,e){"object"===(0,un.A)(e)?Xe(e,g):q(g)},ve=function(g){null===g||p===Z&&void 0===g||(g=fe(g),q(g))};function Re(g,e,t,I,n){var C=new UC(e||this.boundingBox,t||this.xStep,I||this.yStep,this.gState,n||this.matrix);C.stream=this.stream;var l=g+"$$"+this.cloneIndex+++"$$";return wg(l,C),C}var Xe=function(g,e){var t=pg[g.key],I=Zg[t];if(I instanceof MC)q("q"),q(ke(e)),I.gState&&A.setGState(I.gState),q(g.matrix.toString()+" cm"),q("/"+t+" sh"),q("Q");else if(I instanceof UC){var n=new kg(1,0,0,-1,0,it());g.matrix&&(n=n.multiply(g.matrix||Yg),t=Re.call(I,g.key,g.boundingBox,g.xStep,g.yStep,n).id),q("q"),q("/Pattern cs"),q("/"+t+" scn"),I.gState&&A.setGState(I.gState),q(e),q("Q")}},ke=function(g){switch(g){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Je=A.moveTo=function(g,e){return q(S(R(g))+" "+S(X(e))+" m"),this},Ye=A.lineTo=function(g,e){return q(S(R(g))+" "+S(X(e))+" l"),this},we=A.curveTo=function(g,e,t,I,n,C){return q([S(R(g)),S(X(e)),S(R(t)),S(X(I)),S(R(n)),S(X(C)),"c"].join(" ")),this};A.__private__.line=A.line=function(g,e,t,I,n){if(isNaN(g)||isNaN(e)||isNaN(t)||isNaN(I)||!Se(n))throw new Error("Invalid arguments passed to jsPDF.line");return p===b?this.lines([[t-g,I-e]],g,e,[1,1],n||"S"):this.lines([[t-g,I-e]],g,e,[1,1]).stroke()},A.__private__.lines=A.lines=function(g,e,t,I,n,C){var l,a,o,i,r,c,s,A,d,u,m,h;if("number"==typeof g&&(h=t,t=e,e=g,g=h),I=I||[1,1],C=C||!1,isNaN(e)||isNaN(t)||!Array.isArray(g)||!Array.isArray(I)||!Se(n)||"boolean"!=typeof C)throw new Error("Invalid arguments passed to jsPDF.lines");for(Je(e,t),l=I[0],a=I[1],i=g.length,u=e,m=t,o=0;o<i;o++)2===(r=g[o]).length?(u=r[0]*l+u,m=r[1]*a+m,Ye(u,m)):(c=r[0]*l+u,s=r[1]*a+m,A=r[2]*l+u,d=r[3]*a+m,u=r[4]*l+u,m=r[5]*a+m,we(c,s,A,d,u,m));return C&&We(),ve(n),this},A.path=function(g){for(var e=0;e<g.length;e++){var t=g[e],I=t.c;switch(t.op){case"m":Je(I[0],I[1]);break;case"l":Ye(I[0],I[1]);break;case"c":we.apply(this,I);break;case"h":We()}}return this},A.__private__.rect=A.rect=function(g,e,t,I,n){if(isNaN(g)||isNaN(e)||isNaN(t)||isNaN(I)||!Se(n))throw new Error("Invalid arguments passed to jsPDF.rect");return p===b&&(I=-I),q([S(R(g)),S(X(e)),S(R(t)),S(R(I)),"re"].join(" ")),ve(n),this},A.__private__.triangle=A.triangle=function(g,e,t,I,n,C,l){if(isNaN(g)||isNaN(e)||isNaN(t)||isNaN(I)||isNaN(n)||isNaN(C)||!Se(l))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[t-g,I-e],[n-t,C-I],[g-n,e-C]],g,e,[1,1],l,!0),this},A.__private__.roundedRect=A.roundedRect=function(g,e,t,I,n,C,l){if(isNaN(g)||isNaN(e)||isNaN(t)||isNaN(I)||isNaN(n)||isNaN(C)||!Se(l))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var a=4/3*(Math.SQRT2-1);return n=Math.min(n,.5*t),C=Math.min(C,.5*I),this.lines([[t-2*n,0],[n*a,0,n,C-C*a,n,C],[0,I-2*C],[0,C*a,-n*a,C,-n,C],[2*n-t,0],[-n*a,0,-n,-C*a,-n,-C],[0,2*C-I],[0,-C*a,n*a,-C,n,-C]],g+n,e,[1,1],l,!0),this},A.__private__.ellipse=A.ellipse=function(g,e,t,I,n){if(isNaN(g)||isNaN(e)||isNaN(t)||isNaN(I)||!Se(n))throw new Error("Invalid arguments passed to jsPDF.ellipse");var C=4/3*(Math.SQRT2-1)*t,l=4/3*(Math.SQRT2-1)*I;return Je(g+t,e),we(g+t,e-l,g+C,e-I,g,e-I),we(g-C,e-I,g-t,e-l,g-t,e),we(g-t,e+l,g-C,e+I,g,e+I),we(g+C,e+I,g+t,e+l,g+t,e),ve(n),this},A.__private__.circle=A.circle=function(g,e,t,I){if(isNaN(g)||isNaN(e)||isNaN(t)||!Se(I))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(g,e,t,t,I)},A.setFont=function(g,e,t){return t&&(e=B(e,t)),cg=ie(g,e,{disableWarning:!1}),this};var Ne=A.__private__.getFont=A.getFont=function(){return mg[ie.apply(A,arguments)]};A.__private__.getFontList=A.getFontList=function(){var g,e,t={};for(g in hg)if(hg.hasOwnProperty(g))for(e in t[g]=[],hg[g])hg[g].hasOwnProperty(e)&&t[g].push(e);return t},A.addFont=function(g,e,t,I,n){var C=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&-1!==C.indexOf(arguments[3])?n=arguments[3]:arguments[3]&&-1==C.indexOf(arguments[3])&&(t=B(t,I)),te.call(this,g,e,t,n=n||"Identity-H")};var He,Fe=g.lineWidth||.200025,Ke=A.__private__.getLineWidth=A.getLineWidth=function(){return Fe},xe=A.__private__.setLineWidth=A.setLineWidth=function(g){return Fe=g,q(S(R(g))+" w"),this};A.__private__.setLineDash=jC.API.setLineDash=jC.API.setLineDashPattern=function(g,e){if(g=g||[],e=e||0,isNaN(e)||!Array.isArray(g))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return g=g.map((function(g){return S(R(g))})).join(" "),e=S(R(e)),q("["+g+"] "+e+" d"),this};var Le=A.__private__.getLineHeight=A.getLineHeight=function(){return eg*He};A.__private__.getLineHeight=A.getLineHeight=function(){return eg*He};var ze=A.__private__.setLineHeightFactor=A.setLineHeightFactor=function(g){return"number"==typeof(g=g||1.15)&&(He=g),this},Ee=A.__private__.getLineHeightFactor=A.getLineHeightFactor=function(){return He};ze(g.lineHeight);var Me=A.__private__.getHorizontalCoordinate=function(g){return R(g)},Ue=A.__private__.getVerticalCoordinate=function(g){return p===Z?g:fg[x].mediaBox.topRightY-fg[x].mediaBox.bottomLeftY-R(g)},je=A.__private__.getHorizontalCoordinateString=A.getHorizontalCoordinateString=function(g){return S(Me(g))},Qe=A.__private__.getVerticalCoordinateString=A.getVerticalCoordinateString=function(g){return S(Ue(g))},De=g.strokeColor||"0 G";A.__private__.getStrokeColor=A.getDrawColor=function(){return Eg(De)},A.__private__.setStrokeColor=A.setDrawColor=function(g,e,t,I){return De=Mg({ch1:g,ch2:e,ch3:t,ch4:I,pdfColorType:"draw",precision:2}),q(De),this};var Te=g.fillColor||"0 g";A.__private__.getFillColor=A.getFillColor=function(){return Eg(Te)},A.__private__.setFillColor=A.setFillColor=function(g,e,t,I){return Te=Mg({ch1:g,ch2:e,ch3:t,ch4:I,pdfColorType:"fill",precision:2}),q(Te),this};var Pe=g.textColor||"0 g",Oe=A.__private__.getTextColor=A.getTextColor=function(){return Eg(Pe)};A.__private__.setTextColor=A.setTextColor=function(g,e,t,I){return Pe=Mg({ch1:g,ch2:e,ch3:t,ch4:I,pdfColorType:"text",precision:3}),this};var qe=g.charSpace,_e=A.__private__.getCharSpace=A.getCharSpace=function(){return parseFloat(qe||0)};A.__private__.setCharSpace=A.setCharSpace=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return qe=g,this};var $e=0;A.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},A.__private__.setLineCap=A.setLineCap=function(g){var e=A.CapJoinStyles[g];if(void 0===e)throw new Error("Line cap style of '"+g+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return $e=e,q(e+" J"),this};var gt=0;A.__private__.setLineJoin=A.setLineJoin=function(g){var e=A.CapJoinStyles[g];if(void 0===e)throw new Error("Line join style of '"+g+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return gt=e,q(e+" j"),this},A.__private__.setLineMiterLimit=A.__private__.setMiterLimit=A.setLineMiterLimit=A.setMiterLimit=function(g){if(g=g||0,isNaN(g))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return q(S(R(g))+" M"),this},A.GState=zC,A.setGState=function(g){(g="string"==typeof g?Gg[yg[g]]:et(null,g)).equals(Bg)||(q("/"+g.id+" gs"),Bg=g)};var et=function(g,e){if(!g||!yg[g]){var t=!1;for(var I in Gg)if(Gg.hasOwnProperty(I)&&Gg[I].equals(e)){t=!0;break}if(t)e=Gg[I];else{var n="GS"+(Object.keys(Gg).length+1).toString(10);Gg[n]=e,e.id=n}return g&&(yg[g]=e.id),Wg.publish("addGState",e),e}};A.addGState=function(g,e){return et(g,e),this},A.saveGraphicsState=function(){return q("q"),bg.push({key:cg,size:eg,color:Pe}),this},A.restoreGraphicsState=function(){q("Q");var g=bg.pop();return cg=g.key,eg=g.size,Pe=g.color,Bg=null,this},A.setCurrentTransformationMatrix=function(g){return q(g.toString()+" cm"),this},A.comment=function(g){return q("#"+g),this};var tt=function(g,e){var t=g||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return t},set:function(g){isNaN(g)||(t=parseFloat(g))}});var I=e||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return I},set:function(g){isNaN(g)||(I=parseFloat(g))}});var n="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return n},set:function(g){n=g.toString()}}),this},It=function(g,e,t,I){tt.call(this,g,e),this.type="rect";var n=t||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return n},set:function(g){isNaN(g)||(n=parseFloat(g))}});var C=I||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return C},set:function(g){isNaN(g)||(C=parseFloat(g))}}),this},nt=function(){this.page=Sg,this.currentPage=x,this.pages=D.slice(0),this.pagesContext=fg.slice(0),this.x=Ag,this.y=dg,this.matrix=ug,this.width=at(x),this.height=it(x),this.outputDestination=P,this.id="",this.objectNumber=-1};nt.prototype.restore=function(){Sg=this.page,x=this.currentPage,fg=this.pagesContext,D=this.pages,Ag=this.x,dg=this.y,ug=this.matrix,ot(x,this.width),rt(x,this.height),P=this.outputDestination};var Ct=function(g,e,t,I,n){Xg.push(new nt),Sg=x=0,D=[],Ag=g,dg=e,ug=n,ne([t,I])};for(var lt in A.beginFormObject=function(g,e,t,I,n){return Ct(g,e,t,I,n),this},A.endFormObject=function(g){return function(g){if(Rg[g])Xg.pop().restore();else{var e=new nt,t="Xo"+(Object.keys(vg).length+1).toString(10);e.id=t,Rg[g]=t,vg[t]=e,Wg.publish("addFormObject",e),Xg.pop().restore()}}(g),this},A.doFormObject=function(g,e){var t=vg[Rg[g]];return q("q"),q(e.toString()+" cm"),q("/"+t.id+" Do"),q("Q"),this},A.getFormObject=function(g){var e=vg[Rg[g]];return{x:e.x,y:e.y,width:e.width,height:e.height,matrix:e.matrix}},A.save=function(g,e){return g=g||"generated.pdf",(e=e||{}).returnPromise=e.returnPromise||!1,!1===e.returnPromise?(pC(me(ue()),g),"function"==typeof pC.unload&&sC.setTimeout&&setTimeout(pC.unload,911),this):new Promise((function(e,t){try{var I=pC(me(ue()),g);"function"==typeof pC.unload&&sC.setTimeout&&setTimeout(pC.unload,911),e(I)}catch(g){t(g.message)}}))},jC.API)jC.API.hasOwnProperty(lt)&&("events"===lt&&jC.API.events.length?function(g,e){var t,I,n;for(n=e.length-1;-1!==n;n--)t=e[n][0],I=e[n][1],g.subscribe.apply(g,[t].concat("function"==typeof I?[I]:I))}(Wg,jC.API.events):A[lt]=jC.API[lt]);var at=A.getPageWidth=function(g){return(fg[g=g||x].mediaBox.topRightX-fg[g].mediaBox.bottomLeftX)/sg},ot=A.setPageWidth=function(g,e){fg[g].mediaBox.topRightX=e*sg+fg[g].mediaBox.bottomLeftX},it=A.getPageHeight=function(g){return(fg[g=g||x].mediaBox.topRightY-fg[g].mediaBox.bottomLeftY)/sg},rt=A.setPageHeight=function(g,e){fg[g].mediaBox.topRightY=e*sg+fg[g].mediaBox.bottomLeftY};return A.internal={pdfEscape:Ie,getStyle:fe,getFont:Ne,getFontSize:Ig,getCharSpace:_e,getTextColor:Oe,getLineHeight:Le,getLineHeightFactor:Ee,getLineWidth:Ke,write:_,getHorizontalCoordinate:Me,getVerticalCoordinate:Ue,getCoordinateString:je,getVerticalCoordinateString:Qe,collections:{},newObject:Hg,newAdditionalObject:xg,newObjectDeferred:Fg,newObjectDeferredBegin:Kg,getFilters:Ug,putStream:jg,events:Wg,scaleFactor:sg,pageSize:{getWidth:function(){return at(x)},setWidth:function(g){ot(x,g)},getHeight:function(){return it(x)},setHeight:function(g){rt(x,g)}},encryptionOptions:r,encryption:Ze,getEncryptor:function(g){return null!==r?Ze.encryptor(g,0):function(g){return g}},output:he,getNumberOfPages:oe,pages:D,out:q,f2:V,f3:v,getPageInfo:pe,getPageInfoByObjId:Ge,getCurrentPageInfo:ye,getPDFVersion:u,Point:tt,Rectangle:It,Matrix:kg,hasHotfix:be},Object.defineProperty(A.internal.pageSize,"width",{get:function(){return at(x)},set:function(g){ot(x,g)},enumerable:!0,configurable:!0}),Object.defineProperty(A.internal.pageSize,"height",{get:function(){return it(x)},set:function(g){rt(x,g)},enumerable:!0,configurable:!0}),function(g){for(var e=0,t=gg.length;e<t;e++){var I=te.call(this,g[e][0],g[e][1],g[e][2],gg[e][3],!0);!1===c&&(s[I]=!0);var n=g[e][0].split("-");ee({id:I,fontName:n[0],fontStyle:n[1]||""})}Wg.publish("addFonts",{fonts:mg,dictionary:hg})}.call(A,gg),cg="F1",Ce(n,t),Wg.publish("initialized"),A}KC.prototype.lsbFirstWord=function(g){return String.fromCharCode(255&g,g>>8&255,g>>16&255,g>>24&255)},KC.prototype.toHexString=function(g){return g.split("").map((function(g){return("0"+(255&g.charCodeAt(0)).toString(16)).slice(-2)})).join("")},KC.prototype.hexToBytes=function(g){for(var e=[],t=0;t<g.length;t+=2)e.push(String.fromCharCode(parseInt(g.substr(t,2),16)));return e.join("")},KC.prototype.processOwnerPassword=function(g,e){return HC(YC(e).substr(0,5),g)},KC.prototype.encryptor=function(g,e){var t=YC(this.encryptionKey+String.fromCharCode(255&g,g>>8&255,g>>16&255,255&e,e>>8&255)).substr(0,10);return function(g){return HC(t,g)}},zC.prototype.equals=function(g){var e,t="id,objectNumber,equals";if(!g||(0,un.A)(g)!==(0,un.A)(this))return!1;var I=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!g.hasOwnProperty(e))return!1;if(this[e]!==g[e])return!1;I++}for(e in g)g.hasOwnProperty(e)&&t.indexOf(e)<0&&I--;return 0===I},jC.API={events:[]},jC.version="3.0.1";var QC=jC.API,DC=1,TC=function(g){return g.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},PC=function(g){return g.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},OC=function(g){return g.toFixed(2)},qC=function(g){return g.toFixed(5)};QC.__acroform__={};var _C=function(g,e){g.prototype=Object.create(e.prototype),g.prototype.constructor=g},$C=function(g){return g*DC},gl=function(g){var e=new hl,t=kl.internal.getHeight(g)||0,I=kl.internal.getWidth(g)||0;return e.BBox=[0,0,Number(OC(I)),Number(OC(t))],e},el=QC.__acroform__.setBit=function(g,e){if(g=g||0,e=e||0,isNaN(g)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return g|1<<e},tl=QC.__acroform__.clearBit=function(g,e){if(g=g||0,e=e||0,isNaN(g)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return g&~(1<<e)},Il=QC.__acroform__.getBit=function(g,e){if(isNaN(g)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return 0==(g&1<<e)?0:1},nl=QC.__acroform__.getBitForPdf=function(g,e){if(isNaN(g)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Il(g,e-1)},Cl=QC.__acroform__.setBitForPdf=function(g,e){if(isNaN(g)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return el(g,e-1)},ll=QC.__acroform__.clearBitForPdf=function(g,e){if(isNaN(g)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return tl(g,e-1)},al=QC.__acroform__.calculateCoordinates=function(g,e){var t=e.internal.getHorizontalCoordinate,I=e.internal.getVerticalCoordinate,n=g[0],C=g[1],l=g[2],a=g[3],o={};return o.lowerLeft_X=t(n)||0,o.lowerLeft_Y=I(C+a)||0,o.upperRight_X=t(n+l)||0,o.upperRight_Y=I(C)||0,[Number(OC(o.lowerLeft_X)),Number(OC(o.lowerLeft_Y)),Number(OC(o.upperRight_X)),Number(OC(o.upperRight_Y))]},ol=function(g){if(g.appearanceStreamContent)return g.appearanceStreamContent;if(g.V||g.DV){var e=[],t=g._V||g.DV,I=il(g,t),n=g.scope.internal.getFont(g.fontName,g.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(g.scope.__private__.encodeColorString(g.color)),e.push("/"+n+" "+OC(I.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(I.text),e.push("ET"),e.push("Q"),e.push("EMC");var C=gl(g);return C.scope=g.scope,C.stream=e.join("\n"),C}},il=function(g,e){var t=0===g.fontSize?g.maxFontSize:g.fontSize,I={text:"",fontSize:""},n=(e=")"==(e="("==e.substr(0,1)?e.substr(1):e).substr(e.length-1)?e.substr(0,e.length-1):e).split(" ");n=g.multiline?n.map((function(g){return g.split("\n")})):n.map((function(g){return[g]}));var C=t,l=kl.internal.getHeight(g)||0;l=l<0?-l:l;var a=kl.internal.getWidth(g)||0;a=a<0?-a:a;var o=function(e,t,I){if(e+1<n.length){var C=t+" "+n[e+1][0];return rl(C,g,I).width<=a-4}return!1};C++;g:for(;C>0;){e="",C--;var i,r,c=rl("3",g,C).height,s=g.multiline?l-C:(l-c)/2,A=s+=2,d=0,u=0,m=0;if(C<=0){e="(...) Tj\n",e+="% Width of Text: "+rl(e,g,C=12).width+", FieldWidth:"+a+"\n";break}for(var h="",b=0,Z=0;Z<n.length;Z++)if(n.hasOwnProperty(Z)){var p=!1;if(1!==n[Z].length&&m!==n[Z].length-1){if((c+2)*(b+2)+2>l)continue g;h+=n[Z][m],p=!0,u=Z,Z--}else{h=" "==(h+=n[Z][m]+" ").substr(h.length-1)?h.substr(0,h.length-1):h;var G=parseInt(Z),y=o(G,h,C),B=Z>=n.length-1;if(y&&!B){h+=" ",m=0;continue}if(y||B){if(B)u=G;else if(g.multiline&&(c+2)*(b+2)+2>l)continue g}else{if(!g.multiline)continue g;if((c+2)*(b+2)+2>l)continue g;u=G}}for(var S="",f=d;f<=u;f++){var W=n[f];if(g.multiline){if(f===u){S+=W[m]+" ",m=(m+1)%W.length;continue}if(f===d){S+=W[W.length-1]+" ";continue}}S+=W[0]+" "}switch(S=" "==S.substr(S.length-1)?S.substr(0,S.length-1):S,r=rl(S,g,C).width,g.textAlign){case"right":i=a-r-2;break;case"center":i=(a-r)/2;break;default:i=2}e+=OC(i)+" "+OC(A)+" Td\n",e+="("+TC(S)+") Tj\n",e+=-OC(i)+" 0 Td\n",A=-(C+2),r=0,d=p?u:u+1,b++,h=""}break}return I.text=e,I.fontSize=C,I},rl=function(g,e,t){var I=e.scope.internal.getFont(e.fontName,e.fontStyle),n=e.scope.getStringUnitWidth(g,{font:I,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:I,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:n}},cl={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},sl=function(g,e){var t={type:"reference",object:g};void 0===e.internal.getPageInfo(g.page).pageContext.annotations.find((function(g){return g.type===t.type&&g.object===t.object}))&&e.internal.getPageInfo(g.page).pageContext.annotations.push(t)},Al=function(g,e){if(e.scope=g,void 0!==g.internal&&(void 0===g.internal.acroformPlugin||!1===g.internal.acroformPlugin.isInitialized)){if(Zl.FieldNum=0,g.internal.acroformPlugin=JSON.parse(JSON.stringify(cl)),g.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");DC=g.internal.scaleFactor,g.internal.acroformPlugin.acroFormDictionaryRoot=new bl,g.internal.acroformPlugin.acroFormDictionaryRoot.scope=g,g.internal.acroformPlugin.acroFormDictionaryRoot._eventID=g.internal.events.subscribe("postPutResources",(function(){var e;(e=g).internal.events.unsubscribe(e.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete e.internal.acroformPlugin.acroFormDictionaryRoot._eventID,e.internal.acroformPlugin.printedOut=!0})),g.internal.events.subscribe("buildDocument",(function(){!function(g){g.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var e=g.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var t in e)if(e.hasOwnProperty(t)){var I=e[t];I.objId=void 0,I.hasAnnotation&&sl(I,g)}}(g)})),g.internal.events.subscribe("putCatalog",(function(){!function(g){if(void 0===g.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("putCatalogCallback: Root missing.");g.internal.write("/AcroForm "+g.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")}(g)})),g.internal.events.subscribe("postPutPages",(function(e){!function(g,e){var t=!g;for(var I in g||(e.internal.newObjectDeferredBegin(e.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),e.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),g=g||e.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(g.hasOwnProperty(I)){var n=g[I],C=[],l=n.Rect;if(n.Rect&&(n.Rect=al(n.Rect,e)),e.internal.newObjectDeferredBegin(n.objId,!0),n.DA=kl.createDefaultAppearanceStream(n),"object"===(0,un.A)(n)&&"function"==typeof n.getKeyValueListForStream&&(C=n.getKeyValueListForStream()),n.Rect=l,n.hasAppearanceStream&&!n.appearanceStreamContent){var a=ol(n);C.push({key:"AP",value:"<</N "+a+">>"}),e.internal.acroformPlugin.xForms.push(a)}if(n.appearanceStreamContent){var o="";for(var i in n.appearanceStreamContent)if(n.appearanceStreamContent.hasOwnProperty(i)){var r=n.appearanceStreamContent[i];if(o+="/"+i+" ",o+="<<",Object.keys(r).length>=1||Array.isArray(r)){for(var I in r)if(r.hasOwnProperty(I)){var c=r[I];"function"==typeof c&&(c=c.call(e,n)),o+="/"+I+" "+c+" ",e.internal.acroformPlugin.xForms.indexOf(c)>=0||e.internal.acroformPlugin.xForms.push(c)}}else"function"==typeof(c=r)&&(c=c.call(e,n)),o+="/"+I+" "+c,e.internal.acroformPlugin.xForms.indexOf(c)>=0||e.internal.acroformPlugin.xForms.push(c);o+=">>"}C.push({key:"AP",value:"<<\n"+o+">>"})}e.internal.putStream({additionalKeyValues:C,objectId:n.objId}),e.internal.out("endobj")}t&&function(g,e){for(var t in g)if(g.hasOwnProperty(t)){var I=t,n=g[t];e.internal.newObjectDeferredBegin(n.objId,!0),"object"===(0,un.A)(n)&&"function"==typeof n.putStream&&n.putStream(),delete g[I]}}(e.internal.acroformPlugin.xForms,e)}(e,g)})),g.internal.acroformPlugin.isInitialized=!0}},dl=QC.__acroform__.arrayToPdfArray=function(g,e,t){var I=function(g){return g};if(Array.isArray(g)){for(var n="[",C=0;C<g.length;C++)switch(0!==C&&(n+=" "),(0,un.A)(g[C])){case"boolean":case"number":case"object":n+=g[C].toString();break;case"string":"/"!==g[C].substr(0,1)?(void 0!==e&&t&&(I=t.internal.getEncryptor(e)),n+="("+TC(I(g[C].toString()))+")"):n+=g[C].toString()}return n+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},ul=function(g,e,t){var I=function(g){return g};return void 0!==e&&t&&(I=t.internal.getEncryptor(e)),(g=g||"").toString(),"("+TC(I(g))+")"},ml=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(void 0===this._objId){if(void 0===this.scope)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(g){this._objId=g}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ml.prototype.toString=function(){return this.objId+" 0 R"},ml.prototype.putStream=function(){var g=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:g,objectId:this.objId}),this.scope.internal.out("endobj")},ml.prototype.getKeyValueListForStream=function(){var g=[],e=Object.getOwnPropertyNames(this).filter((function(g){return"content"!=g&&"appearanceStreamContent"!=g&&"scope"!=g&&"objId"!=g&&"_"!=g.substring(0,1)}));for(var t in e)if(!1===Object.getOwnPropertyDescriptor(this,e[t]).configurable){var I=e[t],n=this[I];n&&(Array.isArray(n)?g.push({key:I,value:dl(n,this.objId,this.scope)}):n instanceof ml?(n.scope=this.scope,g.push({key:I,value:n.objId+" 0 R"})):"function"!=typeof n&&g.push({key:I,value:n}))}return g};var hl=function(){ml.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var g,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(g){e=g}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(e){g=e.trim()},get:function(){return g||null}})};_C(hl,ml);var bl=function(){ml.call(this);var g,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(g){var e=function(g){return g};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+TC(e(g))+")"}},set:function(e){g=e}})};_C(bl,ml);var Zl=function g(){ml.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(g){if(isNaN(g))throw new Error('Invalid value "'+g+'" for attribute F supplied.');e=g}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return Boolean(nl(e,3))},set:function(g){!0===Boolean(g)?this.F=Cl(e,3):this.F=ll(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(g){if(isNaN(g))throw new Error('Invalid value "'+g+'" for attribute Ff supplied.');t=g}});var I=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(0!==I.length)return I},set:function(g){I=void 0!==g?g:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!I||isNaN(I[0])?0:I[0]},set:function(g){I[0]=g}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!I||isNaN(I[1])?0:I[1]},set:function(g){I[1]=g}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!I||isNaN(I[2])?0:I[2]},set:function(g){I[2]=g}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!I||isNaN(I[3])?0:I[3]},set:function(g){I[3]=g}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(g){switch(g){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=g;break;default:throw new Error('Invalid value "'+g+'" for attribute FT supplied.')}}});var C=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!C||C.length<1){if(this instanceof Vl)return;C="FieldObject"+g.FieldNum++}var e=function(g){return g};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+TC(e(C))+")"},set:function(g){C=g.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return C},set:function(g){C=g}});var l="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return l},set:function(g){l=g}});var a="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return a},set:function(g){a=g}});var o=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return o},set:function(g){o=g}});var i=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return void 0===i?50/DC:i},set:function(g){i=g}});var r="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return r},set:function(g){r=g}});var c="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!c||this instanceof Vl||this instanceof Rl))return ul(c,this.objId,this.scope)},set:function(g){g=g.toString(),c=g}});var s=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(s)return this instanceof Sl==0?ul(s,this.objId,this.scope):s},set:function(g){g=g.toString(),s=this instanceof Sl==0?"("===g.substr(0,1)?PC(g.substr(1,g.length-2)):PC(g):g}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Sl==1?PC(s.substr(1,s.length-1)):s},set:function(g){g=g.toString(),s=this instanceof Sl==1?"/"+g:g}});var A=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(A)return A},set:function(g){this.V=g}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(A)return this instanceof Sl==0?ul(A,this.objId,this.scope):A},set:function(g){g=g.toString(),A=this instanceof Sl==0?"("===g.substr(0,1)?PC(g.substr(1,g.length-2)):PC(g):g}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Sl==1?PC(A.substr(1,A.length-1)):A},set:function(g){g=g.toString(),A=this instanceof Sl==1?"/"+g:g}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var d,u=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return u},set:function(g){g=Boolean(g),u=g}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(d)return d},set:function(g){d=g}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return Boolean(nl(this.Ff,1))},set:function(g){!0===Boolean(g)?this.Ff=Cl(this.Ff,1):this.Ff=ll(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return Boolean(nl(this.Ff,2))},set:function(g){!0===Boolean(g)?this.Ff=Cl(this.Ff,2):this.Ff=ll(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return Boolean(nl(this.Ff,3))},set:function(g){!0===Boolean(g)?this.Ff=Cl(this.Ff,3):this.Ff=ll(this.Ff,3)}});var m=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(null!==m)return m},set:function(g){if(-1===[0,1,2].indexOf(g))throw new Error('Invalid value "'+g+'" for attribute Q supplied.');m=g}}),Object.defineProperty(this,"textAlign",{get:function(){var g;switch(m){case 0:default:g="left";break;case 1:g="center";break;case 2:g="right"}return g},configurable:!0,enumerable:!0,set:function(g){switch(g){case"right":case 2:m=2;break;case"center":case 1:m=1;break;default:m=0}}})};_C(Zl,ml);var pl=function(){Zl.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var g=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return g},set:function(e){g=e}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return g},set:function(e){g=e}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return dl(e,this.objId,this.scope)},set:function(g){var t,I;I=[],"string"==typeof(t=g)&&(I=function(g,e,t){t||(t=1);for(var I,n=[];I=e.exec(g);)n.push(I[t]);return n}(t,/\((.*?)\)/g)),e=I}}),this.getOptions=function(){return e},this.setOptions=function(g){e=g,this.sort&&e.sort()},this.addOption=function(g){g=(g=g||"").toString(),e.push(g),this.sort&&e.sort()},this.removeOption=function(g,t){for(t=t||!1,g=(g=g||"").toString();-1!==e.indexOf(g)&&(e.splice(e.indexOf(g),1),!1!==t););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return Boolean(nl(this.Ff,18))},set:function(g){!0===Boolean(g)?this.Ff=Cl(this.Ff,18):this.Ff=ll(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return Boolean(nl(this.Ff,19))},set:function(g){!0===this.combo&&(!0===Boolean(g)?this.Ff=Cl(this.Ff,19):this.Ff=ll(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return Boolean(nl(this.Ff,20))},set:function(g){!0===Boolean(g)?(this.Ff=Cl(this.Ff,20),e.sort()):this.Ff=ll(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(nl(this.Ff,22))},set:function(g){!0===Boolean(g)?this.Ff=Cl(this.Ff,22):this.Ff=ll(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(nl(this.Ff,23))},set:function(g){!0===Boolean(g)?this.Ff=Cl(this.Ff,23):this.Ff=ll(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return Boolean(nl(this.Ff,27))},set:function(g){!0===Boolean(g)?this.Ff=Cl(this.Ff,27):this.Ff=ll(this.Ff,27)}}),this.hasAppearanceStream=!1};_C(pl,Zl);var Gl=function(){pl.call(this),this.fontName="helvetica",this.combo=!1};_C(Gl,pl);var yl=function(){Gl.call(this),this.combo=!0};_C(yl,Gl);var Bl=function(){yl.call(this),this.edit=!0};_C(Bl,yl);var Sl=function(){Zl.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return Boolean(nl(this.Ff,15))},set:function(g){!0===Boolean(g)?this.Ff=Cl(this.Ff,15):this.Ff=ll(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return Boolean(nl(this.Ff,16))},set:function(g){!0===Boolean(g)?this.Ff=Cl(this.Ff,16):this.Ff=ll(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return Boolean(nl(this.Ff,17))},set:function(g){!0===Boolean(g)?this.Ff=Cl(this.Ff,17):this.Ff=ll(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return Boolean(nl(this.Ff,26))},set:function(g){!0===Boolean(g)?this.Ff=Cl(this.Ff,26):this.Ff=ll(this.Ff,26)}});var g,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var g=function(g){return g};if(this.scope&&(g=this.scope.internal.getEncryptor(this.objId)),0!==Object.keys(e).length){var t,I=[];for(t in I.push("<<"),e)I.push("/"+t+" ("+TC(g(e[t]))+")");return I.push(">>"),I.join("\n")}},set:function(g){"object"===(0,un.A)(g)&&(e=g)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(g){"string"==typeof g&&(e.CA=g)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return g},set:function(e){g=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return g.substr(1,g.length-1)},set:function(e){g="/"+e}})};_C(Sl,Zl);var fl=function(){Sl.call(this),this.pushButton=!0};_C(fl,Sl);var Wl=function(){Sl.call(this),this.radio=!0,this.pushButton=!1;var g=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return g},set:function(e){g=void 0!==e?e:[]}})};_C(Wl,Sl);var Vl=function(){var g,e;Zl.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return g},set:function(e){g=e}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(g){e=g}});var t,I={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var g=function(g){return g};this.scope&&(g=this.scope.internal.getEncryptor(this.objId));var e,t=[];for(e in t.push("<<"),I)t.push("/"+e+" ("+TC(g(I[e]))+")");return t.push(">>"),t.join("\n")},set:function(g){"object"===(0,un.A)(g)&&(I=g)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return I.CA||""},set:function(g){"string"==typeof g&&(I.CA=g)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(g){t=g}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(g){t="/"+g}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=kl.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};_C(Vl,Zl),Wl.prototype.setAppearance=function(g){if(!("createAppearanceStream"in g)||!("getCA"in g))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=g.createAppearanceStream(t.optionName),t.caption=g.getCA()}},Wl.prototype.createOption=function(g){var e=new Vl;return e.Parent=this,e.optionName=g,this.Kids.push(e),Jl.call(this.scope,e),e};var vl=function(){Sl.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=kl.CheckBox.createAppearanceStream()};_C(vl,Sl);var Rl=function(){Zl.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return Boolean(nl(this.Ff,13))},set:function(g){!0===Boolean(g)?this.Ff=Cl(this.Ff,13):this.Ff=ll(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(nl(this.Ff,21))},set:function(g){!0===Boolean(g)?this.Ff=Cl(this.Ff,21):this.Ff=ll(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(nl(this.Ff,23))},set:function(g){!0===Boolean(g)?this.Ff=Cl(this.Ff,23):this.Ff=ll(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return Boolean(nl(this.Ff,24))},set:function(g){!0===Boolean(g)?this.Ff=Cl(this.Ff,24):this.Ff=ll(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return Boolean(nl(this.Ff,25))},set:function(g){!0===Boolean(g)?this.Ff=Cl(this.Ff,25):this.Ff=ll(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return Boolean(nl(this.Ff,26))},set:function(g){!0===Boolean(g)?this.Ff=Cl(this.Ff,26):this.Ff=ll(this.Ff,26)}});var g=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return g},set:function(e){g=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return g},set:function(e){Number.isInteger(e)&&(g=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};_C(Rl,Zl);var Xl=function(){Rl.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return Boolean(nl(this.Ff,14))},set:function(g){!0===Boolean(g)?this.Ff=Cl(this.Ff,14):this.Ff=ll(this.Ff,14)}}),this.password=!0};_C(Xl,Rl);var kl={CheckBox:{createAppearanceStream:function(){return{N:{On:kl.CheckBox.YesNormal},D:{On:kl.CheckBox.YesPushDown,Off:kl.CheckBox.OffPushDown}}},YesPushDown:function(g){var e=gl(g);e.scope=g.scope;var t=[],I=g.scope.internal.getFont(g.fontName,g.fontStyle).id,n=g.scope.__private__.encodeColorString(g.color),C=il(g,g.caption);return t.push("0.749023 g"),t.push("0 0 "+OC(kl.internal.getWidth(g))+" "+OC(kl.internal.getHeight(g))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+I+" "+OC(C.fontSize)+" Tf "+n),t.push("BT"),t.push(C.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join("\n"),e},YesNormal:function(g){var e=gl(g);e.scope=g.scope;var t=g.scope.internal.getFont(g.fontName,g.fontStyle).id,I=g.scope.__private__.encodeColorString(g.color),n=[],C=kl.internal.getHeight(g),l=kl.internal.getWidth(g),a=il(g,g.caption);return n.push("1 g"),n.push("0 0 "+OC(l)+" "+OC(C)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+OC(l-1)+" "+OC(C-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+t+" "+OC(a.fontSize)+" Tf "+I),n.push(a.text),n.push("ET"),n.push("Q"),e.stream=n.join("\n"),e},OffPushDown:function(g){var e=gl(g);e.scope=g.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+OC(kl.internal.getWidth(g))+" "+OC(kl.internal.getHeight(g))+" re"),t.push("f"),e.stream=t.join("\n"),e}},RadioButton:{Circle:{createAppearanceStream:function(g){var e={D:{Off:kl.RadioButton.Circle.OffPushDown},N:{}};return e.N[g]=kl.RadioButton.Circle.YesNormal,e.D[g]=kl.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(g){var e=gl(g);e.scope=g.scope;var t=[],I=kl.internal.getWidth(g)<=kl.internal.getHeight(g)?kl.internal.getWidth(g)/4:kl.internal.getHeight(g)/4;I=Number((.9*I).toFixed(5));var n=kl.internal.Bezier_C,C=Number((I*n).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+qC(kl.internal.getWidth(g)/2)+" "+qC(kl.internal.getHeight(g)/2)+" cm"),t.push(I+" 0 m"),t.push(I+" "+C+" "+C+" "+I+" 0 "+I+" c"),t.push("-"+C+" "+I+" -"+I+" "+C+" -"+I+" 0 c"),t.push("-"+I+" -"+C+" -"+C+" -"+I+" 0 -"+I+" c"),t.push(C+" -"+I+" "+I+" -"+C+" "+I+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join("\n"),e},YesPushDown:function(g){var e=gl(g);e.scope=g.scope;var t=[],I=kl.internal.getWidth(g)<=kl.internal.getHeight(g)?kl.internal.getWidth(g)/4:kl.internal.getHeight(g)/4;I=Number((.9*I).toFixed(5));var n=Number((2*I).toFixed(5)),C=Number((n*kl.internal.Bezier_C).toFixed(5)),l=Number((I*kl.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+qC(kl.internal.getWidth(g)/2)+" "+qC(kl.internal.getHeight(g)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+C+" "+C+" "+n+" 0 "+n+" c"),t.push("-"+C+" "+n+" -"+n+" "+C+" -"+n+" 0 c"),t.push("-"+n+" -"+C+" -"+C+" -"+n+" 0 -"+n+" c"),t.push(C+" -"+n+" "+n+" -"+C+" "+n+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+qC(kl.internal.getWidth(g)/2)+" "+qC(kl.internal.getHeight(g)/2)+" cm"),t.push(I+" 0 m"),t.push(I+" "+l+" "+l+" "+I+" 0 "+I+" c"),t.push("-"+l+" "+I+" -"+I+" "+l+" -"+I+" 0 c"),t.push("-"+I+" -"+l+" -"+l+" -"+I+" 0 -"+I+" c"),t.push(l+" -"+I+" "+I+" -"+l+" "+I+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join("\n"),e},OffPushDown:function(g){var e=gl(g);e.scope=g.scope;var t=[],I=kl.internal.getWidth(g)<=kl.internal.getHeight(g)?kl.internal.getWidth(g)/4:kl.internal.getHeight(g)/4;I=Number((.9*I).toFixed(5));var n=Number((2*I).toFixed(5)),C=Number((n*kl.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+qC(kl.internal.getWidth(g)/2)+" "+qC(kl.internal.getHeight(g)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+C+" "+C+" "+n+" 0 "+n+" c"),t.push("-"+C+" "+n+" -"+n+" "+C+" -"+n+" 0 c"),t.push("-"+n+" -"+C+" -"+C+" -"+n+" 0 -"+n+" c"),t.push(C+" -"+n+" "+n+" -"+C+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join("\n"),e}},Cross:{createAppearanceStream:function(g){var e={D:{Off:kl.RadioButton.Cross.OffPushDown},N:{}};return e.N[g]=kl.RadioButton.Cross.YesNormal,e.D[g]=kl.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(g){var e=gl(g);e.scope=g.scope;var t=[],I=kl.internal.calculateCross(g);return t.push("q"),t.push("1 1 "+OC(kl.internal.getWidth(g)-2)+" "+OC(kl.internal.getHeight(g)-2)+" re"),t.push("W"),t.push("n"),t.push(OC(I.x1.x)+" "+OC(I.x1.y)+" m"),t.push(OC(I.x2.x)+" "+OC(I.x2.y)+" l"),t.push(OC(I.x4.x)+" "+OC(I.x4.y)+" m"),t.push(OC(I.x3.x)+" "+OC(I.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join("\n"),e},YesPushDown:function(g){var e=gl(g);e.scope=g.scope;var t=kl.internal.calculateCross(g),I=[];return I.push("0.749023 g"),I.push("0 0 "+OC(kl.internal.getWidth(g))+" "+OC(kl.internal.getHeight(g))+" re"),I.push("f"),I.push("q"),I.push("1 1 "+OC(kl.internal.getWidth(g)-2)+" "+OC(kl.internal.getHeight(g)-2)+" re"),I.push("W"),I.push("n"),I.push(OC(t.x1.x)+" "+OC(t.x1.y)+" m"),I.push(OC(t.x2.x)+" "+OC(t.x2.y)+" l"),I.push(OC(t.x4.x)+" "+OC(t.x4.y)+" m"),I.push(OC(t.x3.x)+" "+OC(t.x3.y)+" l"),I.push("s"),I.push("Q"),e.stream=I.join("\n"),e},OffPushDown:function(g){var e=gl(g);e.scope=g.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+OC(kl.internal.getWidth(g))+" "+OC(kl.internal.getHeight(g))+" re"),t.push("f"),e.stream=t.join("\n"),e}}},createDefaultAppearanceStream:function(g){var e=g.scope.internal.getFont(g.fontName,g.fontStyle).id,t=g.scope.__private__.encodeColorString(g.color);return"/"+e+" "+g.fontSize+" Tf "+t}};kl.internal={Bezier_C:.551915024494,calculateCross:function(g){var e=kl.internal.getWidth(g),t=kl.internal.getHeight(g),I=Math.min(e,t);return{x1:{x:(e-I)/2,y:(t-I)/2+I},x2:{x:(e-I)/2+I,y:(t-I)/2},x3:{x:(e-I)/2,y:(t-I)/2},x4:{x:(e-I)/2+I,y:(t-I)/2+I}}}},kl.internal.getWidth=function(g){var e=0;return"object"===(0,un.A)(g)&&(e=$C(g.Rect[2])),e},kl.internal.getHeight=function(g){var e=0;return"object"===(0,un.A)(g)&&(e=$C(g.Rect[3])),e};var Jl=QC.addField=function(g){if(Al(this,g),!(g instanceof Zl))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=g).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),g.page=g.scope.internal.getCurrentPageInfo().pageNumber,this};QC.AcroFormChoiceField=pl,QC.AcroFormListBox=Gl,QC.AcroFormComboBox=yl,QC.AcroFormEditBox=Bl,QC.AcroFormButton=Sl,QC.AcroFormPushButton=fl,QC.AcroFormRadioButton=Wl,QC.AcroFormCheckBox=vl,QC.AcroFormTextField=Rl,QC.AcroFormPasswordField=Xl,QC.AcroFormAppearance=kl,QC.AcroForm={ChoiceField:pl,ListBox:Gl,ComboBox:yl,EditBox:Bl,Button:Sl,PushButton:fl,RadioButton:Wl,CheckBox:vl,TextField:Rl,PasswordField:Xl,Appearance:kl},jC.AcroForm={ChoiceField:pl,ListBox:Gl,ComboBox:yl,EditBox:Bl,Button:Sl,PushButton:fl,RadioButton:Wl,CheckBox:vl,TextField:Rl,PasswordField:Xl,Appearance:kl};jC.AcroForm;function Yl(g){return g.reduce((function(g,e,t){return g[e]=t,g}),{})}!function(g){g.__addimage__={};var e="UNKNOWN",t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},I=g.__addimage__.getImageFileTypeByImageData=function(g,I){var n,C,l,a,o,i=e;if("RGBA"===(I=I||e)||void 0!==g.data&&g.data instanceof Uint8ClampedArray&&"height"in g&&"width"in g)return"RGBA";if(y(g))for(o in t)for(l=t[o],n=0;n<l.length;n+=1){for(a=!0,C=0;C<l[n].length;C+=1)if(void 0!==l[n][C]&&l[n][C]!==g[C]){a=!1;break}if(!0===a){i=o;break}}else for(o in t)for(l=t[o],n=0;n<l.length;n+=1){for(a=!0,C=0;C<l[n].length;C+=1)if(void 0!==l[n][C]&&l[n][C]!==g.charCodeAt(C)){a=!1;break}if(!0===a){i=o;break}}return i===e&&I!==e&&(i=I),i},n=function g(e){for(var t=this.internal.write,I=this.internal.putStream,n=(0,this.internal.getFilters)();-1!==n.indexOf("FlateEncode");)n.splice(n.indexOf("FlateEncode"),1);e.objectId=this.internal.newObject();var C=[];if(C.push({key:"Type",value:"/XObject"}),C.push({key:"Subtype",value:"/Image"}),C.push({key:"Width",value:e.width}),C.push({key:"Height",value:e.height}),e.colorSpace===m.INDEXED?C.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(e.palette.length/3-1)+" "+("sMask"in e&&void 0!==e.sMask?e.objectId+2:e.objectId+1)+" 0 R]"}):(C.push({key:"ColorSpace",value:"/"+e.colorSpace}),e.colorSpace===m.DEVICE_CMYK&&C.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),C.push({key:"BitsPerComponent",value:e.bitsPerComponent}),"decodeParameters"in e&&void 0!==e.decodeParameters&&C.push({key:"DecodeParms",value:"<<"+e.decodeParameters+">>"}),"transparency"in e&&Array.isArray(e.transparency)){for(var l="",a=0,o=e.transparency.length;a<o;a++)l+=e.transparency[a]+" "+e.transparency[a]+" ";C.push({key:"Mask",value:"["+l+"]"})}void 0!==e.sMask&&C.push({key:"SMask",value:e.objectId+1+" 0 R"});var i=void 0!==e.filter?["/"+e.filter]:void 0;if(I({data:e.data,additionalKeyValues:C,alreadyAppliedFilters:i,objectId:e.objectId}),t("endobj"),"sMask"in e&&void 0!==e.sMask){var r="/Predictor "+e.predictor+" /Colors 1 /BitsPerComponent "+e.bitsPerComponent+" /Columns "+e.width,c={width:e.width,height:e.height,colorSpace:"DeviceGray",bitsPerComponent:e.bitsPerComponent,decodeParameters:r,data:e.sMask};"filter"in e&&(c.filter=e.filter),g.call(this,c)}if(e.colorSpace===m.INDEXED){var s=this.internal.newObject();I({data:S(new Uint8Array(e.palette)),objectId:s}),t("endobj")}},C=function(){var g=this.internal.collections.addImage_images;for(var e in g)n.call(this,g[e])},l=function(){var g,e=this.internal.collections.addImage_images,t=this.internal.write;for(var I in e)t("/I"+(g=e[I]).index,g.objectId,"0","R")},a=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",C),this.internal.events.subscribe("putXobjectDict",l))},o=function(){var g=this.internal.collections.addImage_images;return a.call(this),g},i=function(){return Object.keys(this.internal.collections.addImage_images).length},r=function(e){return"function"==typeof g["process"+e.toUpperCase()]},c=function(g){return"object"===(0,un.A)(g)&&1===g.nodeType},s=function(e,t){if("IMG"===e.nodeName&&e.hasAttribute("src")){var I=""+e.getAttribute("src");if(0===I.indexOf("data:image/"))return bC(unescape(I).split("base64,").pop());var n=g.loadFile(I,!0);if(void 0!==n)return n}if("CANVAS"===e.nodeName){if(0===e.width||0===e.height)throw new Error("Given canvas must have data. Canvas width: "+e.width+", height: "+e.height);var C;switch(t){case"PNG":C="image/png";break;case"WEBP":C="image/webp";break;default:C="image/jpeg"}return bC(e.toDataURL(C,1).split("base64,").pop())}},A=function(g){var e=this.internal.collections.addImage_images;if(e)for(var t in e)if(g===e[t].alias)return e[t]},d=function(g,e,t){return g||e||(g=-96,e=-96),g<0&&(g=-1*t.width*72/g/this.internal.scaleFactor),e<0&&(e=-1*t.height*72/e/this.internal.scaleFactor),0===g&&(g=e*t.width/t.height),0===e&&(e=g*t.height/t.width),[g,e]},u=function(g,e,t,I,n,C){var l=d.call(this,t,I,n),a=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,r=o.call(this);if(t=l[0],I=l[1],r[n.index]=n,C){C*=Math.PI/180;var c=Math.cos(C),s=Math.sin(C),A=function(g){return g.toFixed(4)},u=[A(c),A(s),A(-1*s),A(c),0,0,"cm"]}this.internal.write("q"),C?(this.internal.write([1,"0","0",1,a(g),i(e+I),"cm"].join(" ")),this.internal.write(u.join(" ")),this.internal.write([a(t),"0","0",a(I),"0","0","cm"].join(" "))):this.internal.write([a(t),"0","0",a(I),a(g),i(e+I),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+n.index+" Do"),this.internal.write("Q")},m=g.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};g.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var h=g.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=g.__addimage__.sHashCode=function(g){var e,t,I=0;if("string"==typeof g)for(t=g.length,e=0;e<t;e++)I=(I<<5)-I+g.charCodeAt(e),I|=0;else if(y(g))for(t=g.byteLength/2,e=0;e<t;e++)I=(I<<5)-I+g[e],I|=0;return I},Z=g.__addimage__.validateStringAsBase64=function(g){(g=g||"").toString().trim();var e=!0;return 0===g.length&&(e=!1),g.length%4!=0&&(e=!1),!1===/^[A-Za-z0-9+/]+$/.test(g.substr(0,g.length-2))&&(e=!1),!1===/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(g.substr(-2))&&(e=!1),e},p=g.__addimage__.extractImageFromDataUrl=function(g){if(null==g)return null;if(!(g=g.trim()).startsWith("data:"))return null;var e=g.indexOf(",");return e<0?null:g.substring(0,e).trim().endsWith("base64")?g.substring(e+1):null},G=g.__addimage__.supportsArrayBuffer=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array};g.__addimage__.isArrayBuffer=function(g){return G()&&g instanceof ArrayBuffer};var y=g.__addimage__.isArrayBufferView=function(g){return G()&&"undefined"!=typeof Uint32Array&&(g instanceof Int8Array||g instanceof Uint8Array||"undefined"!=typeof Uint8ClampedArray&&g instanceof Uint8ClampedArray||g instanceof Int16Array||g instanceof Uint16Array||g instanceof Int32Array||g instanceof Uint32Array||g instanceof Float32Array||g instanceof Float64Array)},B=g.__addimage__.binaryStringToUint8Array=function(g){for(var e=g.length,t=new Uint8Array(e),I=0;I<e;I++)t[I]=g.charCodeAt(I);return t},S=g.__addimage__.arrayBufferToBinaryString=function(g){for(var e="",t=y(g)?g:new Uint8Array(g),I=0;I<t.length;I+=8192)e+=String.fromCharCode.apply(null,t.subarray(I,I+8192));return e};g.addImage=function(){var g,t,I,n,C,l,o,i,r;if("number"==typeof arguments[1]?(t=e,I=arguments[1],n=arguments[2],C=arguments[3],l=arguments[4],o=arguments[5],i=arguments[6],r=arguments[7]):(t=arguments[1],I=arguments[2],n=arguments[3],C=arguments[4],l=arguments[5],o=arguments[6],i=arguments[7],r=arguments[8]),"object"===(0,un.A)(g=arguments[0])&&!c(g)&&"imageData"in g){var s=g;g=s.imageData,t=s.format||t||e,I=s.x||I||0,n=s.y||n||0,C=s.w||s.width||C,l=s.h||s.height||l,o=s.alias||o,i=s.compression||i,r=s.rotation||s.angle||r}var A=this.internal.getFilters();if(void 0===i&&-1!==A.indexOf("FlateEncode")&&(i="SLOW"),isNaN(I)||isNaN(n))throw new Error("Invalid coordinates passed to jsPDF.addImage");a.call(this);var d=f.call(this,g,t,o,i);return u.call(this,I,n,C,l,d,r),this};var f=function(t,n,C,l){var a,o,d;if("string"==typeof t&&I(t)===e){t=unescape(t);var u=W(t,!1);(""!==u||void 0!==(u=g.loadFile(t,!0)))&&(t=u)}if(c(t)&&(t=s(t,n)),n=I(t,n),!r(n))throw new Error("addImage does not support files of type '"+n+"', please ensure that a plugin for '"+n+"' support is added.");if((null==(d=C)||0===d.length)&&(C=function(g){return"string"==typeof g||y(g)?b(g):y(g.data)?b(g.data):null}(t)),(a=A.call(this,C))||(G()&&(t instanceof Uint8Array||"RGBA"===n||(o=t,t=B(t))),a=this["process"+n.toUpperCase()](t,i.call(this),C,function(e){return e&&"string"==typeof e&&(e=e.toUpperCase()),e in g.image_compression?e:h.NONE}(l),o)),!a)throw new Error("An unknown error occurred whilst processing the image.");return a},W=g.__addimage__.convertBase64ToBinaryString=function(g,e){e="boolean"!=typeof e||e;var t,I="";if("string"==typeof g){var n;t=null!==(n=p(g))&&void 0!==n?n:g;try{I=bC(t)}catch(g){if(e)throw Z(t)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+g.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return I};g.getImageProperties=function(t){var n,C,l="";if(c(t)&&(t=s(t)),"string"==typeof t&&I(t)===e&&(""===(l=W(t,!1))&&(l=g.loadFile(t)||""),t=l),C=I(t),!r(C))throw new Error("addImage does not support files of type '"+C+"', please ensure that a plugin for '"+C+"' support is added.");if(!G()||t instanceof Uint8Array||(t=B(t)),!(n=this["process"+C.toUpperCase()](t)))throw new Error("An unknown error occurred whilst processing the image");return n.fileType=C,n}}(jC.API),function(g){var e=function(g){if(void 0!==g&&""!=g)return!0};jC.API.events.push(["addPage",function(g){this.internal.getPageInfo(g.pageNumber).pageContext.annotations=[]}]),g.events.push(["putPage",function(g){for(var t,I,n,C=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,a=this.internal.getPageInfoByObjId(g.objId),o=g.pageContext.annotations,i=!1,r=0;r<o.length&&!i;r++)switch((t=o[r]).type){case"link":(e(t.options.url)||e(t.options.pageNumber))&&(i=!0);break;case"reference":case"text":case"freetext":i=!0}if(0!=i){this.internal.write("/Annots [");for(var c=0;c<o.length;c++){t=o[c];var s=this.internal.pdfEscape,A=this.internal.getEncryptor(g.objId);switch(t.type){case"reference":this.internal.write(" "+t.object.objId+" 0 R ");break;case"text":var d=this.internal.newAdditionalObject(),u=this.internal.newAdditionalObject(),m=this.internal.getEncryptor(d.objId),h=t.title||"Note";n="<</Type /Annot /Subtype /Text "+(I="/Rect ["+C(t.bounds.x)+" "+l(t.bounds.y+t.bounds.h)+" "+C(t.bounds.x+t.bounds.w)+" "+l(t.bounds.y)+"] ")+"/Contents ("+s(m(t.contents))+")",n+=" /Popup "+u.objId+" 0 R",n+=" /P "+a.objId+" 0 R",n+=" /T ("+s(m(h))+") >>",d.content=n;var b=d.objId+" 0 R";n="<</Type /Annot /Subtype /Popup "+(I="/Rect ["+C(t.bounds.x+30)+" "+l(t.bounds.y+t.bounds.h)+" "+C(t.bounds.x+t.bounds.w+30)+" "+l(t.bounds.y)+"] ")+" /Parent "+b,t.open&&(n+=" /Open true"),n+=" >>",u.content=n,this.internal.write(d.objId,"0 R",u.objId,"0 R");break;case"freetext":I="/Rect ["+C(t.bounds.x)+" "+l(t.bounds.y)+" "+C(t.bounds.x+t.bounds.w)+" "+l(t.bounds.y+t.bounds.h)+"] ";var Z=t.color||"#000000";n="<</Type /Annot /Subtype /FreeText "+I+"/Contents ("+s(A(t.contents))+")",n+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+Z+")",n+=" /Border [0 0 0]",n+=" >>",this.internal.write(n);break;case"link":if(t.options.name){var p=this.annotations._nameMap[t.options.name];t.options.pageNumber=p.page,t.options.top=p.y}else t.options.top||(t.options.top=0);if(I="/Rect ["+t.finalBounds.x+" "+t.finalBounds.y+" "+t.finalBounds.w+" "+t.finalBounds.h+"] ",n="",t.options.url)n="<</Type /Annot /Subtype /Link "+I+"/Border [0 0 0] /A <</S /URI /URI ("+s(A(t.options.url))+") >>";else if(t.options.pageNumber)switch(n="<</Type /Annot /Subtype /Link "+I+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(t.options.pageNumber).objId+" 0 R",t.options.magFactor=t.options.magFactor||"XYZ",t.options.magFactor){case"Fit":n+=" /Fit]";break;case"FitH":n+=" /FitH "+t.options.top+"]";break;case"FitV":t.options.left=t.options.left||0,n+=" /FitV "+t.options.left+"]";break;default:var G=l(t.options.top);t.options.left=t.options.left||0,void 0===t.options.zoom&&(t.options.zoom=0),n+=" /XYZ "+t.options.left+" "+G+" "+t.options.zoom+"]"}""!=n&&(n+=" >>",this.internal.write(n))}}this.internal.write("]")}}]),g.createAnnotation=function(g){var e=this.internal.getCurrentPageInfo();switch(g.type){case"link":this.link(g.bounds.x,g.bounds.y,g.bounds.w,g.bounds.h,g);break;case"text":case"freetext":e.pageContext.annotations.push(g)}},g.link=function(g,e,t,I,n){var C=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString;C.pageContext.annotations.push({finalBounds:{x:l(g),y:a(e),w:l(g+t),h:a(e+I)},options:n,type:"link"})},g.textWithLink=function(g,e,t,I){var n,C,l=this.getTextWidth(g),a=this.internal.getLineHeight()/this.internal.scaleFactor;if(void 0!==I.maxWidth){C=I.maxWidth;var o=this.splitTextToSize(g,C).length;n=Math.ceil(a*o)}else C=l,n=a;return this.text(g,e,t,I),t+=.2*a,"center"===I.align&&(e-=l/2),"right"===I.align&&(e-=l),this.link(e,t-a,C,n,I),l},g.getTextWidth=function(g){var e=this.internal.getFontSize();return this.getStringUnitWidth(g)*e/this.internal.scaleFactor}}(jC.API),function(g){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},I={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];g.__arabicParser__={};var C=g.__arabicParser__.isInArabicSubstitutionA=function(g){return void 0!==e[g.charCodeAt(0)]},l=g.__arabicParser__.isArabicLetter=function(g){return"string"==typeof g&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},a=g.__arabicParser__.isArabicEndLetter=function(g){return l(g)&&C(g)&&e[g.charCodeAt(0)].length<=2},o=g.__arabicParser__.isArabicAlfLetter=function(g){return l(g)&&n.indexOf(g.charCodeAt(0))>=0};g.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return l(g)&&C(g)&&e[g.charCodeAt(0)].length>=1};var i=g.__arabicParser__.arabicLetterHasFinalForm=function(g){return l(g)&&C(g)&&e[g.charCodeAt(0)].length>=2};g.__arabicParser__.arabicLetterHasInitialForm=function(g){return l(g)&&C(g)&&e[g.charCodeAt(0)].length>=3};var r=g.__arabicParser__.arabicLetterHasMedialForm=function(g){return l(g)&&C(g)&&4==e[g.charCodeAt(0)].length},c=g.__arabicParser__.resolveLigatures=function(g){var e=0,I=t,n="",C=0;for(e=0;e<g.length;e+=1)void 0!==I[g.charCodeAt(e)]?(C++,"number"==typeof(I=I[g.charCodeAt(e)])&&(n+=String.fromCharCode(I),I=t,C=0),e===g.length-1&&(I=t,n+=g.charAt(e-(C-1)),e-=C-1,C=0)):(I=t,n+=g.charAt(e-C),e-=C,C=0);return n};g.__arabicParser__.isArabicDiacritic=function(g){return void 0!==g&&void 0!==I[g.charCodeAt(0)]};var s=g.__arabicParser__.getCorrectForm=function(g,e,t){return l(g)?!1===C(g)?-1:!i(g)||!l(e)&&!l(t)||!l(t)&&a(e)||a(g)&&!l(e)||a(g)&&o(e)||a(g)&&a(e)?0:r(g)&&l(e)&&!a(e)&&l(t)&&i(t)?3:a(g)||!l(t)?1:2:-1},A=function(g){var t=0,I=0,n=0,C="",a="",o="",i=(g=g||"").split("\\s+"),r=[];for(t=0;t<i.length;t+=1){for(r.push(""),I=0;I<i[t].length;I+=1)C=i[t][I],a=i[t][I-1],o=i[t][I+1],l(C)?(n=s(C,a,o),r[t]+=-1!==n?String.fromCharCode(e[C.charCodeAt(0)][n]):C):r[t]+=C;r[t]=c(r[t])}return r.join(" ")},d=g.__arabicParser__.processArabic=g.processArabic=function(){var g,e="string"==typeof arguments[0]?arguments[0]:arguments[0].text,t=[];if(Array.isArray(e)){var I=0;for(t=[],I=0;I<e.length;I+=1)Array.isArray(e[I])?t.push([A(e[I][0]),e[I][1],e[I][2]]):t.push([A(e[I])]);g=t}else g=A(e);return"string"==typeof arguments[0]?g:(arguments[0].text=g,arguments[0])};g.events.push(["preProcessText",d])}(jC.API),jC.API.autoPrint=function(g){var e;if("javascript"===((g=g||{}).variant=g.variant||"non-conform",g.variant))this.addJS("print({});");else this.internal.events.subscribe("postPutResources",(function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){this.internal.out("/OpenAction "+e+" 0 R")}));return this},function(g){var e=function(){var g=void 0;Object.defineProperty(this,"pdf",{get:function(){return g},set:function(e){g=e}});var e=150;Object.defineProperty(this,"width",{get:function(){return e},set:function(g){e=isNaN(g)||!1===Number.isInteger(g)||g<0?150:g,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=e+1)}});var t=300;Object.defineProperty(this,"height",{get:function(){return t},set:function(g){t=isNaN(g)||!1===Number.isInteger(g)||g<0?300:g,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=t+1)}});var I=[];Object.defineProperty(this,"childNodes",{get:function(){return I},set:function(g){I=g}});var n={};Object.defineProperty(this,"style",{get:function(){return n},set:function(g){n=g}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(g,e){var t;if("2d"!==(g=g||"2d"))return null;for(t in e)this.pdf.context2d.hasOwnProperty(t)&&(this.pdf.context2d[t]=e[t]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},g.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(jC.API),function(g){var e={left:0,top:0,bottom:0,right:0},t=!1,I=function(){void 0===this.internal.__cell__&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new C,this.internal.__cell__.pages=1},C=function(){var g=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return g},set:function(e){g=e}});var e=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return e},set:function(g){e=g}});var t=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return t},set:function(g){t=g}});var I=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return I},set:function(g){I=g}});var n=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return n},set:function(g){n=g}});var C=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return C},set:function(g){C=g}});var l=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return l},set:function(g){l=g}}),this};C.prototype.clone=function(){return new C(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},C.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},g.setHeaderFunction=function(g){return I.call(this),this.internal.__cell__.headerFunction="function"==typeof g?g:void 0,this},g.getTextDimensions=function(g,e){I.call(this);var t=(e=e||{}).fontSize||this.getFontSize(),n=e.font||this.getFont(),C=e.scaleFactor||this.internal.scaleFactor,l=0,a=0,o=0,i=this;if(!Array.isArray(g)&&"string"!=typeof g){if("number"!=typeof g)throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");g=String(g)}var r=e.maxWidth;r>0?"string"==typeof g?g=this.splitTextToSize(g,r):"[object Array]"===Object.prototype.toString.call(g)&&(g=g.reduce((function(g,e){return g.concat(i.splitTextToSize(e,r))}),[])):g=Array.isArray(g)?g:[g];for(var c=0;c<g.length;c++)l<(o=this.getStringUnitWidth(g[c],{font:n})*t)&&(l=o);return 0!==l&&(a=g.length),{w:l/=C,h:Math.max((a*t*this.getLineHeightFactor()-t*(this.getLineHeightFactor()-1))/C,0)}},g.cellAddPage=function(){I.call(this),this.addPage();var g=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new C(g.left,g.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=g.cell=function(){var g;g=arguments[0]instanceof C?arguments[0]:new C(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),I.call(this);var n=this.internal.__cell__.lastCell,l=this.internal.__cell__.padding,a=this.internal.__cell__.margins||e,o=this.internal.__cell__.tableHeaderRow,i=this.internal.__cell__.printHeaders;return void 0!==n.lineNumber&&(n.lineNumber===g.lineNumber?(g.x=(n.x||0)+(n.width||0),g.y=n.y||0):n.y+n.height+g.height+a.bottom>this.getPageHeight()?(this.cellAddPage(),g.y=a.top,i&&o&&(this.printHeaderRow(g.lineNumber,!0),g.y+=o[0].height)):g.y=n.y+n.height||g.y),void 0!==g.text[0]&&(this.rect(g.x,g.y,g.width,g.height,!0===t?"FD":void 0),"right"===g.align?this.text(g.text,g.x+g.width-l,g.y+l,{align:"right",baseline:"top"}):"center"===g.align?this.text(g.text,g.x+g.width/2,g.y+l,{align:"center",baseline:"top",maxWidth:g.width-l-l}):this.text(g.text,g.x+l,g.y+l,{align:"left",baseline:"top",maxWidth:g.width-l-l})),this.internal.__cell__.lastCell=g,this};g.table=function(g,t,o,i,r){if(I.call(this),!o)throw new Error("No data for PDF table.");var c,s,A,d,u=[],m=[],h=[],b={},Z={},p=[],G=[],y=(r=r||{}).autoSize||!1,B=!1!==r.printHeaders,S=r.css&&void 0!==r.css["font-size"]?16*r.css["font-size"]:r.fontSize||12,f=r.margins||Object.assign({width:this.getPageWidth()},e),W="number"==typeof r.padding?r.padding:3,V=r.headerBackgroundColor||"#c8c8c8",v=r.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=B,this.internal.__cell__.margins=f,this.internal.__cell__.table_font_size=S,this.internal.__cell__.padding=W,this.internal.__cell__.headerBackgroundColor=V,this.internal.__cell__.headerTextColor=v,this.setFontSize(S),null==i)m=u=Object.keys(o[0]),h=u.map((function(){return"left"}));else if(Array.isArray(i)&&"object"===(0,un.A)(i[0]))for(u=i.map((function(g){return g.name})),m=i.map((function(g){return g.prompt||g.name||""})),h=i.map((function(g){return g.align||"left"})),c=0;c<i.length;c+=1)Z[i[c].name]=i[c].width*(19.049976/25.4);else Array.isArray(i)&&"string"==typeof i[0]&&(m=u=i,h=u.map((function(){return"left"})));if(y||Array.isArray(i)&&"string"==typeof i[0])for(c=0;c<u.length;c+=1){for(b[d=u[c]]=o.map((function(g){return g[d]})),this.setFont(void 0,"bold"),p.push(this.getTextDimensions(m[c],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),s=b[d],this.setFont(void 0,"normal"),A=0;A<s.length;A+=1)p.push(this.getTextDimensions(s[A],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);Z[d]=Math.max.apply(null,p)+W+W,p=[]}if(B){var R={};for(c=0;c<u.length;c+=1)R[u[c]]={},R[u[c]].text=m[c],R[u[c]].align=h[c];var X=a.call(this,R,Z);G=u.map((function(e){return new C(g,t,Z[e],X,R[e].text,void 0,R[e].align)})),this.setTableHeaderRow(G),this.printHeaderRow(1,!1)}var k=i.reduce((function(g,e){return g[e.name]=e.align,g}),{});for(c=0;c<o.length;c+=1){"rowStart"in r&&r.rowStart instanceof Function&&r.rowStart({row:c,data:o[c]},this);var J=a.call(this,o[c],Z);for(A=0;A<u.length;A+=1){var Y=o[c][u[A]];"cellStart"in r&&r.cellStart instanceof Function&&r.cellStart({row:c,col:A,data:Y},this),l.call(this,new C(g,t,Z[u[A]],J,Y,c+2,k[u[A]]))}}return this.internal.__cell__.table_x=g,this.internal.__cell__.table_y=t,this};var a=function(g,e){var t=this.internal.__cell__.padding,I=this.internal.__cell__.table_font_size,n=this.internal.scaleFactor;return Object.keys(g).map((function(I){var n=g[I];return this.splitTextToSize(n.hasOwnProperty("text")?n.text:n,e[I]-t-t)}),this).map((function(g){return this.getLineHeightFactor()*g.length*I/n+t+t}),this).reduce((function(g,e){return Math.max(g,e)}),0)};g.setTableHeaderRow=function(g){I.call(this),this.internal.__cell__.tableHeaderRow=g},g.printHeaderRow=function(g,e){if(I.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var n;if(t=!0,"function"==typeof this.internal.__cell__.headerFunction){var a=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new C(a[0],a[1],a[2],a[3],void 0,-1)}this.setFont(void 0,"bold");for(var o=[],i=0;i<this.internal.__cell__.tableHeaderRow.length;i+=1){n=this.internal.__cell__.tableHeaderRow[i].clone(),e&&(n.y=this.internal.__cell__.margins.top||0,o.push(n)),n.lineNumber=g;var r=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,n),this.setTextColor(r)}o.length>0&&this.setTableHeaderRow(o),this.setFont(void 0,"normal"),t=!1}}(jC.API);var wl={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Nl=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Hl=Yl(Nl),Fl=[100,200,300,400,500,600,700,800,900],Kl=Yl(Fl);function xl(g){var e=g.family.replace(/"|'/g,"").toLowerCase(),t=function(g){return wl[g=g||"normal"]?g:"normal"}(g.style),I=function(g){return g?"number"==typeof g?g>=100&&g<=900&&g%100==0?g:400:/^\d00$/.test(g)?parseInt(g):"bold"===g?700:400:400}(g.weight),n=function(g){return"number"==typeof Hl[g=g||"normal"]?g:"normal"}(g.stretch);return{family:e,style:t,weight:I,stretch:n,src:g.src||[],ref:g.ref||{name:e,style:[n,t,I].join(" ")}}}function Ll(g,e,t,I){var n;for(n=t;n>=0&&n<e.length;n+=I)if(g[e[n]])return g[e[n]];for(n=t;n>=0&&n<e.length;n-=I)if(g[e[n]])return g[e[n]]}var zl={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},El={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Ml(g){return[g.stretch,g.style,g.weight,g.family].join(" ")}function Ul(g){return g.trimLeft()}function jl(g,e){for(var t=0;t<g.length;){if(g.charAt(t)===e)return[g.substring(0,t),g.substring(t+1)];t+=1}return null}function Ql(g){var e=g.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return null===e?null:[e[0],g.substring(e[0].length)]}var Dl,Tl,Pl,Ol,ql=["times"];!function(g){var e,t,I,n,C,l,a,o,i,r=function(g){return g=g||{},this.isStrokeTransparent=g.isStrokeTransparent||!1,this.strokeOpacity=g.strokeOpacity||1,this.strokeStyle=g.strokeStyle||"#000000",this.fillStyle=g.fillStyle||"#000000",this.isFillTransparent=g.isFillTransparent||!1,this.fillOpacity=g.fillOpacity||1,this.font=g.font||"10px sans-serif",this.textBaseline=g.textBaseline||"alphabetic",this.textAlign=g.textAlign||"left",this.lineWidth=g.lineWidth||1,this.lineJoin=g.lineJoin||"miter",this.lineCap=g.lineCap||"butt",this.path=g.path||[],this.transform=void 0!==g.transform?g.transform.clone():new o,this.globalCompositeOperation=g.globalCompositeOperation||"normal",this.globalAlpha=g.globalAlpha||1,this.clip_path=g.clip_path||[],this.currentPoint=g.currentPoint||new l,this.miterLimit=g.miterLimit||10,this.lastPoint=g.lastPoint||new l,this.lineDashOffset=g.lineDashOffset||0,this.lineDash=g.lineDash||[],this.margin=g.margin||[0,0,0,0],this.prevPageLastElemOffset=g.prevPageLastElemOffset||0,this.ignoreClearRect="boolean"!=typeof g.ignoreClearRect||g.ignoreClearRect,this};g.events.push(["initialized",function(){this.context2d=new c(this),e=this.internal.f2,t=this.internal.getCoordinateString,I=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,C=this.internal.getVerticalCoordinate,l=this.internal.Point,a=this.internal.Rectangle,o=this.internal.Matrix,i=new r}]);var c=function(g){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var e=g;Object.defineProperty(this,"pdf",{get:function(){return e}});var t=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return t},set:function(g){t=Boolean(g)}});var I=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return I},set:function(g){I=Boolean(g)}});var n=0;Object.defineProperty(this,"posX",{get:function(){return n},set:function(g){isNaN(g)||(n=g)}});var C=0;Object.defineProperty(this,"posY",{get:function(){return C},set:function(g){isNaN(g)||(C=g)}}),Object.defineProperty(this,"margin",{get:function(){return i.margin},set:function(g){var e;"number"==typeof g?e=[g,g,g,g]:((e=new Array(4))[0]=g[0],e[1]=g.length>=2?g[1]:e[0],e[2]=g.length>=3?g[2]:e[0],e[3]=g.length>=4?g[3]:e[1]),i.margin=e}});var l=!1;Object.defineProperty(this,"autoPaging",{get:function(){return l},set:function(g){l=g}});var a=0;Object.defineProperty(this,"lastBreak",{get:function(){return a},set:function(g){a=g}});var o=[];Object.defineProperty(this,"pageBreaks",{get:function(){return o},set:function(g){o=g}}),Object.defineProperty(this,"ctx",{get:function(){return i},set:function(g){g instanceof r&&(i=g)}}),Object.defineProperty(this,"path",{get:function(){return i.path},set:function(g){i.path=g}});var c=[];Object.defineProperty(this,"ctxStack",{get:function(){return c},set:function(g){c=g}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(g){var e;e=s(g),this.ctx.fillStyle=e.style,this.ctx.isFillTransparent=0===e.a,this.ctx.fillOpacity=e.a,this.pdf.setFillColor(e.r,e.g,e.b,{a:e.a}),this.pdf.setTextColor(e.r,e.g,e.b,{a:e.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(g){var e=s(g);this.ctx.strokeStyle=e.style,this.ctx.isStrokeTransparent=0===e.a,this.ctx.strokeOpacity=e.a,0===e.a?this.pdf.setDrawColor(255,255,255):(e.a,this.pdf.setDrawColor(e.r,e.g,e.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(g){-1!==["butt","round","square"].indexOf(g)&&(this.ctx.lineCap=g,this.pdf.setLineCap(g))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(g){isNaN(g)||(this.ctx.lineWidth=g,this.pdf.setLineWidth(g))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(g){-1!==["bevel","round","miter"].indexOf(g)&&(this.ctx.lineJoin=g,this.pdf.setLineJoin(g))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(g){isNaN(g)||(this.ctx.miterLimit=g,this.pdf.setMiterLimit(g))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(g){this.ctx.textBaseline=g}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(g){-1!==["right","end","center","left","start"].indexOf(g)&&(this.ctx.textAlign=g)}});var A=null;function d(g,e){if(null===A){var t=function(g){var e=[];return Object.keys(g).forEach((function(t){g[t].forEach((function(g){var I=null;switch(g){case"bold":I={family:t,weight:"bold"};break;case"italic":I={family:t,style:"italic"};break;case"bolditalic":I={family:t,weight:"bold",style:"italic"};break;case"":case"normal":I={family:t}}null!==I&&(I.ref={name:t,style:g},e.push(I))}))})),e}(g.getFontList());A=function(g){for(var e={},t=0;t<g.length;++t){var I=xl(g[t]),n=I.family,C=I.stretch,l=I.style,a=I.weight;e[n]=e[n]||{},e[n][C]=e[n][C]||{},e[n][C][l]=e[n][C][l]||{},e[n][C][l][a]=I}return e}(t.concat(e))}return A}var u=null;Object.defineProperty(this,"fontFaces",{get:function(){return u},set:function(g){A=null,u=g}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(g){var e;if(this.ctx.font=g,null!==(e=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(g))){var t=e[1];e[2];var I=e[3],n=e[4];e[5];var C=e[6],l=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(n)[2];n="px"===l?Math.floor(parseFloat(n)*this.pdf.internal.scaleFactor):"em"===l?Math.floor(parseFloat(n)*this.pdf.getFontSize()):Math.floor(parseFloat(n)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(n);var a=function(g){var e,t,I=[],n=g.trim();if(""===n)return ql;if(n in El)return[El[n]];for(;""!==n;){switch(t=null,e=(n=Ul(n)).charAt(0)){case'"':case"'":t=jl(n.substring(1),e);break;default:t=Ql(n)}if(null===t)return ql;if(I.push(t[0]),""!==(n=Ul(t[1]))&&","!==n.charAt(0))return ql;n=n.replace(/^,/,"")}return I}(C);if(this.fontFaces){var o=function(g,e,t){for(var I=(t=t||{}).defaultFontFamily||"times",n=Object.assign({},zl,t.genericFontFamilies||{}),C=null,l=null,a=0;a<e.length;++a)if(n[(C=xl(e[a])).family]&&(C.family=n[C.family]),g.hasOwnProperty(C.family)){l=g[C.family];break}if(!(l=l||g[I]))throw new Error("Could not find a font-family for the rule '"+Ml(C)+"' and default family '"+I+"'.");if(l=function(g,e){if(e[g])return e[g];var t=Hl[g],I=t<=Hl.normal?-1:1,n=Ll(e,Nl,t,I);if(!n)throw new Error("Could not find a matching font-stretch value for "+g);return n}(C.stretch,l),l=function(g,e){if(e[g])return e[g];for(var t=wl[g],I=0;I<t.length;++I)if(e[t[I]])return e[t[I]];throw new Error("Could not find a matching font-style for "+g)}(C.style,l),!(l=function(g,e){if(e[g])return e[g];if(400===g&&e[500])return e[500];if(500===g&&e[400])return e[400];var t=Kl[g],I=Ll(e,Fl,t,g<400?-1:1);if(!I)throw new Error("Could not find a matching font-weight for value "+g);return I}(C.weight,l)))throw new Error("Failed to resolve a font for the rule '"+Ml(C)+"'.");return l}(d(this.pdf,this.fontFaces),a.map((function(g){return{family:g,stretch:"normal",weight:I,style:t}})));this.pdf.setFont(o.ref.name,o.ref.style)}else{var i="";("bold"===I||parseInt(I,10)>=700||"bold"===t)&&(i="bold"),"italic"===t&&(i+="italic"),0===i.length&&(i="normal");for(var r="",c={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},s=0;s<a.length;s++){if(void 0!==this.pdf.internal.getFont(a[s],i,{noFallback:!0,disableWarning:!0})){r=a[s];break}if("bolditalic"===i&&void 0!==this.pdf.internal.getFont(a[s],"bold",{noFallback:!0,disableWarning:!0}))r=a[s],i="bold";else if(void 0!==this.pdf.internal.getFont(a[s],"normal",{noFallback:!0,disableWarning:!0})){r=a[s],i="normal";break}}if(""===r)for(var A=0;A<a.length;A++)if(c[a[A]]){r=c[a[A]];break}r=""===r?"Times":r,this.pdf.setFont(r,i)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(g){this.ctx.globalCompositeOperation=g}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(g){this.ctx.globalAlpha=g}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(g){this.ctx.lineDashOffset=g,F.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(g){this.ctx.lineDash=g,F.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(g){this.ctx.ignoreClearRect=Boolean(g)}})};c.prototype.setLineDash=function(g){this.lineDash=g},c.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},c.prototype.fill=function(){p.call(this,"fill",!1)},c.prototype.stroke=function(){p.call(this,"stroke",!1)},c.prototype.beginPath=function(){this.path=[{type:"begin"}]},c.prototype.moveTo=function(g,e){if(isNaN(g)||isNaN(e))throw dC.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var t=this.ctx.transform.applyToPoint(new l(g,e));this.path.push({type:"mt",x:t.x,y:t.y}),this.ctx.lastPoint=new l(g,e)},c.prototype.closePath=function(){var g=new l(0,0),e=0;for(e=this.path.length-1;-1!==e;e--)if("begin"===this.path[e].type&&"object"===(0,un.A)(this.path[e+1])&&"number"==typeof this.path[e+1].x){g=new l(this.path[e+1].x,this.path[e+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(g.x,g.y)},c.prototype.lineTo=function(g,e){if(isNaN(g)||isNaN(e))throw dC.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var t=this.ctx.transform.applyToPoint(new l(g,e));this.path.push({type:"lt",x:t.x,y:t.y}),this.ctx.lastPoint=new l(t.x,t.y)},c.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),p.call(this,null,!0)},c.prototype.quadraticCurveTo=function(g,e,t,I){if(isNaN(t)||isNaN(I)||isNaN(g)||isNaN(e))throw dC.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var n=this.ctx.transform.applyToPoint(new l(t,I)),C=this.ctx.transform.applyToPoint(new l(g,e));this.path.push({type:"qct",x1:C.x,y1:C.y,x:n.x,y:n.y}),this.ctx.lastPoint=new l(n.x,n.y)},c.prototype.bezierCurveTo=function(g,e,t,I,n,C){if(isNaN(n)||isNaN(C)||isNaN(g)||isNaN(e)||isNaN(t)||isNaN(I))throw dC.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var a=this.ctx.transform.applyToPoint(new l(n,C)),o=this.ctx.transform.applyToPoint(new l(g,e)),i=this.ctx.transform.applyToPoint(new l(t,I));this.path.push({type:"bct",x1:o.x,y1:o.y,x2:i.x,y2:i.y,x:a.x,y:a.y}),this.ctx.lastPoint=new l(a.x,a.y)},c.prototype.arc=function(g,e,t,I,n,C){if(isNaN(g)||isNaN(e)||isNaN(t)||isNaN(I)||isNaN(n))throw dC.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(C=Boolean(C),!this.ctx.transform.isIdentity){var a=this.ctx.transform.applyToPoint(new l(g,e));g=a.x,e=a.y;var o=this.ctx.transform.applyToPoint(new l(0,t)),i=this.ctx.transform.applyToPoint(new l(0,0));t=Math.sqrt(Math.pow(o.x-i.x,2)+Math.pow(o.y-i.y,2))}Math.abs(n-I)>=2*Math.PI&&(I=0,n=2*Math.PI),this.path.push({type:"arc",x:g,y:e,radius:t,startAngle:I,endAngle:n,counterclockwise:C})},c.prototype.arcTo=function(g,e,t,I,n){throw new Error("arcTo not implemented.")},c.prototype.rect=function(g,e,t,I){if(isNaN(g)||isNaN(e)||isNaN(t)||isNaN(I))throw dC.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(g,e),this.lineTo(g+t,e),this.lineTo(g+t,e+I),this.lineTo(g,e+I),this.lineTo(g,e),this.lineTo(g+t,e),this.lineTo(g,e)},c.prototype.fillRect=function(g,e,t,I){if(isNaN(g)||isNaN(e)||isNaN(t)||isNaN(I))throw dC.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!A.call(this)){var n={};"butt"!==this.lineCap&&(n.lineCap=this.lineCap,this.lineCap="butt"),"miter"!==this.lineJoin&&(n.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(g,e,t,I),this.fill(),n.hasOwnProperty("lineCap")&&(this.lineCap=n.lineCap),n.hasOwnProperty("lineJoin")&&(this.lineJoin=n.lineJoin)}},c.prototype.strokeRect=function(g,e,t,I){if(isNaN(g)||isNaN(e)||isNaN(t)||isNaN(I))throw dC.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");d.call(this)||(this.beginPath(),this.rect(g,e,t,I),this.stroke())},c.prototype.clearRect=function(g,e,t,I){if(isNaN(g)||isNaN(e)||isNaN(t)||isNaN(I))throw dC.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(g,e,t,I))},c.prototype.save=function(g){g="boolean"!=typeof g||g;for(var e=this.pdf.internal.getCurrentPageInfo().pageNumber,t=0;t<this.pdf.internal.getNumberOfPages();t++)this.pdf.setPage(t+1),this.pdf.internal.out("q");if(this.pdf.setPage(e),g){this.ctx.fontSize=this.pdf.internal.getFontSize();var I=new r(this.ctx);this.ctxStack.push(this.ctx),this.ctx=I}},c.prototype.restore=function(g){g="boolean"!=typeof g||g;for(var e=this.pdf.internal.getCurrentPageInfo().pageNumber,t=0;t<this.pdf.internal.getNumberOfPages();t++)this.pdf.setPage(t+1),this.pdf.internal.out("Q");this.pdf.setPage(e),g&&0!==this.ctxStack.length&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},c.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var s=function(g){var e,t,I,n;if(!0===g.isCanvasGradient&&(g=g.getColor()),!g)return{r:0,g:0,b:0,a:0,style:g};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(g))e=0,t=0,I=0,n=0;else{var C=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(g);if(null!==C)e=parseInt(C[1]),t=parseInt(C[2]),I=parseInt(C[3]),n=1;else if(null!==(C=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(g)))e=parseInt(C[1]),t=parseInt(C[2]),I=parseInt(C[3]),n=parseFloat(C[4]);else{if(n=1,"string"==typeof g&&"#"!==g.charAt(0)){var l=new GC(g);g=l.ok?l.toHex():"#000000"}4===g.length?(e=g.substring(1,2),e+=e,t=g.substring(2,3),t+=t,I=g.substring(3,4),I+=I):(e=g.substring(1,3),t=g.substring(3,5),I=g.substring(5,7)),e=parseInt(e,16),t=parseInt(t,16),I=parseInt(I,16)}}return{r:e,g:t,b:I,a:n,style:g}},A=function(){return this.ctx.isFillTransparent||0==this.globalAlpha},d=function(){return Boolean(this.ctx.isStrokeTransparent||0==this.globalAlpha)};c.prototype.fillText=function(g,e,t,I){if(isNaN(e)||isNaN(t)||"string"!=typeof g)throw dC.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(I=isNaN(I)?void 0:I,!A.call(this)){var n=w(this.ctx.transform.rotation),C=this.ctx.transform.scaleX;v.call(this,{text:g,x:e,y:t,scale:C,angle:n,align:this.textAlign,maxWidth:I})}},c.prototype.strokeText=function(g,e,t,I){if(isNaN(e)||isNaN(t)||"string"!=typeof g)throw dC.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!d.call(this)){I=isNaN(I)?void 0:I;var n=w(this.ctx.transform.rotation),C=this.ctx.transform.scaleX;v.call(this,{text:g,x:e,y:t,scale:C,renderingMode:"stroke",angle:n,align:this.textAlign,maxWidth:I})}},c.prototype.measureText=function(g){if("string"!=typeof g)throw dC.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var e=this.pdf,t=this.pdf.internal.scaleFactor,I=e.internal.getFontSize(),n=e.getStringUnitWidth(g)*I/e.internal.scaleFactor;return new function(g){var e=(g=g||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return e}}),this}({width:n*=Math.round(96*t/72*1e4)/1e4})},c.prototype.scale=function(g,e){if(isNaN(g)||isNaN(e))throw dC.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var t=new o(g,0,0,e,0,0);this.ctx.transform=this.ctx.transform.multiply(t)},c.prototype.rotate=function(g){if(isNaN(g))throw dC.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var e=new o(Math.cos(g),Math.sin(g),-Math.sin(g),Math.cos(g),0,0);this.ctx.transform=this.ctx.transform.multiply(e)},c.prototype.translate=function(g,e){if(isNaN(g)||isNaN(e))throw dC.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var t=new o(1,0,0,1,g,e);this.ctx.transform=this.ctx.transform.multiply(t)},c.prototype.transform=function(g,e,t,I,n,C){if(isNaN(g)||isNaN(e)||isNaN(t)||isNaN(I)||isNaN(n)||isNaN(C))throw dC.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var l=new o(g,e,t,I,n,C);this.ctx.transform=this.ctx.transform.multiply(l)},c.prototype.setTransform=function(g,e,t,I,n,C){g=isNaN(g)?1:g,e=isNaN(e)?0:e,t=isNaN(t)?0:t,I=isNaN(I)?1:I,n=isNaN(n)?0:n,C=isNaN(C)?0:C,this.ctx.transform=new o(g,e,t,I,n,C)};var u=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};c.prototype.drawImage=function(g,e,t,I,n,C,l,i,r){var c=this.pdf.getImageProperties(g),s=1,A=1,d=1,h=1;void 0!==I&&void 0!==i&&(d=i/I,h=r/n,s=c.width/I*i/I,A=c.height/n*r/n),void 0===C&&(C=e,l=t,e=0,t=0),void 0!==I&&void 0===i&&(i=I,r=n),void 0===I&&void 0===i&&(i=c.width,r=c.height);for(var p,y=this.ctx.transform.decompose(),B=w(y.rotate.shx),S=new o,f=(S=(S=(S=S.multiply(y.translate)).multiply(y.skew)).multiply(y.scale)).applyToRectangle(new a(C-e*d,l-t*h,I*s,n*A)),W=m.call(this,f),V=[],v=0;v<W.length;v+=1)-1===V.indexOf(W[v])&&V.push(W[v]);if(Z(V),this.autoPaging)for(var R=V[0],X=V[V.length-1],k=R;k<X+1;k++){this.pdf.setPage(k);var J=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Y=1===k?this.posY+this.margin[0]:this.margin[0],N=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],H=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],F=1===k?0:N+(k-2)*H;if(0!==this.ctx.clip_path.length){var K=this.path;p=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(p,this.posX+this.margin[3],-F+Y+this.ctx.prevPageLastElemOffset),G.call(this,"fill",!0),this.path=K}var x=JSON.parse(JSON.stringify(f));x=b([x],this.posX+this.margin[3],-F+Y+this.ctx.prevPageLastElemOffset)[0];var L=(k>R||k<X)&&u.call(this);L&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],J,H,null).clip().discardPath()),this.pdf.addImage(g,"JPEG",x.x,x.y,x.w,x.h,null,null,B),L&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(g,"JPEG",f.x,f.y,f.w,f.h,null,null,B)};var m=function(g,e,t){var I=[];e=e||this.pdf.internal.pageSize.width,t=t||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var n=this.posY+this.ctx.prevPageLastElemOffset;switch(g.type){default:case"mt":case"lt":I.push(Math.floor((g.y+n)/t)+1);break;case"arc":I.push(Math.floor((g.y+n-g.radius)/t)+1),I.push(Math.floor((g.y+n+g.radius)/t)+1);break;case"qct":var C=N(this.ctx.lastPoint.x,this.ctx.lastPoint.y,g.x1,g.y1,g.x,g.y);I.push(Math.floor((C.y+n)/t)+1),I.push(Math.floor((C.y+C.h+n)/t)+1);break;case"bct":var l=H(this.ctx.lastPoint.x,this.ctx.lastPoint.y,g.x1,g.y1,g.x2,g.y2,g.x,g.y);I.push(Math.floor((l.y+n)/t)+1),I.push(Math.floor((l.y+l.h+n)/t)+1);break;case"rect":I.push(Math.floor((g.y+n)/t)+1),I.push(Math.floor((g.y+g.h+n)/t)+1)}for(var a=0;a<I.length;a+=1)for(;this.pdf.internal.getNumberOfPages()<I[a];)h.call(this);return I},h=function(){var g=this.fillStyle,e=this.strokeStyle,t=this.font,I=this.lineCap,n=this.lineWidth,C=this.lineJoin;this.pdf.addPage(),this.fillStyle=g,this.strokeStyle=e,this.font=t,this.lineCap=I,this.lineWidth=n,this.lineJoin=C},b=function(g,e,t){for(var I=0;I<g.length;I++)switch(g[I].type){case"bct":g[I].x2+=e,g[I].y2+=t;case"qct":g[I].x1+=e,g[I].y1+=t;default:g[I].x+=e,g[I].y+=t}return g},Z=function(g){return g.sort((function(g,e){return g-e}))},p=function(g,e){for(var t,I,n=this.fillStyle,C=this.strokeStyle,l=this.lineCap,a=this.lineWidth,o=Math.abs(a*this.ctx.transform.scaleX),i=this.lineJoin,r=JSON.parse(JSON.stringify(this.path)),c=JSON.parse(JSON.stringify(this.path)),s=[],A=0;A<c.length;A++)if(void 0!==c[A].x)for(var d=m.call(this,c[A]),p=0;p<d.length;p+=1)-1===s.indexOf(d[p])&&s.push(d[p]);for(var y=0;y<s.length;y++)for(;this.pdf.internal.getNumberOfPages()<s[y];)h.call(this);if(Z(s),this.autoPaging)for(var B=s[0],S=s[s.length-1],f=B;f<S+1;f++){this.pdf.setPage(f),this.fillStyle=n,this.strokeStyle=C,this.lineCap=l,this.lineWidth=o,this.lineJoin=i;var W=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],V=1===f?this.posY+this.margin[0]:this.margin[0],v=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],R=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],X=1===f?0:v+(f-2)*R;if(0!==this.ctx.clip_path.length){var k=this.path;t=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(t,this.posX+this.margin[3],-X+V+this.ctx.prevPageLastElemOffset),G.call(this,g,!0),this.path=k}if(I=JSON.parse(JSON.stringify(r)),this.path=b(I,this.posX+this.margin[3],-X+V+this.ctx.prevPageLastElemOffset),!1===e||0===f){var J=(f>B||f<S)&&u.call(this);J&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],W,R,null).clip().discardPath()),G.call(this,g,e),J&&this.pdf.restoreGraphicsState()}this.lineWidth=a}else this.lineWidth=o,G.call(this,g,e),this.lineWidth=a;this.path=r},G=function(g,e){if(("stroke"!==g||e||!d.call(this))&&("stroke"===g||e||!A.call(this))){for(var t,I,n=[],C=this.path,l=0;l<C.length;l++){var a=C[l];switch(a.type){case"begin":n.push({begin:!0});break;case"close":n.push({close:!0});break;case"mt":n.push({start:a,deltas:[],abs:[]});break;case"lt":var o=n.length;if(C[l-1]&&!isNaN(C[l-1].x)&&(t=[a.x-C[l-1].x,a.y-C[l-1].y],o>0))for(;o>=0;o--)if(!0!==n[o-1].close&&!0!==n[o-1].begin){n[o-1].deltas.push(t),n[o-1].abs.push(a);break}break;case"bct":t=[a.x1-C[l-1].x,a.y1-C[l-1].y,a.x2-C[l-1].x,a.y2-C[l-1].y,a.x-C[l-1].x,a.y-C[l-1].y],n[n.length-1].deltas.push(t);break;case"qct":var i=C[l-1].x+2/3*(a.x1-C[l-1].x),r=C[l-1].y+2/3*(a.y1-C[l-1].y),c=a.x+2/3*(a.x1-a.x),s=a.y+2/3*(a.y1-a.y),u=a.x,m=a.y;t=[i-C[l-1].x,r-C[l-1].y,c-C[l-1].x,s-C[l-1].y,u-C[l-1].x,m-C[l-1].y],n[n.length-1].deltas.push(t);break;case"arc":n.push({deltas:[],abs:[],arc:!0}),Array.isArray(n[n.length-1].abs)&&n[n.length-1].abs.push(a)}}I=e?null:"stroke"===g?"stroke":"fill";for(var h=!1,b=0;b<n.length;b++)if(n[b].arc)for(var Z=n[b].abs,p=0;p<Z.length;p++){var G=Z[p];"arc"===G.type?S.call(this,G.x,G.y,G.radius,G.startAngle,G.endAngle,G.counterclockwise,void 0,e,!h):R.call(this,G.x,G.y),h=!0}else if(!0===n[b].close)this.pdf.internal.out("h"),h=!1;else if(!0!==n[b].begin){var y=n[b].start.x,B=n[b].start.y;X.call(this,n[b].deltas,y,B),h=!0}I&&f.call(this,I),e&&W.call(this)}},y=function(g){var e=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,t=e*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return g-t;case"top":return g+e-t;case"hanging":return g+e-2*t;case"middle":return g+e/2-t;default:return g}},B=function(g){return g+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};c.prototype.createLinearGradient=function(){var g=function(){};return g.colorStops=[],g.addColorStop=function(g,e){this.colorStops.push([g,e])},g.getColor=function(){return 0===this.colorStops.length?"#000000":this.colorStops[0][1]},g.isCanvasGradient=!0,g},c.prototype.createPattern=function(){return this.createLinearGradient()},c.prototype.createRadialGradient=function(){return this.createLinearGradient()};var S=function(g,e,t,I,n,C,l,a,o){for(var i=J.call(this,t,I,n,C),r=0;r<i.length;r++){var c=i[r];0===r&&(o?V.call(this,c.x1+g,c.y1+e):R.call(this,c.x1+g,c.y1+e)),k.call(this,g,e,c.x2,c.y2,c.x3,c.y3,c.x4,c.y4)}a?W.call(this):f.call(this,l)},f=function(g){switch(g){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},W=function(){this.pdf.clip(),this.pdf.discardPath()},V=function(g,e){this.pdf.internal.out(t(g)+" "+I(e)+" m")},v=function(g){var e;switch(g.align){case"right":case"end":e="right";break;case"center":e="center";break;default:e="left"}var t=this.pdf.getTextDimensions(g.text),I=y.call(this,g.y),n=B.call(this,I)-t.h,C=this.ctx.transform.applyToPoint(new l(g.x,I)),i=this.ctx.transform.decompose(),r=new o;r=(r=(r=r.multiply(i.translate)).multiply(i.skew)).multiply(i.scale);for(var c,s,A,d=this.ctx.transform.applyToRectangle(new a(g.x,I,t.w,t.h)),h=r.applyToRectangle(new a(g.x,n,t.w,t.h)),p=m.call(this,h),S=[],f=0;f<p.length;f+=1)-1===S.indexOf(p[f])&&S.push(p[f]);if(Z(S),this.autoPaging)for(var W=S[0],V=S[S.length-1],v=W;v<V+1;v++){this.pdf.setPage(v);var R=1===v?this.posY+this.margin[0]:this.margin[0],X=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],k=this.pdf.internal.pageSize.height-this.margin[2],J=k-this.margin[0],Y=this.pdf.internal.pageSize.width-this.margin[1],w=Y-this.margin[3],N=1===v?0:X+(v-2)*J;if(0!==this.ctx.clip_path.length){var H=this.path;c=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(c,this.posX+this.margin[3],-1*N+R),G.call(this,"fill",!0),this.path=H}var F=b([JSON.parse(JSON.stringify(h))],this.posX+this.margin[3],-N+R+this.ctx.prevPageLastElemOffset)[0];g.scale>=.01&&(s=this.pdf.internal.getFontSize(),this.pdf.setFontSize(s*g.scale),A=this.lineWidth,this.lineWidth=A*g.scale);var K="text"!==this.autoPaging;if(K||F.y+F.h<=k){if(K||F.y>=R&&F.x<=Y){var x=K?g.text:this.pdf.splitTextToSize(g.text,g.maxWidth||Y-F.x)[0],L=b([JSON.parse(JSON.stringify(d))],this.posX+this.margin[3],-N+R+this.ctx.prevPageLastElemOffset)[0],z=K&&(v>W||v<V)&&u.call(this);z&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],w,J,null).clip().discardPath()),this.pdf.text(x,L.x,L.y,{angle:g.angle,align:e,renderingMode:g.renderingMode}),z&&this.pdf.restoreGraphicsState()}}else F.y<k&&(this.ctx.prevPageLastElemOffset+=k-F.y);g.scale>=.01&&(this.pdf.setFontSize(s),this.lineWidth=A)}else g.scale>=.01&&(s=this.pdf.internal.getFontSize(),this.pdf.setFontSize(s*g.scale),A=this.lineWidth,this.lineWidth=A*g.scale),this.pdf.text(g.text,C.x+this.posX,C.y+this.posY,{angle:g.angle,align:e,renderingMode:g.renderingMode,maxWidth:g.maxWidth}),g.scale>=.01&&(this.pdf.setFontSize(s),this.lineWidth=A)},R=function(g,e,n,C){n=n||0,C=C||0,this.pdf.internal.out(t(g+n)+" "+I(e+C)+" l")},X=function(g,e,t){return this.pdf.lines(g,e,t,null,null)},k=function(g,t,I,l,a,o,i,r){this.pdf.internal.out([e(n(I+g)),e(C(l+t)),e(n(a+g)),e(C(o+t)),e(n(i+g)),e(C(r+t)),"c"].join(" "))},J=function(g,e,t,I){for(var n=2*Math.PI,C=Math.PI/2;e>t;)e-=n;var l=Math.abs(t-e);l<n&&I&&(l=n-l);for(var a=[],o=I?-1:1,i=e;l>1e-5;){var r=i+o*Math.min(l,C);a.push(Y.call(this,g,i,r)),l-=Math.abs(r-i),i=r}return a},Y=function(g,e,t){var I=(t-e)/2,n=g*Math.cos(I),C=g*Math.sin(I),l=n,a=-C,o=l*l+a*a,i=o+l*n+a*C,r=4/3*(Math.sqrt(2*o*i)-i)/(l*C-a*n),c=l-r*a,s=a+r*l,A=c,d=-s,u=I+e,m=Math.cos(u),h=Math.sin(u);return{x1:g*Math.cos(e),y1:g*Math.sin(e),x2:c*m-s*h,y2:c*h+s*m,x3:A*m-d*h,y3:A*h+d*m,x4:g*Math.cos(t),y4:g*Math.sin(t)}},w=function(g){return 180*g/Math.PI},N=function(g,e,t,I,n,C){var l=g+.5*(t-g),o=e+.5*(I-e),i=n+.5*(t-n),r=C+.5*(I-C),c=Math.min(g,n,l,i),s=Math.max(g,n,l,i),A=Math.min(e,C,o,r),d=Math.max(e,C,o,r);return new a(c,A,s-c,d-A)},H=function(g,e,t,I,n,C,l,o){var i,r,c,s,A,d,u,m,h,b,Z,p,G,y,B=t-g,S=I-e,f=n-t,W=C-I,V=l-n,v=o-C;for(r=0;r<41;r++)h=(u=(c=g+(i=r/40)*B)+i*((A=t+i*f)-c))+i*(A+i*(n+i*V-A)-u),b=(m=(s=e+i*S)+i*((d=I+i*W)-s))+i*(d+i*(C+i*v-d)-m),0==r?(Z=h,p=b,G=h,y=b):(Z=Math.min(Z,h),p=Math.min(p,b),G=Math.max(G,h),y=Math.max(y,b));return new a(Math.round(Z),Math.round(p),Math.round(G-Z),Math.round(y-p))},F=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var g,e,t=(g=this.ctx.lineDash,e=this.ctx.lineDashOffset,JSON.stringify({lineDash:g,lineDashOffset:e}));this.prevLineDash!==t&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=t)}}}(jC.API),function(g){var e=function(g){var e,t,I,n,C,l,a,o,i,r;for(/[^\x00-\xFF]/.test(g),t=[],I=0,n=(g+=e="\0\0\0\0".slice(g.length%4||4)).length;n>I;I+=4)0!==(C=(g.charCodeAt(I)<<24)+(g.charCodeAt(I+1)<<16)+(g.charCodeAt(I+2)<<8)+g.charCodeAt(I+3))?(l=(C=((C=((C=((C=(C-(r=C%85))/85)-(i=C%85))/85)-(o=C%85))/85)-(a=C%85))/85)%85,t.push(l+33,a+33,o+33,i+33,r+33)):t.push(122);return function(g,e){for(var t=e;t>0;t--)g.pop()}(t,e.length),String.fromCharCode.apply(String,t)+"~>"},t=function(g){var e,t,I,n,C,l=String,a="length",o=255,i="charCodeAt",r="slice",c="replace";for(g[r](-2),g=g[r](0,-2)[c](/\s/g,"")[c]("z","!!!!!"),I=[],n=0,C=(g+=e="uuuuu"[r](g[a]%5||5))[a];C>n;n+=5)t=52200625*(g[i](n)-33)+614125*(g[i](n+1)-33)+7225*(g[i](n+2)-33)+85*(g[i](n+3)-33)+(g[i](n+4)-33),I.push(o&t>>24,o&t>>16,o&t>>8,o&t);return function(g,e){for(var t=e;t>0;t--)g.pop()}(I,e[a]),l.fromCharCode.apply(l,I)},I=function(g){var e=new RegExp(/^([0-9A-Fa-f]{2})+$/);if(-1!==(g=g.replace(/\s/g,"")).indexOf(">")&&(g=g.substr(0,g.indexOf(">"))),g.length%2&&(g+="0"),!1===e.test(g))return"";for(var t="",I=0;I<g.length;I+=2)t+=String.fromCharCode("0x"+(g[I]+g[I+1]));return t},n=function(g){for(var e=new Uint8Array(g.length),t=g.length;t--;)e[t]=g.charCodeAt(t);return(e=iC(e)).reduce((function(g,e){return g+String.fromCharCode(e)}),"")};g.processDataByFilters=function(g,C){var l=0,a=g||"",o=[];for("string"==typeof(C=C||[])&&(C=[C]),l=0;l<C.length;l+=1)switch(C[l]){case"ASCII85Decode":case"/ASCII85Decode":a=t(a),o.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":a=e(a),o.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":a=I(a),o.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":a=a.split("").map((function(g){return("0"+g.charCodeAt().toString(16)).slice(-2)})).join("")+">",o.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":a=n(a),o.push("/FlateDecode");break;default:throw new Error('The filter: "'+C[l]+'" is not implemented')}return{data:a,reverseChain:o.reverse().join(" ")}}}(jC.API),(Ol=jC.API).loadFile=function(g,e,t){return function(g,e,t){e=!1!==e,t="function"==typeof t?t:function(){};var I=void 0;try{I=function(g,e,t){var I=new XMLHttpRequest,n=0,C=function(g){var e=g.length,t=[],I=String.fromCharCode;for(n=0;n<e;n+=1)t.push(I(255&g.charCodeAt(n)));return t.join("")};if(I.open("GET",g,!e),I.overrideMimeType("text/plain; charset=x-user-defined"),!1===e&&(I.onload=function(){200===I.status?t(C(this.responseText)):t(void 0)}),I.send(null),e&&200===I.status)return C(I.responseText)}(g,e,t)}catch(g){}return I}(g,e,t)},Ol.loadImageFile=Ol.loadFile,function(g){function e(){return(sC.html2canvas?Promise.resolve(sC.html2canvas):t.e(204).then(t.t.bind(t,7204,23))).catch((function(g){return Promise.reject(new Error("Could not load html2canvas: "+g))})).then((function(g){return g.default?g.default:g}))}function I(){return(sC.DOMPurify?Promise.resolve(sC.DOMPurify):t.e(12).then(t.bind(t,1012))).catch((function(g){return Promise.reject(new Error("Could not load dompurify: "+g))})).then((function(g){return g.default?g.default:g}))}var n=function(g){var e=(0,un.A)(g);return"undefined"===e?"undefined":"string"===e||g instanceof String?"string":"number"===e||g instanceof Number?"number":"function"===e||g instanceof Function?"function":g&&g.constructor===Array?"array":g&&1===g.nodeType?"element":"object"===e?"object":"unknown"},C=function(g,e){var t=document.createElement(g);for(var I in e.className&&(t.className=e.className),e.innerHTML&&e.dompurify&&(t.innerHTML=e.dompurify.sanitize(e.innerHTML)),e.style)t.style[I]=e.style[I];return t},l=function g(e){var t=Object.assign(g.convert(Promise.resolve()),JSON.parse(JSON.stringify(g.template))),I=g.convert(Promise.resolve(),t);return(I=I.setProgress(1,g,1,[g])).set(e)};(l.prototype=Object.create(Promise.prototype)).constructor=l,l.convert=function(g,e){return g.__proto__=e||l.prototype,g},l.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},l.prototype.from=function(g,e){return this.then((function(){switch(e=e||function(g){switch(n(g)){case"string":return"string";case"element":return"canvas"===g.nodeName.toLowerCase()?"canvas":"element";default:return"unknown"}}(g)){case"string":return this.then(I).then((function(e){return this.set({src:C("div",{innerHTML:g,dompurify:e})})}));case"element":return this.set({src:g});case"canvas":return this.set({canvas:g});case"img":return this.set({img:g});default:return this.error("Unknown source type.")}}))},l.prototype.to=function(g){switch(g){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},l.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then((function(){var g={position:"relative",display:"inline-block",width:("number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},e=function g(e,t){for(var I=3===e.nodeType?document.createTextNode(e.nodeValue):e.cloneNode(!1),n=e.firstChild;n;n=n.nextSibling)!0!==t&&1===n.nodeType&&"SCRIPT"===n.nodeName||I.appendChild(g(n,t));return 1===e.nodeType&&("CANVAS"===e.nodeName?(I.width=e.width,I.height=e.height,I.getContext("2d").drawImage(e,0,0)):"TEXTAREA"!==e.nodeName&&"SELECT"!==e.nodeName||(I.value=e.value),I.addEventListener("load",(function(){I.scrollTop=e.scrollTop,I.scrollLeft=e.scrollLeft}),!0)),I}(this.prop.src,this.opt.html2canvas.javascriptEnabled);"BODY"===e.tagName&&(g.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=C("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=C("div",{className:"html2pdf__container",style:g}),this.prop.container.appendChild(e),this.prop.container.firstChild.appendChild(C("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"}))},l.prototype.toCanvas=function(){var g=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(g).then(e).then((function(g){var e=Object.assign({},this.opt.html2canvas);return delete e.onrendered,g(this.prop.container,e)})).then((function(g){(this.opt.html2canvas.onrendered||function(){})(g),this.prop.canvas=g,document.body.removeChild(this.prop.overlay)}))},l.prototype.toContext2d=function(){var g=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(g).then(e).then((function(g){var e=this.opt.jsPDF,t=this.opt.fontFaces,I="number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,n=Object.assign({async:!0,allowTaint:!0,scale:I,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete n.onrendered,e.context2d.autoPaging=void 0===this.opt.autoPaging||this.opt.autoPaging,e.context2d.posX=this.opt.x,e.context2d.posY=this.opt.y,e.context2d.margin=this.opt.margin,e.context2d.fontFaces=t,t)for(var C=0;C<t.length;++C){var l=t[C],a=l.src.find((function(g){return"truetype"===g.format}));a&&e.addFont(a.url,l.ref.name,l.ref.style)}return n.windowHeight=n.windowHeight||0,n.windowHeight=0==n.windowHeight?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):n.windowHeight,e.context2d.save(!0),g(this.prop.container,n)})).then((function(g){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(g),this.prop.canvas=g,document.body.removeChild(this.prop.overlay)}))},l.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then((function(){var g=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=g}))},l.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then((function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF}))},l.prototype.output=function(g,e,t){return"img"===(t=t||"pdf").toLowerCase()||"image"===t.toLowerCase()?this.outputImg(g,e):this.outputPdf(g,e)},l.prototype.outputPdf=function(g,e){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){return this.prop.pdf.output(g,e)}))},l.prototype.outputImg=function(g){return this.thenList([function(){return this.prop.img||this.toImg()}]).then((function(){switch(g){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+g+'" is not supported.'}}))},l.prototype.save=function(g){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(g?{filename:g}:null).then((function(){this.prop.pdf.save(this.opt.filename)}))},l.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){this.prop.callback(this.prop.pdf)}))},l.prototype.set=function(g){if("object"!==n(g))return this;var e=Object.keys(g||{}).map((function(e){if(e in l.template.prop)return function(){this.prop[e]=g[e]};switch(e){case"margin":return this.setMargin.bind(this,g.margin);case"jsPDF":return function(){return this.opt.jsPDF=g.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,g.pageSize);default:return function(){this.opt[e]=g[e]}}}),this);return this.then((function(){return this.thenList(e)}))},l.prototype.get=function(g,e){return this.then((function(){var t=g in l.template.prop?this.prop[g]:this.opt[g];return e?e(t):t}))},l.prototype.setMargin=function(g){return this.then((function(){switch(n(g)){case"number":g=[g,g,g,g];case"array":if(2===g.length&&(g=[g[0],g[1],g[0],g[1]]),4===g.length)break;default:return this.error("Invalid margin array.")}this.opt.margin=g})).then(this.setPageSize)},l.prototype.setPageSize=function(g){function e(g,e){return Math.floor(g*e/72*96)}return this.then((function(){(g=g||jC.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(g.inner={width:g.width-this.opt.margin[1]-this.opt.margin[3],height:g.height-this.opt.margin[0]-this.opt.margin[2]},g.inner.px={width:e(g.inner.width,g.k),height:e(g.inner.height,g.k)},g.inner.ratio=g.inner.height/g.inner.width),this.prop.pageSize=g}))},l.prototype.setProgress=function(g,e,t,I){return null!=g&&(this.progress.val=g),null!=e&&(this.progress.state=e),null!=t&&(this.progress.n=t),null!=I&&(this.progress.stack=I),this.progress.ratio=this.progress.val/this.progress.state,this},l.prototype.updateProgress=function(g,e,t,I){return this.setProgress(g?this.progress.val+g:null,e||null,t?this.progress.n+t:null,I?this.progress.stack.concat(I):null)},l.prototype.then=function(g,e){var t=this;return this.thenCore(g,e,(function(g,e){return t.updateProgress(null,null,1,[g]),Promise.prototype.then.call(this,(function(e){return t.updateProgress(null,g),e})).then(g,e).then((function(g){return t.updateProgress(1),g}))}))},l.prototype.thenCore=function(g,e,t){t=t||Promise.prototype.then,g&&(g=g.bind(this)),e&&(e=e.bind(this));var I=-1!==Promise.toString().indexOf("[native code]")&&"Promise"===Promise.name?this:l.convert(Object.assign({},this),Promise.prototype),n=t.call(I,g,e);return l.convert(n,this.__proto__)},l.prototype.thenExternal=function(g,e){return Promise.prototype.then.call(this,g,e)},l.prototype.thenList=function(g){var e=this;return g.forEach((function(g){e=e.thenCore(g)})),e},l.prototype.catch=function(g){g&&(g=g.bind(this));var e=Promise.prototype.catch.call(this,g);return l.convert(e,this)},l.prototype.catchExternal=function(g){return Promise.prototype.catch.call(this,g)},l.prototype.error=function(g){return this.then((function(){throw new Error(g)}))},l.prototype.using=l.prototype.set,l.prototype.saveAs=l.prototype.save,l.prototype.export=l.prototype.output,l.prototype.run=l.prototype.then,jC.getPageSize=function(g,e,t){if("object"===(0,un.A)(g)){var I=g;g=I.orientation,e=I.unit||e,t=I.format||t}e=e||"mm",t=t||"a4",g=(""+(g||"P")).toLowerCase();var n,C=(""+t).toLowerCase(),l={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(e){case"pt":n=1;break;case"mm":n=72/25.4;break;case"cm":n=72/2.54;break;case"in":n=72;break;case"px":n=.75;break;case"pc":case"em":n=12;break;case"ex":n=6;break;default:throw"Invalid unit: "+e}var a,o=0,i=0;if(l.hasOwnProperty(C))o=l[C][1]/n,i=l[C][0]/n;else try{o=t[1],i=t[0]}catch(Ol){throw new Error("Invalid format: "+t)}if("p"===g||"portrait"===g)g="p",i>o&&(a=i,i=o,o=a);else{if("l"!==g&&"landscape"!==g)throw"Invalid orientation: "+g;g="l",o>i&&(a=i,i=o,o=a)}return{width:i,height:o,unit:e,k:n,orientation:g}},g.html=function(g,e){(e=e||{}).callback=e.callback||function(){},e.html2canvas=e.html2canvas||{},e.html2canvas.canvas=e.html2canvas.canvas||this.canvas,e.jsPDF=e.jsPDF||this,e.fontFaces=e.fontFaces?e.fontFaces.map(xl):null;var t=new l(e);return e.worker?t:t.from(g).doCallback()}}(jC.API),jC.API.addJS=function(g){return Pl=g,this.internal.events.subscribe("postPutResources",(function(){Dl=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Dl+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Tl=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Pl+")"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){void 0!==Dl&&void 0!==Tl&&this.internal.out("/Names <</JavaScript "+Dl+" 0 R>>")})),this},function(g){var e;g.events.push(["postPutResources",function(){var g=this,t=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var I=g.outline.render().split(/\r\n/),n=0;n<I.length;n++){var C=I[n],l=t.exec(C);if(null!=l){var a=l[1];g.internal.newObjectDeferredBegin(a,!1)}g.internal.write(C)}if(this.outline.createNamedDestinations){var o=this.internal.pages.length,i=[];for(n=0;n<o;n++){var r=g.internal.newObject();i.push(r);var c=g.internal.getPageInfo(n+1);g.internal.write("<< /D["+c.objId+" 0 R /XYZ null null null]>> endobj")}var s=g.internal.newObject();for(g.internal.write("<< /Names [ "),n=0;n<i.length;n++)g.internal.write("(page_"+(n+1)+")"+i[n]+" 0 R");g.internal.write(" ] >>","endobj"),e=g.internal.newObject(),g.internal.write("<< /Dests "+s+" 0 R"),g.internal.write(">>","endobj")}}]),g.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),g.events.push(["initialized",function(){var g=this;g.outline={createNamedDestinations:!1,root:{children:[]}},g.outline.add=function(g,e,t){var I={title:e,options:t,children:[]};return null==g&&(g=this.root),g.children.push(I),I},g.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=g,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},g.outline.genIds_r=function(e){e.id=g.internal.newObjectDeferred();for(var t=0;t<e.children.length;t++)this.genIds_r(e.children[t])},g.outline.renderRoot=function(g){this.objStart(g),this.line("/Type /Outlines"),g.children.length>0&&(this.line("/First "+this.makeRef(g.children[0])),this.line("/Last "+this.makeRef(g.children[g.children.length-1]))),this.line("/Count "+this.count_r({count:0},g)),this.objEnd()},g.outline.renderItems=function(e){for(var t=this.ctx.pdf.internal.getVerticalCoordinateString,I=0;I<e.children.length;I++){var n=e.children[I];this.objStart(n),this.line("/Title "+this.makeString(n.title)),this.line("/Parent "+this.makeRef(e)),I>0&&this.line("/Prev "+this.makeRef(e.children[I-1])),I<e.children.length-1&&this.line("/Next "+this.makeRef(e.children[I+1])),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1])));var C=this.count=this.count_r({count:0},n);if(C>0&&this.line("/Count "+C),n.options&&n.options.pageNumber){var l=g.internal.getPageInfo(n.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+t(0)+" 0]")}this.objEnd()}for(var a=0;a<e.children.length;a++)this.renderItems(e.children[a])},g.outline.line=function(g){this.ctx.val+=g+"\r\n"},g.outline.makeRef=function(g){return g.id+" 0 R"},g.outline.makeString=function(e){return"("+g.internal.pdfEscape(e)+")"},g.outline.objStart=function(g){this.ctx.val+="\r\n"+g.id+" 0 obj\r\n<<\r\n"},g.outline.objEnd=function(){this.ctx.val+=">> \r\nendobj\r\n"},g.outline.count_r=function(g,e){for(var t=0;t<e.children.length;t++)g.count++,this.count_r(g,e.children[t]);return g.count}}])}(jC.API),function(g){var e=[192,193,194,195,196,197,198,199];g.processJPEG=function(g,t,I,n,C,l){var a,o=this.decode.DCT_DECODE,i=null;if("string"==typeof g||this.__addimage__.isArrayBuffer(g)||this.__addimage__.isArrayBufferView(g)){switch(g=C||g,g=this.__addimage__.isArrayBuffer(g)?new Uint8Array(g):g,(a=function(g){for(var t,I=256*g.charCodeAt(4)+g.charCodeAt(5),n=g.length,C={width:0,height:0,numcomponents:1},l=4;l<n;l+=2){if(l+=I,-1!==e.indexOf(g.charCodeAt(l+1))){t=256*g.charCodeAt(l+5)+g.charCodeAt(l+6),C={width:256*g.charCodeAt(l+7)+g.charCodeAt(l+8),height:t,numcomponents:g.charCodeAt(l+9)};break}I=256*g.charCodeAt(l+2)+g.charCodeAt(l+3)}return C}(g=this.__addimage__.isArrayBufferView(g)?this.__addimage__.arrayBufferToBinaryString(g):g)).numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}i={data:g,width:a.width,height:a.height,colorSpace:l,bitsPerComponent:8,filter:o,index:t,alias:I}}return i}}(jC.API);var _l,$l,ga,ea,ta,Ia=function(){var g,e,t;function I(g){var e,t,I,n,C,l,a,o,i,r,c,s,A,d;for(this.data=g,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},l=null;;){switch(e=this.readUInt32(),i=function(){var g,e;for(e=[],g=0;g<4;++g)e.push(String.fromCharCode(this.data[this.pos++]));return e}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(e);break;case"fcTL":l&&this.animation.frames.push(l),this.pos+=4,l={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},C=this.readUInt16(),n=this.readUInt16()||100,l.delay=1e3*C/n,l.disposeOp=this.data[this.pos++],l.blendOp=this.data[this.pos++],l.data=[];break;case"IDAT":case"fdAT":for("fdAT"===i&&(this.pos+=4,e-=4),g=(null!=l?l.data:void 0)||this.imgData,s=0;0<=e?s<e:s>e;0<=e?++s:--s)g.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(I=this.palette.length/3,this.transparency.indexed=this.read(e),this.transparency.indexed.length>I)throw new Error("More transparent colors than palette size");if((r=I-this.transparency.indexed.length)>0)for(A=0;0<=r?A<r:A>r;0<=r?++A:--A)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(e)[0];break;case 2:this.transparency.rgb=this.read(e)}break;case"tEXt":a=(c=this.read(e)).indexOf(0),o=String.fromCharCode.apply(String,c.slice(0,a)),this.text[o]=String.fromCharCode.apply(String,c.slice(a+1));break;case"IEND":return l&&this.animation.frames.push(l),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(d=this.colorType)||6===d,t=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*t,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=e}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}I.prototype.read=function(g){var e,t;for(t=[],e=0;0<=g?e<g:e>g;0<=g?++e:--e)t.push(this.data[this.pos++]);return t},I.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},I.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},I.prototype.decodePixels=function(g){var e=this.pixelBitlength/8,t=new Uint8Array(this.width*this.height*e),I=0,n=this;if(null==g&&(g=this.imgData),0===g.length)return new Uint8Array(0);function C(C,l,a,o){var i,r,c,s,A,d,u,m,h,b,Z,p,G,y,B,S,f,W,V,v,R,X=Math.ceil((n.width-C)/a),k=Math.ceil((n.height-l)/o),J=n.width==X&&n.height==k;for(y=e*X,p=J?t:new Uint8Array(y*k),d=g.length,G=0,r=0;G<k&&I<d;){switch(g[I++]){case 0:for(s=f=0;f<y;s=f+=1)p[r++]=g[I++];break;case 1:for(s=W=0;W<y;s=W+=1)i=g[I++],A=s<e?0:p[r-e],p[r++]=(i+A)%256;break;case 2:for(s=V=0;V<y;s=V+=1)i=g[I++],c=(s-s%e)/e,B=G&&p[(G-1)*y+c*e+s%e],p[r++]=(B+i)%256;break;case 3:for(s=v=0;v<y;s=v+=1)i=g[I++],c=(s-s%e)/e,A=s<e?0:p[r-e],B=G&&p[(G-1)*y+c*e+s%e],p[r++]=(i+Math.floor((A+B)/2))%256;break;case 4:for(s=R=0;R<y;s=R+=1)i=g[I++],c=(s-s%e)/e,A=s<e?0:p[r-e],0===G?B=S=0:(B=p[(G-1)*y+c*e+s%e],S=c&&p[(G-1)*y+(c-1)*e+s%e]),u=A+B-S,m=Math.abs(u-A),b=Math.abs(u-B),Z=Math.abs(u-S),h=m<=b&&m<=Z?A:b<=Z?B:S,p[r++]=(i+h)%256;break;default:throw new Error("Invalid filter algorithm: "+g[I-1])}if(!J){var Y=((l+G*o)*n.width+C)*e,w=G*y;for(s=0;s<X;s+=1){for(var N=0;N<e;N+=1)t[Y++]=p[w++];Y+=(a-1)*e}}G++}}return g=rC(g),1==n.interlaceMethod?(C(0,0,8,8),C(4,0,8,8),C(0,4,4,8),C(2,0,4,4),C(0,2,2,4),C(1,0,2,2),C(0,1,1,2)):C(0,0,1,1),t},I.prototype.decodePalette=function(){var g,e,t,I,n,C,l,a,o;for(t=this.palette,C=this.transparency.indexed||[],n=new Uint8Array((C.length||0)+t.length),I=0,g=0,e=l=0,a=t.length;l<a;e=l+=3)n[I++]=t[e],n[I++]=t[e+1],n[I++]=t[e+2],n[I++]=null!=(o=C[g++])?o:255;return n},I.prototype.copyToImageData=function(g,e){var t,I,n,C,l,a,o,i,r,c,s;if(I=this.colors,r=null,t=this.hasAlphaChannel,this.palette.length&&(r=null!=(s=this._decodedPalette)?s:this._decodedPalette=this.decodePalette(),I=4,t=!0),i=(n=g.data||g).length,l=r||e,C=a=0,1===I)for(;C<i;)o=r?4*e[C/4]:a,c=l[o++],n[C++]=c,n[C++]=c,n[C++]=c,n[C++]=t?l[o++]:255,a=o;else for(;C<i;)o=r?4*e[C/4]:a,n[C++]=l[o++],n[C++]=l[o++],n[C++]=l[o++],n[C++]=t?l[o++]:255,a=o},I.prototype.decode=function(){var g;return g=new Uint8Array(this.width*this.height*4),this.copyToImageData(g,this.decodePixels()),g};var n=function(){if("[object Window]"===Object.prototype.toString.call(sC)){try{e=sC.document.createElement("canvas"),t=e.getContext("2d")}catch(g){return!1}return!0}return!1};return n(),g=function(g){var I;if(!0===n())return t.width=g.width,t.height=g.height,t.clearRect(0,0,g.width,g.height),t.putImageData(g,0,0),(I=new Image).src=e.toDataURL(),I;throw new Error("This method requires a Browser with Canvas-capability.")},I.prototype.decodeFrames=function(e){var t,I,n,C,l,a,o,i;if(this.animation){for(i=[],I=l=0,a=(o=this.animation.frames).length;l<a;I=++l)t=o[I],n=e.createImageData(t.width,t.height),C=this.decodePixels(new Uint8Array(t.data)),this.copyToImageData(n,C),t.imageData=n,i.push(t.image=g(n));return i}},I.prototype.renderFrame=function(g,e){var t,I,n;return t=(I=this.animation.frames)[e],n=I[e-1],0===e&&g.clearRect(0,0,this.width,this.height),1===(null!=n?n.disposeOp:void 0)?g.clearRect(n.xOffset,n.yOffset,n.width,n.height):2===(null!=n?n.disposeOp:void 0)&&g.putImageData(n.imageData,n.xOffset,n.yOffset),0===t.blendOp&&g.clearRect(t.xOffset,t.yOffset,t.width,t.height),g.drawImage(t.image,t.xOffset,t.yOffset)},I.prototype.animate=function(g){var e,t,I,n,C,l,a=this;return t=0,l=this.animation,n=l.numFrames,I=l.frames,C=l.numPlays,(e=function(){var l,o;if(l=t++%n,o=I[l],a.renderFrame(g,l),n>1&&t/n<C)return a.animation._timeout=setTimeout(e,o.delay)})()},I.prototype.stopAnimation=function(){var g;return clearTimeout(null!=(g=this.animation)?g._timeout:void 0)},I.prototype.render=function(g){var e,t;return g._png&&g._png.stopAnimation(),g._png=this,g.width=this.width,g.height=this.height,e=g.getContext("2d"),this.animation?(this.decodeFrames(e),this.animate(e)):(t=e.createImageData(this.width,this.height),this.copyToImageData(t,this.decodePixels()),e.putImageData(t,0,0))},I}();function na(g){var e=0;if(71!==g[e++]||73!==g[e++]||70!==g[e++]||56!==g[e++]||56!=(g[e++]+1&253)||97!==g[e++])throw new Error("Invalid GIF 87a/89a header.");var t=g[e++]|g[e++]<<8,I=g[e++]|g[e++]<<8,n=g[e++],C=n>>7,l=1<<1+(7&n);g[e++],g[e++];var a=null,o=null;C&&(a=e,o=l,e+=3*l);var i=!0,r=[],c=0,s=null,A=0,d=null;for(this.width=t,this.height=I;i&&e<g.length;)switch(g[e++]){case 33:switch(g[e++]){case 255:if(11!==g[e]||78==g[e+1]&&69==g[e+2]&&84==g[e+3]&&83==g[e+4]&&67==g[e+5]&&65==g[e+6]&&80==g[e+7]&&69==g[e+8]&&50==g[e+9]&&46==g[e+10]&&48==g[e+11]&&3==g[e+12]&&1==g[e+13]&&0==g[e+16])e+=14,d=g[e++]|g[e++]<<8,e++;else for(e+=12;;){if(!((V=g[e++])>=0))throw Error("Invalid block size");if(0===V)break;e+=V}break;case 249:if(4!==g[e++]||0!==g[e+4])throw new Error("Invalid graphics extension block.");var u=g[e++];c=g[e++]|g[e++]<<8,s=g[e++],0==(1&u)&&(s=null),A=u>>2&7,e++;break;case 254:for(;;){if(!((V=g[e++])>=0))throw Error("Invalid block size");if(0===V)break;e+=V}break;default:throw new Error("Unknown graphic control label: 0x"+g[e-1].toString(16))}break;case 44:var m=g[e++]|g[e++]<<8,h=g[e++]|g[e++]<<8,b=g[e++]|g[e++]<<8,Z=g[e++]|g[e++]<<8,p=g[e++],G=p>>6&1,y=1<<1+(7&p),B=a,S=o,f=!1;p>>7&&(f=!0,B=e,S=y,e+=3*y);var W=e;for(e++;;){var V;if(!((V=g[e++])>=0))throw Error("Invalid block size");if(0===V)break;e+=V}r.push({x:m,y:h,width:b,height:Z,has_local_palette:f,palette_offset:B,palette_size:S,data_offset:W,data_length:e-W,transparent_index:s,interlaced:!!G,delay:c,disposal:A});break;case 59:i=!1;break;default:throw new Error("Unknown gif block: 0x"+g[e-1].toString(16))}this.numFrames=function(){return r.length},this.loopCount=function(){return d},this.frameInfo=function(g){if(g<0||g>=r.length)throw new Error("Frame index out of range.");return r[g]},this.decodeAndBlitFrameBGRA=function(e,I){var n=this.frameInfo(e),C=n.width*n.height,l=new Uint8Array(C);Ca(g,n.data_offset,l,C);var a=n.palette_offset,o=n.transparent_index;null===o&&(o=256);var i=n.width,r=t-i,c=i,s=4*(n.y*t+n.x),A=4*((n.y+n.height)*t+n.x),d=s,u=4*r;!0===n.interlaced&&(u+=4*t*7);for(var m=8,h=0,b=l.length;h<b;++h){var Z=l[h];if(0===c&&(c=i,(d+=u)>=A&&(u=4*r+4*t*(m-1),d=s+(i+r)*(m<<1),m>>=1)),Z===o)d+=4;else{var p=g[a+3*Z],G=g[a+3*Z+1],y=g[a+3*Z+2];I[d++]=y,I[d++]=G,I[d++]=p,I[d++]=255}--c}},this.decodeAndBlitFrameRGBA=function(e,I){var n=this.frameInfo(e),C=n.width*n.height,l=new Uint8Array(C);Ca(g,n.data_offset,l,C);var a=n.palette_offset,o=n.transparent_index;null===o&&(o=256);var i=n.width,r=t-i,c=i,s=4*(n.y*t+n.x),A=4*((n.y+n.height)*t+n.x),d=s,u=4*r;!0===n.interlaced&&(u+=4*t*7);for(var m=8,h=0,b=l.length;h<b;++h){var Z=l[h];if(0===c&&(c=i,(d+=u)>=A&&(u=4*r+4*t*(m-1),d=s+(i+r)*(m<<1),m>>=1)),Z===o)d+=4;else{var p=g[a+3*Z],G=g[a+3*Z+1],y=g[a+3*Z+2];I[d++]=p,I[d++]=G,I[d++]=y,I[d++]=255}--c}}}function Ca(g,e,t,I){for(var n=g[e++],C=1<<n,l=C+1,a=l+1,o=n+1,i=(1<<o)-1,r=0,c=0,s=0,A=g[e++],d=new Int32Array(4096),u=null;;){for(;r<16&&0!==A;)c|=g[e++]<<r,r+=8,1===A?A=g[e++]:--A;if(r<o)break;var m=c&i;if(c>>=o,r-=o,m!==C){if(m===l)break;for(var h=m<a?m:u,b=0,Z=h;Z>C;)Z=d[Z]>>8,++b;var p=Z;if(s+b+(h!==m?1:0)>I)return void dC.log("Warning, gif stream longer than expected.");t[s++]=p;var G=s+=b;for(h!==m&&(t[s++]=p),Z=h;b--;)Z=d[Z],t[--G]=255&Z,Z>>=8;null!==u&&a<4096&&(d[a++]=u<<8|p,a>=i+1&&o<12&&(++o,i=i<<1|1)),u=m}else a=l+1,i=(1<<(o=n+1))-1,u=null}return s!==I&&dC.log("Warning, gif stream shorter than expected."),t}function la(g){var e,t,I,n,C,l=Math.floor,a=new Array(64),o=new Array(64),i=new Array(64),r=new Array(64),c=new Array(65535),s=new Array(65535),A=new Array(64),d=new Array(64),u=[],m=0,h=7,b=new Array(64),Z=new Array(64),p=new Array(64),G=new Array(256),y=new Array(2048),B=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],S=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],f=[0,1,2,3,4,5,6,7,8,9,10,11],W=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],V=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],v=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],R=[0,1,2,3,4,5,6,7,8,9,10,11],X=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],k=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function J(g,e){for(var t=0,I=0,n=new Array,C=1;C<=16;C++){for(var l=1;l<=g[C];l++)n[e[I]]=[],n[e[I]][0]=t,n[e[I]][1]=C,I++,t++;t*=2}return n}function Y(g){for(var e=g[0],t=g[1]-1;t>=0;)e&1<<t&&(m|=1<<h),t--,--h<0&&(255==m?(w(255),w(0)):w(m),h=7,m=0)}function w(g){u.push(g)}function N(g){w(g>>8&255),w(255&g)}function H(g,e,t,I,n){for(var C,l=n[0],a=n[240],o=function(g,e){var t,I,n,C,l,a,o,i,r,c,s=0;for(r=0;r<8;++r){t=g[s],I=g[s+1],n=g[s+2],C=g[s+3],l=g[s+4],a=g[s+5],o=g[s+6];var d=t+(i=g[s+7]),u=t-i,m=I+o,h=I-o,b=n+a,Z=n-a,p=C+l,G=C-l,y=d+p,B=d-p,S=m+b,f=m-b;g[s]=y+S,g[s+4]=y-S;var W=.707106781*(f+B);g[s+2]=B+W,g[s+6]=B-W;var V=.382683433*((y=G+Z)-(f=h+u)),v=.5411961*y+V,R=1.306562965*f+V,X=.707106781*(S=Z+h),k=u+X,J=u-X;g[s+5]=J+v,g[s+3]=J-v,g[s+1]=k+R,g[s+7]=k-R,s+=8}for(s=0,r=0;r<8;++r){t=g[s],I=g[s+8],n=g[s+16],C=g[s+24],l=g[s+32],a=g[s+40],o=g[s+48];var Y=t+(i=g[s+56]),w=t-i,N=I+o,H=I-o,F=n+a,K=n-a,x=C+l,L=C-l,z=Y+x,E=Y-x,M=N+F,U=N-F;g[s]=z+M,g[s+32]=z-M;var j=.707106781*(U+E);g[s+16]=E+j,g[s+48]=E-j;var Q=.382683433*((z=L+K)-(U=H+w)),D=.5411961*z+Q,T=1.306562965*U+Q,P=.707106781*(M=K+H),O=w+P,q=w-P;g[s+40]=q+D,g[s+24]=q-D,g[s+8]=O+T,g[s+56]=O-T,s++}for(r=0;r<64;++r)c=g[r]*e[r],A[r]=c>0?c+.5|0:c-.5|0;return A}(g,e),i=0;i<64;++i)d[B[i]]=o[i];var r=d[0]-t;t=d[0],0==r?Y(I[0]):(Y(I[s[C=32767+r]]),Y(c[C]));for(var u=63;u>0&&0==d[u];)u--;if(0==u)return Y(l),t;for(var m,h=1;h<=u;){for(var b=h;0==d[h]&&h<=u;)++h;var Z=h-b;if(Z>=16){m=Z>>4;for(var p=1;p<=m;++p)Y(a);Z&=15}C=32767+d[h],Y(n[(Z<<4)+s[C]]),Y(c[C]),h++}return 63!=u&&Y(l),t}function F(g){g=Math.min(Math.max(g,1),100),C!=g&&(function(g){for(var e=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],t=0;t<64;t++){var I=l((e[t]*g+50)/100);I=Math.min(Math.max(I,1),255),a[B[t]]=I}for(var n=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],C=0;C<64;C++){var c=l((n[C]*g+50)/100);c=Math.min(Math.max(c,1),255),o[B[C]]=c}for(var s=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],A=0,d=0;d<8;d++)for(var u=0;u<8;u++)i[A]=1/(a[B[A]]*s[d]*s[u]*8),r[A]=1/(o[B[A]]*s[d]*s[u]*8),A++}(g<50?Math.floor(5e3/g):Math.floor(200-2*g)),C=g)}this.encode=function(g,C){C&&F(C),u=new Array,m=0,h=7,N(65496),N(65504),N(16),w(74),w(70),w(73),w(70),w(0),w(1),w(1),w(0),N(1),N(1),w(0),w(0),function(){N(65499),N(132),w(0);for(var g=0;g<64;g++)w(a[g]);w(1);for(var e=0;e<64;e++)w(o[e])}(),function(g,e){N(65472),N(17),w(8),N(e),N(g),w(3),w(1),w(17),w(0),w(2),w(17),w(1),w(3),w(17),w(1)}(g.width,g.height),function(){N(65476),N(418),w(0);for(var g=0;g<16;g++)w(S[g+1]);for(var e=0;e<=11;e++)w(f[e]);w(16);for(var t=0;t<16;t++)w(W[t+1]);for(var I=0;I<=161;I++)w(V[I]);w(1);for(var n=0;n<16;n++)w(v[n+1]);for(var C=0;C<=11;C++)w(R[C]);w(17);for(var l=0;l<16;l++)w(X[l+1]);for(var a=0;a<=161;a++)w(k[a])}(),N(65498),N(12),w(3),w(1),w(0),w(2),w(17),w(3),w(17),w(0),w(63),w(0);var l=0,c=0,s=0;m=0,h=7,this.encode.displayName="_encode_";for(var A,d,G,B,J,K,x,L,z,E=g.data,M=g.width,U=g.height,j=4*M,Q=0;Q<U;){for(A=0;A<j;){for(J=j*Q+A,x=-1,L=0,z=0;z<64;z++)K=J+(L=z>>3)*j+(x=4*(7&z)),Q+L>=U&&(K-=j*(Q+1+L-U)),A+x>=j&&(K-=A+x-j+4),d=E[K++],G=E[K++],B=E[K++],b[z]=(y[d]+y[G+256|0]+y[B+512|0]>>16)-128,Z[z]=(y[d+768|0]+y[G+1024|0]+y[B+1280|0]>>16)-128,p[z]=(y[d+1280|0]+y[G+1536|0]+y[B+1792|0]>>16)-128;l=H(b,i,l,e,I),c=H(Z,r,c,t,n),s=H(p,r,s,t,n),A+=32}Q+=8}if(h>=0){var D=[];D[1]=h+1,D[0]=(1<<h+1)-1,Y(D)}return N(65497),new Uint8Array(u)},g=g||50,function(){for(var g=String.fromCharCode,e=0;e<256;e++)G[e]=g(e)}(),e=J(S,f),t=J(v,R),I=J(W,V),n=J(X,k),function(){for(var g=1,e=2,t=1;t<=15;t++){for(var I=g;I<e;I++)s[32767+I]=t,c[32767+I]=[],c[32767+I][1]=t,c[32767+I][0]=I;for(var n=-(e-1);n<=-g;n++)s[32767+n]=t,c[32767+n]=[],c[32767+n][1]=t,c[32767+n][0]=e-1+n;g<<=1,e<<=1}}(),function(){for(var g=0;g<256;g++)y[g]=19595*g,y[g+256|0]=38470*g,y[g+512|0]=7471*g+32768,y[g+768|0]=-11059*g,y[g+1024|0]=-21709*g,y[g+1280|0]=32768*g+8421375,y[g+1536|0]=-27439*g,y[g+1792|0]=-5329*g}(),F(g)}function aa(g,e){if(this.pos=0,this.buffer=g,this.datav=new DataView(g.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,-1===["BM","BA","CI","CP","IC","PT"].indexOf(this.flag))throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function oa(g){function e(g){if(!g)throw Error("assert :P")}function t(g,e,t){for(var I=0;4>I;I++)if(g[e+I]!=t.charCodeAt(I))return!0;return!1}function I(g,e,t,I,n){for(var C=0;C<n;C++)g[e+C]=t[I+C]}function n(g,e,t,I){for(var n=0;n<I;n++)g[e+n]=t}function C(g){return new Int32Array(g)}function l(g,e){for(var t=[],I=0;I<g;I++)t.push(new e);return t}function a(g,e){var t=[];return function g(t,I,n){for(var C=n[I],l=0;l<C&&(t.push(n.length>I+1?[]:new e),!(n.length<I+1));l++)g(t[l],I+1,n)}(t,0,g),t}var o=function(){var g=this;function o(g,e){for(var t=1<<e-1>>>0;g&t;)t>>>=1;return t?(g&t-1)+t:g}function i(g,t,I,n,C){e(!(n%I));do{g[t+(n-=I)]=C}while(0<n)}function r(g,t,I,n,l){if(e(2328>=l),512>=l)var a=C(512);else if(null==(a=C(l)))return 0;return function(g,t,I,n,l,a){var r,s,A=t,d=1<<I,u=C(16),m=C(16);for(e(0!=l),e(null!=n),e(null!=g),e(0<I),s=0;s<l;++s){if(15<n[s])return 0;++u[n[s]]}if(u[0]==l)return 0;for(m[1]=0,r=1;15>r;++r){if(u[r]>1<<r)return 0;m[r+1]=m[r]+u[r]}for(s=0;s<l;++s)r=n[s],0<n[s]&&(a[m[r]++]=s);if(1==m[15])return(n=new c).g=0,n.value=a[0],i(g,A,1,d,n),d;var h,b=-1,Z=d-1,p=0,G=1,y=1,B=1<<I;for(s=0,r=1,l=2;r<=I;++r,l<<=1){if(G+=y<<=1,0>(y-=u[r]))return 0;for(;0<u[r];--u[r])(n=new c).g=r,n.value=a[s++],i(g,A+p,l,B,n),p=o(p,r)}for(r=I+1,l=2;15>=r;++r,l<<=1){if(G+=y<<=1,0>(y-=u[r]))return 0;for(;0<u[r];--u[r]){if(n=new c,(p&Z)!=b){for(A+=B,h=1<<(b=r)-I;15>b&&!(0>=(h-=u[b]));)++b,h<<=1;d+=B=1<<(h=b-I),g[t+(b=p&Z)].g=h+I,g[t+b].value=A-t-b}n.g=r-I,n.value=a[s++],i(g,A+(p>>I),l,B,n),p=o(p,r)}}return G!=2*m[15]-1?0:d}(g,t,I,n,l,a)}function c(){this.value=this.g=0}function s(){this.value=this.g=0}function A(){this.G=l(5,c),this.H=C(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=l(Kt,s)}function d(g,t,I,n){e(null!=g),e(null!=t),e(2147483648>n),g.Ca=254,g.I=0,g.b=-8,g.Ka=0,g.oa=t,g.pa=I,g.Jd=t,g.Yc=I+n,g.Zc=4<=n?I+n-4+1:I,W(g)}function u(g,e){for(var t=0;0<e--;)t|=v(g,128)<<e;return t}function m(g,e){var t=u(g,e);return V(g)?-t:t}function h(g,t,I,n){var C,l=0;for(e(null!=g),e(null!=t),e(4294967288>n),g.Sb=n,g.Ra=0,g.u=0,g.h=0,4<n&&(n=4),C=0;C<n;++C)l+=t[I+C]<<8*C;g.Ra=l,g.bb=n,g.oa=t,g.pa=I}function b(g){for(;8<=g.u&&g.bb<g.Sb;)g.Ra>>>=8,g.Ra+=g.oa[g.pa+g.bb]<<zt-8>>>0,++g.bb,g.u-=8;B(g)&&(g.h=1,g.u=0)}function Z(g,t){if(e(0<=t),!g.h&&t<=Lt){var I=y(g)&xt[t];return g.u+=t,b(g),I}return g.h=1,g.u=0}function p(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function G(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function y(g){return g.Ra>>>(g.u&zt-1)>>>0}function B(g){return e(g.bb<=g.Sb),g.h||g.bb==g.Sb&&g.u>zt}function S(g,e){g.u=e,g.h=B(g)}function f(g){g.u>=Et&&(e(g.u>=Et),b(g))}function W(g){e(null!=g&&null!=g.oa),g.pa<g.Zc?(g.I=(g.oa[g.pa++]|g.I<<8)>>>0,g.b+=8):(e(null!=g&&null!=g.oa),g.pa<g.Yc?(g.b+=8,g.I=g.oa[g.pa++]|g.I<<8):g.Ka?g.b=0:(g.I<<=8,g.b+=8,g.Ka=1))}function V(g){return u(g,1)}function v(g,e){var t=g.Ca;0>g.b&&W(g);var I=g.b,n=t*e>>>8,C=(g.I>>>I>n)+0;for(C?(t-=n,g.I-=n+1<<I>>>0):t=n+1,I=t,n=0;256<=I;)n+=8,I>>=8;return I=7^n+Mt[I],g.b-=I,g.Ca=(t<<I)-1,C}function R(g,e,t){g[e+0]=t>>24&255,g[e+1]=t>>16&255,g[e+2]=t>>8&255,g[e+3]=255&t}function X(g,e){return g[e+0]|g[e+1]<<8}function k(g,e){return X(g,e)|g[e+2]<<16}function J(g,e){return X(g,e)|X(g,e+2)<<16}function Y(g,t){var I=1<<t;return e(null!=g),e(0<t),g.X=C(I),null==g.X?0:(g.Mb=32-t,g.Xa=t,1)}function w(g,t){e(null!=g),e(null!=t),e(g.Xa==t.Xa),I(t.X,0,g.X,0,1<<t.Xa)}function N(){this.X=[],this.Xa=this.Mb=0}function H(g,t,I,n){e(null!=I),e(null!=n);var C=I[0],l=n[0];return 0==C&&(C=(g*l+t/2)/t),0==l&&(l=(t*C+g/2)/g),0>=C||0>=l?0:(I[0]=C,n[0]=l,1)}function F(g,e){return g+(1<<e)-1>>>e}function K(g,e){return((4278255360&g)+(4278255360&e)>>>0&4278255360)+((16711935&g)+(16711935&e)>>>0&16711935)>>>0}function x(e,t){g[t]=function(t,I,n,C,l,a,o){var i;for(i=0;i<l;++i){var r=g[e](a[o+i-1],n,C+i);a[o+i]=K(t[I+i],r)}}}function L(){this.ud=this.hd=this.jd=0}function z(g,e){return((4278124286&(g^e))>>>1)+(g&e)>>>0}function E(g){return 0<=g&&256>g?g:0>g?0:255<g?255:void 0}function M(g,e){return E(g+(g-e+.5>>1))}function U(g,e,t){return Math.abs(e-t)-Math.abs(g-t)}function j(g,e,t,I,n,C,l){for(I=C[l-1],t=0;t<n;++t)C[l+t]=I=K(g[e+t],I)}function Q(g,e,t,I,n){var C;for(C=0;C<t;++C){var l=g[e+C],a=l>>8&255,o=16711935&(o=(o=16711935&l)+((a<<16)+a));I[n+C]=(4278255360&l)+o>>>0}}function D(g,e){e.jd=255&g,e.hd=g>>8&255,e.ud=g>>16&255}function T(g,e,t,I,n,C){var l;for(l=0;l<I;++l){var a=e[t+l],o=a>>>8,i=a,r=255&(r=(r=a>>>16)+((g.jd<<24>>24)*(o<<24>>24)>>>5));i=255&(i=(i+=(g.hd<<24>>24)*(o<<24>>24)>>>5)+((g.ud<<24>>24)*(r<<24>>24)>>>5)),n[C+l]=(4278255360&a)+(r<<16)+i}}function P(e,t,I,n,C){g[t]=function(g,e,t,I,l,a,o,i,r){for(I=o;I<i;++I)for(o=0;o<r;++o)l[a++]=C(t[n(g[e++])])},g[e]=function(e,t,l,a,o,i,r){var c=8>>e.b,s=e.Ea,A=e.K[0],d=e.w;if(8>c)for(e=(1<<e.b)-1,d=(1<<c)-1;t<l;++t){var u,m=0;for(u=0;u<s;++u)u&e||(m=n(a[o++])),i[r++]=C(A[m&d]),m>>=c}else g["VP8LMapColor"+I](a,o,A,d,i,r,t,l,s)}}function O(g,e,t,I,n){for(t=e+t;e<t;){var C=g[e++];I[n++]=C>>16&255,I[n++]=C>>8&255,I[n++]=255&C}}function q(g,e,t,I,n){for(t=e+t;e<t;){var C=g[e++];I[n++]=C>>16&255,I[n++]=C>>8&255,I[n++]=255&C,I[n++]=C>>24&255}}function _(g,e,t,I,n){for(t=e+t;e<t;){var C=(l=g[e++])>>16&240|l>>12&15,l=240&l|l>>28&15;I[n++]=C,I[n++]=l}}function $(g,e,t,I,n){for(t=e+t;e<t;){var C=(l=g[e++])>>16&248|l>>13&7,l=l>>5&224|l>>3&31;I[n++]=C,I[n++]=l}}function gg(g,e,t,I,n){for(t=e+t;e<t;){var C=g[e++];I[n++]=255&C,I[n++]=C>>8&255,I[n++]=C>>16&255}}function eg(g,e,t,n,C,l){if(0==l)for(t=e+t;e<t;)R(n,((l=g[e++])[0]>>24|l[1]>>8&65280|l[2]<<8&16711680|l[3]<<24)>>>0),C+=32;else I(n,C,g,e,t)}function tg(e,t){g[t][0]=g[e+"0"],g[t][1]=g[e+"1"],g[t][2]=g[e+"2"],g[t][3]=g[e+"3"],g[t][4]=g[e+"4"],g[t][5]=g[e+"5"],g[t][6]=g[e+"6"],g[t][7]=g[e+"7"],g[t][8]=g[e+"8"],g[t][9]=g[e+"9"],g[t][10]=g[e+"10"],g[t][11]=g[e+"11"],g[t][12]=g[e+"12"],g[t][13]=g[e+"13"],g[t][14]=g[e+"0"],g[t][15]=g[e+"0"]}function Ig(g){return g==EI||g==MI||g==UI||g==jI}function ng(){this.eb=[],this.size=this.A=this.fb=0}function Cg(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function lg(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ng,this.f.kb=new Cg,this.sd=null}function ag(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function og(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ig(g){return alert("todo:WebPSamplerProcessPlane"),g.T}function rg(g,e){var t=g.T,n=e.ba.f.RGBA,C=n.eb,l=n.fb+g.ka*n.A,a=hn[e.ba.S],o=g.y,i=g.O,r=g.f,c=g.N,s=g.ea,A=g.W,d=e.cc,u=e.dc,m=e.Mc,h=e.Nc,b=g.ka,Z=g.ka+g.T,p=g.U,G=p+1>>1;for(0==b?a(o,i,null,null,r,c,s,A,r,c,s,A,C,l,null,null,p):(a(e.ec,e.fc,o,i,d,u,m,h,r,c,s,A,C,l-n.A,C,l,p),++t);b+2<Z;b+=2)d=r,u=c,m=s,h=A,c+=g.Rc,A+=g.Rc,l+=2*n.A,a(o,(i+=2*g.fa)-g.fa,o,i,d,u,m,h,r,c,s,A,C,l-n.A,C,l,p);return i+=g.fa,g.j+Z<g.o?(I(e.ec,e.fc,o,i,p),I(e.cc,e.dc,r,c,G),I(e.Mc,e.Nc,s,A,G),t--):1&Z||a(o,i,null,null,r,c,s,A,r,c,s,A,C,l+n.A,null,null,p),t}function cg(g,t,I){var n=g.F,C=[g.J];if(null!=n){var l=g.U,a=t.ba.S,o=a==xI||a==UI;t=t.ba.f.RGBA;var i=[0],r=g.ka;i[0]=g.T,g.Kb&&(0==r?--i[0]:(--r,C[0]-=g.width),g.j+g.ka+g.T==g.o&&(i[0]=g.o-g.j-r));var c=t.eb;r=t.fb+r*t.A,g=SI(n,C[0],g.width,l,i,c,r+(o?0:3),t.A),e(I==i),g&&Ig(a)&&yI(c,r,o,l,i,t.A)}return 0}function sg(g){var e=g.ma,t=e.ba.S,I=11>t,n=t==HI||t==KI||t==xI||t==LI||12==t||Ig(t);if(e.memory=null,e.Ib=null,e.Jb=null,e.Nd=null,!Nt(e.Oa,g,n?11:12))return 0;if(n&&Ig(t)&&bt(),g.da)alert("todo:use_scaling");else{if(I){if(e.Ib=ig,g.Kb){if(t=g.U+1>>1,e.memory=C(g.U+2*t),null==e.memory)return 0;e.ec=e.memory,e.fc=0,e.cc=e.ec,e.dc=e.fc+g.U,e.Mc=e.cc,e.Nc=e.dc+t,e.Ib=rg,bt()}}else alert("todo:EmitYUV");n&&(e.Jb=cg,I&&mt())}if(I&&!kn){for(g=0;256>g;++g)Jn[g]=89858*(g-128)+Wn>>fn,Nn[g]=-22014*(g-128)+Wn,wn[g]=-45773*(g-128),Yn[g]=113618*(g-128)+Wn>>fn;for(g=Vn;g<vn;++g)e=76283*(g-16)+Wn>>fn,Hn[g-Vn]=jg(e,255),Fn[g-Vn]=jg(e+8>>4,15);kn=1}return 1}function Ag(g){var t=g.ma,I=g.U,n=g.T;return e(!(1&g.ka)),0>=I||0>=n?0:(I=t.Ib(g,t),null!=t.Jb&&t.Jb(g,t,I),t.Dc+=I,1)}function dg(g){g.ma.memory=null}function ug(g,e,t,I){return 47!=Z(g,8)?0:(e[0]=Z(g,14)+1,t[0]=Z(g,14)+1,I[0]=Z(g,1),0!=Z(g,3)?0:!g.h)}function mg(g,e){if(4>g)return g+1;var t=g-2>>1;return(2+(1&g)<<t)+Z(e,t)+1}function hg(g,e){return 120<e?e-120:1<=(t=((t=qI[e-1])>>4)*g+(8-(15&t)))?t:1;var t}function bg(g,e,t){var I=y(t),n=g[e+=255&I].g-8;return 0<n&&(S(t,t.u+8),I=y(t),e+=g[e].value,e+=I&(1<<n)-1),S(t,t.u+g[e].g),g[e].value}function Zg(g,t,I){return I.g+=g.g,I.value+=g.value<<t>>>0,e(8>=I.g),g.g}function pg(g,t,I){var n=g.xc;return e((t=0==n?0:g.vc[g.md*(I>>n)+(t>>n)])<g.Wb),g.Ya[t]}function Gg(g,t,n,C){var l=g.ab,a=g.c*t,o=g.C;t=o+t;var i=n,r=C;for(C=g.Ta,n=g.Ua;0<l--;){var c=g.gc[l],s=o,A=t,d=i,u=r,m=(r=C,i=n,c.Ea);switch(e(s<A),e(A<=c.nc),c.hc){case 2:Qt(d,u,(A-s)*m,r,i);break;case 0:var h=s,b=A,Z=r,p=i,G=(W=c).Ea;0==h&&(Ut(d,u,null,null,1,Z,p),j(d,u+1,0,0,G-1,Z,p+1),u+=G,p+=G,++h);for(var y=1<<W.b,B=y-1,S=F(G,W.b),f=W.K,W=W.w+(h>>W.b)*S;h<b;){var V=f,v=W,R=1;for(jt(d,u,Z,p-G,1,Z,p);R<G;){var X=(R&~B)+y;X>G&&(X=G),(0,qt[V[v++]>>8&15])(d,u+ +R,Z,p+R-G,X-R,Z,p+R),R=X}u+=G,p+=G,++h&B||(W+=S)}A!=c.nc&&I(r,i-m,r,i+(A-s-1)*m,m);break;case 1:for(m=d,b=u,G=(d=c.Ea)-(p=d&~(Z=(u=1<<c.b)-1)),h=F(d,c.b),y=c.K,c=c.w+(s>>c.b)*h;s<A;){for(B=y,S=c,f=new L,W=b+p,V=b+d;b<W;)D(B[S++],f),_t(f,m,b,u,r,i),b+=u,i+=u;b<V&&(D(B[S++],f),_t(f,m,b,G,r,i),b+=G,i+=G),++s&Z||(c+=h)}break;case 3:if(d==r&&u==i&&0<c.b){for(b=r,d=m=i+(A-s)*m-(p=(A-s)*F(c.Ea,c.b)),u=r,Z=i,h=[],p=(G=p)-1;0<=p;--p)h[p]=u[Z+p];for(p=G-1;0<=p;--p)b[d+p]=h[p];Dt(c,s,A,r,m,r,i)}else Dt(c,s,A,d,u,r,i)}i=C,r=n}r!=n&&I(C,n,i,r,a)}function yg(g,t){var I=g.V,n=g.Ba+g.c*g.C,C=t-g.C;if(e(t<=g.l.o),e(16>=C),0<C){var l=g.l,a=g.Ta,o=g.Ua,i=l.width;if(Gg(g,C,I,n),C=o=[o],e((I=g.C)<(n=t)),e(l.v<l.va),n>l.o&&(n=l.o),I<l.j){var r=l.j-I;I=l.j,C[0]+=r*i}if(I>=n?I=0:(C[0]+=4*l.v,l.ka=I-l.j,l.U=l.va-l.v,l.T=n-I,I=1),I){if(o=o[0],11>(I=g.ca).S){var c=I.f.RGBA,s=(n=I.S,C=l.U,l=l.T,r=c.eb,c.A),A=l;for(c=c.fb+g.Ma*c.A;0<A--;){var d=a,u=o,m=C,h=r,b=c;switch(n){case NI:$t(d,u,m,h,b);break;case HI:gI(d,u,m,h,b);break;case EI:gI(d,u,m,h,b),yI(h,b,0,m,1,0);break;case FI:II(d,u,m,h,b);break;case KI:eg(d,u,m,h,b,1);break;case MI:eg(d,u,m,h,b,1),yI(h,b,0,m,1,0);break;case xI:eg(d,u,m,h,b,0);break;case UI:eg(d,u,m,h,b,0),yI(h,b,1,m,1,0);break;case LI:eI(d,u,m,h,b);break;case jI:eI(d,u,m,h,b),BI(h,b,m,1,0);break;case zI:tI(d,u,m,h,b);break;default:e(0)}o+=i,c+=s}g.Ma+=l}else alert("todo:EmitRescaledRowsYUVA");e(g.Ma<=I.height)}}g.C=t,e(g.C<=g.i)}function Bg(g){var e;if(0<g.ua)return 0;for(e=0;e<g.Wb;++e){var t=g.Ya[e].G,I=g.Ya[e].H;if(0<t[1][I[1]+0].g||0<t[2][I[2]+0].g||0<t[3][I[3]+0].g)return 0}return 1}function Sg(g,t,I,n,C,l){if(0!=g.Z){var a=g.qd,o=g.rd;for(e(null!=mn[g.Z]);t<I;++t)mn[g.Z](a,o,n,C,n,C,l),a=n,o=C,C+=l;g.qd=a,g.rd=o}}function fg(g,t){var I=g.l.ma,n=0==I.Z||1==I.Z?g.l.j:g.C;if(n=g.C<n?n:g.C,e(t<=g.l.o),t>n){var C=g.l.width,l=I.ca,a=I.tb+C*n,o=g.V,i=g.Ba+g.c*n,r=g.gc;e(1==g.ab),e(3==r[0].hc),Pt(r[0],n,t,o,i,l,a),Sg(I,n,t,l,a,C)}g.C=g.Ma=t}function Wg(g,t,I,n,C,l,a){var o=g.$/n,i=g.$%n,r=g.m,c=g.s,s=I+g.$,A=s;C=I+n*C;var d=I+n*l,u=280+c.ua,m=g.Pb?o:16777216,h=0<c.ua?c.Wa:null,b=c.wc,Z=s<d?pg(c,i,o):null;e(g.C<l),e(d<=C);var p=!1;g:for(;;){for(;p||s<d;){var G=0;if(o>=m){var W=s-I;e((m=g).Pb),m.wd=m.m,m.xd=W,0<m.s.ua&&w(m.s.Wa,m.s.vb),m=o+$I}if(i&b||(Z=pg(c,i,o)),e(null!=Z),Z.Qb&&(t[s]=Z.qb,p=!0),!p)if(f(r),Z.jc){G=r,W=t;var V=s,v=Z.pd[y(G)&Kt-1];e(Z.jc),256>v.g?(S(G,G.u+v.g),W[V]=v.value,G=0):(S(G,G.u+v.g-256),e(256<=v.value),G=v.value),0==G&&(p=!0)}else G=bg(Z.G[0],Z.H[0],r);if(r.h)break;if(p||256>G){if(!p)if(Z.nd)t[s]=(Z.qb|G<<8)>>>0;else{if(f(r),p=bg(Z.G[1],Z.H[1],r),f(r),W=bg(Z.G[2],Z.H[2],r),V=bg(Z.G[3],Z.H[3],r),r.h)break;t[s]=(V<<24|p<<16|G<<8|W)>>>0}if(p=!1,++s,++i>=n&&(i=0,++o,null!=a&&o<=l&&!(o%16)&&a(g,o),null!=h))for(;A<s;)G=t[A++],h.X[(506832829*G&4294967295)>>>h.Mb]=G}else if(280>G){if(G=mg(G-256,r),W=bg(Z.G[4],Z.H[4],r),f(r),W=hg(n,W=mg(W,r)),r.h)break;if(s-I<W||C-s<G)break g;for(V=0;V<G;++V)t[s+V]=t[s+V-W];for(s+=G,i+=G;i>=n;)i-=n,++o,null!=a&&o<=l&&!(o%16)&&a(g,o);if(e(s<=C),i&b&&(Z=pg(c,i,o)),null!=h)for(;A<s;)G=t[A++],h.X[(506832829*G&4294967295)>>>h.Mb]=G}else{if(!(G<u))break g;for(p=G-280,e(null!=h);A<s;)G=t[A++],h.X[(506832829*G&4294967295)>>>h.Mb]=G;G=s,e(!(p>>>(W=h).Xa)),t[G]=W.X[p],p=!0}p||e(r.h==B(r))}if(g.Pb&&r.h&&s<C)e(g.m.h),g.a=5,g.m=g.wd,g.$=g.xd,0<g.s.ua&&w(g.s.vb,g.s.Wa);else{if(r.h)break g;null!=a&&a(g,o>l?l:o),g.a=0,g.$=s-I}return 1}return g.a=3,0}function Vg(g){e(null!=g),g.vc=null,g.yc=null,g.Ya=null;var t=g.Wa;null!=t&&(t.X=null),g.vb=null,e(null!=g)}function vg(){var e=new lt;return null==e?null:(e.a=0,e.xb=un,tg("Predictor","VP8LPredictors"),tg("Predictor","VP8LPredictors_C"),tg("PredictorAdd","VP8LPredictorsAdd"),tg("PredictorAdd","VP8LPredictorsAdd_C"),Qt=Q,_t=T,$t=O,gI=q,eI=_,tI=$,II=gg,g.VP8LMapColor32b=Tt,g.VP8LMapColor8b=Ot,e)}function Rg(g,t,I,a,o){var i=1,s=[g],d=[t],u=a.m,m=a.s,h=null,b=0;g:for(;;){if(I)for(;i&&Z(u,1);){var p=s,G=d,B=a,W=1,V=B.m,v=B.gc[B.ab],R=Z(V,2);if(B.Oc&1<<R)i=0;else{switch(B.Oc|=1<<R,v.hc=R,v.Ea=p[0],v.nc=G[0],v.K=[null],++B.ab,e(4>=B.ab),R){case 0:case 1:v.b=Z(V,3)+2,W=Rg(F(v.Ea,v.b),F(v.nc,v.b),0,B,v.K),v.K=v.K[0];break;case 3:var X,k=Z(V,8)+1,J=16<k?0:4<k?1:2<k?2:3;if(p[0]=F(v.Ea,J),v.b=J,X=W=Rg(k,1,0,B,v.K)){var w,N=k,H=v,x=1<<(8>>H.b),L=C(x);if(null==L)X=0;else{var z=H.K[0],E=H.w;for(L[0]=H.K[0][0],w=1;w<1*N;++w)L[w]=K(z[E+w],L[w-1]);for(;w<4*x;++w)L[w]=0;H.K[0]=null,H.K[0]=L,X=1}}W=X;break;case 2:break;default:e(0)}i=W}}if(s=s[0],d=d[0],i&&Z(u,1)&&!(i=1<=(b=Z(u,4))&&11>=b)){a.a=3;break g}var M;if(M=i)e:{var U,j,Q,D=a,T=s,P=d,O=b,q=I,_=D.m,$=D.s,gg=[null],eg=1,tg=0,Ig=_I[O];t:for(;;){if(q&&Z(_,1)){var ng=Z(_,3)+2,Cg=F(T,ng),lg=F(P,ng),ag=Cg*lg;if(!Rg(Cg,lg,0,D,gg))break t;for(gg=gg[0],$.xc=ng,U=0;U<ag;++U){var og=gg[U]>>8&65535;gg[U]=og,og>=eg&&(eg=og+1)}}if(_.h)break t;for(j=0;5>j;++j){var ig=TI[j];!j&&0<O&&(ig+=1<<O),tg<ig&&(tg=ig)}var rg=l(eg*Ig,c),cg=eg,sg=l(cg,A);if(null==sg)var Ag=null;else e(65536>=cg),Ag=sg;var dg=C(tg);if(null==Ag||null==dg||null==rg){D.a=1;break t}var ug=rg;for(U=Q=0;U<eg;++U){var mg=Ag[U],hg=mg.G,bg=mg.H,pg=0,Gg=1,yg=0;for(j=0;5>j;++j){ig=TI[j],hg[j]=ug,bg[j]=Q,!j&&0<O&&(ig+=1<<O);I:{var Bg,Sg=ig,fg=D,vg=dg,Xg=ug,kg=Q,Jg=0,Yg=fg.m,wg=Z(Yg,1);if(n(vg,0,0,Sg),wg){var Ng=Z(Yg,1)+1,Hg=Z(Yg,1),Fg=Z(Yg,0==Hg?1:8);vg[Fg]=1,2==Ng&&(vg[Fg=Z(Yg,8)]=1);var Kg=1}else{var xg=C(19),Lg=Z(Yg,4)+4;if(19<Lg){fg.a=3;var zg=0;break I}for(Bg=0;Bg<Lg;++Bg)xg[OI[Bg]]=Z(Yg,3);var Eg=void 0,Mg=void 0,Ug=fg,jg=xg,Qg=Sg,Dg=vg,Tg=0,Pg=Ug.m,Og=8,qg=l(128,c);n:for(;r(qg,0,7,jg,19);){if(Z(Pg,1)){var _g=2+2*Z(Pg,3);if((Eg=2+Z(Pg,_g))>Qg)break n}else Eg=Qg;for(Mg=0;Mg<Qg&&Eg--;){f(Pg);var $g=qg[0+(127&y(Pg))];S(Pg,Pg.u+$g.g);var ge=$g.value;if(16>ge)Dg[Mg++]=ge,0!=ge&&(Og=ge);else{var ee=16==ge,te=ge-16,Ie=DI[te],ne=Z(Pg,QI[te])+Ie;if(Mg+ne>Qg)break n;for(var Ce=ee?Og:0;0<ne--;)Dg[Mg++]=Ce}}Tg=1;break n}Tg||(Ug.a=3),Kg=Tg}(Kg=Kg&&!Yg.h)&&(Jg=r(Xg,kg,8,vg,Sg)),Kg&&0!=Jg?zg=Jg:(fg.a=3,zg=0)}if(0==zg)break t;if(Gg&&1==PI[j]&&(Gg=0==ug[Q].g),pg+=ug[Q].g,Q+=zg,3>=j){var le,ae=dg[0];for(le=1;le<ig;++le)dg[le]>ae&&(ae=dg[le]);yg+=ae}}if(mg.nd=Gg,mg.Qb=0,Gg&&(mg.qb=(hg[3][bg[3]+0].value<<24|hg[1][bg[1]+0].value<<16|hg[2][bg[2]+0].value)>>>0,0==pg&&256>hg[0][bg[0]+0].value&&(mg.Qb=1,mg.qb+=hg[0][bg[0]+0].value<<8)),mg.jc=!mg.Qb&&6>yg,mg.jc){var oe,ie=mg;for(oe=0;oe<Kt;++oe){var re=oe,ce=ie.pd[re],se=ie.G[0][ie.H[0]+re];256<=se.value?(ce.g=se.g+256,ce.value=se.value):(ce.g=0,ce.value=0,re>>=Zg(se,8,ce),re>>=Zg(ie.G[1][ie.H[1]+re],16,ce),re>>=Zg(ie.G[2][ie.H[2]+re],0,ce),Zg(ie.G[3][ie.H[3]+re],24,ce))}}}$.vc=gg,$.Wb=eg,$.Ya=Ag,$.yc=rg,M=1;break e}M=0}if(!(i=M)){a.a=3;break g}if(0<b){if(m.ua=1<<b,!Y(m.Wa,b)){a.a=1,i=0;break g}}else m.ua=0;var Ae=a,de=s,ue=d,me=Ae.s,he=me.xc;if(Ae.c=de,Ae.i=ue,me.md=F(de,he),me.wc=0==he?-1:(1<<he)-1,I){a.xb=dn;break g}if(null==(h=C(s*d))){a.a=1,i=0;break g}i=(i=Wg(a,h,0,s,d,d,null))&&!u.h;break g}return i?(null!=o?o[0]=h:(e(null==h),e(I)),a.$=0,I||Vg(m)):Vg(m),i}function Xg(g,t){var I=g.c*g.i,n=I+t+16*t;return e(g.c<=t),g.V=C(n),null==g.V?(g.Ta=null,g.Ua=0,g.a=1,0):(g.Ta=g.V,g.Ua=g.Ba+I+t,1)}function kg(g,t){var I=g.C,n=t-I,C=g.V,l=g.Ba+g.c*I;for(e(t<=g.l.o);0<n;){var a=16<n?16:n,o=g.l.ma,i=g.l.width,r=i*a,c=o.ca,s=o.tb+i*I,A=g.Ta,d=g.Ua;Gg(g,a,C,l),fI(A,d,c,s,r),Sg(o,I,I+a,c,s,i),n-=a,C+=a*g.c,I+=a}e(I==t),g.C=g.Ma=t}function Jg(){this.ub=this.yd=this.td=this.Rb=0}function Yg(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function wg(){this.Fb=this.Bb=this.Cb=0,this.Zb=C(4),this.Lb=C(4)}function Ng(){this.Yb=function(){var g=[];return function g(e,t,I){for(var n=I[t],C=0;C<n&&(e.push(I.length>t+1?[]:0),!(I.length<t+1));C++)g(e[C],t+1,I)}(g,0,[3,11]),g}()}function Hg(){this.jb=C(3),this.Wc=a([4,8],Ng),this.Xc=a([4,17],Ng)}function Fg(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new C(4),this.od=new C(4)}function Kg(){this.ld=this.La=this.dd=this.tc=0}function xg(){this.Na=this.la=0}function Lg(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function zg(){this.ad=C(384),this.Za=0,this.Ob=C(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Eg(){this.uc=this.M=this.Nb=0,this.wa=Array(new Kg),this.Y=0,this.ya=Array(new zg),this.aa=0,this.l=new Qg}function Mg(){this.y=C(16),this.f=C(8),this.ea=C(8)}function Ug(){this.cb=this.a=0,this.sc="",this.m=new p,this.Od=new Jg,this.Kc=new Yg,this.ed=new Fg,this.Qa=new wg,this.Ic=this.$c=this.Aa=0,this.D=new Eg,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=l(8,p),this.ia=0,this.pb=l(4,Lg),this.Pa=new Hg,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Mg),this.Hd=0,this.rb=Array(new xg),this.sb=0,this.wa=Array(new Kg),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new zg),this.L=this.aa=0,this.gd=a([4,2],Kg),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function jg(g,e){return 0>g?0:g>e?e:g}function Qg(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Dg(){var g=new Ug;return null!=g&&(g.a=0,g.sc="OK",g.cb=0,g.Xb=0,tn||(tn=qg)),g}function Tg(g,e,t){return 0==g.a&&(g.a=e,g.sc=t,g.cb=0),0}function Pg(g,e,t){return 3<=t&&157==g[e+0]&&1==g[e+1]&&42==g[e+2]}function Og(g,t){if(null==g)return 0;if(g.a=0,g.sc="OK",null==t)return Tg(g,2,"null VP8Io passed to VP8GetHeaders()");var I=t.data,C=t.w,l=t.ha;if(4>l)return Tg(g,7,"Truncated header.");var a=I[C+0]|I[C+1]<<8|I[C+2]<<16,o=g.Od;if(o.Rb=!(1&a),o.td=a>>1&7,o.yd=a>>4&1,o.ub=a>>5,3<o.td)return Tg(g,3,"Incorrect keyframe parameters.");if(!o.yd)return Tg(g,4,"Frame not displayable.");C+=3,l-=3;var i=g.Kc;if(o.Rb){if(7>l)return Tg(g,7,"cannot parse picture header");if(!Pg(I,C,l))return Tg(g,3,"Bad code word");i.c=16383&(I[C+4]<<8|I[C+3]),i.Td=I[C+4]>>6,i.i=16383&(I[C+6]<<8|I[C+5]),i.Ud=I[C+6]>>6,C+=7,l-=7,g.za=i.c+15>>4,g.Ub=i.i+15>>4,t.width=i.c,t.height=i.i,t.Da=0,t.j=0,t.v=0,t.va=t.width,t.o=t.height,t.da=0,t.ib=t.width,t.hb=t.height,t.U=t.width,t.T=t.height,n((a=g.Pa).jb,0,255,a.jb.length),e(null!=(a=g.Qa)),a.Cb=0,a.Bb=0,a.Fb=1,n(a.Zb,0,0,a.Zb.length),n(a.Lb,0,0,a.Lb)}if(o.ub>l)return Tg(g,7,"bad partition length");d(a=g.m,I,C,o.ub),C+=o.ub,l-=o.ub,o.Rb&&(i.Ld=V(a),i.Kd=V(a)),i=g.Qa;var r,c=g.Pa;if(e(null!=a),e(null!=i),i.Cb=V(a),i.Cb){if(i.Bb=V(a),V(a)){for(i.Fb=V(a),r=0;4>r;++r)i.Zb[r]=V(a)?m(a,7):0;for(r=0;4>r;++r)i.Lb[r]=V(a)?m(a,6):0}if(i.Bb)for(r=0;3>r;++r)c.jb[r]=V(a)?u(a,8):255}else i.Bb=0;if(a.Ka)return Tg(g,3,"cannot parse segment header");if((i=g.ed).zd=V(a),i.Tb=u(a,6),i.wb=u(a,3),i.Pc=V(a),i.Pc&&V(a)){for(c=0;4>c;++c)V(a)&&(i.vd[c]=m(a,6));for(c=0;4>c;++c)V(a)&&(i.od[c]=m(a,6))}if(g.L=0==i.Tb?0:i.zd?1:2,a.Ka)return Tg(g,3,"cannot parse filter header");var s=l;if(l=r=C,C=r+s,i=s,g.Xb=(1<<u(g.m,2))-1,s<3*(c=g.Xb))I=7;else{for(r+=3*c,i-=3*c,s=0;s<c;++s){var A=I[l+0]|I[l+1]<<8|I[l+2]<<16;A>i&&(A=i),d(g.Jc[+s],I,r,A),r+=A,i-=A,l+=3}d(g.Jc[+c],I,r,i),I=r<C?0:5}if(0!=I)return Tg(g,I,"cannot parse partitions");for(I=u(r=g.m,7),l=V(r)?m(r,4):0,C=V(r)?m(r,4):0,i=V(r)?m(r,4):0,c=V(r)?m(r,4):0,r=V(r)?m(r,4):0,s=g.Qa,A=0;4>A;++A){if(s.Cb){var h=s.Zb[A];s.Fb||(h+=I)}else{if(0<A){g.pb[A]=g.pb[0];continue}h=I}var b=g.pb[A];b.Sc[0]=gn[jg(h+l,127)],b.Sc[1]=en[jg(h+0,127)],b.Eb[0]=2*gn[jg(h+C,127)],b.Eb[1]=101581*en[jg(h+i,127)]>>16,8>b.Eb[1]&&(b.Eb[1]=8),b.Qc[0]=gn[jg(h+c,117)],b.Qc[1]=en[jg(h+r,127)],b.lc=h+r}if(!o.Rb)return Tg(g,4,"Not a key frame.");for(V(a),o=g.Pa,I=0;4>I;++I){for(l=0;8>l;++l)for(C=0;3>C;++C)for(i=0;11>i;++i)c=v(a,on[I][l][C][i])?u(a,8):ln[I][l][C][i],o.Wc[I][l].Yb[C][i]=c;for(l=0;17>l;++l)o.Xc[I][l]=o.Wc[I][rn[l]]}return g.kc=V(a),g.kc&&(g.Bd=u(a,8)),g.cb=1}function qg(g,e,t,I,n,C,l){var a=e[n].Yb[t];for(t=0;16>n;++n){if(!v(g,a[t+0]))return n;for(;!v(g,a[t+1]);)if(a=e[++n].Yb[0],t=0,16==n)return 16;var o=e[n+1].Yb;if(v(g,a[t+2])){var i=g,r=0;if(v(i,(s=a)[(c=t)+3]))if(v(i,s[c+6])){for(a=0,c=2*(r=v(i,s[c+8]))+(s=v(i,s[c+9+r])),r=0,s=In[c];s[a];++a)r+=r+v(i,s[a]);r+=3+(8<<c)}else v(i,s[c+7])?(r=7+2*v(i,165),r+=v(i,145)):r=5+v(i,159);else r=v(i,s[c+4])?3+v(i,s[c+5]):2;a=o[2]}else r=1,a=o[1];o=l+nn[n],0>(i=g).b&&W(i);var c,s=i.b,A=(c=i.Ca>>1)-(i.I>>s)>>31;--i.b,i.Ca+=A,i.Ca|=1,i.I-=(c+1&A)<<s,C[o]=((r^A)-A)*I[(0<n)+0]}return 16}function _g(g){var e=g.rb[g.sb-1];e.la=0,e.Na=0,n(g.zc,0,0,g.zc.length),g.ja=0}function $g(g,t){if(null==g)return 0;if(null==t)return Tg(g,2,"NULL VP8Io parameter in VP8Decode().");if(!g.cb&&!Og(g,t))return 0;if(e(g.cb),null==t.ac||t.ac(t)){t.ob&&(g.L=0);var a=xn[g.L];if(2==g.L?(g.yb=0,g.zb=0):(g.yb=t.v-a>>4,g.zb=t.j-a>>4,0>g.yb&&(g.yb=0),0>g.zb&&(g.zb=0)),g.Va=t.o+15+a>>4,g.Hb=t.va+15+a>>4,g.Hb>g.za&&(g.Hb=g.za),g.Va>g.Ub&&(g.Va=g.Ub),0<g.L){var o=g.ed;for(a=0;4>a;++a){var i;if(g.Qa.Cb){var r=g.Qa.Lb[a];g.Qa.Fb||(r+=o.Tb)}else r=o.Tb;for(i=0;1>=i;++i){var c=g.gd[a][i],s=r;if(o.Pc&&(s+=o.vd[0],i&&(s+=o.od[0])),0<(s=0>s?0:63<s?63:s)){var A=s;0<o.wb&&(A=4<o.wb?A>>2:A>>1)>9-o.wb&&(A=9-o.wb),1>A&&(A=1),c.dd=A,c.tc=2*s+A,c.ld=40<=s?2:15<=s?1:0}else c.tc=0;c.La=i}}}a=0}else Tg(g,6,"Frame setup failed"),a=g.a;if(a=0==a){if(a){g.$c=0,0<g.Aa||(g.Ic=zn);g:{a=g.Ic,o=4*(A=g.za);var d=32*A,u=A+1,m=0<g.L?A*(0<g.Aa?2:1):0,h=(2==g.Aa?2:1)*A;if((c=o+832+(i=3*(16*a+xn[g.L])/2*d)+(r=null!=g.Fa&&0<g.Fa.length?g.Kc.c*g.Kc.i:0))!=c)a=0;else{if(c>g.Vb){if(g.Vb=0,g.Ec=C(c),g.Fc=0,null==g.Ec){a=Tg(g,1,"no memory during frame initialization.");break g}g.Vb=c}c=g.Ec,s=g.Fc,g.Ac=c,g.Bc=s,s+=o,g.Gd=l(d,Mg),g.Hd=0,g.rb=l(u+1,xg),g.sb=1,g.wa=m?l(m,Kg):null,g.Y=0,g.D.Nb=0,g.D.wa=g.wa,g.D.Y=g.Y,0<g.Aa&&(g.D.Y+=A),e(!0),g.oc=c,g.pc=s,s+=832,g.ya=l(h,zg),g.aa=0,g.D.ya=g.ya,g.D.aa=g.aa,2==g.Aa&&(g.D.aa+=A),g.R=16*A,g.B=8*A,A=(d=xn[g.L])*g.R,d=d/2*g.B,g.sa=c,g.ta=s+A,g.qa=g.sa,g.ra=g.ta+16*a*g.R+d,g.Ha=g.qa,g.Ia=g.ra+8*a*g.B+d,g.$c=0,s+=i,g.mb=r?c:null,g.nb=r?s:null,e(s+r<=g.Fc+g.Vb),_g(g),n(g.Ac,g.Bc,0,o),a=1}}if(a){if(t.ka=0,t.y=g.sa,t.O=g.ta,t.f=g.qa,t.N=g.ra,t.ea=g.Ha,t.Vd=g.Ia,t.fa=g.R,t.Rc=g.B,t.F=null,t.J=0,!XI){for(a=-255;255>=a;++a)WI[255+a]=0>a?-a:a;for(a=-1020;1020>=a;++a)VI[1020+a]=-128>a?-128:127<a?127:a;for(a=-112;112>=a;++a)vI[112+a]=-16>a?-16:15<a?15:a;for(a=-255;510>=a;++a)RI[255+a]=0>a?0:255<a?255:a;XI=1}nI=ie,CI=Ce,aI=le,oI=ae,iI=oe,lI=ne,rI=Te,cI=Pe,sI=_e,AI=$e,dI=Oe,uI=qe,mI=gt,hI=et,bI=Ee,ZI=Me,pI=Ue,GI=je,sn[0]=Se,sn[1]=ce,sn[2]=ye,sn[3]=Be,sn[4]=fe,sn[5]=Ve,sn[6]=We,sn[7]=ve,sn[8]=Xe,sn[9]=Re,cn[0]=he,cn[1]=Ae,cn[2]=de,cn[3]=ue,cn[4]=be,cn[5]=Ze,cn[6]=pe,An[0]=we,An[1]=se,An[2]=ke,An[3]=Je,An[4]=He,An[5]=Ne,An[6]=Fe,a=1}else a=0}a&&(a=function(g,t){for(g.M=0;g.M<g.Va;++g.M){var l,a=g.Jc[g.M&g.Xb],o=g.m,i=g;for(l=0;l<i.za;++l){var r=o,c=i,s=c.Ac,A=c.Bc+4*l,d=c.zc,u=c.ya[c.aa+l];if(c.Qa.Bb?u.$b=v(r,c.Pa.jb[0])?2+v(r,c.Pa.jb[2]):v(r,c.Pa.jb[1]):u.$b=0,c.kc&&(u.Ad=v(r,c.Bd)),u.Za=!v(r,145)+0,u.Za){var m=u.Ob,h=0;for(c=0;4>c;++c){var b,Z=d[0+c];for(b=0;4>b;++b){Z=an[s[A+b]][Z];for(var p=Cn[v(r,Z[0])];0<p;)p=Cn[2*p+v(r,Z[p])];Z=-p,s[A+b]=Z}I(m,h,s,A,4),h+=4,d[0+c]=Z}}else Z=v(r,156)?v(r,128)?1:3:v(r,163)?2:0,u.Ob[0]=Z,n(s,A,Z,4),n(d,0,Z,4);u.Dd=v(r,142)?v(r,114)?v(r,183)?1:3:2:0}if(i.m.Ka)return Tg(g,7,"Premature end-of-partition0 encountered.");for(;g.ja<g.za;++g.ja){if(i=a,r=(o=g).rb[o.sb-1],s=o.rb[o.sb+o.ja],l=o.ya[o.aa+o.ja],A=o.kc?l.Ad:0)r.la=s.la=0,l.Za||(r.Na=s.Na=0),l.Hc=0,l.Gc=0,l.ia=0;else{var G,y;if(r=s,s=i,A=o.Pa.Xc,d=o.ya[o.aa+o.ja],u=o.pb[d.$b],c=d.ad,m=0,h=o.rb[o.sb-1],Z=b=0,n(c,m,0,384),d.Za)var B=0,S=A[3];else{p=C(16);var f=r.Na+h.Na;if(f=tn(s,A[1],f,u.Eb,0,p,0),r.Na=h.Na=(0<f)+0,1<f)nI(p,0,c,m);else{var W=p[0]+3>>3;for(p=0;256>p;p+=16)c[m+p]=W}B=1,S=A[0]}var V=15&r.la,R=15&h.la;for(p=0;4>p;++p){var X=1&R;for(W=y=0;4>W;++W)V=V>>1|(X=(f=tn(s,S,f=X+(1&V),u.Sc,B,c,m))>B)<<7,y=y<<2|(3<f?3:1<f?2:0!=c[m+0]),m+=16;V>>=4,R=R>>1|X<<7,b=(b<<8|y)>>>0}for(S=V,B=R>>4,G=0;4>G;G+=2){for(y=0,V=r.la>>4+G,R=h.la>>4+G,p=0;2>p;++p){for(X=1&R,W=0;2>W;++W)f=X+(1&V),V=V>>1|(X=0<(f=tn(s,A[2],f,u.Qc,0,c,m)))<<3,y=y<<2|(3<f?3:1<f?2:0!=c[m+0]),m+=16;V>>=2,R=R>>1|X<<5}Z|=y<<4*G,S|=V<<4<<G,B|=(240&R)<<G}r.la=S,h.la=B,d.Hc=b,d.Gc=Z,d.ia=43690&Z?0:u.ia,A=!(b|Z)}if(0<o.L&&(o.wa[o.Y+o.ja]=o.gd[l.$b][l.Za],o.wa[o.Y+o.ja].La|=!A),i.Ka)return Tg(g,7,"Premature end-of-file encountered.")}if(_g(g),o=t,i=1,l=(a=g).D,r=0<a.L&&a.M>=a.zb&&a.M<=a.Va,0==a.Aa)g:{if(l.M=a.M,l.uc=r,Yt(a,l),i=1,l=(y=a.D).Nb,r=(Z=xn[a.L])*a.R,s=Z/2*a.B,p=16*l*a.R,W=8*l*a.B,A=a.sa,d=a.ta-r+p,u=a.qa,c=a.ra-s+W,m=a.Ha,h=a.Ia-s+W,R=0==(V=y.M),b=V>=a.Va-1,2==a.Aa&&Yt(a,y),y.uc)for(X=(f=a).D.M,e(f.D.uc),y=f.yb;y<f.Hb;++y){B=y,S=X;var k=(J=(z=f).D).Nb;G=z.R;var J=J.wa[J.Y+B],Y=z.sa,w=z.ta+16*k*G+16*B,N=J.dd,H=J.tc;if(0!=H)if(e(3<=H),1==z.L)0<B&&ZI(Y,w,G,H+4),J.La&&GI(Y,w,G,H),0<S&&bI(Y,w,G,H+4),J.La&&pI(Y,w,G,H);else{var F=z.B,K=z.qa,x=z.ra+8*k*F+8*B,L=z.Ha,z=z.Ia+8*k*F+8*B;k=J.ld,0<B&&(cI(Y,w,G,H+4,N,k),AI(K,x,L,z,F,H+4,N,k)),J.La&&(uI(Y,w,G,H,N,k),hI(K,x,L,z,F,H,N,k)),0<S&&(rI(Y,w,G,H+4,N,k),sI(K,x,L,z,F,H+4,N,k)),J.La&&(dI(Y,w,G,H,N,k),mI(K,x,L,z,F,H,N,k))}}if(a.ia&&alert("todo:DitherRow"),null!=o.put){if(y=16*V,V=16*(V+1),R?(o.y=a.sa,o.O=a.ta+p,o.f=a.qa,o.N=a.ra+W,o.ea=a.Ha,o.W=a.Ia+W):(y-=Z,o.y=A,o.O=d,o.f=u,o.N=c,o.ea=m,o.W=h),b||(V-=Z),V>o.o&&(V=o.o),o.F=null,o.J=null,null!=a.Fa&&0<a.Fa.length&&y<V&&(o.J=ct(a,o,y,V-y),o.F=a.mb,null==o.F&&0==o.F.length)){i=Tg(a,3,"Could not decode alpha data.");break g}y<o.j&&(Z=o.j-y,y=o.j,e(!(1&Z)),o.O+=a.R*Z,o.N+=a.B*(Z>>1),o.W+=a.B*(Z>>1),null!=o.F&&(o.J+=o.width*Z)),y<V&&(o.O+=o.v,o.N+=o.v>>1,o.W+=o.v>>1,null!=o.F&&(o.J+=o.v),o.ka=y-o.j,o.U=o.va-o.v,o.T=V-y,i=o.put(o))}l+1!=a.Ic||b||(I(a.sa,a.ta-r,A,d+16*a.R,r),I(a.qa,a.ra-s,u,c+8*a.B,s),I(a.Ha,a.Ia-s,m,h+8*a.B,s))}if(!i)return Tg(g,6,"Output aborted.")}return 1}(g,t)),null!=t.bc&&t.bc(t),a&=1}return a?(g.cb=0,a):0}function ge(g,e,t,I,n){n=g[e+t+32*I]+(n>>3),g[e+t+32*I]=-256&n?0>n?0:255:n}function ee(g,e,t,I,n,C){ge(g,e,0,t,I+n),ge(g,e,1,t,I+C),ge(g,e,2,t,I-C),ge(g,e,3,t,I-n)}function te(g){return(20091*g>>16)+g}function Ie(g,e,t,I){var n,l=0,a=C(16);for(n=0;4>n;++n){var o=g[e+0]+g[e+8],i=g[e+0]-g[e+8],r=(35468*g[e+4]>>16)-te(g[e+12]),c=te(g[e+4])+(35468*g[e+12]>>16);a[l+0]=o+c,a[l+1]=i+r,a[l+2]=i-r,a[l+3]=o-c,l+=4,e++}for(n=l=0;4>n;++n)o=(g=a[l+0]+4)+a[l+8],i=g-a[l+8],r=(35468*a[l+4]>>16)-te(a[l+12]),ge(t,I,0,0,o+(c=te(a[l+4])+(35468*a[l+12]>>16))),ge(t,I,1,0,i+r),ge(t,I,2,0,i-r),ge(t,I,3,0,o-c),l++,I+=32}function ne(g,e,t,I){var n=g[e+0]+4,C=35468*g[e+4]>>16,l=te(g[e+4]),a=35468*g[e+1]>>16;ee(t,I,0,n+l,g=te(g[e+1]),a),ee(t,I,1,n+C,g,a),ee(t,I,2,n-C,g,a),ee(t,I,3,n-l,g,a)}function Ce(g,e,t,I,n){Ie(g,e,t,I),n&&Ie(g,e+16,t,I+4)}function le(g,e,t,I){CI(g,e+0,t,I,1),CI(g,e+32,t,I+128,1)}function ae(g,e,t,I){var n;for(g=g[e+0]+4,n=0;4>n;++n)for(e=0;4>e;++e)ge(t,I,e,n,g)}function oe(g,e,t,I){g[e+0]&&oI(g,e+0,t,I),g[e+16]&&oI(g,e+16,t,I+4),g[e+32]&&oI(g,e+32,t,I+128),g[e+48]&&oI(g,e+48,t,I+128+4)}function ie(g,e,t,I){var n,l=C(16);for(n=0;4>n;++n){var a=g[e+0+n]+g[e+12+n],o=g[e+4+n]+g[e+8+n],i=g[e+4+n]-g[e+8+n],r=g[e+0+n]-g[e+12+n];l[0+n]=a+o,l[8+n]=a-o,l[4+n]=r+i,l[12+n]=r-i}for(n=0;4>n;++n)a=(g=l[0+4*n]+3)+l[3+4*n],o=l[1+4*n]+l[2+4*n],i=l[1+4*n]-l[2+4*n],r=g-l[3+4*n],t[I+0]=a+o>>3,t[I+16]=r+i>>3,t[I+32]=a-o>>3,t[I+48]=r-i>>3,I+=64}function re(g,e,t){var I,n=e-32,C=YI,l=255-g[n-1];for(I=0;I<t;++I){var a,o=C,i=l+g[e-1];for(a=0;a<t;++a)g[e+a]=o[i+g[n+a]];e+=32}}function ce(g,e){re(g,e,4)}function se(g,e){re(g,e,8)}function Ae(g,e){re(g,e,16)}function de(g,e){var t;for(t=0;16>t;++t)I(g,e+32*t,g,e-32,16)}function ue(g,e){var t;for(t=16;0<t;--t)n(g,e,g[e-1],16),e+=32}function me(g,e,t){var I;for(I=0;16>I;++I)n(e,t+32*I,g,16)}function he(g,e){var t,I=16;for(t=0;16>t;++t)I+=g[e-1+32*t]+g[e+t-32];me(I>>5,g,e)}function be(g,e){var t,I=8;for(t=0;16>t;++t)I+=g[e-1+32*t];me(I>>4,g,e)}function Ze(g,e){var t,I=8;for(t=0;16>t;++t)I+=g[e+t-32];me(I>>4,g,e)}function pe(g,e){me(128,g,e)}function Ge(g,e,t){return g+2*e+t+2>>2}function ye(g,e){var t,n=e-32;for(n=new Uint8Array([Ge(g[n-1],g[n+0],g[n+1]),Ge(g[n+0],g[n+1],g[n+2]),Ge(g[n+1],g[n+2],g[n+3]),Ge(g[n+2],g[n+3],g[n+4])]),t=0;4>t;++t)I(g,e+32*t,n,0,n.length)}function Be(g,e){var t=g[e-1],I=g[e-1+32],n=g[e-1+64],C=g[e-1+96];R(g,e+0,16843009*Ge(g[e-1-32],t,I)),R(g,e+32,16843009*Ge(t,I,n)),R(g,e+64,16843009*Ge(I,n,C)),R(g,e+96,16843009*Ge(n,C,C))}function Se(g,e){var t,I=4;for(t=0;4>t;++t)I+=g[e+t-32]+g[e-1+32*t];for(I>>=3,t=0;4>t;++t)n(g,e+32*t,I,4)}function fe(g,e){var t=g[e-1+0],I=g[e-1+32],n=g[e-1+64],C=g[e-1-32],l=g[e+0-32],a=g[e+1-32],o=g[e+2-32],i=g[e+3-32];g[e+0+96]=Ge(I,n,g[e-1+96]),g[e+1+96]=g[e+0+64]=Ge(t,I,n),g[e+2+96]=g[e+1+64]=g[e+0+32]=Ge(C,t,I),g[e+3+96]=g[e+2+64]=g[e+1+32]=g[e+0+0]=Ge(l,C,t),g[e+3+64]=g[e+2+32]=g[e+1+0]=Ge(a,l,C),g[e+3+32]=g[e+2+0]=Ge(o,a,l),g[e+3+0]=Ge(i,o,a)}function We(g,e){var t=g[e+1-32],I=g[e+2-32],n=g[e+3-32],C=g[e+4-32],l=g[e+5-32],a=g[e+6-32],o=g[e+7-32];g[e+0+0]=Ge(g[e+0-32],t,I),g[e+1+0]=g[e+0+32]=Ge(t,I,n),g[e+2+0]=g[e+1+32]=g[e+0+64]=Ge(I,n,C),g[e+3+0]=g[e+2+32]=g[e+1+64]=g[e+0+96]=Ge(n,C,l),g[e+3+32]=g[e+2+64]=g[e+1+96]=Ge(C,l,a),g[e+3+64]=g[e+2+96]=Ge(l,a,o),g[e+3+96]=Ge(a,o,o)}function Ve(g,e){var t=g[e-1+0],I=g[e-1+32],n=g[e-1+64],C=g[e-1-32],l=g[e+0-32],a=g[e+1-32],o=g[e+2-32],i=g[e+3-32];g[e+0+0]=g[e+1+64]=C+l+1>>1,g[e+1+0]=g[e+2+64]=l+a+1>>1,g[e+2+0]=g[e+3+64]=a+o+1>>1,g[e+3+0]=o+i+1>>1,g[e+0+96]=Ge(n,I,t),g[e+0+64]=Ge(I,t,C),g[e+0+32]=g[e+1+96]=Ge(t,C,l),g[e+1+32]=g[e+2+96]=Ge(C,l,a),g[e+2+32]=g[e+3+96]=Ge(l,a,o),g[e+3+32]=Ge(a,o,i)}function ve(g,e){var t=g[e+0-32],I=g[e+1-32],n=g[e+2-32],C=g[e+3-32],l=g[e+4-32],a=g[e+5-32],o=g[e+6-32],i=g[e+7-32];g[e+0+0]=t+I+1>>1,g[e+1+0]=g[e+0+64]=I+n+1>>1,g[e+2+0]=g[e+1+64]=n+C+1>>1,g[e+3+0]=g[e+2+64]=C+l+1>>1,g[e+0+32]=Ge(t,I,n),g[e+1+32]=g[e+0+96]=Ge(I,n,C),g[e+2+32]=g[e+1+96]=Ge(n,C,l),g[e+3+32]=g[e+2+96]=Ge(C,l,a),g[e+3+64]=Ge(l,a,o),g[e+3+96]=Ge(a,o,i)}function Re(g,e){var t=g[e-1+0],I=g[e-1+32],n=g[e-1+64],C=g[e-1+96];g[e+0+0]=t+I+1>>1,g[e+2+0]=g[e+0+32]=I+n+1>>1,g[e+2+32]=g[e+0+64]=n+C+1>>1,g[e+1+0]=Ge(t,I,n),g[e+3+0]=g[e+1+32]=Ge(I,n,C),g[e+3+32]=g[e+1+64]=Ge(n,C,C),g[e+3+64]=g[e+2+64]=g[e+0+96]=g[e+1+96]=g[e+2+96]=g[e+3+96]=C}function Xe(g,e){var t=g[e-1+0],I=g[e-1+32],n=g[e-1+64],C=g[e-1+96],l=g[e-1-32],a=g[e+0-32],o=g[e+1-32],i=g[e+2-32];g[e+0+0]=g[e+2+32]=t+l+1>>1,g[e+0+32]=g[e+2+64]=I+t+1>>1,g[e+0+64]=g[e+2+96]=n+I+1>>1,g[e+0+96]=C+n+1>>1,g[e+3+0]=Ge(a,o,i),g[e+2+0]=Ge(l,a,o),g[e+1+0]=g[e+3+32]=Ge(t,l,a),g[e+1+32]=g[e+3+64]=Ge(I,t,l),g[e+1+64]=g[e+3+96]=Ge(n,I,t),g[e+1+96]=Ge(C,n,I)}function ke(g,e){var t;for(t=0;8>t;++t)I(g,e+32*t,g,e-32,8)}function Je(g,e){var t;for(t=0;8>t;++t)n(g,e,g[e-1],8),e+=32}function Ye(g,e,t){var I;for(I=0;8>I;++I)n(e,t+32*I,g,8)}function we(g,e){var t,I=8;for(t=0;8>t;++t)I+=g[e+t-32]+g[e-1+32*t];Ye(I>>4,g,e)}function Ne(g,e){var t,I=4;for(t=0;8>t;++t)I+=g[e+t-32];Ye(I>>3,g,e)}function He(g,e){var t,I=4;for(t=0;8>t;++t)I+=g[e-1+32*t];Ye(I>>3,g,e)}function Fe(g,e){Ye(128,g,e)}function Ke(g,e,t){var I=g[e-t],n=g[e+0],C=3*(n-I)+kI[1020+g[e-2*t]-g[e+t]],l=JI[112+(C+4>>3)];g[e-t]=YI[255+I+JI[112+(C+3>>3)]],g[e+0]=YI[255+n-l]}function xe(g,e,t,I){var n=g[e+0],C=g[e+t];return wI[255+g[e-2*t]-g[e-t]]>I||wI[255+C-n]>I}function Le(g,e,t,I){return 4*wI[255+g[e-t]-g[e+0]]+wI[255+g[e-2*t]-g[e+t]]<=I}function ze(g,e,t,I,n){var C=g[e-3*t],l=g[e-2*t],a=g[e-t],o=g[e+0],i=g[e+t],r=g[e+2*t],c=g[e+3*t];return 4*wI[255+a-o]+wI[255+l-i]>I?0:wI[255+g[e-4*t]-C]<=n&&wI[255+C-l]<=n&&wI[255+l-a]<=n&&wI[255+c-r]<=n&&wI[255+r-i]<=n&&wI[255+i-o]<=n}function Ee(g,e,t,I){var n=2*I+1;for(I=0;16>I;++I)Le(g,e+I,t,n)&&Ke(g,e+I,t)}function Me(g,e,t,I){var n=2*I+1;for(I=0;16>I;++I)Le(g,e+I*t,1,n)&&Ke(g,e+I*t,1)}function Ue(g,e,t,I){var n;for(n=3;0<n;--n)Ee(g,e+=4*t,t,I)}function je(g,e,t,I){var n;for(n=3;0<n;--n)Me(g,e+=4,t,I)}function Qe(g,e,t,I,n,C,l,a){for(C=2*C+1;0<n--;){if(ze(g,e,t,C,l))if(xe(g,e,t,a))Ke(g,e,t);else{var o=g,i=e,r=t,c=o[i-2*r],s=o[i-r],A=o[i+0],d=o[i+r],u=o[i+2*r],m=27*(b=kI[1020+3*(A-s)+kI[1020+c-d]])+63>>7,h=18*b+63>>7,b=9*b+63>>7;o[i-3*r]=YI[255+o[i-3*r]+b],o[i-2*r]=YI[255+c+h],o[i-r]=YI[255+s+m],o[i+0]=YI[255+A-m],o[i+r]=YI[255+d-h],o[i+2*r]=YI[255+u-b]}e+=I}}function De(g,e,t,I,n,C,l,a){for(C=2*C+1;0<n--;){if(ze(g,e,t,C,l))if(xe(g,e,t,a))Ke(g,e,t);else{var o=g,i=e,r=t,c=o[i-r],s=o[i+0],A=o[i+r],d=JI[112+(4+(u=3*(s-c))>>3)],u=JI[112+(u+3>>3)],m=d+1>>1;o[i-2*r]=YI[255+o[i-2*r]+m],o[i-r]=YI[255+c+u],o[i+0]=YI[255+s-d],o[i+r]=YI[255+A-m]}e+=I}}function Te(g,e,t,I,n,C){Qe(g,e,t,1,16,I,n,C)}function Pe(g,e,t,I,n,C){Qe(g,e,1,t,16,I,n,C)}function Oe(g,e,t,I,n,C){var l;for(l=3;0<l;--l)De(g,e+=4*t,t,1,16,I,n,C)}function qe(g,e,t,I,n,C){var l;for(l=3;0<l;--l)De(g,e+=4,1,t,16,I,n,C)}function _e(g,e,t,I,n,C,l,a){Qe(g,e,n,1,8,C,l,a),Qe(t,I,n,1,8,C,l,a)}function $e(g,e,t,I,n,C,l,a){Qe(g,e,1,n,8,C,l,a),Qe(t,I,1,n,8,C,l,a)}function gt(g,e,t,I,n,C,l,a){De(g,e+4*n,n,1,8,C,l,a),De(t,I+4*n,n,1,8,C,l,a)}function et(g,e,t,I,n,C,l,a){De(g,e+4,1,n,8,C,l,a),De(t,I+4,1,n,8,C,l,a)}function tt(){this.ba=new lg,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new og,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function It(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function nt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ct(){this.ua=0,this.Wa=new N,this.vb=new N,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new A,this.yc=new c}function lt(){this.xb=this.a=0,this.l=new Qg,this.ca=new lg,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new G,this.Pb=0,this.wd=new G,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ct,this.ab=0,this.gc=l(4,nt),this.Oc=0}function at(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Qg,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ot(g,e,t,I,n,C,l){for(g=null==g?0:g[e+0],e=0;e<l;++e)n[C+e]=g+t[I+e]&255,g=n[C+e]}function it(g,e,t,I,n,C,l){var a;if(null==g)ot(null,null,t,I,n,C,l);else for(a=0;a<l;++a)n[C+a]=g[e+a]+t[I+a]&255}function rt(g,e,t,I,n,C,l){if(null==g)ot(null,null,t,I,n,C,l);else{var a,o=g[e+0],i=o,r=o;for(a=0;a<l;++a)i=r+(o=g[e+a])-i,r=t[I+a]+(-256&i?0>i?0:255:i)&255,i=o,n[C+a]=r}}function ct(g,t,n,l){var a=t.width,o=t.o;if(e(null!=g&&null!=t),0>n||0>=l||n+l>o)return null;if(!g.Cc){if(null==g.ga){var i;if(g.ga=new at,(i=null==g.ga)||(i=t.width*t.o,e(0==g.Gb.length),g.Gb=C(i),g.Uc=0,null==g.Gb?i=0:(g.mb=g.Gb,g.nb=g.Uc,g.rc=null,i=1),i=!i),!i){i=g.ga;var r=g.Fa,c=g.P,s=g.qc,A=g.mb,d=g.nb,u=c+1,m=s-1,b=i.l;if(e(null!=r&&null!=A&&null!=t),mn[0]=null,mn[1]=ot,mn[2]=it,mn[3]=rt,i.ca=A,i.tb=d,i.c=t.width,i.i=t.height,e(0<i.c&&0<i.i),1>=s)t=0;else if(i.$a=3&r[c+0],i.Z=r[c+0]>>2&3,i.Lc=r[c+0]>>4&3,c=r[c+0]>>6&3,0>i.$a||1<i.$a||4<=i.Z||1<i.Lc||c)t=0;else if(b.put=Ag,b.ac=sg,b.bc=dg,b.ma=i,b.width=t.width,b.height=t.height,b.Da=t.Da,b.v=t.v,b.va=t.va,b.j=t.j,b.o=t.o,i.$a)g:{e(1==i.$a),t=vg();e:for(;;){if(null==t){t=0;break g}if(e(null!=i),i.mc=t,t.c=i.c,t.i=i.i,t.l=i.l,t.l.ma=i,t.l.width=i.c,t.l.height=i.i,t.a=0,h(t.m,r,u,m),!Rg(i.c,i.i,1,t,null))break e;if(1==t.ab&&3==t.gc[0].hc&&Bg(t.s)?(i.ic=1,r=t.c*t.i,t.Ta=null,t.Ua=0,t.V=C(r),t.Ba=0,null==t.V?(t.a=1,t=0):t=1):(i.ic=0,t=Xg(t,i.c)),!t)break e;t=1;break g}i.mc=null,t=0}else t=m>=i.c*i.i;i=!t}if(i)return null;1!=g.ga.Lc?g.Ga=0:l=o-n}e(null!=g.ga),e(n+l<=o);g:{if(t=(r=g.ga).c,o=r.l.o,0==r.$a){if(u=g.rc,m=g.Vc,b=g.Fa,c=g.P+1+n*t,s=g.mb,A=g.nb+n*t,e(c<=g.P+g.qc),0!=r.Z)for(e(null!=mn[r.Z]),i=0;i<l;++i)mn[r.Z](u,m,b,c,s,A,t),u=s,m=A,A+=t,c+=t;else for(i=0;i<l;++i)I(s,A,b,c,t),u=s,m=A,A+=t,c+=t;g.rc=u,g.Vc=m}else{if(e(null!=r.mc),t=n+l,e(null!=(i=r.mc)),e(t<=i.i),i.C>=t)t=1;else if(r.ic||mt(),r.ic){r=i.V,u=i.Ba,m=i.c;var Z=i.i,p=(b=1,c=i.$/m,s=i.$%m,A=i.m,d=i.s,i.$),G=m*Z,y=m*t,S=d.wc,W=p<y?pg(d,s,c):null;e(p<=G),e(t<=Z),e(Bg(d));e:for(;;){for(;!A.h&&p<y;){if(s&S||(W=pg(d,s,c)),e(null!=W),f(A),256>(Z=bg(W.G[0],W.H[0],A)))r[u+p]=Z,++p,++s>=m&&(s=0,++c<=t&&!(c%16)&&fg(i,c));else{if(!(280>Z)){b=0;break e}Z=mg(Z-256,A);var V,v=bg(W.G[4],W.H[4],A);if(f(A),!(p>=(v=hg(m,v=mg(v,A)))&&G-p>=Z)){b=0;break e}for(V=0;V<Z;++V)r[u+p+V]=r[u+p+V-v];for(p+=Z,s+=Z;s>=m;)s-=m,++c<=t&&!(c%16)&&fg(i,c);p<y&&s&S&&(W=pg(d,s,c))}e(A.h==B(A))}fg(i,c>t?t:c);break e}!b||A.h&&p<G?(b=0,i.a=A.h?5:3):i.$=p,t=b}else t=Wg(i,i.V,i.Ba,i.c,i.i,t,kg);if(!t){l=0;break g}}n+l>=o&&(g.Cc=1),l=1}if(!l)return null;if(g.Cc&&(null!=(l=g.ga)&&(l.mc=null),g.ga=null,0<g.Ga))return alert("todo:WebPDequantizeLevels"),null}return g.nb+n*a}function st(g,e,t,I,n,C){for(;0<n--;){var l,a=g,o=e+(t?1:0),i=g,r=e+(t?0:3);for(l=0;l<I;++l){var c=i[r+4*l];255!=c&&(c*=32897,a[o+4*l+0]=a[o+4*l+0]*c>>23,a[o+4*l+1]=a[o+4*l+1]*c>>23,a[o+4*l+2]=a[o+4*l+2]*c>>23)}e+=C}}function At(g,e,t,I,n){for(;0<I--;){var C;for(C=0;C<t;++C){var l=g[e+2*C+0],a=15&(i=g[e+2*C+1]),o=4369*a,i=(240&i|i>>4)*o>>16;g[e+2*C+0]=(240&l|l>>4)*o>>16&240|(15&l|l<<4)*o>>16>>4&15,g[e+2*C+1]=240&i|a}e+=n}}function dt(g,e,t,I,n,C,l,a){var o,i,r=255;for(i=0;i<n;++i){for(o=0;o<I;++o){var c=g[e+o];C[l+4*o]=c,r&=c}e+=t,l+=a}return 255!=r}function ut(g,e,t,I,n){var C;for(C=0;C<n;++C)t[I+C]=g[e+C]>>8}function mt(){yI=st,BI=At,SI=dt,fI=ut}function ht(t,I,n){g[t]=function(g,t,C,l,a,o,i,r,c,s,A,d,u,m,h,b,Z){var p,G=Z-1>>1,y=a[o+0]|i[r+0]<<16,B=c[s+0]|A[d+0]<<16;e(null!=g);var S=3*y+B+131074>>2;for(I(g[t+0],255&S,S>>16,u,m),null!=C&&(S=3*B+y+131074>>2,I(C[l+0],255&S,S>>16,h,b)),p=1;p<=G;++p){var f=a[o+p]|i[r+p]<<16,W=c[s+p]|A[d+p]<<16,V=y+f+B+W+524296,v=V+2*(f+B)>>3;S=v+y>>1,y=(V=V+2*(y+W)>>3)+f>>1,I(g[t+2*p-1],255&S,S>>16,u,m+(2*p-1)*n),I(g[t+2*p-0],255&y,y>>16,u,m+(2*p-0)*n),null!=C&&(S=V+B>>1,y=v+W>>1,I(C[l+2*p-1],255&S,S>>16,h,b+(2*p-1)*n),I(C[l+2*p+0],255&y,y>>16,h,b+(2*p+0)*n)),y=f,B=W}1&Z||(S=3*y+B+131074>>2,I(g[t+Z-1],255&S,S>>16,u,m+(Z-1)*n),null!=C&&(S=3*B+y+131074>>2,I(C[l+Z-1],255&S,S>>16,h,b+(Z-1)*n)))}}function bt(){hn[NI]=bn,hn[HI]=pn,hn[FI]=Zn,hn[KI]=Gn,hn[xI]=yn,hn[LI]=Bn,hn[zI]=Sn,hn[EI]=pn,hn[MI]=Gn,hn[UI]=yn,hn[jI]=Bn}function Zt(g){return g&~Xn?0>g?0:255:g>>Rn}function pt(g,e){return Zt((19077*g>>8)+(26149*e>>8)-14234)}function Gt(g,e,t){return Zt((19077*g>>8)-(6419*e>>8)-(13320*t>>8)+8708)}function yt(g,e){return Zt((19077*g>>8)+(33050*e>>8)-17685)}function Bt(g,e,t,I,n){I[n+0]=pt(g,t),I[n+1]=Gt(g,e,t),I[n+2]=yt(g,e)}function St(g,e,t,I,n){I[n+0]=yt(g,e),I[n+1]=Gt(g,e,t),I[n+2]=pt(g,t)}function ft(g,e,t,I,n){var C=Gt(g,e,t);e=C<<3&224|yt(g,e)>>3,I[n+0]=248&pt(g,t)|C>>5,I[n+1]=e}function Wt(g,e,t,I,n){var C=240&yt(g,e)|15;I[n+0]=240&pt(g,t)|Gt(g,e,t)>>4,I[n+1]=C}function Vt(g,e,t,I,n){I[n+0]=255,Bt(g,e,t,I,n+1)}function vt(g,e,t,I,n){St(g,e,t,I,n),I[n+3]=255}function Rt(g,e,t,I,n){Bt(g,e,t,I,n),I[n+3]=255}function jg(g,e){return 0>g?0:g>e?e:g}function Xt(e,t,I){g[e]=function(g,e,n,C,l,a,o,i,r){for(var c=i+(-2&r)*I;i!=c;)t(g[e+0],n[C+0],l[a+0],o,i),t(g[e+1],n[C+0],l[a+0],o,i+I),e+=2,++C,++a,i+=2*I;1&r&&t(g[e+0],n[C+0],l[a+0],o,i)}}function kt(g,e,t){return 0==t?0==g?0==e?6:5:0==e?4:0:t}function Jt(g,e,t,I,n){switch(g>>>30){case 3:CI(e,t,I,n,0);break;case 2:lI(e,t,I,n);break;case 1:oI(e,t,I,n)}}function Yt(g,e){var t,C,l=e.M,a=e.Nb,o=g.oc,i=g.pc+40,r=g.oc,c=g.pc+584,s=g.oc,A=g.pc+600;for(t=0;16>t;++t)o[i+32*t-1]=129;for(t=0;8>t;++t)r[c+32*t-1]=129,s[A+32*t-1]=129;for(0<l?o[i-1-32]=r[c-1-32]=s[A-1-32]=129:(n(o,i-32-1,127,21),n(r,c-32-1,127,9),n(s,A-32-1,127,9)),C=0;C<g.za;++C){var d=e.ya[e.aa+C];if(0<C){for(t=-1;16>t;++t)I(o,i+32*t-4,o,i+32*t+12,4);for(t=-1;8>t;++t)I(r,c+32*t-4,r,c+32*t+4,4),I(s,A+32*t-4,s,A+32*t+4,4)}var u=g.Gd,m=g.Hd+C,h=d.ad,b=d.Hc;if(0<l&&(I(o,i-32,u[m].y,0,16),I(r,c-32,u[m].f,0,8),I(s,A-32,u[m].ea,0,8)),d.Za){var Z=o,p=i-32+16;for(0<l&&(C>=g.za-1?n(Z,p,u[m].y[15],4):I(Z,p,u[m+1].y,0,4)),t=0;4>t;t++)Z[p+128+t]=Z[p+256+t]=Z[p+384+t]=Z[p+0+t];for(t=0;16>t;++t,b<<=2)Z=o,p=i+Kn[t],sn[d.Ob[t]](Z,p),Jt(b,h,16*+t,Z,p)}else if(Z=kt(C,l,d.Ob[0]),cn[Z](o,i),0!=b)for(t=0;16>t;++t,b<<=2)Jt(b,h,16*+t,o,i+Kn[t]);for(t=d.Gc,Z=kt(C,l,d.Dd),An[Z](r,c),An[Z](s,A),b=h,Z=r,p=c,255&(d=t|0)&&(170&d?aI(b,256,Z,p):iI(b,256,Z,p)),d=s,b=A,255&(t>>=8)&&(170&t?aI(h,320,d,b):iI(h,320,d,b)),l<g.Ub-1&&(I(u[m].y,0,o,i+480,16),I(u[m].f,0,r,c+224,8),I(u[m].ea,0,s,A+224,8)),t=8*a*g.B,u=g.sa,m=g.ta+16*C+16*a*g.R,h=g.qa,d=g.ra+8*C+t,b=g.Ha,Z=g.Ia+8*C+t,t=0;16>t;++t)I(u,m+t*g.R,o,i+32*t,16);for(t=0;8>t;++t)I(h,d+t*g.B,r,c+32*t,8),I(b,Z+t*g.B,s,A+32*t,8)}}function wt(g,I,n,C,l,a,o,i,r){var c=[0],s=[0],A=0,d=null!=r?r.kd:0,u=null!=r?r:new It;if(null==g||12>n)return 7;u.data=g,u.w=I,u.ha=n,I=[I],n=[n],u.gb=[u.gb];g:{var m=I,b=n,Z=u.gb;if(e(null!=g),e(null!=b),e(null!=Z),Z[0]=0,12<=b[0]&&!t(g,m[0],"RIFF")){if(t(g,m[0]+8,"WEBP")){Z=3;break g}var p=J(g,m[0]+4);if(12>p||4294967286<p){Z=3;break g}if(d&&p>b[0]-8){Z=7;break g}Z[0]=p,m[0]+=12,b[0]-=12}Z=0}if(0!=Z)return Z;for(p=0<u.gb[0],n=n[0];;){g:{var y=g;b=I,Z=n;var B=c,S=s,f=m=[0];if((v=A=[A])[0]=0,8>Z[0])Z=7;else{if(!t(y,b[0],"VP8X")){if(10!=J(y,b[0]+4)){Z=3;break g}if(18>Z[0]){Z=7;break g}var W=J(y,b[0]+8),V=1+k(y,b[0]+12);if(2147483648<=V*(y=1+k(y,b[0]+15))){Z=3;break g}null!=f&&(f[0]=W),null!=B&&(B[0]=V),null!=S&&(S[0]=y),b[0]+=18,Z[0]-=18,v[0]=1}Z=0}}if(A=A[0],m=m[0],0!=Z)return Z;if(b=!!(2&m),!p&&A)return 3;if(null!=a&&(a[0]=!!(16&m)),null!=o&&(o[0]=b),null!=i&&(i[0]=0),o=c[0],m=s[0],A&&b&&null==r){Z=0;break}if(4>n){Z=7;break}if(p&&A||!p&&!A&&!t(g,I[0],"ALPH")){n=[n],u.na=[u.na],u.P=[u.P],u.Sa=[u.Sa];g:{W=g,Z=I,p=n;var v=u.gb;B=u.na,S=u.P,f=u.Sa,V=22,e(null!=W),e(null!=p),y=Z[0];var R=p[0];for(e(null!=B),e(null!=f),B[0]=null,S[0]=null,f[0]=0;;){if(Z[0]=y,p[0]=R,8>R){Z=7;break g}var X=J(W,y+4);if(4294967286<X){Z=3;break g}var Y=8+X+1&-2;if(V+=Y,0<v&&V>v){Z=3;break g}if(!t(W,y,"VP8 ")||!t(W,y,"VP8L")){Z=0;break g}if(R[0]<Y){Z=7;break g}t(W,y,"ALPH")||(B[0]=W,S[0]=y+8,f[0]=X),y+=Y,R-=Y}}if(n=n[0],u.na=u.na[0],u.P=u.P[0],u.Sa=u.Sa[0],0!=Z)break}n=[n],u.Ja=[u.Ja],u.xa=[u.xa];g:if(v=g,Z=I,p=n,B=u.gb[0],S=u.Ja,f=u.xa,W=Z[0],y=!t(v,W,"VP8 "),V=!t(v,W,"VP8L"),e(null!=v),e(null!=p),e(null!=S),e(null!=f),8>p[0])Z=7;else{if(y||V){if(v=J(v,W+4),12<=B&&v>B-12){Z=3;break g}if(d&&v>p[0]-8){Z=7;break g}S[0]=v,Z[0]+=8,p[0]-=8,f[0]=V}else f[0]=5<=p[0]&&47==v[W+0]&&!(v[W+4]>>5),S[0]=p[0];Z=0}if(n=n[0],u.Ja=u.Ja[0],u.xa=u.xa[0],I=I[0],0!=Z)break;if(4294967286<u.Ja)return 3;if(null==i||b||(i[0]=u.xa?2:1),o=[o],m=[m],u.xa){if(5>n){Z=7;break}i=o,d=m,b=a,null==g||5>n?g=0:5<=n&&47==g[I+0]&&!(g[I+4]>>5)?(p=[0],v=[0],B=[0],h(S=new G,g,I,n),ug(S,p,v,B)?(null!=i&&(i[0]=p[0]),null!=d&&(d[0]=v[0]),null!=b&&(b[0]=B[0]),g=1):g=0):g=0}else{if(10>n){Z=7;break}i=m,null==g||10>n||!Pg(g,I+3,n-3)?g=0:(d=g[I+0]|g[I+1]<<8|g[I+2]<<16,b=16383&(g[I+7]<<8|g[I+6]),g=16383&(g[I+9]<<8|g[I+8]),1&d||3<(d>>1&7)||!(d>>4&1)||d>>5>=u.Ja||!b||!g?g=0:(o&&(o[0]=b),i&&(i[0]=g),g=1))}if(!g)return 3;if(o=o[0],m=m[0],A&&(c[0]!=o||s[0]!=m))return 3;null!=r&&(r[0]=u,r.offset=I-r.w,e(4294967286>I-r.w),e(r.offset==r.ha-n));break}return 0==Z||7==Z&&A&&null==r?(null!=a&&(a[0]|=null!=u.na&&0<u.na.length),null!=C&&(C[0]=o),null!=l&&(l[0]=m),0):Z}function Nt(g,e,t){var I=e.width,n=e.height,C=0,l=0,a=I,o=n;if(e.Da=null!=g&&0<g.Da,e.Da&&(a=g.cd,o=g.bd,C=g.v,l=g.j,11>t||(C&=-2,l&=-2),0>C||0>l||0>=a||0>=o||C+a>I||l+o>n))return 0;if(e.v=C,e.j=l,e.va=C+a,e.o=l+o,e.U=a,e.T=o,e.da=null!=g&&0<g.da,e.da){if(!H(a,o,t=[g.ib],C=[g.hb]))return 0;e.ib=t[0],e.hb=C[0]}return e.ob=null!=g&&g.ob,e.Kb=null==g||!g.Sd,e.da&&(e.ob=e.ib<3*I/4&&e.hb<3*n/4,e.Kb=0),1}function Ht(g){if(null==g)return 2;if(11>g.S){var e=g.f.RGBA;e.fb+=(g.height-1)*e.A,e.A=-e.A}else e=g.f.kb,g=g.height,e.O+=(g-1)*e.fa,e.fa=-e.fa,e.N+=(g-1>>1)*e.Ab,e.Ab=-e.Ab,e.W+=(g-1>>1)*e.Db,e.Db=-e.Db,null!=e.F&&(e.J+=(g-1)*e.lb,e.lb=-e.lb);return 0}function Ft(g,e,t,I){if(null==I||0>=g||0>=e)return 2;if(null!=t){if(t.Da){var n=t.cd,l=t.bd,a=-2&t.v,o=-2&t.j;if(0>a||0>o||0>=n||0>=l||a+n>g||o+l>e)return 2;g=n,e=l}if(t.da){if(!H(g,e,n=[t.ib],l=[t.hb]))return 2;g=n[0],e=l[0]}}I.width=g,I.height=e;g:{var i=I.width,r=I.height;if(g=I.S,0>=i||0>=r||!(g>=NI&&13>g))g=2;else{if(0>=I.Rd&&null==I.sd){a=l=n=e=0;var c=(o=i*En[g])*r;if(11>g||(l=(r+1)/2*(e=(i+1)/2),12==g&&(a=(n=i)*r)),null==(r=C(c+2*l+a))){g=1;break g}I.sd=r,11>g?((i=I.f.RGBA).eb=r,i.fb=0,i.A=o,i.size=c):((i=I.f.kb).y=r,i.O=0,i.fa=o,i.Fd=c,i.f=r,i.N=0+c,i.Ab=e,i.Cd=l,i.ea=r,i.W=0+c+l,i.Db=e,i.Ed=l,12==g&&(i.F=r,i.J=0+c+2*l),i.Tc=a,i.lb=n)}if(e=1,n=I.S,l=I.width,a=I.height,n>=NI&&13>n)if(11>n)g=I.f.RGBA,e&=(o=Math.abs(g.A))*(a-1)+l<=g.size,e&=o>=l*En[n],e&=null!=g.eb;else{g=I.f.kb,o=(l+1)/2,c=(a+1)/2,i=Math.abs(g.fa),r=Math.abs(g.Ab);var s=Math.abs(g.Db),A=Math.abs(g.lb),d=A*(a-1)+l;e&=i*(a-1)+l<=g.Fd,e&=r*(c-1)+o<=g.Cd,e=(e&=s*(c-1)+o<=g.Ed)&i>=l&r>=o&s>=o,e&=null!=g.y,e&=null!=g.f,e&=null!=g.ea,12==n&&(e&=A>=l,e&=d<=g.Tc,e&=null!=g.F)}else e=0;g=e?0:2}}return 0!=g||null!=t&&t.fd&&(g=Ht(I)),g}var Kt=64,xt=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Lt=24,zt=32,Et=8,Mt=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];x("Predictor0","PredictorAdd0"),g.Predictor0=function(){return 4278190080},g.Predictor1=function(g){return g},g.Predictor2=function(g,e,t){return e[t+0]},g.Predictor3=function(g,e,t){return e[t+1]},g.Predictor4=function(g,e,t){return e[t-1]},g.Predictor5=function(g,e,t){return z(z(g,e[t+1]),e[t+0])},g.Predictor6=function(g,e,t){return z(g,e[t-1])},g.Predictor7=function(g,e,t){return z(g,e[t+0])},g.Predictor8=function(g,e,t){return z(e[t-1],e[t+0])},g.Predictor9=function(g,e,t){return z(e[t+0],e[t+1])},g.Predictor10=function(g,e,t){return z(z(g,e[t-1]),z(e[t+0],e[t+1]))},g.Predictor11=function(g,e,t){var I=e[t+0];return 0>=U(I>>24&255,g>>24&255,(e=e[t-1])>>24&255)+U(I>>16&255,g>>16&255,e>>16&255)+U(I>>8&255,g>>8&255,e>>8&255)+U(255&I,255&g,255&e)?I:g},g.Predictor12=function(g,e,t){var I=e[t+0];return(E((g>>24&255)+(I>>24&255)-((e=e[t-1])>>24&255))<<24|E((g>>16&255)+(I>>16&255)-(e>>16&255))<<16|E((g>>8&255)+(I>>8&255)-(e>>8&255))<<8|E((255&g)+(255&I)-(255&e)))>>>0},g.Predictor13=function(g,e,t){var I=e[t-1];return(M((g=z(g,e[t+0]))>>24&255,I>>24&255)<<24|M(g>>16&255,I>>16&255)<<16|M(g>>8&255,I>>8&255)<<8|M(255&g,255&I))>>>0};var Ut=g.PredictorAdd0;g.PredictorAdd1=j,x("Predictor2","PredictorAdd2"),x("Predictor3","PredictorAdd3"),x("Predictor4","PredictorAdd4"),x("Predictor5","PredictorAdd5"),x("Predictor6","PredictorAdd6"),x("Predictor7","PredictorAdd7"),x("Predictor8","PredictorAdd8"),x("Predictor9","PredictorAdd9"),x("Predictor10","PredictorAdd10"),x("Predictor11","PredictorAdd11"),x("Predictor12","PredictorAdd12"),x("Predictor13","PredictorAdd13");var jt=g.PredictorAdd2;P("ColorIndexInverseTransform","MapARGB","32b",(function(g){return g>>8&255}),(function(g){return g})),P("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",(function(g){return g}),(function(g){return g>>8&255}));var Qt,Dt=g.ColorIndexInverseTransform,Tt=g.MapARGB,Pt=g.VP8LColorIndexInverseTransformAlpha,Ot=g.MapAlpha,qt=g.VP8LPredictorsAdd=[];qt.length=16,(g.VP8LPredictors=[]).length=16,(g.VP8LPredictorsAdd_C=[]).length=16,(g.VP8LPredictors_C=[]).length=16;var _t,$t,gI,eI,tI,II,nI,CI,lI,aI,oI,iI,rI,cI,sI,AI,dI,uI,mI,hI,bI,ZI,pI,GI,yI,BI,SI,fI,WI=C(511),VI=C(2041),vI=C(225),RI=C(767),XI=0,kI=VI,JI=vI,YI=RI,wI=WI,NI=0,HI=1,FI=2,KI=3,xI=4,LI=5,zI=6,EI=7,MI=8,UI=9,jI=10,QI=[2,3,7],DI=[3,3,11],TI=[280,256,256,256,40],PI=[0,1,1,1,0],OI=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],qI=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],_I=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],$I=8,gn=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],en=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],tn=null,In=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],nn=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Cn=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],ln=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],an=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],on=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],rn=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],cn=[],sn=[],An=[],dn=1,un=2,mn=[],hn=[];ht("UpsampleRgbLinePair",Bt,3),ht("UpsampleBgrLinePair",St,3),ht("UpsampleRgbaLinePair",Rt,4),ht("UpsampleBgraLinePair",vt,4),ht("UpsampleArgbLinePair",Vt,4),ht("UpsampleRgba4444LinePair",Wt,2),ht("UpsampleRgb565LinePair",ft,2);var bn=g.UpsampleRgbLinePair,Zn=g.UpsampleBgrLinePair,pn=g.UpsampleRgbaLinePair,Gn=g.UpsampleBgraLinePair,yn=g.UpsampleArgbLinePair,Bn=g.UpsampleRgba4444LinePair,Sn=g.UpsampleRgb565LinePair,fn=16,Wn=1<<fn-1,Vn=-227,vn=482,Rn=6,Xn=(256<<Rn)-1,kn=0,Jn=C(256),Yn=C(256),wn=C(256),Nn=C(256),Hn=C(vn-Vn),Fn=C(vn-Vn);Xt("YuvToRgbRow",Bt,3),Xt("YuvToBgrRow",St,3),Xt("YuvToRgbaRow",Rt,4),Xt("YuvToBgraRow",vt,4),Xt("YuvToArgbRow",Vt,4),Xt("YuvToRgba4444Row",Wt,2),Xt("YuvToRgb565Row",ft,2);var Kn=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],xn=[0,2,8],Ln=[8,7,6,4,4,2,2,2,1,1,1,1],zn=1;this.WebPDecodeRGBA=function(g,t,I,n,C){var l=HI,a=new tt,o=new lg;a.ba=o,o.S=l,o.width=[o.width],o.height=[o.height];var i=o.width,r=o.height,c=new ag;if(null==c||null==g)var s=2;else e(null!=c),s=wt(g,t,I,c.width,c.height,c.Pd,c.Qd,c.format,null);if(0!=s?i=0:(null!=i&&(i[0]=c.width[0]),null!=r&&(r[0]=c.height[0]),i=1),i){o.width=o.width[0],o.height=o.height[0],null!=n&&(n[0]=o.width),null!=C&&(C[0]=o.height);g:{if(n=new Qg,(C=new It).data=g,C.w=t,C.ha=I,C.kd=1,t=[0],e(null!=C),(0==(g=wt(C.data,C.w,C.ha,null,null,null,t,null,C))||7==g)&&t[0]&&(g=4),0==(t=g)){if(e(null!=a),n.data=C.data,n.w=C.w+C.offset,n.ha=C.ha-C.offset,n.put=Ag,n.ac=sg,n.bc=dg,n.ma=a,C.xa){if(null==(g=vg())){a=1;break g}if(function(g,t){var I=[0],n=[0],C=[0];e:for(;;){if(null==g)return 0;if(null==t)return g.a=2,0;if(g.l=t,g.a=0,h(g.m,t.data,t.w,t.ha),!ug(g.m,I,n,C)){g.a=3;break e}if(g.xb=un,t.width=I[0],t.height=n[0],!Rg(I[0],n[0],1,g,null))break e;return 1}return e(0!=g.a),0}(g,n)){if(n=0==(t=Ft(n.width,n.height,a.Oa,a.ba))){e:{n=g;t:for(;;){if(null==n){n=0;break e}if(e(null!=n.s.yc),e(null!=n.s.Ya),e(0<n.s.Wb),e(null!=(I=n.l)),e(null!=(C=I.ma)),0!=n.xb){if(n.ca=C.ba,n.tb=C.tb,e(null!=n.ca),!Nt(C.Oa,I,KI)){n.a=2;break t}if(!Xg(n,I.width))break t;if(I.da)break t;if((I.da||Ig(n.ca.S))&&mt(),11>n.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),null!=n.ca.f.kb.F&&mt()),n.Pb&&0<n.s.ua&&null==n.s.vb.X&&!Y(n.s.vb,n.s.Wa.Xa)){n.a=1;break t}n.xb=0}if(!Wg(n,n.V,n.Ba,n.c,n.i,I.o,yg))break t;C.Dc=n.Ma,n=1;break e}e(0!=n.a),n=0}n=!n}n&&(t=g.a)}else t=g.a}else{if(null==(g=new Dg)){a=1;break g}if(g.Fa=C.na,g.P=C.P,g.qc=C.Sa,Og(g,n)){if(0==(t=Ft(n.width,n.height,a.Oa,a.ba))){if(g.Aa=0,I=a.Oa,e(null!=(C=g)),null!=I){if(0<(i=0>(i=I.Md)?0:100<i?255:255*i/100)){for(r=c=0;4>r;++r)12>(s=C.pb[r]).lc&&(s.ia=i*Ln[0>s.lc?0:s.lc]>>3),c|=s.ia;c&&(alert("todo:VP8InitRandom"),C.ia=1)}C.Ga=I.Id,100<C.Ga?C.Ga=100:0>C.Ga&&(C.Ga=0)}$g(g,n)||(t=g.a)}}else t=g.a}0==t&&null!=a.Oa&&a.Oa.fd&&(t=Ht(a.ba))}a=t}l=0!=a?null:11>l?o.f.RGBA.eb:o.f.kb.y}else l=null;return l};var En=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function i(g,e){for(var t="",I=0;I<4;I++)t+=String.fromCharCode(g[e++]);return t}function r(g,e){return(g[e+0]|g[e+1]<<8|g[e+2]<<16)>>>0}function c(g,e){return(g[e+0]|g[e+1]<<8|g[e+2]<<16|g[e+3]<<24)>>>0}new o;var s=[0],A=[0],d=[],u=new o,m=g,h=function(g,e){var t={},I=0,n=!1,C=0,l=0;if(t.frames=[],!function(g,e){for(var t=0;t<4;t++)if(g[e+t]!="RIFF".charCodeAt(t))return!0;return!1}(g,e)){for(c(g,e+=4),e+=8;e<g.length;){var a=i(g,e),o=c(g,e+=4);e+=4;var s=o+(1&o);switch(a){case"VP8 ":case"VP8L":void 0===t.frames[I]&&(t.frames[I]={}),(u=t.frames[I]).src_off=n?l:e-8,u.src_size=C+o+8,I++,n&&(n=!1,C=0,l=0);break;case"VP8X":(u=t.header={}).feature_flags=g[e];var A=e+4;u.canvas_width=1+r(g,A),A+=3,u.canvas_height=1+r(g,A),A+=3;break;case"ALPH":n=!0,C=s+8,l=e-8;break;case"ANIM":(u=t.header).bgcolor=c(g,e),A=e+4,u.loop_count=(m=g)[(h=A)+0]|m[h+1]<<8,A+=2;break;case"ANMF":var d,u;(u=t.frames[I]={}).offset_x=2*r(g,e),e+=3,u.offset_y=2*r(g,e),e+=3,u.width=1+r(g,e),e+=3,u.height=1+r(g,e),e+=3,u.duration=r(g,e),e+=3,d=g[e++],u.dispose=1&d,u.blend=d>>1&1}"ANMF"!=a&&(e+=s)}var m,h;return t}}(m,0);h.response=m,h.rgbaoutput=!0,h.dataurl=!1;var b=h.header?h.header:null,Z=h.frames?h.frames:null;if(b){b.loop_counter=b.loop_count,s=[b.canvas_height],A=[b.canvas_width];for(var p=0;p<Z.length&&0!=Z[p].blend;p++);}var G=Z[0],y=u.WebPDecodeRGBA(m,G.src_off,G.src_size,A,s);G.rgba=y,G.imgwidth=A[0],G.imgheight=s[0];for(var B=0;B<A[0]*s[0]*4;B++)d[B]=y[B];return this.width=A,this.height=s,this.data=d,this}!function(g){var e=function(e,I,o,i){var r=4,c=C;switch(i){case g.image_compression.FAST:r=1,c=n;break;case g.image_compression.MEDIUM:r=6,c=l;break;case g.image_compression.SLOW:r=9,c=a}var s=iC(e=t(e,I,o,c),{level:r});return g.__addimage__.arrayBufferToBinaryString(s)},t=function(g,e,t,I){for(var n,C,l,a=g.length/e,o=new Uint8Array(g.length+a),c=i(),s=0;s<a;s+=1){if(l=s*e,n=g.subarray(l,l+e),I)o.set(I(n,t,C),l+s);else{for(var A,d=c.length,u=[];A<d;A+=1)u[A]=c[A](n,t,C);var m=r(u.concat());o.set(u[m],l+s)}C=n}return o},I=function(g){var e=Array.apply([],g);return e.unshift(0),e},n=function(g,e){var t,I=[],n=g.length;I[0]=1;for(var C=0;C<n;C+=1)t=g[C-e]||0,I[C+1]=g[C]-t+256&255;return I},C=function(g,e,t){var I,n=[],C=g.length;n[0]=2;for(var l=0;l<C;l+=1)I=t&&t[l]||0,n[l+1]=g[l]-I+256&255;return n},l=function(g,e,t){var I,n,C=[],l=g.length;C[0]=3;for(var a=0;a<l;a+=1)I=g[a-e]||0,n=t&&t[a]||0,C[a+1]=g[a]+256-(I+n>>>1)&255;return C},a=function(g,e,t){var I,n,C,l,a=[],i=g.length;a[0]=4;for(var r=0;r<i;r+=1)I=g[r-e]||0,n=t&&t[r]||0,C=t&&t[r-e]||0,l=o(I,n,C),a[r+1]=g[r]-l+256&255;return a},o=function(g,e,t){if(g===e&&e===t)return g;var I=Math.abs(e-t),n=Math.abs(g-t),C=Math.abs(g+e-t-t);return I<=n&&I<=C?g:n<=C?e:t},i=function(){return[I,n,C,l,a]},r=function(g){var e=g.map((function(g){return g.reduce((function(g,e){return g+Math.abs(e)}),0)}));return e.indexOf(Math.min.apply(null,e))};g.processPNG=function(t,I,n,C){var l,a,o,i,r,c,s,A,d,u,m,h,b,Z,p,G=this.decode.FLATE_DECODE,y="";if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){if(t=(o=new Ia(t)).imgData,a=o.bits,l=o.colorSpace,r=o.colors,-1!==[4,6].indexOf(o.colorType)){if(8===o.bits){d=(A=32==o.pixelBitlength?new Uint32Array(o.decodePixels().buffer):16==o.pixelBitlength?new Uint16Array(o.decodePixels().buffer):new Uint8Array(o.decodePixels().buffer)).length,m=new Uint8Array(d*o.colors),u=new Uint8Array(d);var B,S=o.pixelBitlength-o.bits;for(Z=0,p=0;Z<d;Z++){for(b=A[Z],B=0;B<S;)m[p++]=b>>>B&255,B+=o.bits;u[Z]=b>>>B&255}}if(16===o.bits){d=(A=new Uint32Array(o.decodePixels().buffer)).length,m=new Uint8Array(d*(32/o.pixelBitlength)*o.colors),u=new Uint8Array(d*(32/o.pixelBitlength)),h=o.colors>1,Z=0,p=0;for(var f=0;Z<d;)b=A[Z++],m[p++]=b>>>0&255,h&&(m[p++]=b>>>16&255,b=A[Z++],m[p++]=b>>>0&255),u[f++]=b>>>16&255;a=8}C!==g.image_compression.NONE?(t=e(m,o.width*o.colors,o.colors,C),s=e(u,o.width,1,C)):(t=m,s=u,G=void 0)}if(3===o.colorType&&(l=this.color_spaces.INDEXED,c=o.palette,o.transparency.indexed)){var W=o.transparency.indexed,V=0;for(Z=0,d=W.length;Z<d;++Z)V+=W[Z];if((V/=255)===d-1&&-1!==W.indexOf(0))i=[W.indexOf(0)];else if(V!==d){for(A=o.decodePixels(),u=new Uint8Array(A.length),Z=0,d=A.length;Z<d;Z++)u[Z]=W[A[Z]];s=e(u,o.width,1)}}var v=function(e){var t;switch(e){case g.image_compression.FAST:t=11;break;case g.image_compression.MEDIUM:t=13;break;case g.image_compression.SLOW:t=14;break;default:t=12}return t}(C);return G===this.decode.FLATE_DECODE&&(y="/Predictor "+v+" "),y+="/Colors "+r+" /BitsPerComponent "+a+" /Columns "+o.width,(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(s&&this.__addimage__.isArrayBuffer(s)||this.__addimage__.isArrayBufferView(s))&&(s=this.__addimage__.arrayBufferToBinaryString(s)),{alias:n,data:t,index:I,filter:G,decodeParameters:y,transparency:i,palette:c,sMask:s,predictor:v,width:o.width,height:o.height,bitsPerComponent:a,colorSpace:l}}}}(jC.API),function(g){g.processGIF89A=function(e,t,I,n){var C=new na(e),l=C.width,a=C.height,o=[];C.decodeAndBlitFrameRGBA(0,o);var i={data:o,width:l,height:a},r=new la(100).encode(i,100);return g.processJPEG.call(this,r,t,I,n)},g.processGIF87A=g.processGIF89A}(jC.API),aa.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var g=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(g);for(var e=0;e<g;e++){var t=this.datav.getUint8(this.pos++,!0),I=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),C=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:n,green:I,blue:t,quad:C}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},aa.prototype.parseBGR=function(){this.pos=this.offset;try{var g="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[g]()}catch(g){dC.log("bit decode error:"+g)}},aa.prototype.bit1=function(){var g,e=Math.ceil(this.width/8),t=e%4;for(g=this.height-1;g>=0;g--){for(var I=this.bottom_up?g:this.height-1-g,n=0;n<e;n++)for(var C=this.datav.getUint8(this.pos++,!0),l=I*this.width*4+8*n*4,a=0;a<8&&8*n+a<this.width;a++){var o=this.palette[C>>7-a&1];this.data[l+4*a]=o.blue,this.data[l+4*a+1]=o.green,this.data[l+4*a+2]=o.red,this.data[l+4*a+3]=255}0!==t&&(this.pos+=4-t)}},aa.prototype.bit4=function(){for(var g=Math.ceil(this.width/2),e=g%4,t=this.height-1;t>=0;t--){for(var I=this.bottom_up?t:this.height-1-t,n=0;n<g;n++){var C=this.datav.getUint8(this.pos++,!0),l=I*this.width*4+2*n*4,a=C>>4,o=15&C,i=this.palette[a];if(this.data[l]=i.blue,this.data[l+1]=i.green,this.data[l+2]=i.red,this.data[l+3]=255,2*n+1>=this.width)break;i=this.palette[o],this.data[l+4]=i.blue,this.data[l+4+1]=i.green,this.data[l+4+2]=i.red,this.data[l+4+3]=255}0!==e&&(this.pos+=4-e)}},aa.prototype.bit8=function(){for(var g=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,I=0;I<this.width;I++){var n=this.datav.getUint8(this.pos++,!0),C=t*this.width*4+4*I;if(n<this.palette.length){var l=this.palette[n];this.data[C]=l.red,this.data[C+1]=l.green,this.data[C+2]=l.blue,this.data[C+3]=255}else this.data[C]=255,this.data[C+1]=255,this.data[C+2]=255,this.data[C+3]=255}0!==g&&(this.pos+=4-g)}},aa.prototype.bit15=function(){for(var g=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var I=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var C=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(C&e)/e*255|0,a=(C>>5&e)/e*255|0,o=(C>>10&e)/e*255|0,i=C>>15?255:0,r=I*this.width*4+4*n;this.data[r]=o,this.data[r+1]=a,this.data[r+2]=l,this.data[r+3]=i}this.pos+=g}},aa.prototype.bit16=function(){for(var g=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),I=this.height-1;I>=0;I--){for(var n=this.bottom_up?I:this.height-1-I,C=0;C<this.width;C++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(l&e)/e*255|0,o=(l>>5&t)/t*255|0,i=(l>>11)/e*255|0,r=n*this.width*4+4*C;this.data[r]=i,this.data[r+1]=o,this.data[r+2]=a,this.data[r+3]=255}this.pos+=g}},aa.prototype.bit24=function(){for(var g=this.height-1;g>=0;g--){for(var e=this.bottom_up?g:this.height-1-g,t=0;t<this.width;t++){var I=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),C=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*t;this.data[l]=C,this.data[l+1]=n,this.data[l+2]=I,this.data[l+3]=255}this.pos+=this.width%4}},aa.prototype.bit32=function(){for(var g=this.height-1;g>=0;g--)for(var e=this.bottom_up?g:this.height-1-g,t=0;t<this.width;t++){var I=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),C=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*t;this.data[a]=C,this.data[a+1]=n,this.data[a+2]=I,this.data[a+3]=l}},aa.prototype.getData=function(){return this.data},function(g){g.processBMP=function(e,t,I,n){var C=new aa(e,!1),l=C.width,a=C.height,o={data:C.getData(),width:l,height:a},i=new la(100).encode(o,100);return g.processJPEG.call(this,i,t,I,n)}}(jC.API),oa.prototype.getData=function(){return this.data},function(g){g.processWEBP=function(e,t,I,n){var C=new oa(e),l=C.width,a=C.height,o={data:C.getData(),width:l,height:a},i=new la(100).encode(o,100);return g.processJPEG.call(this,i,t,I,n)}}(jC.API),jC.API.processRGBA=function(g,e,t){for(var I=g.data,n=I.length,C=new Uint8Array(n/4*3),l=new Uint8Array(n/4),a=0,o=0,i=0;i<n;i+=4){var r=I[i],c=I[i+1],s=I[i+2],A=I[i+3];C[a++]=r,C[a++]=c,C[a++]=s,l[o++]=A}var d=this.__addimage__.arrayBufferToBinaryString(C);return{alpha:this.__addimage__.arrayBufferToBinaryString(l),data:d,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:g.width,height:g.height}},jC.API.setLanguage=function(g){return void 0===this.internal.languageSettings&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),void 0!=={af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[g]&&(this.internal.languageSettings.languageCode=g,!1===this.internal.languageSettings.isSubscribed&&(this.internal.events.subscribe("putCatalog",(function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")})),this.internal.languageSettings.isSubscribed=!0)),this},_l=jC.API,$l=_l.getCharWidthsArray=function(g,e){var t,I,n=(e=e||{}).font||this.internal.getFont(),C=e.fontSize||this.internal.getFontSize(),l=e.charSpace||this.internal.getCharSpace(),a=e.widths?e.widths:n.metadata.Unicode.widths,o=a.fof?a.fof:1,i=e.kerning?e.kerning:n.metadata.Unicode.kerning,r=i.fof?i.fof:1,c=!1!==e.doKerning,s=0,A=g.length,d=0,u=a[0]||o,m=[];for(t=0;t<A;t++)I=g.charCodeAt(t),"function"==typeof n.metadata.widthOfString?m.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(I))+l*(1e3/C)||0)/1e3):(s=c&&"object"===(0,un.A)(i[I])&&!isNaN(parseInt(i[I][d],10))?i[I][d]/r:0,m.push((a[I]||u)/o+s)),d=I;return m},ga=_l.getStringUnitWidth=function(g,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),I=e.font||this.internal.getFont(),n=e.charSpace||this.internal.getCharSpace();return _l.processArabic&&(g=_l.processArabic(g)),"function"==typeof I.metadata.widthOfString?I.metadata.widthOfString(g,t,n)/t:$l.apply(this,arguments).reduce((function(g,e){return g+e}),0)},ea=function(g,e,t,I){for(var n=[],C=0,l=g.length,a=0;C!==l&&a+e[C]<t;)a+=e[C],C++;n.push(g.slice(0,C));var o=C;for(a=0;C!==l;)a+e[C]>I&&(n.push(g.slice(o,C)),a=0,o=C),a+=e[C],C++;return o!==C&&n.push(g.slice(o,C)),n},ta=function(g,e,t){t||(t={});var I,n,C,l,a,o,i,r=[],c=[r],s=t.textIndent||0,A=0,d=0,u=g.split(" "),m=$l.apply(this,[" ",t])[0];if(o=-1===t.lineIndent?u[0].length+2:t.lineIndent||0){var h=Array(o).join(" "),b=[];u.map((function(g){(g=g.split(/\s*\n/)).length>1?b=b.concat(g.map((function(g,e){return(e&&g.length?"\n":"")+g}))):b.push(g[0])})),u=b,o=ga.apply(this,[h,t])}for(C=0,l=u.length;C<l;C++){var Z=0;if(I=u[C],o&&"\n"==I[0]&&(I=I.substr(1),Z=1),s+A+(d=(n=$l.apply(this,[I,t])).reduce((function(g,e){return g+e}),0))>e||Z){if(d>e){for(a=ea.apply(this,[I,n,e-(s+A),e]),r.push(a.shift()),r=[a.pop()];a.length;)c.push([a.shift()]);d=n.slice(I.length-(r[0]?r[0].length:0)).reduce((function(g,e){return g+e}),0)}else r=[I];c.push(r),s=d+o,A=m}else r.push(I),s+=A+d,A=m}return i=o?function(g,e){return(e?h:"")+g.join(" ")}:function(g){return g.join(" ")},c.map(i)},_l.splitTextToSize=function(g,e,t){var I,n=(t=t||{}).fontSize||this.internal.getFontSize(),C=function(g){if(g.widths&&g.kerning)return{widths:g.widths,kerning:g.kerning};var e=this.internal.getFont(g.fontName,g.fontStyle);return e.metadata.Unicode?{widths:e.metadata.Unicode.widths||{0:1},kerning:e.metadata.Unicode.kerning||{}}:{font:e.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,t);I=Array.isArray(g)?g:String(g).split(/\r?\n/);var l=1*this.internal.scaleFactor*e/n;C.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/n:0,C.lineIndent=t.lineIndent;var a,o,i=[];for(a=0,o=I.length;a<o;a++)i=i.concat(ta.apply(this,[I[a],l,C]));return i},function(g){g.__fontmetrics__=g.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",t={},I={},n=0;n<16;n++)t[e[n]]="0123456789abcdef"[n],I["0123456789abcdef"[n]]=e[n];var C=function(g){return"0x"+parseInt(g,10).toString(16)},l=g.__fontmetrics__.compress=function(g){var e,t,n,a,o=["{"];for(var i in g){if(e=g[i],isNaN(parseInt(i,10))?t="'"+i+"'":(i=parseInt(i,10),t=(t=C(i).slice(2)).slice(0,-1)+I[t.slice(-1)]),"number"==typeof e)e<0?(n=C(e).slice(3),a="-"):(n=C(e).slice(2),a=""),n=a+n.slice(0,-1)+I[n.slice(-1)];else{if("object"!==(0,un.A)(e))throw new Error("Don't know what to do with value type "+(0,un.A)(e)+".");n=l(e)}o.push(t+n)}return o.push("}"),o.join("")},a=g.__fontmetrics__.uncompress=function(g){if("string"!=typeof g)throw new Error("Invalid argument passed to uncompress.");for(var e,I,n,C,l={},a=1,o=l,i=[],r="",c="",s=g.length-1,A=1;A<s;A+=1)"'"==(C=g[A])?e?(n=e.join(""),e=void 0):e=[]:e?e.push(C):"{"==C?(i.push([o,n]),o={},n=void 0):"}"==C?((I=i.pop())[0][I[1]]=o,n=void 0,o=I[0]):"-"==C?a=-1:void 0===n?t.hasOwnProperty(C)?(r+=t[C],n=parseInt(r,16)*a,a=1,r=""):r+=C:t.hasOwnProperty(C)?(c+=t[C],o[n]=parseInt(c,16)*a,a=1,n=void 0,c=""):c+=C;return l},o={codePages:["WinAnsiEncoding"],WinAnsiEncoding:a("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},i={Unicode:{Courier:o,"Courier-Bold":o,"Courier-BoldOblique":o,"Courier-Oblique":o,Helvetica:o,"Helvetica-Bold":o,"Helvetica-BoldOblique":o,"Helvetica-Oblique":o,"Times-Roman":o,"Times-Bold":o,"Times-BoldItalic":o,"Times-Italic":o}},r={Unicode:{"Courier-Oblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":a("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":a("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:a("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:a("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":a("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":a("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};g.events.push(["addFont",function(g){var e=g.font,t=r.Unicode[e.postScriptName];t&&(e.metadata.Unicode={},e.metadata.Unicode.widths=t.widths,e.metadata.Unicode.kerning=t.kerning);var I=i.Unicode[e.postScriptName];I&&(e.metadata.Unicode.encoding=I,e.encoding=I.codePages[0])}])}(jC.API),function(g){var e=function(g){for(var e=g.length,t=new Uint8Array(e),I=0;I<e;I++)t[I]=g.charCodeAt(I);return t};g.API.events.push(["addFont",function(t){var I=void 0,n=t.font,C=t.instance;if(!n.isStandardFont){if(void 0===C)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if("string"!=typeof(I=!1===C.existsFileInVFS(n.postScriptName)?C.loadFile(n.postScriptName):C.getFileFromVFS(n.postScriptName)))throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");!function(t,I){I=/^\x00\x01\x00\x00/.test(I)?e(I):e(bC(I)),t.metadata=g.API.TTFFont.open(I),t.metadata.Unicode=t.metadata.Unicode||{encoding:{},kerning:{},widths:[]},t.metadata.glyIdsUsed=[0]}(n,I)}}])}(jC),function(){function g(){return(sC.canvg?Promise.resolve(sC.canvg):t.e(85).then(t.bind(t,85))).catch((function(g){return Promise.reject(new Error("Could not load canvg: "+g))})).then((function(g){return g.default?g.default:g}))}jC.API.addSvgAsImage=function(e,t,I,n,C,l,a,o){if(isNaN(t)||isNaN(I))throw dC.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(C))throw dC.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var i=document.createElement("canvas");i.width=n,i.height=C;var r=i.getContext("2d");r.fillStyle="#fff",r.fillRect(0,0,i.width,i.height);var c={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},s=this;return g().then((function(g){return g.fromString(r,e,c)}),(function(){return Promise.reject(new Error("Could not load canvg."))})).then((function(g){return g.render(c)})).then((function(){s.addImage(i.toDataURL("image/jpeg",1),t,I,n,C,a,o)}))}}(),jC.API.putTotalPages=function(g){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(g,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(g,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var I=1;I<=this.internal.getNumberOfPages();I++)for(var n=0;n<this.internal.pages[I].length;n++)this.internal.pages[I][n]=this.internal.pages[I][n].replace(e,t);return this},jC.API.viewerPreferences=function(g,e){var t;g=g||{},e=e||!1;var I,n,C,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},a=Object.keys(l),o=[],i=0,r=0,c=0;function s(g,e){var t,I=!1;for(t=0;t<g.length;t+=1)g[t]===e&&(I=!0);return I}if(void 0===this.internal.viewerpreferences&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,"reset"===g||!0===e){var A=a.length;for(c=0;c<A;c+=1)t[a[c]].value=t[a[c]].defaultValue,t[a[c]].explicitSet=!1}if("object"===(0,un.A)(g))for(n in g)if(C=g[n],s(a,n)&&void 0!==C){if("boolean"===t[n].type&&"boolean"==typeof C)t[n].value=C;else if("name"===t[n].type&&s(t[n].valueSet,C))t[n].value=C;else if("integer"===t[n].type&&Number.isInteger(C))t[n].value=C;else if("array"===t[n].type){for(i=0;i<C.length;i+=1)if(I=!0,1===C[i].length&&"number"==typeof C[i][0])o.push(String(C[i]-1));else if(C[i].length>1){for(r=0;r<C[i].length;r+=1)"number"!=typeof C[i][r]&&(I=!1);!0===I&&o.push([C[i][0]-1,C[i][1]-1].join(" "))}t[n].value="["+o.join(" ")+"]"}else t[n].value=t[n].defaultValue;t[n].explicitSet=!0}return!1===this.internal.viewerpreferences.isSubscribed&&(this.internal.events.subscribe("putCatalog",(function(){var g,e=[];for(g in t)!0===t[g].explicitSet&&("name"===t[g].type?e.push("/"+g+" /"+t[g].value):e.push("/"+g+" "+t[g].value));0!==e.length&&this.internal.write("/ViewerPreferences\n<<\n"+e.join("\n")+"\n>>")})),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},function(g){var e=function(){var g='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',e=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),t=unescape(encodeURIComponent(g)),I=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),n=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),C=unescape(encodeURIComponent("</x:xmpmeta>")),l=t.length+I.length+n.length+e.length+C.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+l+" >>"),this.internal.write("stream"),this.internal.write(e+t+I+n+C),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};g.addMetadata=function(g,I){return void 0===this.internal.__metadata__&&(this.internal.__metadata__={metadata:g,namespaceuri:I||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}}(jC.API),function(g){var e=g.API,t=e.pdfEscape16=function(g,e){for(var t,I=e.metadata.Unicode.widths,n=["","0","00","000","0000"],C=[""],l=0,a=g.length;l<a;++l){if(t=e.metadata.characterToGlyph(g.charCodeAt(l)),e.metadata.glyIdsUsed.push(t),e.metadata.toUnicode[t]=g.charCodeAt(l),-1==I.indexOf(t)&&(I.push(t),I.push([parseInt(e.metadata.widthOfGlyph(t),10)])),"0"==t)return C.join("");t=t.toString(16),C.push(n[4-t.length],t)}return C.join("")},I=function(g){var e,t,I,n,C,l,a;for(C="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange",I=[],l=0,a=(t=Object.keys(g).sort((function(g,e){return g-e}))).length;l<a;l++)e=t[l],I.length>=100&&(C+="\n"+I.length+" beginbfchar\n"+I.join("\n")+"\nendbfchar",I=[]),void 0!==g[e]&&null!==g[e]&&"function"==typeof g[e].toString&&(n=("0000"+g[e].toString(16)).slice(-4),e=("0000"+(+e).toString(16)).slice(-4),I.push("<"+e+"><"+n+">"));return I.length&&(C+="\n"+I.length+" beginbfchar\n"+I.join("\n")+"\nendbfchar\n"),C+"endcmap\nCMapName currentdict /CMap defineresource pop\nend\nend"};e.events.push(["putFont",function(e){!function(e){var t=e.font,n=e.out,C=e.newObject,l=e.putStream;if(t.metadata instanceof g.API.TTFFont&&"Identity-H"===t.encoding){for(var a=t.metadata.Unicode.widths,o=t.metadata.subset.encode(t.metadata.glyIdsUsed,1),i="",r=0;r<o.length;r++)i+=String.fromCharCode(o[r]);var c=C();l({data:i,addLength1:!0,objectId:c}),n("endobj");var s=C();l({data:I(t.metadata.toUnicode),addLength1:!0,objectId:s}),n("endobj");var A=C();n("<<"),n("/Type /FontDescriptor"),n("/FontName /"+xC(t.fontName)),n("/FontFile2 "+c+" 0 R"),n("/FontBBox "+g.API.PDFObject.convert(t.metadata.bbox)),n("/Flags "+t.metadata.flags),n("/StemV "+t.metadata.stemV),n("/ItalicAngle "+t.metadata.italicAngle),n("/Ascent "+t.metadata.ascender),n("/Descent "+t.metadata.decender),n("/CapHeight "+t.metadata.capHeight),n(">>"),n("endobj");var d=C();n("<<"),n("/Type /Font"),n("/BaseFont /"+xC(t.fontName)),n("/FontDescriptor "+A+" 0 R"),n("/W "+g.API.PDFObject.convert(a)),n("/CIDToGIDMap /Identity"),n("/DW 1000"),n("/Subtype /CIDFontType2"),n("/CIDSystemInfo"),n("<<"),n("/Supplement 0"),n("/Registry (Adobe)"),n("/Ordering ("+t.encoding+")"),n(">>"),n(">>"),n("endobj"),t.objectNumber=C(),n("<<"),n("/Type /Font"),n("/Subtype /Type0"),n("/ToUnicode "+s+" 0 R"),n("/BaseFont /"+xC(t.fontName)),n("/Encoding /"+t.encoding),n("/DescendantFonts ["+d+" 0 R]"),n(">>"),n("endobj"),t.isAlreadyPutted=!0}}(e)}]),e.events.push(["putFont",function(e){!function(e){var t=e.font,n=e.out,C=e.newObject,l=e.putStream;if(t.metadata instanceof g.API.TTFFont&&"WinAnsiEncoding"===t.encoding){for(var a=t.metadata.rawData,o="",i=0;i<a.length;i++)o+=String.fromCharCode(a[i]);var r=C();l({data:o,addLength1:!0,objectId:r}),n("endobj");var c=C();l({data:I(t.metadata.toUnicode),addLength1:!0,objectId:c}),n("endobj");var s=C();n("<<"),n("/Descent "+t.metadata.decender),n("/CapHeight "+t.metadata.capHeight),n("/StemV "+t.metadata.stemV),n("/Type /FontDescriptor"),n("/FontFile2 "+r+" 0 R"),n("/Flags 96"),n("/FontBBox "+g.API.PDFObject.convert(t.metadata.bbox)),n("/FontName /"+xC(t.fontName)),n("/ItalicAngle "+t.metadata.italicAngle),n("/Ascent "+t.metadata.ascender),n(">>"),n("endobj"),t.objectNumber=C();for(var A=0;A<t.metadata.hmtx.widths.length;A++)t.metadata.hmtx.widths[A]=parseInt(t.metadata.hmtx.widths[A]*(1e3/t.metadata.head.unitsPerEm));n("<</Subtype/TrueType/Type/Font/ToUnicode "+c+" 0 R/BaseFont/"+xC(t.fontName)+"/FontDescriptor "+s+" 0 R/Encoding/"+t.encoding+" /FirstChar 29 /LastChar 255 /Widths "+g.API.PDFObject.convert(t.metadata.hmtx.widths)+">>"),n("endobj"),t.isAlreadyPutted=!0}}(e)}]);var n=function(g){var e,I=g.text||"",n=g.x,C=g.y,l=g.options||{},a=g.mutex||{},o=a.pdfEscape,i=a.activeFontKey,r=a.fonts,c=i,s="",A=0,d="",u=r[c].encoding;if("Identity-H"!==r[c].encoding)return{text:I,x:n,y:C,options:l,mutex:a};for(d=I,c=i,Array.isArray(I)&&(d=I[0]),A=0;A<d.length;A+=1)r[c].metadata.hasOwnProperty("cmap")&&(e=r[c].metadata.cmap.unicode.codeMap[d[A].charCodeAt(0)]),e||d[A].charCodeAt(0)<256&&r[c].metadata.hasOwnProperty("Unicode")?s+=d[A]:s+="";var m="";return parseInt(c.slice(1))<14||"WinAnsiEncoding"===u?m=o(s,c).split("").map((function(g){return g.charCodeAt(0).toString(16)})).join(""):"Identity-H"===u&&(m=t(s,r[c])),a.isHex=!0,{text:m,x:n,y:C,options:l,mutex:a}};e.events.push(["postProcessText",function(g){var e=g.text||"",t=[],I={text:e,x:g.x,y:g.y,options:g.options,mutex:g.mutex};if(Array.isArray(e)){var C=0;for(C=0;C<e.length;C+=1)Array.isArray(e[C])&&3===e[C].length?t.push([n(Object.assign({},I,{text:e[C][0]})).text,e[C][1],e[C][2]]):t.push(n(Object.assign({},I,{text:e[C]})).text);g.text=t}else g.text=n(Object.assign({},I,{text:e})).text}])}(jC),function(g){var e=function(){return void 0===this.internal.vFS&&(this.internal.vFS={}),!0};g.existsFileInVFS=function(g){return e.call(this),void 0!==this.internal.vFS[g]},g.addFileToVFS=function(g,t){return e.call(this),this.internal.vFS[g]=t,this},g.getFileFromVFS=function(g){return e.call(this),void 0!==this.internal.vFS[g]?this.internal.vFS[g]:null}}(jC.API),function(g){g.__bidiEngine__=g.prototype.__bidiEngine__=function(g){var t,I,n,C,l,a,o,i=e,r=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],c=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],s={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},A={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},d=["(",")","(","<",">","<","[","]","[","{","}","{","\xab","\xbb","\xab","\u2039","\u203a","\u2039","\u2045","\u2046","\u2045","\u207d","\u207e","\u207d","\u208d","\u208e","\u208d","\u2264","\u2265","\u2264","\u2329","\u232a","\u2329","\ufe59","\ufe5a","\ufe59","\ufe5b","\ufe5c","\ufe5b","\ufe5d","\ufe5e","\ufe5d","\ufe64","\ufe65","\ufe64"],u=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),m=!1,h=0;this.__bidiEngine__={};var b=function(g){var e=g.charCodeAt(),t=e>>8,I=A[t];return void 0!==I?i[256*I+(255&e)]:252===t||253===t?"AL":u.test(t)?"L":8===t?"R":"N"},Z=function(g){for(var e,t=0;t<g.length;t++){if("L"===(e=b(g.charAt(t))))return!1;if("R"===e)return!0}return!1},p=function(g,e,l,a){var o,i,r,c,s=e[a];switch(s){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":m=!1;break;case"N":case"AN":break;case"EN":m&&(s="AN");break;case"AL":m=!0,s="R";break;case"WS":case"BN":s="N";break;case"CS":a<1||a+1>=e.length||"EN"!==(o=l[a-1])&&"AN"!==o||"EN"!==(i=e[a+1])&&"AN"!==i?s="N":m&&(i="AN"),s=i===o?i:"N";break;case"ES":s="EN"===(o=a>0?l[a-1]:"B")&&a+1<e.length&&"EN"===e[a+1]?"EN":"N";break;case"ET":if(a>0&&"EN"===l[a-1]){s="EN";break}if(m){s="N";break}for(r=a+1,c=e.length;r<c&&"ET"===e[r];)r++;s=r<c&&"EN"===e[r]?"EN":"N";break;case"NSM":if(n&&!C){for(c=e.length,r=a+1;r<c&&"NSM"===e[r];)r++;if(r<c){var A=g[a],d=A>=1425&&A<=2303||64286===A;if(o=e[r],d&&("R"===o||"AL"===o)){s="R";break}}}s=a<1||"B"===(o=e[a-1])?"N":l[a-1];break;case"B":m=!1,t=!0,s=h;break;case"S":I=!0,s="N"}return s},G=function(g,e,t){var I=g.split("");return t&&y(I,t,{hiLevel:h}),I.reverse(),e&&e.reverse(),I.join("")},y=function(g,e,n){var C,l,a,o,i,A=-1,d=g.length,u=0,Z=[],G=h?c:r,y=[];for(m=!1,t=!1,I=!1,l=0;l<d;l++)y[l]=b(g[l]);for(a=0;a<d;a++){if(i=u,Z[a]=p(g,y,Z,a),C=240&(u=G[i][s[Z[a]]]),u&=15,e[a]=o=G[u][5],C>0)if(16===C){for(l=A;l<a;l++)e[l]=1;A=-1}else A=-1;if(G[u][6])-1===A&&(A=a);else if(A>-1){for(l=A;l<a;l++)e[l]=o;A=-1}"B"===y[a]&&(e[a]=0),n.hiLevel|=o}I&&function(g,e,t){for(var I=0;I<t;I++)if("S"===g[I]){e[I]=h;for(var n=I-1;n>=0&&"WS"===g[n];n--)e[n]=h}}(y,e,d)},B=function(g,e,I,n,C){if(!(C.hiLevel<g)){if(1===g&&1===h&&!t)return e.reverse(),void(I&&I.reverse());for(var l,a,o,i,r=e.length,c=0;c<r;){if(n[c]>=g){for(o=c+1;o<r&&n[o]>=g;)o++;for(i=c,a=o-1;i<a;i++,a--)l=e[i],e[i]=e[a],e[a]=l,I&&(l=I[i],I[i]=I[a],I[a]=l);c=o}c++}}},S=function(g,e,t){var I=g.split(""),n={hiLevel:h};return t||(t=[]),y(I,t,n),function(g,e,t){if(0!==t.hiLevel&&o)for(var I,n=0;n<g.length;n++)1===e[n]&&(I=d.indexOf(g[n]))>=0&&(g[n]=d[I+1])}(I,t,n),B(2,I,e,t,n),B(1,I,e,t,n),I.join("")};return this.__bidiEngine__.doBidiReorder=function(g,e,t){if(function(g,e){if(e)for(var t=0;t<g.length;t++)e[t]=t;void 0===C&&(C=Z(g)),void 0===a&&(a=Z(g))}(g,e),n||!l||a)if(n&&l&&C^a)h=C?1:0,g=G(g,e,t);else if(!n&&l&&a)h=C?1:0,g=S(g,e,t),g=G(g,e);else if(!n||C||l||a){if(n&&!l&&C^a)g=G(g,e),C?(h=0,g=S(g,e,t)):(h=1,g=S(g,e,t),g=G(g,e));else if(n&&C&&!l&&a)h=1,g=S(g,e,t),g=G(g,e);else if(!n&&!l&&C^a){var I=o;C?(h=1,g=S(g,e,t),h=0,o=!1,g=S(g,e,t),o=I):(h=0,g=S(g,e,t),g=G(g,e),h=1,o=!1,g=S(g,e,t),o=I,g=G(g,e))}}else h=0,g=S(g,e,t);else h=C?1:0,g=S(g,e,t);return g},this.__bidiEngine__.setOptions=function(g){g&&(n=g.isInputVisual,l=g.isOutputVisual,C=g.isInputRtl,a=g.isOutputRtl,o=g.isSymmetricSwapping)},this.__bidiEngine__.setOptions(g),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new g.__bidiEngine__({isInputVisual:!0});g.API.events.push(["postProcessText",function(g){var e=g.text;g.x,g.y;var I=g.options||{};g.mutex,I.lang;var n=[];if(I.isInputVisual="boolean"!=typeof I.isInputVisual||I.isInputVisual,t.setOptions(I),"[object Array]"===Object.prototype.toString.call(e)){var C=0;for(n=[],C=0;C<e.length;C+=1)"[object Array]"===Object.prototype.toString.call(e[C])?n.push([t.doBidiReorder(e[C][0]),e[C][1],e[C][2]]):n.push([t.doBidiReorder(e[C])]);g.text=n}else g.text=t.doBidiReorder(e);t.setOptions({isInputVisual:!0})}])}(jC),jC.API.TTFFont=function(){function g(g){var e;if(this.rawData=g,e=this.contents=new ra(g),this.contents.pos=4,"ttcf"===e.readString(4))throw new Error("TTCF not supported.");e.pos=0,this.parse(),this.subset=new Ra(this),this.registerTTF()}return g.open=function(e){return new g(e)},g.prototype.parse=function(){return this.directory=new ca(this.contents),this.head=new da(this),this.name=new Ga(this),this.cmap=new ma(this),this.toUnicode={},this.hhea=new ha(this),this.maxp=new ya(this),this.hmtx=new Ba(this),this.post=new Za(this),this.os2=new ba(this),this.loca=new va(this),this.glyf=new fa(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},g.prototype.registerTTF=function(){var g,e,t,I,n;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var e,t,I,n;for(n=[],e=0,t=(I=this.bbox).length;e<t;e++)g=I[e],n.push(Math.round(g*this.scaleFactor));return n}.call(this),this.stemV=0,this.post.exists?(t=255&(I=this.post.italic_angle),0!=(32768&(e=I>>16))&&(e=-(1+(65535^e))),this.italicAngle=+(e+"."+t)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=1===(n=this.familyClass)||2===n||3===n||4===n||5===n||7===n,this.isScript=10===this.familyClass,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),0!==this.italicAngle&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},g.prototype.characterToGlyph=function(g){var e;return(null!=(e=this.cmap.unicode)?e.codeMap[g]:void 0)||0},g.prototype.widthOfGlyph=function(g){var e;return e=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(g).advance*e},g.prototype.widthOfString=function(g,e,t){var I,n,C,l;for(C=0,n=0,l=(g=""+g).length;0<=l?n<l:n>l;n=0<=l?++n:--n)I=g.charCodeAt(n),C+=this.widthOfGlyph(this.characterToGlyph(I))+t*(1e3/e)||0;return C*(e/1e3)},g.prototype.lineHeight=function(g,e){var t;return null==e&&(e=!1),t=e?this.lineGap:0,(this.ascender+t-this.decender)/1e3*g},g}();var ia,ra=function(){function g(g){this.data=null!=g?g:[],this.pos=0,this.length=this.data.length}return g.prototype.readByte=function(){return this.data[this.pos++]},g.prototype.writeByte=function(g){return this.data[this.pos++]=g},g.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},g.prototype.writeUInt32=function(g){return this.writeByte(g>>>24&255),this.writeByte(g>>16&255),this.writeByte(g>>8&255),this.writeByte(255&g)},g.prototype.readInt32=function(){var g;return(g=this.readUInt32())>=2147483648?g-4294967296:g},g.prototype.writeInt32=function(g){return g<0&&(g+=4294967296),this.writeUInt32(g)},g.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},g.prototype.writeUInt16=function(g){return this.writeByte(g>>8&255),this.writeByte(255&g)},g.prototype.readInt16=function(){var g;return(g=this.readUInt16())>=32768?g-65536:g},g.prototype.writeInt16=function(g){return g<0&&(g+=65536),this.writeUInt16(g)},g.prototype.readString=function(g){var e,t;for(t=[],e=0;0<=g?e<g:e>g;e=0<=g?++e:--e)t[e]=String.fromCharCode(this.readByte());return t.join("")},g.prototype.writeString=function(g){var e,t,I;for(I=[],e=0,t=g.length;0<=t?e<t:e>t;e=0<=t?++e:--e)I.push(this.writeByte(g.charCodeAt(e)));return I},g.prototype.readShort=function(){return this.readInt16()},g.prototype.writeShort=function(g){return this.writeInt16(g)},g.prototype.readLongLong=function(){var g,e,t,I,n,C,l,a;return g=this.readByte(),e=this.readByte(),t=this.readByte(),I=this.readByte(),n=this.readByte(),C=this.readByte(),l=this.readByte(),a=this.readByte(),128&g?-1*(72057594037927940*(255^g)+281474976710656*(255^e)+1099511627776*(255^t)+4294967296*(255^I)+16777216*(255^n)+65536*(255^C)+256*(255^l)+(255^a)+1):72057594037927940*g+281474976710656*e+1099511627776*t+4294967296*I+16777216*n+65536*C+256*l+a},g.prototype.writeLongLong=function(g){var e,t;return e=Math.floor(g/4294967296),t=4294967295&g,this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},g.prototype.readInt=function(){return this.readInt32()},g.prototype.writeInt=function(g){return this.writeInt32(g)},g.prototype.read=function(g){var e,t;for(e=[],t=0;0<=g?t<g:t>g;t=0<=g?++t:--t)e.push(this.readByte());return e},g.prototype.write=function(g){var e,t,I,n;for(n=[],t=0,I=g.length;t<I;t++)e=g[t],n.push(this.writeByte(e));return n},g}(),ca=function(){var g;function e(g){var e,t,I;for(this.scalarType=g.readInt(),this.tableCount=g.readShort(),this.searchRange=g.readShort(),this.entrySelector=g.readShort(),this.rangeShift=g.readShort(),this.tables={},t=0,I=this.tableCount;0<=I?t<I:t>I;t=0<=I?++t:--t)e={tag:g.readString(4),checksum:g.readInt(),offset:g.readInt(),length:g.readInt()},this.tables[e.tag]=e}return e.prototype.encode=function(e){var t,I,n,C,l,a,o,i,r,c,s,A,d;for(d in s=Object.keys(e).length,a=Math.log(2),r=16*Math.floor(Math.log(s)/a),C=Math.floor(r/a),i=16*s-r,(I=new ra).writeInt(this.scalarType),I.writeShort(s),I.writeShort(r),I.writeShort(C),I.writeShort(i),n=16*s,o=I.pos+n,l=null,A=[],e)for(c=e[d],I.writeString(d),I.writeInt(g(c)),I.writeInt(o),I.writeInt(c.length),A=A.concat(c),"head"===d&&(l=o),o+=c.length;o%4;)A.push(0),o++;return I.write(A),t=2981146554-g(I.data),I.pos=l+8,I.writeUInt32(t),I.data},g=function(g){var e,t,I,n;for(g=Sa.call(g);g.length%4;)g.push(0);for(I=new ra(g),t=0,e=0,n=g.length;e<n;e=e+=4)t+=I.readUInt32();return 4294967295&t},e}(),sa={}.hasOwnProperty,Aa=function(g,e){for(var t in e)sa.call(e,t)&&(g[t]=e[t]);function I(){this.constructor=g}return I.prototype=e.prototype,g.prototype=new I,g.__super__=e.prototype,g};ia=function(){function g(g){var e;this.file=g,e=this.file.directory.tables[this.tag],this.exists=!!e,e&&(this.offset=e.offset,this.length=e.length,this.parse(this.file.contents))}return g.prototype.parse=function(){},g.prototype.encode=function(){},g.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},g}();var da=function(){function g(){return g.__super__.constructor.apply(this,arguments)}return Aa(g,ia),g.prototype.tag="head",g.prototype.parse=function(g){return g.pos=this.offset,this.version=g.readInt(),this.revision=g.readInt(),this.checkSumAdjustment=g.readInt(),this.magicNumber=g.readInt(),this.flags=g.readShort(),this.unitsPerEm=g.readShort(),this.created=g.readLongLong(),this.modified=g.readLongLong(),this.xMin=g.readShort(),this.yMin=g.readShort(),this.xMax=g.readShort(),this.yMax=g.readShort(),this.macStyle=g.readShort(),this.lowestRecPPEM=g.readShort(),this.fontDirectionHint=g.readShort(),this.indexToLocFormat=g.readShort(),this.glyphDataFormat=g.readShort()},g.prototype.encode=function(g){var e;return(e=new ra).writeInt(this.version),e.writeInt(this.revision),e.writeInt(this.checkSumAdjustment),e.writeInt(this.magicNumber),e.writeShort(this.flags),e.writeShort(this.unitsPerEm),e.writeLongLong(this.created),e.writeLongLong(this.modified),e.writeShort(this.xMin),e.writeShort(this.yMin),e.writeShort(this.xMax),e.writeShort(this.yMax),e.writeShort(this.macStyle),e.writeShort(this.lowestRecPPEM),e.writeShort(this.fontDirectionHint),e.writeShort(g),e.writeShort(this.glyphDataFormat),e.data},g}(),ua=function(){function g(g,e){var t,I,n,C,l,a,o,i,r,c,s,A,d,u,m,h,b;switch(this.platformID=g.readUInt16(),this.encodingID=g.readShort(),this.offset=e+g.readInt(),r=g.pos,g.pos=this.offset,this.format=g.readUInt16(),this.length=g.readUInt16(),this.language=g.readUInt16(),this.isUnicode=3===this.platformID&&1===this.encodingID&&4===this.format||0===this.platformID&&4===this.format,this.codeMap={},this.format){case 0:for(a=0;a<256;++a)this.codeMap[a]=g.readByte();break;case 4:for(s=g.readUInt16(),c=s/2,g.pos+=6,n=function(){var e,t;for(t=[],a=e=0;0<=c?e<c:e>c;a=0<=c?++e:--e)t.push(g.readUInt16());return t}(),g.pos+=2,d=function(){var e,t;for(t=[],a=e=0;0<=c?e<c:e>c;a=0<=c?++e:--e)t.push(g.readUInt16());return t}(),o=function(){var e,t;for(t=[],a=e=0;0<=c?e<c:e>c;a=0<=c?++e:--e)t.push(g.readUInt16());return t}(),i=function(){var e,t;for(t=[],a=e=0;0<=c?e<c:e>c;a=0<=c?++e:--e)t.push(g.readUInt16());return t}(),I=(this.length-g.pos+this.offset)/2,l=function(){var e,t;for(t=[],a=e=0;0<=I?e<I:e>I;a=0<=I?++e:--e)t.push(g.readUInt16());return t}(),a=m=0,b=n.length;m<b;a=++m)for(u=n[a],t=h=A=d[a];A<=u?h<=u:h>=u;t=A<=u?++h:--h)0===i[a]?C=t+o[a]:0!==(C=l[i[a]/2+(t-A)-(c-a)]||0)&&(C+=o[a]),this.codeMap[t]=65535&C}g.pos=r}return g.encode=function(g,e){var t,I,n,C,l,a,o,i,r,c,s,A,d,u,m,h,b,Z,p,G,y,B,S,f,W,V,v,R,X,k,J,Y,w,N,H,F,K,x,L,z,E,M,U,j,Q,D;switch(R=new ra,C=Object.keys(g).sort((function(g,e){return g-e})),e){case"macroman":for(d=0,u=function(){var g=[];for(A=0;A<256;++A)g.push(0);return g}(),h={0:0},n={},X=0,w=C.length;X<w;X++)null==h[U=g[I=C[X]]]&&(h[U]=++d),n[I]={old:g[I],new:h[g[I]]},u[I]=h[g[I]];return R.writeUInt16(1),R.writeUInt16(0),R.writeUInt32(12),R.writeUInt16(0),R.writeUInt16(262),R.writeUInt16(0),R.write(u),{charMap:n,subtable:R.data,maxGlyphID:d+1};case"unicode":for(V=[],r=[],b=0,h={},t={},m=o=null,k=0,N=C.length;k<N;k++)null==h[p=g[I=C[k]]]&&(h[p]=++b),t[I]={old:p,new:h[p]},l=h[p]-I,null!=m&&l===o||(m&&r.push(m),V.push(I),o=l),m=I;for(m&&r.push(m),r.push(65535),V.push(65535),f=2*(S=V.length),B=2*Math.pow(Math.log(S)/Math.LN2,2),c=Math.log(B/2)/Math.LN2,y=2*S-B,a=[],G=[],s=[],A=J=0,H=V.length;J<H;A=++J){if(W=V[A],i=r[A],65535===W){a.push(0),G.push(0);break}if(W-(v=t[W].new)>=32768)for(a.push(0),G.push(2*(s.length+S-A)),I=Y=W;W<=i?Y<=i:Y>=i;I=W<=i?++Y:--Y)s.push(t[I].new);else a.push(v-W),G.push(0)}for(R.writeUInt16(3),R.writeUInt16(1),R.writeUInt32(12),R.writeUInt16(4),R.writeUInt16(16+8*S+2*s.length),R.writeUInt16(0),R.writeUInt16(f),R.writeUInt16(B),R.writeUInt16(c),R.writeUInt16(y),E=0,F=r.length;E<F;E++)I=r[E],R.writeUInt16(I);for(R.writeUInt16(0),M=0,K=V.length;M<K;M++)I=V[M],R.writeUInt16(I);for(j=0,x=a.length;j<x;j++)l=a[j],R.writeUInt16(l);for(Q=0,L=G.length;Q<L;Q++)Z=G[Q],R.writeUInt16(Z);for(D=0,z=s.length;D<z;D++)d=s[D],R.writeUInt16(d);return{charMap:t,subtable:R.data,maxGlyphID:b+1}}},g}(),ma=function(){function g(){return g.__super__.constructor.apply(this,arguments)}return Aa(g,ia),g.prototype.tag="cmap",g.prototype.parse=function(g){var e,t,I;for(g.pos=this.offset,this.version=g.readUInt16(),I=g.readUInt16(),this.tables=[],this.unicode=null,t=0;0<=I?t<I:t>I;t=0<=I?++t:--t)e=new ua(g,this.offset),this.tables.push(e),e.isUnicode&&null==this.unicode&&(this.unicode=e);return!0},g.encode=function(g,e){var t,I;return null==e&&(e="macroman"),t=ua.encode(g,e),(I=new ra).writeUInt16(0),I.writeUInt16(1),t.table=I.data.concat(t.subtable),t},g}(),ha=function(){function g(){return g.__super__.constructor.apply(this,arguments)}return Aa(g,ia),g.prototype.tag="hhea",g.prototype.parse=function(g){return g.pos=this.offset,this.version=g.readInt(),this.ascender=g.readShort(),this.decender=g.readShort(),this.lineGap=g.readShort(),this.advanceWidthMax=g.readShort(),this.minLeftSideBearing=g.readShort(),this.minRightSideBearing=g.readShort(),this.xMaxExtent=g.readShort(),this.caretSlopeRise=g.readShort(),this.caretSlopeRun=g.readShort(),this.caretOffset=g.readShort(),g.pos+=8,this.metricDataFormat=g.readShort(),this.numberOfMetrics=g.readUInt16()},g}(),ba=function(){function g(){return g.__super__.constructor.apply(this,arguments)}return Aa(g,ia),g.prototype.tag="OS/2",g.prototype.parse=function(g){if(g.pos=this.offset,this.version=g.readUInt16(),this.averageCharWidth=g.readShort(),this.weightClass=g.readUInt16(),this.widthClass=g.readUInt16(),this.type=g.readShort(),this.ySubscriptXSize=g.readShort(),this.ySubscriptYSize=g.readShort(),this.ySubscriptXOffset=g.readShort(),this.ySubscriptYOffset=g.readShort(),this.ySuperscriptXSize=g.readShort(),this.ySuperscriptYSize=g.readShort(),this.ySuperscriptXOffset=g.readShort(),this.ySuperscriptYOffset=g.readShort(),this.yStrikeoutSize=g.readShort(),this.yStrikeoutPosition=g.readShort(),this.familyClass=g.readShort(),this.panose=function(){var e,t;for(t=[],e=0;e<10;++e)t.push(g.readByte());return t}(),this.charRange=function(){var e,t;for(t=[],e=0;e<4;++e)t.push(g.readInt());return t}(),this.vendorID=g.readString(4),this.selection=g.readShort(),this.firstCharIndex=g.readShort(),this.lastCharIndex=g.readShort(),this.version>0&&(this.ascent=g.readShort(),this.descent=g.readShort(),this.lineGap=g.readShort(),this.winAscent=g.readShort(),this.winDescent=g.readShort(),this.codePageRange=function(){var e,t;for(t=[],e=0;e<2;e=++e)t.push(g.readInt());return t}(),this.version>1))return this.xHeight=g.readShort(),this.capHeight=g.readShort(),this.defaultChar=g.readShort(),this.breakChar=g.readShort(),this.maxContext=g.readShort()},g}(),Za=function(){function g(){return g.__super__.constructor.apply(this,arguments)}return Aa(g,ia),g.prototype.tag="post",g.prototype.parse=function(g){var e,t,I;switch(g.pos=this.offset,this.format=g.readInt(),this.italicAngle=g.readInt(),this.underlinePosition=g.readShort(),this.underlineThickness=g.readShort(),this.isFixedPitch=g.readInt(),this.minMemType42=g.readInt(),this.maxMemType42=g.readInt(),this.minMemType1=g.readInt(),this.maxMemType1=g.readInt(),this.format){case 65536:case 196608:break;case 131072:var n;for(t=g.readUInt16(),this.glyphNameIndex=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)this.glyphNameIndex.push(g.readUInt16());for(this.names=[],I=[];g.pos<this.offset+this.length;)e=g.readByte(),I.push(this.names.push(g.readString(e)));return I;case 151552:return t=g.readUInt16(),this.offsets=g.read(t);case 262144:return this.map=function(){var e,t,I;for(I=[],n=e=0,t=this.file.maxp.numGlyphs;0<=t?e<t:e>t;n=0<=t?++e:--e)I.push(g.readUInt32());return I}.call(this)}},g}(),pa=function(g,e){this.raw=g,this.length=g.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},Ga=function(){function g(){return g.__super__.constructor.apply(this,arguments)}return Aa(g,ia),g.prototype.tag="name",g.prototype.parse=function(g){var e,t,I,n,C,l,a,o,i,r,c;for(g.pos=this.offset,g.readShort(),e=g.readShort(),l=g.readShort(),t=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)t.push({platformID:g.readShort(),encodingID:g.readShort(),languageID:g.readShort(),nameID:g.readShort(),length:g.readShort(),offset:this.offset+l+g.readShort()});for(a={},n=i=0,r=t.length;i<r;n=++i)I=t[n],g.pos=I.offset,o=g.readString(I.length),C=new pa(o,I),null==a[c=I.nameID]&&(a[c]=[]),a[I.nameID].push(C);this.strings=a,this.copyright=a[0],this.fontFamily=a[1],this.fontSubfamily=a[2],this.uniqueSubfamily=a[3],this.fontName=a[4],this.version=a[5];try{this.postscriptName=a[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch(g){this.postscriptName=a[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=a[7],this.manufacturer=a[8],this.designer=a[9],this.description=a[10],this.vendorUrl=a[11],this.designerUrl=a[12],this.license=a[13],this.licenseUrl=a[14],this.preferredFamily=a[15],this.preferredSubfamily=a[17],this.compatibleFull=a[18],this.sampleText=a[19]},g}(),ya=function(){function g(){return g.__super__.constructor.apply(this,arguments)}return Aa(g,ia),g.prototype.tag="maxp",g.prototype.parse=function(g){return g.pos=this.offset,this.version=g.readInt(),this.numGlyphs=g.readUInt16(),this.maxPoints=g.readUInt16(),this.maxContours=g.readUInt16(),this.maxCompositePoints=g.readUInt16(),this.maxComponentContours=g.readUInt16(),this.maxZones=g.readUInt16(),this.maxTwilightPoints=g.readUInt16(),this.maxStorage=g.readUInt16(),this.maxFunctionDefs=g.readUInt16(),this.maxInstructionDefs=g.readUInt16(),this.maxStackElements=g.readUInt16(),this.maxSizeOfInstructions=g.readUInt16(),this.maxComponentElements=g.readUInt16(),this.maxComponentDepth=g.readUInt16()},g}(),Ba=function(){function g(){return g.__super__.constructor.apply(this,arguments)}return Aa(g,ia),g.prototype.tag="hmtx",g.prototype.parse=function(g){var e,t,I,n,C,l,a;for(g.pos=this.offset,this.metrics=[],e=0,l=this.file.hhea.numberOfMetrics;0<=l?e<l:e>l;e=0<=l?++e:--e)this.metrics.push({advance:g.readUInt16(),lsb:g.readInt16()});for(I=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var t,n;for(n=[],e=t=0;0<=I?t<I:t>I;e=0<=I?++t:--t)n.push(g.readInt16());return n}(),this.widths=function(){var g,e,t,I;for(I=[],g=0,e=(t=this.metrics).length;g<e;g++)n=t[g],I.push(n.advance);return I}.call(this),t=this.widths[this.widths.length-1],a=[],e=C=0;0<=I?C<I:C>I;e=0<=I?++C:--C)a.push(this.widths.push(t));return a},g.prototype.forGlyph=function(g){return g in this.metrics?this.metrics[g]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[g-this.metrics.length]}},g}(),Sa=[].slice,fa=function(){function g(){return g.__super__.constructor.apply(this,arguments)}return Aa(g,ia),g.prototype.tag="glyf",g.prototype.parse=function(){return this.cache={}},g.prototype.glyphFor=function(g){var e,t,I,n,C,l,a,o,i,r;return g in this.cache?this.cache[g]:(n=this.file.loca,e=this.file.contents,t=n.indexOf(g),0===(I=n.lengthOf(g))?this.cache[g]=null:(e.pos=this.offset+t,C=(l=new ra(e.read(I))).readShort(),o=l.readShort(),r=l.readShort(),a=l.readShort(),i=l.readShort(),this.cache[g]=-1===C?new Va(l,o,r,a,i):new Wa(l,C,o,r,a,i),this.cache[g]))},g.prototype.encode=function(g,e,t){var I,n,C,l,a;for(C=[],n=[],l=0,a=e.length;l<a;l++)I=g[e[l]],n.push(C.length),I&&(C=C.concat(I.encode(t)));return n.push(C.length),{table:C,offsets:n}},g}(),Wa=function(){function g(g,e,t,I,n,C){this.raw=g,this.numberOfContours=e,this.xMin=t,this.yMin=I,this.xMax=n,this.yMax=C,this.compound=!1}return g.prototype.encode=function(){return this.raw.data},g}(),Va=function(){function g(g,e,t,I,n){var C,l;for(this.raw=g,this.xMin=e,this.yMin=t,this.xMax=I,this.yMax=n,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],C=this.raw;l=C.readShort(),this.glyphOffsets.push(C.pos),this.glyphIDs.push(C.readUInt16()),32&l;)C.pos+=1&l?4:2,128&l?C.pos+=8:64&l?C.pos+=4:8&l&&(C.pos+=2)}return g.prototype.encode=function(){var g,e,t;for(e=new ra(Sa.call(this.raw.data)),g=0,t=this.glyphIDs.length;g<t;++g)e.pos=this.glyphOffsets[g];return e.data},g}(),va=function(){function g(){return g.__super__.constructor.apply(this,arguments)}return Aa(g,ia),g.prototype.tag="loca",g.prototype.parse=function(g){var e,t;return g.pos=this.offset,e=this.file.head.indexToLocFormat,this.offsets=0===e?function(){var e,I;for(I=[],t=0,e=this.length;t<e;t+=2)I.push(2*g.readUInt16());return I}.call(this):function(){var e,I;for(I=[],t=0,e=this.length;t<e;t+=4)I.push(g.readUInt32());return I}.call(this)},g.prototype.indexOf=function(g){return this.offsets[g]},g.prototype.lengthOf=function(g){return this.offsets[g+1]-this.offsets[g]},g.prototype.encode=function(g,e){for(var t=new Uint32Array(this.offsets.length),I=0,n=0,C=0;C<t.length;++C)if(t[C]=I,n<e.length&&e[n]==C){++n,t[C]=I;var l=this.offsets[C],a=this.offsets[C+1]-l;a>0&&(I+=a)}for(var o=new Array(4*t.length),i=0;i<t.length;++i)o[4*i+3]=255&t[i],o[4*i+2]=(65280&t[i])>>8,o[4*i+1]=(16711680&t[i])>>16,o[4*i]=(4278190080&t[i])>>24;return o},g}(),Ra=function(){function g(g){this.font=g,this.subset={},this.unicodes={},this.next=33}return g.prototype.generateCmap=function(){var g,e,t,I,n;for(e in I=this.font.cmap.tables[0].codeMap,g={},n=this.subset)t=n[e],g[e]=I[t];return g},g.prototype.glyphsFor=function(g){var e,t,I,n,C,l,a;for(I={},C=0,l=g.length;C<l;C++)I[n=g[C]]=this.font.glyf.glyphFor(n);for(n in e=[],I)(null!=(t=I[n])?t.compound:void 0)&&e.push.apply(e,t.glyphIDs);if(e.length>0)for(n in a=this.glyphsFor(e))t=a[n],I[n]=t;return I},g.prototype.encode=function(g,e){var t,I,n,C,l,a,o,i,r,c,s,A,d,u,m;for(I in t=ma.encode(this.generateCmap(),"unicode"),C=this.glyphsFor(g),s={0:0},m=t.charMap)s[(a=m[I]).old]=a.new;for(A in c=t.maxGlyphID,C)A in s||(s[A]=c++);return i=function(g){var e,t;for(e in t={},g)t[g[e]]=e;return t}(s),r=Object.keys(i).sort((function(g,e){return g-e})),d=function(){var g,e,t;for(t=[],g=0,e=r.length;g<e;g++)l=r[g],t.push(i[l]);return t}(),n=this.font.glyf.encode(C,d,s),o=this.font.loca.encode(n.offsets,d),u={cmap:this.font.cmap.raw(),glyf:n.table,loca:o,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(u["OS/2"]=this.font.os2.raw()),this.font.directory.encode(u)},g}();function Xa(g,e,t,I,n){I=I||{};var C=n.internal.scaleFactor,l=n.internal.getFontSize()/C,a=l*(n.getLineHeightFactor?n.getLineHeightFactor():1.15),o="",i=1;if("middle"!==I.valign&&"bottom"!==I.valign&&"center"!==I.halign&&"right"!==I.halign||(i=(o="string"===typeof g?g.split(/\r\n|\r|\n/g):g).length||1),t+=l*(2-1.15),"middle"===I.valign?t-=i/2*a:"bottom"===I.valign&&(t-=i*a),"center"===I.halign||"right"===I.halign){var r=l;if("center"===I.halign&&(r*=.5),o&&i>=1){for(var c=0;c<o.length;c++)n.text(o[c],e-n.getStringUnitWidth(o[c])*r,t),t+=a;return n}e-=n.getStringUnitWidth(g)*r}return"justify"===I.halign?n.text(g,e,t,{maxWidth:I.maxWidth||100,align:"justify"}):n.text(g,e,t),n}jC.API.PDFObject=function(){var g;function e(){}return g=function(g,e){return(Array(e+1).join("0")+g).slice(-e)},e.convert=function(t){var I,n,C,l;if(Array.isArray(t))return"["+function(){var g,n,C;for(C=[],g=0,n=t.length;g<n;g++)I=t[g],C.push(e.convert(I));return C}().join(" ")+"]";if("string"==typeof t)return"/"+t;if(null!=t?t.isString:void 0)return"("+t+")";if(t instanceof Date)return"(D:"+g(t.getUTCFullYear(),4)+g(t.getUTCMonth(),2)+g(t.getUTCDate(),2)+g(t.getUTCHours(),2)+g(t.getUTCMinutes(),2)+g(t.getUTCSeconds(),2)+"Z)";if("[object Object]"==={}.toString.call(t)){for(n in C=["<<"],t)l=t[n],C.push("/"+n+" "+e.convert(l));return C.push(">>"),C.join("\n")}return""+t},e}();var ka={},Ja=function(){function g(g){this.jsPDFDocument=g,this.userStyles={textColor:g.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:g.internal.getFontSize(),fontStyle:g.internal.getFont().fontStyle,font:g.internal.getFont().fontName,lineWidth:g.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:g.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return g.setDefaults=function(g,e){void 0===e&&(e=null),e?e.__autoTableDocumentDefaults=g:ka=g},g.unifyColor=function(g){return Array.isArray(g)?g:"number"===typeof g?[g,g,g]:"string"===typeof g?[g]:null},g.prototype.applyStyles=function(e,t){var I,n,C;void 0===t&&(t=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var l=this.jsPDFDocument.internal.getFont(),a=l.fontStyle,o=l.fontName;if(e.font&&(o=e.font),e.fontStyle){a=e.fontStyle;var i=this.getFontList()[o];i&&-1===i.indexOf(a)&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(i[0]),a=i[0])}if(this.jsPDFDocument.setFont(o,a),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!t){var r=g.unifyColor(e.fillColor);r&&(I=this.jsPDFDocument).setFillColor.apply(I,r),(r=g.unifyColor(e.textColor))&&(n=this.jsPDFDocument).setTextColor.apply(n,r),(r=g.unifyColor(e.lineColor))&&(C=this.jsPDFDocument).setDrawColor.apply(C,r),"number"===typeof e.lineWidth&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},g.prototype.splitTextToSize=function(g,e,t){return this.jsPDFDocument.splitTextToSize(g,e,t)},g.prototype.rect=function(g,e,t,I,n){return this.jsPDFDocument.rect(g,e,t,I,n)},g.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},g.prototype.getTextWidth=function(g){return this.jsPDFDocument.getTextWidth(g)},g.prototype.getDocument=function(){return this.jsPDFDocument},g.prototype.setPage=function(g){this.jsPDFDocument.setPage(g)},g.prototype.addPage=function(){return this.jsPDFDocument.addPage()},g.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},g.prototype.getGlobalOptions=function(){return ka||{}},g.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},g.prototype.pageSize=function(){var g=this.jsPDFDocument.internal.pageSize;return null==g.width&&(g={width:g.getWidth(),height:g.getHeight()}),g},g.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},g.prototype.getLineHeightFactor=function(){var g=this.jsPDFDocument;return g.getLineHeightFactor?g.getLineHeightFactor():1.15},g.prototype.getLineHeight=function(g){return g/this.scaleFactor()*this.getLineHeightFactor()},g.prototype.pageNumber=function(){var g=this.jsPDFDocument.internal.getCurrentPageInfo();return g?g.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},g}(),Ya=function(g,e){return Ya=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,e){g.__proto__=e}||function(g,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(g[t]=e[t])},Ya(g,e)};function wa(g,e){if("function"!==typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=g}Ya(g,e),g.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}"function"===typeof SuppressedError&&SuppressedError;var Na=function(g){function e(e){var t=g.call(this)||this;return t._element=e,t}return wa(e,g),e}(Array);function Ha(g,e,t){t.applyStyles(e,!0);var I=(Array.isArray(g)?g:[g]).map((function(g){return t.getTextWidth(g)})).reduce((function(g,e){return Math.max(g,e)}),0);return I}function Fa(g,e,t,I){var n=e.settings.tableLineWidth,C=e.settings.tableLineColor;g.applyStyles({lineWidth:n,lineColor:C});var l=Ka(n,!1);l&&g.rect(t.x,t.y,e.getWidth(g.pageSize().width),I.y-t.y,l)}function Ka(g,e){var t=g>0,I=e||0===e;return t&&I?"DF":t?"S":I?"F":null}function xa(g,e){var t,I,n,C;if(g=g||e,Array.isArray(g)){if(g.length>=4)return{top:g[0],right:g[1],bottom:g[2],left:g[3]};if(3===g.length)return{top:g[0],right:g[1],bottom:g[2],left:g[1]};if(2===g.length)return{top:g[0],right:g[1],bottom:g[0],left:g[1]};g=1===g.length?g[0]:e}return"object"===typeof g?("number"===typeof g.vertical&&(g.top=g.vertical,g.bottom=g.vertical),"number"===typeof g.horizontal&&(g.right=g.horizontal,g.left=g.horizontal),{left:null!==(t=g.left)&&void 0!==t?t:e,top:null!==(I=g.top)&&void 0!==I?I:e,right:null!==(n=g.right)&&void 0!==n?n:e,bottom:null!==(C=g.bottom)&&void 0!==C?C:e}):("number"!==typeof g&&(g=e),{top:g,right:g,bottom:g,left:g})}function La(g,e){var t=xa(e.settings.margin,0);return g.pageSize().width-(t.left+t.right)}function za(g,e,t,I,n){var C={},l=96/72,a=Ea(e,(function(g){return n.getComputedStyle(g).backgroundColor}));null!=a&&(C.fillColor=a);var o=Ea(e,(function(g){return n.getComputedStyle(g).color}));null!=o&&(C.textColor=o);var i=function(g,e){var t=[g.paddingTop,g.paddingRight,g.paddingBottom,g.paddingLeft],I=96/(72/e),n=(parseInt(g.lineHeight)-parseInt(g.fontSize))/e/2,C=t.map((function(g){return parseInt(g||"0")/I})),l=xa(C,0);n>l.top&&(l.top=n);n>l.bottom&&(l.bottom=n);return l}(I,t);i&&(C.cellPadding=i);var r="borderTopColor",c=l*t,s=I.borderTopWidth;if(I.borderBottomWidth===s&&I.borderRightWidth===s&&I.borderLeftWidth===s){var A=(parseFloat(s)||0)/c;A&&(C.lineWidth=A)}else C.lineWidth={top:(parseFloat(I.borderTopWidth)||0)/c,right:(parseFloat(I.borderRightWidth)||0)/c,bottom:(parseFloat(I.borderBottomWidth)||0)/c,left:(parseFloat(I.borderLeftWidth)||0)/c},C.lineWidth.top||(C.lineWidth.right?r="borderRightColor":C.lineWidth.bottom?r="borderBottomColor":C.lineWidth.left&&(r="borderLeftColor"));var d=Ea(e,(function(g){return n.getComputedStyle(g)[r]}));null!=d&&(C.lineColor=d);var u=["left","right","center","justify"];-1!==u.indexOf(I.textAlign)&&(C.halign=I.textAlign),-1!==(u=["middle","bottom","top"]).indexOf(I.verticalAlign)&&(C.valign=I.verticalAlign);var m=parseInt(I.fontSize||"");isNaN(m)||(C.fontSize=m/l);var h=function(g){var e="";("bold"===g.fontWeight||"bolder"===g.fontWeight||parseInt(g.fontWeight)>=700)&&(e="bold");"italic"!==g.fontStyle&&"oblique"!==g.fontStyle||(e+="italic");return e}(I);h&&(C.fontStyle=h);var b=(I.fontFamily||"").toLowerCase();return-1!==g.indexOf(b)&&(C.font=b),C}function Ea(g,e){var t=Ma(g,e);if(!t)return null;var I=t.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!I||!Array.isArray(I))return null;var n=[parseInt(I[1]),parseInt(I[2]),parseInt(I[3])];return 0===parseInt(I[4])||isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function Ma(g,e){var t=e(g);return"rgba(0, 0, 0, 0)"===t||"transparent"===t||"initial"===t||"inherit"===t?null==g.parentElement?null:Ma(g.parentElement,e):t}function Ua(g,e,t,I,n){var C,l,a;void 0===I&&(I=!1),void 0===n&&(n=!1),a="string"===typeof e?t.document.querySelector(e):e;var o=Object.keys(g.getFontList()),i=g.scaleFactor(),r=[],c=[],s=[];if(!a)return console.error("Html table could not be found with input: ",e),{head:r,body:c,foot:s};for(var A=0;A<a.rows.length;A++){var d=a.rows[A],u=null===(l=null===(C=null===d||void 0===d?void 0:d.parentElement)||void 0===C?void 0:C.tagName)||void 0===l?void 0:l.toLowerCase(),m=ja(o,i,t,d,I,n);m&&("thead"===u?r.push(m):"tfoot"===u?s.push(m):c.push(m))}return{head:r,body:c,foot:s}}function ja(g,e,t,I,n,C){for(var l=new Na(I),a=0;a<I.cells.length;a++){var o=I.cells[a],i=t.getComputedStyle(o);if(n||"none"!==i.display){var r=void 0;C&&(r=za(g,o,e,i,t)),l.push({rowSpan:o.rowSpan,colSpan:o.colSpan,styles:r,_element:o,content:Qa(o)})}}var c=t.getComputedStyle(I);if(l.length>0&&(n||"none"!==c.display))return l}function Qa(g){var e=g.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map((function(g){return g.trim()})).join("\n"),e.innerText||e.textContent||""}function Da(g,e,t,I,n){if(null==g)throw new TypeError("Cannot convert undefined or null to object");for(var C=Object(g),l=1;l<arguments.length;l++){var a=arguments[l];if(null!=a)for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(C[o]=a[o])}return C}function Ta(g,e){var t=new Ja(g),I=t.getDocumentOptions(),n=t.getGlobalOptions();!function(g,e,t){for(var I=0,n=[g,e,t];I<n.length;I++){var C=n[I];C&&"object"!==typeof C&&console.error("The options parameter should be of type object, is: "+typeof C),C.startY&&"number"!==typeof C.startY&&(console.error("Invalid value for startY option",C.startY),delete C.startY)}}(n,I,e);var C,l=Da({},n,I,e);"undefined"!==typeof window&&(C=window);var a=function(g,e,t){for(var I={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},n=function(n){if("columnStyles"===n){var C=g[n],l=e[n],a=t[n];I.columnStyles=Da({},C,l,a)}else{var o=[g,e,t].map((function(g){return g[n]||{}}));I[n]=Da({},o[0],o[1],o[2])}},C=0,l=Object.keys(I);C<l.length;C++){n(l[C])}return I}(n,I,e),o=function(g,e,t){for(var I={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},n=0,C=[g,e,t];n<C.length;n++){var l=C[n];l.didParseCell&&I.didParseCell.push(l.didParseCell),l.willDrawCell&&I.willDrawCell.push(l.willDrawCell),l.didDrawCell&&I.didDrawCell.push(l.didDrawCell),l.willDrawPage&&I.willDrawPage.push(l.willDrawPage),l.didDrawPage&&I.didDrawPage.push(l.didDrawPage)}return I}(n,I,e),i=function(g,e){var t,I,n,C,l,a,o,i,r,c,s,A,d,u,m=xa(e.margin,40/g.scaleFactor()),h=null!==(t=function(g,e){var t=g.getLastAutoTable(),I=g.scaleFactor(),n=g.pageNumber(),C=!1;if(t&&t.startPageNumber){C=t.startPageNumber+t.pageNumber-1===n}if("number"===typeof e)return e;if((null==e||!1===e)&&C&&null!=(null===t||void 0===t?void 0:t.finalY))return t.finalY+20/I;return null}(g,e.startY))&&void 0!==t?t:m.top;d=!0===e.showFoot?"everyPage":!1===e.showFoot?"never":null!==(I=e.showFoot)&&void 0!==I?I:"everyPage";u=!0===e.showHead?"everyPage":!1===e.showHead?"never":null!==(n=e.showHead)&&void 0!==n?n:"everyPage";var b=null!==(C=e.useCss)&&void 0!==C&&C,Z=e.theme||(b?"plain":"striped"),p=!!e.horizontalPageBreak,G=null!==(l=e.horizontalPageBreakRepeat)&&void 0!==l?l:null;return{includeHiddenHtml:null!==(a=e.includeHiddenHtml)&&void 0!==a&&a,useCss:b,theme:Z,startY:h,margin:m,pageBreak:null!==(o=e.pageBreak)&&void 0!==o?o:"auto",rowPageBreak:null!==(i=e.rowPageBreak)&&void 0!==i?i:"auto",tableWidth:null!==(r=e.tableWidth)&&void 0!==r?r:"auto",showHead:u,showFoot:d,tableLineWidth:null!==(c=e.tableLineWidth)&&void 0!==c?c:0,tableLineColor:null!==(s=e.tableLineColor)&&void 0!==s?s:200,horizontalPageBreak:p,horizontalPageBreakRepeat:G,horizontalPageBreakBehaviour:null!==(A=e.horizontalPageBreakBehaviour)&&void 0!==A?A:"afterAllRows"}}(t,l),r=function(g,e,t){var I=e.head||[],n=e.body||[],C=e.foot||[];if(e.html){var l=e.includeHiddenHtml;if(t){var a=Ua(g,e.html,t,l,e.useCss)||{};I=a.head||I,n=a.body||I,C=a.foot||I}else console.error("Cannot parse html in non browser environment")}var o=e.columns||function(g,e,t){var I=g[0]||e[0]||t[0]||[],n=[];return Object.keys(I).filter((function(g){return"_element"!==g})).forEach((function(g){var e,t=1;"object"!==typeof(e=Array.isArray(I)?I[parseInt(g)]:I[g])||Array.isArray(e)||(t=(null===e||void 0===e?void 0:e.colSpan)||1);for(var C=0;C<t;C++){var l={dataKey:Array.isArray(I)?n.length:g+(C>0?"_".concat(C):"")};n.push(l)}})),n}(I,n,C);return{columns:o,head:I,body:n,foot:C}}(t,l,C);return{id:e.tableId,content:r,hooks:o,styles:a,settings:i}}var Pa,Oa=function(g,e,t){this.table=e,this.pageNumber=e.pageNumber,this.settings=e.settings,this.cursor=t,this.doc=g.getDocument()},qa=function(g){function e(e,t,I,n,C,l){var a=g.call(this,e,t,l)||this;return a.cell=I,a.row=n,a.column=C,a.section=n.section,a}return wa(e,g),e}(Oa),_a=function(){function g(g,e){this.pageNumber=1,this.id=g.id,this.settings=g.settings,this.styles=g.styles,this.hooks=g.hooks,this.columns=e.columns,this.head=e.head,this.body=e.body,this.foot=e.foot}return g.prototype.getHeadHeight=function(g){return this.head.reduce((function(e,t){return e+t.getMaxCellHeight(g)}),0)},g.prototype.getFootHeight=function(g){return this.foot.reduce((function(e,t){return e+t.getMaxCellHeight(g)}),0)},g.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},g.prototype.callCellHooks=function(g,e,t,I,n,C){for(var l=0,a=e;l<a.length;l++){var o=!1===(0,a[l])(new qa(g,this,t,I,n,C));if(t.text=Array.isArray(t.text)?t.text:[t.text],o)return!1}return!0},g.prototype.callEndPageHooks=function(g,e){g.applyStyles(g.userStyles);for(var t=0,I=this.hooks.didDrawPage;t<I.length;t++){(0,I[t])(new Oa(g,this,e))}},g.prototype.callWillDrawPageHooks=function(g,e){for(var t=0,I=this.hooks.willDrawPage;t<I.length;t++){(0,I[t])(new Oa(g,this,e))}},g.prototype.getWidth=function(g){if("number"===typeof this.settings.tableWidth)return this.settings.tableWidth;if("wrap"===this.settings.tableWidth)return this.columns.reduce((function(g,e){return g+e.wrappedWidth}),0);var e=this.settings.margin;return g-e.left-e.right},g}(),$a=function(){function g(g,e,t,I,n){void 0===n&&(n=!1),this.height=0,this.raw=g,g instanceof Na&&(this.raw=g._element,this.element=g._element),this.index=e,this.section=t,this.cells=I,this.spansMultiplePages=n}return g.prototype.getMaxCellHeight=function(g){var e=this;return g.reduce((function(g,t){var I;return Math.max(g,(null===(I=e.cells[t.index])||void 0===I?void 0:I.height)||0)}),0)},g.prototype.hasRowSpan=function(g){var e=this;return g.filter((function(g){var t=e.cells[g.index];return!!t&&t.rowSpan>1})).length>0},g.prototype.canEntireRowFit=function(g,e){return this.getMaxCellHeight(e)<=g},g.prototype.getMinimumRowHeight=function(g,e){var t=this;return g.reduce((function(g,I){var n=t.cells[I.index];if(!n)return 0;var C=e.getLineHeight(n.styles.fontSize),l=n.padding("vertical")+C;return l>g?l:g}),0)},g}(),go=function(){function g(g,e,t){var I;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=e,this.section=t,this.raw=g;var n=g;null==g||"object"!==typeof g||Array.isArray(g)?(this.rowSpan=1,this.colSpan=1):(this.rowSpan=g.rowSpan||1,this.colSpan=g.colSpan||1,n=null!==(I=g.content)&&void 0!==I?I:g,g._element&&(this.raw=g._element));var C=null!=n?""+n:"";this.text=C.split(/\r\n|\r|\n/g)}return g.prototype.getTextPos=function(){var g,e;if("top"===this.styles.valign)g=this.y+this.padding("top");else if("bottom"===this.styles.valign)g=this.y+this.height-this.padding("bottom");else{var t=this.height-this.padding("vertical");g=this.y+t/2+this.padding("top")}if("right"===this.styles.halign)e=this.x+this.width-this.padding("right");else if("center"===this.styles.halign){var I=this.width-this.padding("horizontal");e=this.x+I/2+this.padding("left")}else e=this.x+this.padding("left");return{x:e,y:g}},g.prototype.getContentHeight=function(g,e){void 0===e&&(e=1.15);var t=(Array.isArray(this.text)?this.text.length:1)*(this.styles.fontSize/g*e)+this.padding("vertical");return Math.max(t,this.styles.minCellHeight)},g.prototype.padding=function(g){var e=xa(this.styles.cellPadding,0);return"vertical"===g?e.top+e.bottom:"horizontal"===g?e.left+e.right:e[g]},g}(),eo=function(){function g(g,e,t){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=g,this.raw=e,this.index=t}return g.prototype.getMaxCustomCellWidth=function(g){for(var e=0,t=0,I=g.allRows();t<I.length;t++){var n=I[t].cells[this.index];n&&"number"===typeof n.styles.cellWidth&&(e=Math.max(e,n.styles.cellWidth))}return e},g}();function to(g,e){!function(g,e){var t=g.scaleFactor(),I=e.settings.horizontalPageBreak,n=La(g,e);e.allRows().forEach((function(C){for(var l=0,a=e.columns;l<a.length;l++){var o=a[l],i=C.cells[o.index];if(i){var r=e.hooks.didParseCell;e.callCellHooks(g,r,i,C,o,null);var c=i.padding("horizontal");i.contentWidth=Ha(i.text,i.styles,g)+c;var s=Ha(i.text.join(" ").split(/[^\S\u00A0]+/),i.styles,g);if(i.minReadableWidth=s+i.padding("horizontal"),"number"===typeof i.styles.cellWidth)i.minWidth=i.styles.cellWidth,i.wrappedWidth=i.styles.cellWidth;else if("wrap"===i.styles.cellWidth||!0===I)i.contentWidth>n?(i.minWidth=n,i.wrappedWidth=n):(i.minWidth=i.contentWidth,i.wrappedWidth=i.contentWidth);else{var A=10/t;i.minWidth=i.styles.minCellWidth||A,i.wrappedWidth=i.contentWidth,i.minWidth>i.wrappedWidth&&(i.wrappedWidth=i.minWidth)}}}})),e.allRows().forEach((function(g){for(var t=0,I=e.columns;t<I.length;t++){var n=I[t],C=g.cells[n.index];if(C&&1===C.colSpan)n.wrappedWidth=Math.max(n.wrappedWidth,C.wrappedWidth),n.minWidth=Math.max(n.minWidth,C.minWidth),n.minReadableWidth=Math.max(n.minReadableWidth,C.minReadableWidth);else{var l=e.styles.columnStyles[n.dataKey]||e.styles.columnStyles[n.index]||{},a=l.cellWidth||l.minCellWidth;a&&"number"===typeof a&&(n.minWidth=a,n.wrappedWidth=a)}C&&(C.colSpan>1&&!n.minWidth&&(n.minWidth=C.minWidth),C.colSpan>1&&!n.wrappedWidth&&(n.wrappedWidth=C.minWidth))}}))}(g,e);var t=[],I=0;e.columns.forEach((function(g){var n=g.getMaxCustomCellWidth(e);n?g.width=n:(g.width=g.wrappedWidth,t.push(g)),I+=g.width}));var n=e.getWidth(g.pageSize().width)-I;n&&(n=Io(t,n,(function(g){return Math.max(g.minReadableWidth,g.minWidth)}))),n&&(n=Io(t,n,(function(g){return g.minWidth}))),n=Math.abs(n),!e.settings.horizontalPageBreak&&n>.1/g.scaleFactor()&&(n=n<1?n:Math.round(n),console.warn("Of the table content, ".concat(n," units width could not fit page"))),function(g){for(var e=g.allRows(),t=0;t<e.length;t++)for(var I=e[t],n=null,C=0,l=0,a=0;a<g.columns.length;a++){var o=g.columns[a];if((l-=1)>1&&g.columns[a+1])C+=o.width,delete I.cells[o.index];else if(n){var i=n;delete I.cells[o.index],n=null,i.width=o.width+C}else{if(!(i=I.cells[o.index]))continue;if(l=i.colSpan,C=0,i.colSpan>1){n=i,C+=o.width;continue}i.width=o.width+C}}}(e),function(g,e){for(var t={count:0,height:0},I=0,n=g.allRows();I<n.length;I++){for(var C=n[I],l=0,a=g.columns;l<a.length;l++){var o=a[l],i=C.cells[o.index];if(i){e.applyStyles(i.styles,!0);var r=i.width-i.padding("horizontal");if("linebreak"===i.styles.overflow)i.text=e.splitTextToSize(i.text,r+1/e.scaleFactor(),{fontSize:i.styles.fontSize});else if("ellipsize"===i.styles.overflow)i.text=no(i.text,r,i.styles,e,"...");else if("hidden"===i.styles.overflow)i.text=no(i.text,r,i.styles,e,"");else if("function"===typeof i.styles.overflow){var c=i.styles.overflow(i.text,r);i.text="string"===typeof c?[c]:c}i.contentHeight=i.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var s=i.contentHeight/i.rowSpan;i.rowSpan>1&&t.count*t.height<s*i.rowSpan?t={height:s,count:i.rowSpan}:t&&t.count>0&&t.height>s&&(s=t.height),s>C.height&&(C.height=s)}}t.count--}}(e,g),function(g){for(var e={},t=1,I=g.allRows(),n=0;n<I.length;n++)for(var C=I[n],l=0,a=g.columns;l<a.length;l++){var o=a[l],i=e[o.index];if(t>1)t--,delete C.cells[o.index];else if(i)i.cell.height+=C.height,t=i.cell.colSpan,delete C.cells[o.index],i.left--,i.left<=1&&delete e[o.index];else{var r=C.cells[o.index];if(!r)continue;if(r.height=C.height,r.rowSpan>1){var c=I.length-n,s=r.rowSpan>c?c:r.rowSpan;e[o.index]={cell:r,left:s,row:C}}}}}(e)}function Io(g,e,t){for(var I=e,n=g.reduce((function(g,e){return g+e.wrappedWidth}),0),C=0;C<g.length;C++){var l=g[C],a=I*(l.wrappedWidth/n),o=l.width+a,i=t(l),r=o<i?i:o;e-=r-l.width,l.width=r}if(e=Math.round(1e10*e)/1e10){var c=g.filter((function(g){return!(e<0)||g.width>t(g)}));c.length&&(e=Io(c,e,t))}return e}function no(g,e,t,I,n){return g.map((function(g){return function(g,e,t,I,n){var C=1e4*I.scaleFactor();if(e=Math.ceil(e*C)/C,e>=Ha(g,t,I))return g;for(;e<Ha(g+n,t,I)&&!(g.length<=1);)g=g.substring(0,g.length-1);return g.trim()+n}(g,e,t,I,n)}))}function Co(g,e){var t=new Ja(g),I=function(g,e){var t=g.content,I=function(g){return g.map((function(g,e){var t,I;return I="object"===typeof g&&null!==(t=g.dataKey)&&void 0!==t?t:e,new eo(I,g,e)}))}(t.columns);if(0===t.head.length){(n=ao(I,"head"))&&t.head.push(n)}if(0===t.foot.length){var n;(n=ao(I,"foot"))&&t.foot.push(n)}var C=g.settings.theme,l=g.styles;return{columns:I,head:lo("head",t.head,I,l,C,e),body:lo("body",t.body,I,l,C,e),foot:lo("foot",t.foot,I,l,C,e)}}(e,t.scaleFactor()),n=new _a(e,I);return to(t,n),t.applyStyles(t.userStyles),n}function lo(g,e,t,I,n,C){var l={};return e.map((function(e,a){for(var o=0,i={},r=0,c=0,s=0,A=t;s<A.length;s++){var d=A[s];if(null==l[d.index]||0===l[d.index].left)if(0===c){var u=void 0,m={};"object"!==typeof(u=Array.isArray(e)?e[d.index-r-o]:e[d.dataKey])||Array.isArray(u)||(m=(null===u||void 0===u?void 0:u.styles)||{});var h=oo(g,d,a,n,I,C,m),b=new go(u,h,g);i[d.dataKey]=b,i[d.index]=b,c=b.colSpan-1,l[d.index]={left:b.rowSpan-1,times:c}}else c--,r++;else l[d.index].left--,c=l[d.index].times,o++}return new $a(e,a,g,i)}))}function ao(g,e){var t={};return g.forEach((function(g){if(null!=g.raw){var I=function(g,e){if("head"===g){if("object"===typeof e)return e.header||null;if("string"===typeof e||"number"===typeof e)return e}else if("foot"===g&&"object"===typeof e)return e.footer;return null}(e,g.raw);null!=I&&(t[g.dataKey]=I)}})),Object.keys(t).length>0?t:null}function oo(g,e,t,I,n,C,l){var a,o={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}}[I];"head"===g?a=n.headStyles:"body"===g?a=n.bodyStyles:"foot"===g&&(a=n.footStyles);var i=Da({},o.table,o[g],n.styles,a),r=n.columnStyles[e.dataKey]||n.columnStyles[e.index]||{},c="body"===g?r:{},s="body"===g&&t%2===0?Da({},o.alternateRow,n.alternateRowStyles):{},A=function(g){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/g,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}(C),d=Da({},A,i,s,c);return Da(d,l)}function io(g,e,t){var I;void 0===t&&(t={});var n=La(g,e),C=new Map,l=[],a=[],o=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?o=e.settings.horizontalPageBreakRepeat:"string"!==typeof e.settings.horizontalPageBreakRepeat&&"number"!==typeof e.settings.horizontalPageBreakRepeat||(o=[e.settings.horizontalPageBreakRepeat]),o.forEach((function(g){var t=e.columns.find((function(e){return e.dataKey===g||e.index===g}));t&&!C.has(t.index)&&(C.set(t.index,!0),l.push(t.index),a.push(e.columns[t.index]),n-=t.wrappedWidth)}));for(var i=!0,r=null!==(I=null===t||void 0===t?void 0:t.start)&&void 0!==I?I:0;r<e.columns.length;)if(C.has(r))r++;else{var c=e.columns[r].wrappedWidth;if(!(i||n>=c))break;i=!1,l.push(r),a.push(e.columns[r]),n-=c,r++}return{colIndexes:l,columns:a,lastIndex:r-1}}function ro(g,e){var t=e.settings,I=t.startY,n=t.margin,C={x:n.left,y:I},l=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),a=I+n.bottom+l;"avoid"===t.pageBreak&&(a+=e.body.reduce((function(g,e){return g+e.height}),0));var o=new Ja(g);("always"===t.pageBreak||null!=t.startY&&a>o.pageSize().height)&&(Go(o),C.y=n.top),e.callWillDrawPageHooks(o,C);var i=Da({},C);e.startPageNumber=o.pageNumber(),t.horizontalPageBreak?function(g,e,t,I){var n=function(g,e){for(var t=[],I=0;I<e.columns.length;I++){var n=io(g,e,{start:I});n.columns.length&&(t.push(n),I=n.lastIndex)}return t}(g,e),C=e.settings;if("afterAllRows"===C.horizontalPageBreakBehaviour)n.forEach((function(n,C){g.applyStyles(g.userStyles),C>0?po(g,e,t,I,n.columns,!0):co(g,e,I,n.columns),function(g,e,t,I,n){g.applyStyles(g.userStyles),e.body.forEach((function(C,l){var a=l===e.body.length-1;mo(g,e,C,a,t,I,n)}))}(g,e,t,I,n.columns),Ao(g,e,I,n.columns)}));else for(var l=-1,a=n[0],o=function(){var C=l;if(a){g.applyStyles(g.userStyles);var o=a.columns;l>=0?po(g,e,t,I,o,!0):co(g,e,I,o),C=so(g,e,l+1,I,o),Ao(g,e,I,o)}var i=C-l;n.slice(1).forEach((function(n){g.applyStyles(g.userStyles),po(g,e,t,I,n.columns,!0),so(g,e,l+1,I,n.columns,i),Ao(g,e,I,n.columns)})),l=C};l<e.body.length-1;)o()}(o,e,i,C):(o.applyStyles(o.userStyles),"firstPage"!==t.showHead&&"everyPage"!==t.showHead||e.head.forEach((function(g){return ho(o,e,g,C,e.columns)})),o.applyStyles(o.userStyles),e.body.forEach((function(g,t){var I=t===e.body.length-1;mo(o,e,g,I,i,C,e.columns)})),o.applyStyles(o.userStyles),"lastPage"!==t.showFoot&&"everyPage"!==t.showFoot||e.foot.forEach((function(g){return ho(o,e,g,C,e.columns)}))),Fa(o,e,i,C),e.callEndPageHooks(o,C),e.finalY=C.y,g.lastAutoTable=e,o.applyStyles(o.userStyles)}function co(g,e,t,I){var n=e.settings;g.applyStyles(g.userStyles),"firstPage"!==n.showHead&&"everyPage"!==n.showHead||e.head.forEach((function(n){return ho(g,e,n,t,I)}))}function so(g,e,t,I,n,C){g.applyStyles(g.userStyles),C=null!==C&&void 0!==C?C:e.body.length;var l=Math.min(t+C,e.body.length),a=-1;return e.body.slice(t,l).forEach((function(C,l){var o=t+l===e.body.length-1,i=Zo(g,e,o,I);C.canEntireRowFit(i,n)&&(ho(g,e,C,I,n),a=t+l)})),a}function Ao(g,e,t,I){var n=e.settings;g.applyStyles(g.userStyles),"lastPage"!==n.showFoot&&"everyPage"!==n.showFoot||e.foot.forEach((function(n){return ho(g,e,n,t,I)}))}function uo(g,e,t){var I=t.getLineHeight(g.styles.fontSize),n=g.padding("vertical"),C=Math.floor((e-n)/I);return Math.max(0,C)}function mo(g,e,t,I,n,C,l){var a=Zo(g,e,I,C);if(t.canEntireRowFit(a,l))ho(g,e,t,C,l);else if(function(g,e,t,I){var n=g.pageSize().height,C=I.settings.margin,l=n-(C.top+C.bottom);"body"===e.section&&(l-=I.getHeadHeight(I.columns)+I.getFootHeight(I.columns));var a=e.getMinimumRowHeight(I.columns,g),o=a<t;if(a>l)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!o)return!1;var i=e.hasRowSpan(I.columns);return e.getMaxCellHeight(I.columns)>l?(i&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!i&&"avoid"!==I.settings.rowPageBreak}(g,t,a,e)){var o=function(g,e,t,I){var n={};g.spansMultiplePages=!0,g.height=0;for(var C=0,l=0,a=t.columns;l<a.length;l++){var o=a[l];if(m=g.cells[o.index]){Array.isArray(m.text)||(m.text=[m.text]),(u=Da(u=new go(m.raw,m.styles,m.section),m)).text=[];var i=uo(m,e,I);m.text.length>i&&(u.text=m.text.splice(i,m.text.length));var r=I.scaleFactor(),c=I.getLineHeightFactor();m.contentHeight=m.getContentHeight(r,c),m.contentHeight>=e&&(m.contentHeight=e,u.styles.minCellHeight-=e),m.contentHeight>g.height&&(g.height=m.contentHeight),u.contentHeight=u.getContentHeight(r,c),u.contentHeight>C&&(C=u.contentHeight),n[o.index]=u}}var s=new $a(g.raw,-1,g.section,n,!0);s.height=C;for(var A=0,d=t.columns;A<d.length;A++){var u,m;o=d[A],(u=s.cells[o.index])&&(u.height=s.height),(m=g.cells[o.index])&&(m.height=g.height)}return s}(t,a,e,g);ho(g,e,t,C,l),po(g,e,n,C,l),mo(g,e,o,I,n,C,l)}else po(g,e,n,C,l),mo(g,e,t,I,n,C,l)}function ho(g,e,t,I,n){I.x=e.settings.margin.left;for(var C=0,l=n;C<l.length;C++){var a=l[C],o=t.cells[a.index];if(o)if(g.applyStyles(o.styles),o.x=I.x,o.y=I.y,!1!==e.callCellHooks(g,e.hooks.willDrawCell,o,t,a,I)){bo(g,o,I);var i=o.getTextPos();Xa(o.text,i.x,i.y,{halign:o.styles.halign,valign:o.styles.valign,maxWidth:Math.ceil(o.width-o.padding("left")-o.padding("right"))},g.getDocument()),e.callCellHooks(g,e.hooks.didDrawCell,o,t,a,I),I.x+=a.width}else I.x+=a.width;else I.x+=a.width}I.y+=t.height}function bo(g,e,t){var I=e.styles;if(g.getDocument().setFillColor(g.getDocument().getFillColor()),"number"===typeof I.lineWidth){var n=Ka(I.lineWidth,I.fillColor);n&&g.rect(e.x,t.y,e.width,e.height,n)}else"object"===typeof I.lineWidth&&(I.fillColor&&g.rect(e.x,t.y,e.width,e.height,"F"),function(g,e,t,I){var n,C,l,a;I.top&&(n=t.x,C=t.y,l=t.x+e.width,a=t.y,I.right&&(l+=.5*I.right),I.left&&(n-=.5*I.left),o(I.top,n,C,l,a));I.bottom&&(n=t.x,C=t.y+e.height,l=t.x+e.width,a=t.y+e.height,I.right&&(l+=.5*I.right),I.left&&(n-=.5*I.left),o(I.bottom,n,C,l,a));I.left&&(n=t.x,C=t.y,l=t.x,a=t.y+e.height,I.top&&(C-=.5*I.top),I.bottom&&(a+=.5*I.bottom),o(I.left,n,C,l,a));I.right&&(n=t.x+e.width,C=t.y,l=t.x+e.width,a=t.y+e.height,I.top&&(C-=.5*I.top),I.bottom&&(a+=.5*I.bottom),o(I.right,n,C,l,a));function o(e,t,I,n,C){g.getDocument().setLineWidth(e),g.getDocument().line(t,I,n,C,"S")}}(g,e,t,I.lineWidth))}function Zo(g,e,t,I){var n=e.settings.margin.bottom,C=e.settings.showFoot;return("everyPage"===C||"lastPage"===C&&t)&&(n+=e.getFootHeight(e.columns)),g.pageSize().height-I.y-n}function po(g,e,t,I,n,C){void 0===n&&(n=[]),void 0===C&&(C=!1),g.applyStyles(g.userStyles),"everyPage"!==e.settings.showFoot||C||e.foot.forEach((function(t){return ho(g,e,t,I,n)})),e.callEndPageHooks(g,I);var l=e.settings.margin;Fa(g,e,t,I),Go(g),e.pageNumber++,I.x=l.left,I.y=l.top,t.y=l.top,e.callWillDrawPageHooks(g,I),"everyPage"===e.settings.showHead&&(e.head.forEach((function(t){return ho(g,e,t,I,n)})),g.applyStyles(g.userStyles))}function Go(g){var e=g.pageNumber();return g.setPage(e+1),g.pageNumber()===e&&(g.addPage(),!0)}try{if("undefined"!==typeof window&&window){var yo=window,Bo=yo.jsPDF||(null===(Pa=yo.jspdf)||void 0===Pa?void 0:Pa.jsPDF);Bo&&function(g){g.API.autoTable=function(){for(var g=[],e=0;e<arguments.length;e++)g[e]=arguments[e];return ro(this,Co(this,Ta(this,g[0]))),this},g.API.lastAutoTable=!1,g.API.autoTableText=function(g,e,t,I){Xa(g,e,t,I,this)},g.API.autoTableSetDefaults=function(g){return Ja.setDefaults(g,this),this},g.autoTableSetDefaults=function(g,e){Ja.setDefaults(g,e)},g.API.autoTableHtmlToJson=function(g,e){var t;if(void 0===e&&(e=!1),"undefined"===typeof window)return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var I=Ua(new Ja(this),g,window,e,!1),n=I.head,C=I.body,l=(null===(t=n[0])||void 0===t?void 0:t.map((function(g){return g.content})))||[];return{columns:l,rows:C,data:C}}}(Bo)}}catch(mi){console.error("Could not apply autoTable plugin",mi)}const So=()=>{const[g,e]=(0,I.useState)([]),[t,n]=(0,I.useState)(""),[C,l]=(0,I.useState)([]),[a,o]=(0,I.useState)([]),[i]=(0,I.useState)(.5),[r,c]=(0,I.useState)(0),[s,A]=(0,I.useState)(0),[d,u]=(0,I.useState)(0),[m,h]=(0,I.useState)(!1),[b,Z]=(0,I.useState)(null),[p,G]=(0,I.useState)(""),y=eg();(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat(lI,"/customers"));if(!g.ok)throw new Error("HTTP error! status: ".concat(g.status));const t=await g.json();e(t)}catch(mi){console.error("Error fetching customers:",mi)}})(),(async()=>{try{const g=await fetch("".concat(lI,"/products"));if(!g.ok)throw new Error("HTTP error! status: ".concat(g.status));const e=await g.json();l(e)}catch(mi){console.error("Error fetching products:",mi)}})()}),[]),(0,I.useEffect)((()=>{const g=a.reduce(((g,e)=>{var t;return g+e.quantity*((null===(t=e.product)||void 0===t?void 0:t.unit_price)||0)}),0),e=g*i/100;c(g),A(e),u(g+e)}),[a,i]);const B=(g,e,t)=>{const I=[...a];if("product"===e){const n=C.find((g=>g.id===parseInt(t)));I[g][e]=n||""}else I[g][e]=t;o(I)},S=e=>{var I;const n=new jC;n.setFontSize(16),n.text("Bonnesante Medicals",14,15),n.setFontSize(10),n.text("Head Office: No 17A Isuofia/6B Peace Avenue, Federal Housing TransEkulu",14,22),n.text("Bank Name: MONIEPOINT",14,27),n.text("Account Name: BONNESANTE MEDICALS",14,32),n.text("Account Number: 8259518195",14,37),n.text("Bank Name: Access Bank",14,42),n.text("Account Name: BONNESANTE MEDICALS",14,47),n.text("Account Number: 1379643548",14,52),n.setFontSize(12),n.text("paid"===e?"Payment Receipt":"Invoice",150,15),n.text("Customer: ".concat((null===(I=g.find((g=>g.id===parseInt(t))))||void 0===I?void 0:I.name)||""),14,60),n.text("Date: ".concat((new Date).toLocaleDateString()),150,60);const C=a.map(((g,e)=>{var t,I,n,C;return[e+1,(null===(t=g.product)||void 0===t?void 0:t.name)||"",g.quantity,(null===(I=g.product)||void 0===I||null===(n=I.unit_price)||void 0===n?void 0:n.toFixed(2))||"0.00",((g.quantity||0)*((null===(C=g.product)||void 0===C?void 0:C.unit_price)||0)).toFixed(2)]}));!function(g,e){ro(g,Co(g,Ta(g,e)))}(n,{head:[["#","Product","Qty","Unit Price","Total"]],body:C,startY:70});let l=n.lastAutoTable?n.lastAutoTable.finalY:70+10*C.length;n.text("Subtotal: \u20a6".concat(r.toFixed(2)),150,l+10),n.text("VAT (".concat(i,"%): \u20a6").concat(s.toFixed(2)),150,l+16),n.text("Total: \u20a6".concat(d.toFixed(2)),150,l+22),"paid"===e&&(n.setFontSize(14),n.setTextColor(0,128,0),n.text("PAID",150,l+32)),Z(n),G("paid"===e?"receipt":"invoice"),h(!0)},f=async e=>{await(async e=>{var I;const n=new Date,C={invoice_number:"INV-".concat(n.getFullYear()).concat(String(n.getMonth()+1).padStart(2,"0")).concat(String(n.getDate()).padStart(2,"0"),"-").concat(n.getHours()).concat(n.getMinutes()).concat(n.getSeconds()),customer_name:(null===(I=g.find((g=>g.id===parseInt(t))))||void 0===I?void 0:I.name)||"",total_amount:d,vat:s,status:"paid"===e?"paid":"unpaid",items:a.map((g=>{var e,t;return{product_id:null===(e=g.product)||void 0===e?void 0:e.id,quantity:g.quantity,price:null===(t=g.product)||void 0===t?void 0:t.unit_price}})),date:n.toISOString().split("T")[0]};try{const g=await fetch("".concat(lI,"/invoices"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)});if(!g.ok){const e=await g.text();console.error("Failed to save invoice:",e)}}catch(jn){console.error("Error saving invoice:",jn)}})(e),S(e)};return(0,aI.jsxs)("div",{className:"generate-invoice-container",children:[(0,aI.jsx)("h1",{children:"Generate Invoice"}),(0,aI.jsxs)("div",{className:"company-details",children:[(0,aI.jsx)("h2",{children:"Bonnesante Medicals"}),(0,aI.jsx)("p",{children:"Head Office: No 17A Isuofia/6B Peace Avenue, Federal Housing TransEkulu"}),(0,aI.jsx)("p",{children:"Bank Name: MONIEPOINT"}),(0,aI.jsx)("p",{children:"Account Name: BONNESANTE MEDICALS"}),(0,aI.jsx)("p",{children:"Account Number: 8259518195"}),(0,aI.jsx)("p",{children:"Bank Name: Access Bank"}),(0,aI.jsx)("p",{children:"Account Name: BONNESANTE MEDICALS"}),(0,aI.jsx)("p",{children:"Account Number: 1379643548"})]}),(0,aI.jsxs)("form",{onSubmit:g=>g.preventDefault(),children:[(0,aI.jsxs)("label",{children:["Customer:",(0,aI.jsxs)("select",{value:t,onChange:g=>n(g.target.value),required:!0,children:[(0,aI.jsx)("option",{value:"",children:"Select a customer"}),g.map((g=>(0,aI.jsx)("option",{value:g.id,children:g.name},g.id)))]})]}),(0,aI.jsx)("p",{children:(0,aI.jsx)("a",{href:"#",onClick:()=>y("/register-customer"),children:"Register a new customer"})}),(0,aI.jsxs)("div",{className:"product-list",children:[a.map(((g,e)=>{var t;return(0,aI.jsxs)("div",{className:"product-item",children:[(0,aI.jsxs)("select",{value:(null===(t=g.product)||void 0===t?void 0:t.id)||"",onChange:g=>B(e,"product",g.target.value),children:[(0,aI.jsx)("option",{value:"",children:"Select Product"}),C.map((g=>(0,aI.jsx)("option",{value:g.id,children:g.name},g.id)))]}),(0,aI.jsx)("input",{type:"number",value:g.quantity,onChange:g=>B(e,"quantity",parseInt(g.target.value)||0),placeholder:"Quantity"})]},e)})),(0,aI.jsx)("button",{type:"button",onClick:()=>{o([...a,{product:"",quantity:0}])},children:"Add Product"})]}),(0,aI.jsxs)("p",{children:["Subtotal: \u20a6",r.toFixed(2)]}),(0,aI.jsxs)("p",{children:["VAT (",i,"%): \u20a6",s.toFixed(2)]}),(0,aI.jsx)("p",{children:(0,aI.jsxs)("b",{children:["Total Amount: \u20a6",d.toFixed(2)]})}),(0,aI.jsx)("button",{type:"button",onClick:()=>f("unpaid"),children:"Submit as Unpaid (Generate Invoice PDF)"}),(0,aI.jsx)("button",{type:"button",onClick:()=>f("paid"),children:"Submit as Paid (Generate Payment Receipt PDF)"})]}),m&&(0,aI.jsxs)("div",{className:"pdf-download-modal",children:[(0,aI.jsxs)("p",{children:["receipt"===p?"Payment receipt":"Invoice"," generated!"]}),(0,aI.jsx)("button",{onClick:()=>{if(b){var e,I;const n=(null===(e=g.find((g=>g.id===parseInt(t))))||void 0===e||null===(I=e.name)||void 0===I?void 0:I.replace(/\s+/g,"_"))||"customer",C=(new Date).toISOString().split("T")[0],l="".concat("receipt"===p?"payment_receipt":"invoice","_").concat(n,"_").concat(C,".pdf");b.save(l),h(!1)}},children:"Download PDF"})]})]})},fo=()=>{const[g,e]=(0,I.useState)([]);(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("http://localhost:8000/api/v1/invoices");if(!g.ok)throw new Error("HTTP error! status: ".concat(g.status));const t=await g.json();e(t)}catch(mi){console.error("Error fetching invoices:",mi)}})()}),[]);return(0,aI.jsxs)("div",{className:"sales-summary-container",children:[(0,aI.jsx)("h1",{children:"Sales Summary"}),(0,aI.jsxs)("table",{className:"sales-summary-table",children:[(0,aI.jsx)("thead",{children:(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("th",{children:"Transaction ID"}),(0,aI.jsx)("th",{children:"Customer Name"}),(0,aI.jsx)("th",{children:"Total Amount"}),(0,aI.jsx)("th",{children:"Status"}),(0,aI.jsx)("th",{children:"Action"})]})}),(0,aI.jsx)("tbody",{children:g.map((g=>(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("td",{children:g.id}),(0,aI.jsx)("td",{children:g.customer_name}),(0,aI.jsx)("td",{children:g.total_amount}),(0,aI.jsx)("td",{children:g.status}),(0,aI.jsx)("td",{children:(0,aI.jsx)("button",{onClick:()=>(g=>{const e="Dear ".concat(g.customer_name,",\n\nThis is a reminder to complete the payment for the following transaction:\n\nTransaction ID: ").concat(g.id,"\nTotal Amount: ").concat(g.total_amount,"\nStatus: ").concat(g.status,"\n\nCompany Name: Bonnesante Medicals\nBank Name: MONIEPOINT\nAccount Name: BONNESANTE MEDICALS\nAccount Number: 8259518195\n\nBank Name: Access Bank\nAccount Name: BONNESANTE MEDICALS\nAccount Number: 1379643548\n\nThank you.");console.log("Sending reminder:",e)})(g),children:"Send Reminder"})})]},g.id)))})]})]})},Wo=()=>{const[g,e]=(0,I.useState)([]);(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat(lI,"/customer-performance"));if(!g.ok)throw new Error("HTTP error! status: ".concat(g.status));const t=await g.json();e(t)}catch(mi){console.error("Error fetching customer performance:",mi)}})()}),[]);return(0,aI.jsxs)("div",{className:"customer-performance-container",children:[(0,aI.jsx)("h1",{children:"Customer Performance"}),(0,aI.jsxs)("table",{className:"customer-performance-table",children:[(0,aI.jsx)("thead",{children:(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("th",{children:"Customer Name"}),(0,aI.jsx)("th",{children:"Total Transactions"}),(0,aI.jsx)("th",{children:"Total Amount"}),(0,aI.jsx)("th",{children:"Feedback"})]})}),(0,aI.jsx)("tbody",{children:g.map((g=>{return(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("td",{children:g.name}),(0,aI.jsx)("td",{children:g.totalTransactions}),(0,aI.jsx)("td",{children:g.totalAmount}),(0,aI.jsx)("td",{children:(e=g.totalAmount,e>1e4?"Thank you for being a top customer! We appreciate your loyalty.":e>5e3?"We value your patronage! Keep shopping with us.":"Thank you for your business! We look forward to serving you again.")})]},g.id);var e}))})]})]})},Vo=()=>{const g=eg();return(0,aI.jsxs)("div",{className:"sales-inventory-container",children:[(0,aI.jsx)("h1",{children:"Sales Inventory"}),(0,aI.jsxs)("div",{className:"sales-inventory-buttons",children:[(0,aI.jsx)("button",{onClick:()=>g("/product-stock-intake"),children:"Product Stock Intake"}),(0,aI.jsx)("button",{onClick:()=>{console.log("Navigating to /product-stock-level"),g("/product-stock-level")},children:"Product Stock Level"}),(0,aI.jsx)("button",{onClick:()=>g("/generate-invoice"),children:"Generate Invoice"}),(0,aI.jsx)("button",{onClick:()=>g("/sales-summary"),children:"Sales Summary"}),(0,aI.jsx)("button",{onClick:()=>g("/customer-performance"),children:"Customer Performance"})]})]})},vo=()=>{const[g,e]=(0,I.useState)([]);return(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat(lI,"/database-table")),t=await g.json();e(t)}catch(mi){console.error("Error fetching data:",mi)}})()}),[]),(0,aI.jsxs)("div",{className:"database-table-container",children:[(0,aI.jsx)("h1",{children:"Database Table"}),(0,aI.jsxs)("table",{className:"database-table",children:[(0,aI.jsx)("thead",{children:(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("th",{children:"ID"}),(0,aI.jsx)("th",{children:"Name"}),(0,aI.jsx)("th",{children:"Details"})]})}),(0,aI.jsx)("tbody",{children:g.map((g=>(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("td",{children:g.id}),(0,aI.jsx)("td",{children:g.name}),(0,aI.jsx)("td",{children:g.details})]},g.id)))})]})]})},Ro=()=>{const g=eg();return(0,aI.jsxs)("div",{className:"production-inventory-container",children:[(0,aI.jsx)("h1",{children:"Production Inventory"}),(0,aI.jsxs)("div",{className:"button-group",children:[(0,aI.jsx)("button",{onClick:()=>g("/raw-material-stock-intake"),children:"Raw Material Stock Intake"}),(0,aI.jsx)("button",{onClick:()=>g("/raw-material-stock-level"),children:"Raw Material Stock Level"}),(0,aI.jsx)("button",{onClick:()=>g("/register-production-requirement"),children:"Production Requirement"}),(0,aI.jsx)("button",{onClick:()=>g("/production-console"),children:"Production Console"}),(0,aI.jsx)("button",{onClick:()=>g("/production-output"),children:"Production Output"}),(0,aI.jsx)("button",{onClick:()=>g("/production-analysis"),children:"Production Analysis"})]})]})},Xo="https://astrobsm-oracle-backend.onrender.com/api/v1",ko=()=>{const[g,e]=(0,I.useState)([]),[t,n]=(0,I.useState)([]),[C,l]=(0,I.useState)([]),[a,o]=(0,I.useState)([]),[i,r]=(0,I.useState)({rawMaterialId:"",quantity:"",supplier:"",expiryDate:"",dateOfIntake:"",intakeStaff:""}),[c,s]=(0,I.useState)(""),[A,d]=(0,I.useState)(!1);(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat(Xo,"/inventory/raw-materials")),t=await fetch("".concat(Xo,"/suppliers")),I=await fetch("".concat(Xo,"/staff")),C=await fetch("".concat(Xo,"/inventory/products"));if(!g.ok||!t.ok||!I.ok||!C.ok)throw new Error("Failed to fetch data");e(await g.json()),n(await t.json()),l(await I.json()),o(await C.json())}catch(mi){console.error("Error fetching data:",mi)}})()}),[]);const u=g=>{const{name:e,value:t}=g.target;r(wg(wg({},i),{},{[e]:t}))};return(0,aI.jsxs)("div",{className:"raw-material-stock-intake-container",children:[(0,aI.jsx)("h1",{children:"Raw Material Stock Intake"}),(0,aI.jsxs)("form",{onSubmit:async g=>{g.preventDefault(),d(!0),s("");try{const g=await fetch("".concat(Xo,"/raw-material-stock-intake"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});let t;try{t=await g.json()}catch(e){t={}}if(g.ok)s("Raw material stock intake recorded successfully!"),r({rawMaterialId:"",quantity:"",supplier:"",expiryDate:"",dateOfIntake:"",intakeStaff:""});else{let g="Failed to record raw material stock intake.";t.detail&&("string"===typeof t.detail?g=t.detail:Array.isArray(t.detail)?g=t.detail.map((g=>g.msg||JSON.stringify(g))).join("; "):"object"===typeof t.detail&&(g=JSON.stringify(t.detail))),s(g)}}catch(mi){s("An error occurred. Please try again.")}finally{d(!1)}},children:[(0,aI.jsxs)("label",{children:["Raw Material ID:",(0,aI.jsxs)("select",{name:"rawMaterialId",value:i.rawMaterialId,onChange:u,required:!0,children:[(0,aI.jsx)("option",{value:"",children:"Select Raw Material"}),g.map((g=>(0,aI.jsx)("option",{value:g.id,children:g.name},g.id)))]})]}),(0,aI.jsxs)("label",{children:["Quantity:",(0,aI.jsx)("input",{type:"number",name:"quantity",value:i.quantity,onChange:u,required:!0})]}),(0,aI.jsxs)("label",{children:["Supplier:",(0,aI.jsxs)("select",{name:"supplier",value:i.supplier,onChange:u,required:!0,children:[(0,aI.jsx)("option",{value:"",children:"Select Supplier"}),t.map((g=>(0,aI.jsx)("option",{value:g.id,children:g.name},g.id)))]})]}),(0,aI.jsxs)("label",{children:["Expiry Date:",(0,aI.jsx)("input",{type:"date",name:"expiryDate",value:i.expiryDate,onChange:u,required:!0})]}),(0,aI.jsxs)("label",{children:["Date of Intake:",(0,aI.jsx)("input",{type:"date",name:"dateOfIntake",value:i.dateOfIntake,onChange:u,required:!0})]}),(0,aI.jsxs)("label",{children:["Intake Staff:",(0,aI.jsxs)("select",{name:"intakeStaff",value:i.intakeStaff,onChange:u,required:!0,children:[(0,aI.jsx)("option",{value:"",children:"Select Staff"}),C.map((g=>(0,aI.jsx)("option",{value:g.id,children:g.name},g.id)))]})]}),(0,aI.jsx)("button",{type:"submit",disabled:A,children:A?"Submitting...":"Submit"})]}),c&&(0,aI.jsx)("div",{className:c.includes("success")?"success":"error",style:{marginTop:"1rem"},children:c})]})},Jo=()=>{const[g,e]=(0,I.useState)([]);return(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat("https://astrobsm-oracle-backend.onrender.com/api/v1","/raw-material-stock-level"));if(!g.ok)throw new Error("Failed to fetch raw material stock levels");const t=await g.json();e(t)}catch(mi){console.error("Error fetching raw material stock levels:",mi)}})()}),[]),(0,aI.jsxs)("div",{className:"raw-material-stock-level-container",children:[(0,aI.jsx)("h1",{children:"Raw Material Stock Level"}),(0,aI.jsxs)("table",{className:"raw-material-stock-level-table",children:[(0,aI.jsx)("thead",{children:(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("th",{children:"Raw Material"}),(0,aI.jsx)("th",{children:"Quantity"}),(0,aI.jsx)("th",{children:"Reorder Point"})]})}),(0,aI.jsx)("tbody",{children:g.map((g=>(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("td",{children:g.name}),(0,aI.jsx)("td",{children:g.quantity}),(0,aI.jsx)("td",{children:g.reorderPoint})]},g.id)))})]})]})},Yo="https://astrobsm-oracle-backend.onrender.com/api/v1",wo=g=>{let{onEdit:e}=g;const[t,n]=(0,I.useState)([]),[C,l]=(0,I.useState)([]),[a,o]=(0,I.useState)([]),[i,r]=(0,I.useState)(!0),[c,s]=(0,I.useState)("");(0,I.useEffect)((()=>{(async()=>{r(!0);try{const[g,e,t]=await Promise.all([fetch("".concat(Yo,"/production-requirements")),fetch("".concat(Yo,"/inventory/products")),fetch("".concat(Yo,"/inventory/raw-materials"))]);if(!g.ok)throw new Error("Failed to fetch requirements: "+g.status);if(!e.ok)throw new Error("Failed to fetch products: "+e.status);if(!t.ok)throw new Error("Failed to fetch raw materials: "+t.status);n(await g.json()),l(await e.json()),o(await t.json())}catch(jn){s("Could not load production requirements. "+jn)}finally{r(!1)}})()}),[]);const A=g=>{const e=C.find((e=>String(e.id)===String(g)));return e?e.name:g},d=g=>{const e=a.find((e=>String(e.id)===String(g)));return e?e.name:g};return i?(0,aI.jsx)("div",{children:"Loading..."}):c?(0,aI.jsx)("div",{className:"error",children:c}):(0,aI.jsxs)("div",{className:"production-requirements-list",children:[(0,aI.jsx)("h2",{children:"Production Requirements List"}),(0,aI.jsxs)("table",{children:[(0,aI.jsx)("thead",{children:(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("th",{children:"ID"}),(0,aI.jsx)("th",{children:"Product"}),(0,aI.jsx)("th",{children:"Raw Materials"}),(0,aI.jsx)("th",{children:"Actions"})]})}),(0,aI.jsx)("tbody",{children:t.map((g=>(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("td",{children:g.id}),(0,aI.jsx)("td",{children:A(g.productId)}),(0,aI.jsx)("td",{children:g.requirements.map(((g,e)=>(0,aI.jsxs)("div",{children:[d(g.rawMaterialId)," (Qty: ",g.quantity,")"]},e)))}),(0,aI.jsxs)("td",{children:[(0,aI.jsx)("button",{onClick:()=>e(g),children:"Edit"}),(0,aI.jsx)("button",{onClick:()=>(async g=>{if(window.confirm("Delete this production requirement?"))try{if(!(await fetch("".concat(Yo,"/production-requirements/").concat(g),{method:"DELETE"})).ok)throw new Error("Delete failed");n(t.filter((e=>e.id!==g)))}catch(jn){s("Delete failed.")}})(g.id),children:"Delete"})]})]},g.id)))})]})]})},No="https://astrobsm-oracle-backend.onrender.com/api/v1",Ho=()=>{const[g,e]=(0,I.useState)([]),[t,n]=(0,I.useState)([]),[C,l]=(0,I.useState)(""),[a,o]=(0,I.useState)([]),[i,r]=(0,I.useState)(""),[c,s]=(0,I.useState)(!1),[A,d]=(0,I.useState)(!1),[u,m]=(0,I.useState)(null);(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat(No,"/inventory/products")),t=await fetch("".concat(No,"/inventory/raw-materials"));if(!g.ok||!t.ok)throw new Error("Failed to fetch data");e(await g.json()),n(await t.json())}catch(mi){console.error("Error fetching data:",mi)}})()}),[]);const h=(g,e,t)=>{const I=[...a];I[g][e]=t,o(I)};return(0,aI.jsxs)("div",{className:"register-production-requirement-container",children:[(0,aI.jsx)("h1",{children:"Register Production Requirement"}),A?(0,aI.jsx)(wo,{onEdit:g=>{m(g),d(!1),l(g.productId),o(g.requirements)}}):(0,aI.jsxs)("form",{onSubmit:async g=>{g.preventDefault(),s(!0),r("");try{const g=await fetch("".concat(No,"/production-requirements"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:C,requirements:a})});let t;try{t=await g.json()}catch(e){t={}}if(g.ok)r("Production requirements registered successfully!"),l(""),o([]);else{let g="Failed to register production requirements. Please try again.";t.detail&&("string"===typeof t.detail?g=t.detail:Array.isArray(t.detail)?g=t.detail.map((g=>g.msg||JSON.stringify(g))).join("; "):"object"===typeof t.detail&&(g=JSON.stringify(t.detail))),r(g)}}catch(mi){r("An error occurred. Please try again.")}finally{s(!1)}},children:[(0,aI.jsxs)("label",{children:["Product:",(0,aI.jsxs)("select",{value:C,onChange:g=>l(g.target.value),required:!0,children:[(0,aI.jsx)("option",{value:"",children:"Select a product"}),g.map((g=>(0,aI.jsx)("option",{value:g.id,children:g.name},g.id)))]})]}),(0,aI.jsxs)("div",{className:"requirements-list",children:[a.map(((g,e)=>(0,aI.jsxs)("div",{className:"requirement-item",children:[(0,aI.jsxs)("select",{value:g.rawMaterialId,onChange:g=>h(e,"rawMaterialId",g.target.value),required:!0,children:[(0,aI.jsx)("option",{value:"",children:"Select Raw Material"}),t.map((g=>(0,aI.jsx)("option",{value:g.id,children:g.name},g.id)))]}),(0,aI.jsx)("input",{type:"number",value:g.quantity,onChange:g=>h(e,"quantity",g.target.value),placeholder:"Quantity per unit",required:!0})]},e))),(0,aI.jsx)("button",{type:"button",onClick:()=>{o([...a,{rawMaterialId:"",quantity:""}])},children:"Add Requirement"})]}),(0,aI.jsx)("button",{type:"submit",disabled:c,children:c?"Submitting...":"Submit"})]}),i&&(0,aI.jsx)("div",{className:i.includes("success")?"success":"error",style:{marginTop:"1rem"},children:i}),(0,aI.jsx)("button",{onClick:()=>d(!A),children:A?"Back to Form":"View Production Requirements"})]})},Fo="https://astrobsm-oracle-backend.onrender.com/api/v1",Ko=()=>{const[g,e]=(0,I.useState)([]),[t,n]=(0,I.useState)(""),[C,l]=(0,I.useState)(0),[a,o]=(0,I.useState)([]);(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat(Fo,"/products"));if(!g.ok)throw new Error("Failed to fetch products");e(await g.json())}catch(mi){console.error("Error fetching products:",mi)}})()}),[]);return(0,aI.jsxs)("div",{className:"production-console-container",children:[(0,aI.jsx)("h1",{children:"Production Console"}),(0,aI.jsxs)("form",{onSubmit:g=>{g.preventDefault(),(async()=>{try{const g=await fetch("".concat(Fo,"/production-requirements/").concat(t));if(!g.ok)throw new Error("Failed to fetch production requirements");const e=(await g.json()).map((g=>({rawMaterial:g.rawMaterial,quantityNeeded:g.quantity_per_unit*C})));o(e)}catch(mi){console.error("Error calculating materials:",mi)}})()},children:[(0,aI.jsxs)("label",{children:["Product:",(0,aI.jsxs)("select",{value:t,onChange:g=>n(g.target.value),required:!0,children:[(0,aI.jsx)("option",{value:"",children:"Select a product"}),g.map((g=>(0,aI.jsx)("option",{value:g.id,children:g.name},g.id)))]})]}),(0,aI.jsxs)("label",{children:["Quantity to Produce:",(0,aI.jsx)("input",{type:"number",value:C,onChange:g=>l(g.target.value),required:!0})]}),(0,aI.jsx)("button",{type:"submit",children:"Calculate Materials"})]}),a.length>0&&(0,aI.jsxs)("div",{className:"required-materials",children:[(0,aI.jsx)("h2",{children:"Required Materials"}),(0,aI.jsx)("ul",{children:a.map(((g,e)=>(0,aI.jsxs)("li",{children:[g.rawMaterial.name,": ",g.quantityNeeded]},e)))}),(0,aI.jsx)("button",{onClick:async()=>{try{if(!(await fetch("".concat(Fo,"/approve-production"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:t,quantity:C})})).ok)throw new Error("Failed to approve production");alert("Production approved and exported as PDF!")}catch(mi){console.error("Error approving production:",mi),alert("Failed to approve production. Please try again.")}},children:"Approve and Export as PDF"})]})]})},xo="https://astrobsm-oracle-backend.onrender.com/api/v1",Lo=()=>{const[g,e]=(0,I.useState)([]),[t,n]=(0,I.useState)([]),[C,l]=(0,I.useState)(""),[a,o]=(0,I.useState)(0),[i,r]=(0,I.useState)(0),[c,s]=(0,I.useState)(0),[A,d]=(0,I.useState)([]),[u,m]=(0,I.useState)(""),[h,b]=(0,I.useState)(!1);(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat(xo,"/products")),t=await fetch("".concat(xo,"/staff"));if(!g.ok||!t.ok)throw new Error("Failed to fetch data");e(await g.json()),n(await t.json())}catch(mi){console.error("Error fetching data:",mi)}})()}),[]);const Z=()=>{const g=a+i;s(g>0?(a/g*100).toFixed(2):0)};return(0,aI.jsxs)("div",{className:"production-output-container",children:[(0,aI.jsx)("h1",{children:"Production Output"}),(0,aI.jsxs)("form",{onSubmit:async g=>{g.preventDefault(),b(!0),m("");try{const g=await fetch("".concat(xo,"/production-output"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:C,goodProducts:a,damagedProducts:i,efficiency:c,participatingStaff:A})});let t;try{t=await g.json()}catch(e){t={}}if(g.ok)m("Production output recorded successfully!"),l(""),o(0),r(0),s(0),d([]);else{let g="Failed to record production output.";t.detail&&("string"===typeof t.detail?g=t.detail:Array.isArray(t.detail)?g=t.detail.map((g=>g.msg||JSON.stringify(g))).join("; "):"object"===typeof t.detail&&(g=JSON.stringify(t.detail))),m(g)}}catch(mi){m("An error occurred. Please try again.")}finally{b(!1)}},children:[(0,aI.jsxs)("label",{children:["Product:",(0,aI.jsxs)("select",{value:C,onChange:g=>l(g.target.value),required:!0,children:[(0,aI.jsx)("option",{value:"",children:"Select a product"}),g.map((g=>(0,aI.jsx)("option",{value:g.id,children:g.name},g.id)))]})]}),(0,aI.jsxs)("label",{children:["Good Products:",(0,aI.jsx)("input",{type:"number",value:a,onChange:g=>o(g.target.value),onBlur:Z,required:!0})]}),(0,aI.jsxs)("label",{children:["Damaged Products:",(0,aI.jsx)("input",{type:"number",value:i,onChange:g=>r(g.target.value),onBlur:Z,required:!0})]}),(0,aI.jsxs)("label",{children:["Efficiency: ",c,"%"]}),(0,aI.jsxs)("label",{children:["Participating Staff:",(0,aI.jsx)("select",{multiple:!0,value:A,onChange:g=>d([...g.target.selectedOptions].map((g=>g.value))),children:t.map((g=>(0,aI.jsx)("option",{value:g.id,children:g.name},g.id)))})]}),(0,aI.jsx)("button",{type:"submit",disabled:h,children:h?"Submitting...":"Submit"})]}),u&&(0,aI.jsx)("div",{className:u.includes("success")?"success":"error",style:{marginTop:"1rem"},children:u})]})},zo=()=>{const[g,e]=(0,I.useState)([]);return(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat("https://astrobsm-oracle-backend.onrender.com/api/v1","/production-analysis"));if(!g.ok)throw new Error("Failed to fetch production data");e(await g.json())}catch(mi){console.error("Error fetching production data:",mi)}})()}),[]),(0,aI.jsxs)("div",{className:"production-analysis-container",children:[(0,aI.jsx)("h1",{children:"Production Analysis"}),(0,aI.jsxs)("table",{children:[(0,aI.jsx)("thead",{children:(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("th",{children:"Date"}),(0,aI.jsx)("th",{children:"Product"}),(0,aI.jsx)("th",{children:"Good Products"}),(0,aI.jsx)("th",{children:"Damaged Products"}),(0,aI.jsx)("th",{children:"Efficiency (%)"})]})}),(0,aI.jsx)("tbody",{children:g.map(((g,e)=>(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("td",{children:g.date}),(0,aI.jsx)("td",{children:g.productName}),(0,aI.jsx)("td",{children:g.goodProducts}),(0,aI.jsx)("td",{children:g.damagedProducts}),(0,aI.jsx)("td",{children:g.efficiency})]},e)))})]})]})},Eo=()=>{const[g,e]=(0,I.useState)({deviceName:"",serialNumber:"",quantity:0,functions:[],dateOfIntake:"",cost:0,staffId:"",usefulLife:0,depreciationRate:0}),[t,n]=(0,I.useState)([]),[C,l]=(0,I.useState)([]);(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat(lI,"/staff")),e=await g.json();console.log("Fetched staff:",e),n(Array.isArray(e)?e:[])}catch(mi){console.error("Error fetching staff:",mi),n([])}})(),(async()=>{try{const g=await fetch("".concat(lI,"/products")),e=await g.json();console.log("Fetched products:",e),l(Array.isArray(e)?e:[])}catch(mi){console.error("Error fetching products:",mi),l([])}})()}),[]);const a=t=>{const{name:I,value:n}=t.target;e(wg(wg({},g),{},{[I]:n}))};return(0,aI.jsxs)("div",{className:"device-intake-container",children:[(0,aI.jsx)("h1",{children:"Device Intake"}),(0,aI.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=await fetch("".concat(lI,"/device-intake"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)}),t=await e.json();alert(t.message||"Device intake recorded successfully!")}catch(mi){alert("An error occurred. Please try again.")}},className:"device-intake-form",children:[(0,aI.jsxs)("label",{children:["Device Name:",(0,aI.jsx)("input",{type:"text",name:"deviceName",value:g.deviceName,onChange:a,required:!0})]}),(0,aI.jsxs)("label",{children:["Serial Number (Auto-generated):",(0,aI.jsx)("input",{type:"text",name:"serialNumber",value:g.serialNumber,readOnly:!0})]}),(0,aI.jsxs)("label",{children:["Quantity:",(0,aI.jsx)("input",{type:"number",name:"quantity",value:g.quantity,onChange:a,required:!0})]}),(0,aI.jsxs)("label",{children:["Functions:",(0,aI.jsx)("select",{name:"functions",value:g.functions,onChange:a,multiple:!0,children:C.map((g=>(0,aI.jsx)("option",{value:g.name,children:g.name},g.id)))})]}),(0,aI.jsxs)("label",{children:["Date of Intake:",(0,aI.jsx)("input",{type:"date",name:"dateOfIntake",value:g.dateOfIntake,onChange:a,required:!0})]}),(0,aI.jsxs)("label",{children:["Cost of Machine:",(0,aI.jsx)("input",{type:"number",name:"cost",value:g.cost,onChange:a,required:!0})]}),(0,aI.jsxs)("label",{children:["Select Staff:",(0,aI.jsx)("select",{name:"staffId",value:g.staffId,onChange:a,required:!0,children:t.map((g=>(0,aI.jsx)("option",{value:g.id,children:g.name},g.id)))})]}),(0,aI.jsxs)("label",{children:["Useful Life (years):",(0,aI.jsx)("input",{type:"number",name:"usefulLife",value:g.usefulLife,onChange:a,required:!0})]}),(0,aI.jsxs)("label",{children:["Depreciation Rate (%):",(0,aI.jsx)("input",{type:"number",name:"depreciationRate",value:g.depreciationRate,onChange:a,required:!0})]}),(0,aI.jsx)("button",{type:"submit",children:"Submit"})]})]})},Mo=()=>{const[g,e]=(0,I.useState)([]);return(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat(lI,"/products")),t=await g.json();e(t)}catch(mi){console.error("Error fetching devices:",mi)}})()}),[]),(0,aI.jsxs)("div",{className:"device-list-container",children:[(0,aI.jsx)("h1",{children:"Device List"}),(0,aI.jsx)("button",{className:"awesome-button",children:"View All Devices"}),(0,aI.jsx)("ul",{children:g.map((g=>(0,aI.jsx)("li",{children:g.name},g.id)))})]})},Uo=()=>{const[g,e]=(0,I.useState)([]),[t,n]=(0,I.useState)({deviceId:"",date:"",technicianName:"",findings:"",nextMaintenanceDate:""});(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat(lI,"/devices")),t=await g.json();e(Array.isArray(t)?t:[])}catch(mi){console.error("Error fetching devices:",mi)}})()}),[]);const C=g=>{const{name:e,value:I}=g.target;n(wg(wg({},t),{},{[e]:I}))};return(0,aI.jsxs)("div",{className:"maintenance-log-container",children:[(0,aI.jsx)("h1",{children:"Device Maintenance Log"}),(0,aI.jsxs)("form",{onSubmit:async g=>{g.preventDefault();try{const g=await fetch("".concat(lI,"/maintenance-logs"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),e=await g.json();alert(e.message||"Maintenance log recorded successfully!")}catch(mi){alert("An error occurred. Please try again.")}},className:"maintenance-log-form",children:[(0,aI.jsxs)("label",{children:["Select Device:",(0,aI.jsxs)("select",{name:"deviceId",value:t.deviceId,onChange:C,required:!0,children:[(0,aI.jsx)("option",{value:"",children:"-- Select a Device --"}),g.map((g=>(0,aI.jsx)("option",{value:g.id,children:g.deviceName},g.id)))]})]}),(0,aI.jsxs)("label",{children:["Date:",(0,aI.jsx)("input",{type:"date",name:"date",value:t.date,onChange:C,required:!0})]}),(0,aI.jsxs)("label",{children:["Technician Name:",(0,aI.jsx)("input",{type:"text",name:"technicianName",value:t.technicianName,onChange:C,required:!0})]}),(0,aI.jsxs)("label",{children:["Findings:",(0,aI.jsx)("textarea",{name:"findings",value:t.findings,onChange:C,required:!0})]}),(0,aI.jsxs)("label",{children:["Next Maintenance Date:",(0,aI.jsx)("input",{type:"date",name:"nextMaintenanceDate",value:t.nextMaintenanceDate,onChange:C,required:!0})]}),(0,aI.jsx)("button",{type:"submit",className:"submit-button",children:"Submit"})]})]})},jo=()=>{const[g,e]=(0,I.useState)([]),[t,n]=(0,I.useState)({deviceId:"",date:"",faultSeverity:"",actionRequired:""});(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat(lI,"/devices")),t=await g.json();e(Array.isArray(t)?t:[])}catch(mi){console.error("Error fetching devices:",mi)}})()}),[]);const C=g=>{const{name:e,value:I}=g.target;n(wg(wg({},t),{},{[e]:I}))};return(0,aI.jsxs)("div",{className:"fault-reporting-container",children:[(0,aI.jsx)("h1",{children:"Device Fault Reporting"}),(0,aI.jsxs)("form",{onSubmit:async g=>{g.preventDefault();try{const g=await fetch("".concat(lI,"/fault-reports"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),e=await g.json();alert(e.message||"Fault reported successfully!")}catch(mi){alert("An error occurred. Please try again.")}},className:"fault-reporting-form",children:[(0,aI.jsxs)("label",{children:["Select Device:",(0,aI.jsxs)("select",{name:"deviceId",value:t.deviceId,onChange:C,required:!0,children:[(0,aI.jsx)("option",{value:"",children:"-- Select a Device --"}),g.map((g=>(0,aI.jsx)("option",{value:g.id,children:g.deviceName},g.id)))]})]}),(0,aI.jsxs)("label",{children:["Date:",(0,aI.jsx)("input",{type:"date",name:"date",value:t.date,onChange:C,required:!0})]}),(0,aI.jsxs)("label",{children:["Nature of Fault:",(0,aI.jsxs)("select",{name:"faultSeverity",value:t.faultSeverity,onChange:C,required:!0,children:[(0,aI.jsx)("option",{value:"",children:"-- Select Severity --"}),(0,aI.jsx)("option",{value:"Mild",children:"Mild"}),(0,aI.jsx)("option",{value:"Moderate",children:"Moderate"}),(0,aI.jsx)("option",{value:"Severe",children:"Severe"}),(0,aI.jsx)("option",{value:"Critical",children:"Critical"})]})]}),(0,aI.jsxs)("label",{children:["Action Required:",(0,aI.jsx)("textarea",{name:"actionRequired",value:t.actionRequired,onChange:C,required:!0})]}),(0,aI.jsx)("button",{type:"submit",className:"submit-button",children:"Submit"})]})]})},Qo=()=>{const[g,e]=(0,I.useState)([]);(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat(lI,"/devices")),t=await g.json();e(t)}catch(mi){console.error("Error fetching devices:",mi)}})()}),[]);const t=(g,e)=>{const t=new Date(e),I=(new Date-t)/31536e6;return Math.max(0,g-I).toFixed(2)};return(0,aI.jsxs)("div",{className:"device-list-container",children:[(0,aI.jsx)("h1",{children:"Device List"}),(0,aI.jsx)("ul",{className:"device-list",children:g.map((g=>(0,aI.jsxs)("li",{className:"device-item",children:[(0,aI.jsx)("h2",{children:g.deviceName}),(0,aI.jsxs)("p",{children:["Serial Number: ",g.serialNumber]}),(0,aI.jsxs)("p",{children:["Quantity: ",g.quantity]}),(0,aI.jsxs)("p",{children:["Residual Useful Life: ",t(g.usefulLife,g.dateOfIntake)," years"]})]},g.id)))})]})},Do=()=>{const g=eg();return(0,aI.jsxs)("div",{className:"staff-management-container",children:[(0,aI.jsx)("h1",{children:"Staff Management"}),(0,aI.jsxs)("div",{className:"button-group",children:[(0,aI.jsx)("button",{className:"awesome-button",onClick:()=>g("/staff-list"),children:"Staff List"}),(0,aI.jsx)("button",{className:"awesome-button",onClick:()=>g("/salary-calculation"),children:"Salary Calculation"}),(0,aI.jsx)("button",{className:"awesome-button",onClick:()=>g("/staff-appraisal"),children:"Staff Appraisal"})]})]})},To=()=>{const[g,e]=(0,I.useState)([]);return(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat("https://astrobsm-oracle-backend.onrender.com/api/v1","/staff/")),t=await g.json();e(Array.isArray(t)?t:[])}catch(mi){console.error("Error fetching staff:",mi)}})()}),[]),(0,aI.jsxs)("div",{className:"staff-list-container",children:[(0,aI.jsx)("h1",{children:"Staff List"}),(0,aI.jsxs)("table",{className:"staff-table",children:[(0,aI.jsx)("thead",{children:(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("th",{children:"Name"}),(0,aI.jsx)("th",{children:"Staff ID"}),(0,aI.jsx)("th",{children:"Date of Birth"}),(0,aI.jsx)("th",{children:"Gender"}),(0,aI.jsx)("th",{children:"Phone"}),(0,aI.jsx)("th",{children:"Address"}),(0,aI.jsx)("th",{children:"Bank"}),(0,aI.jsx)("th",{children:"Account Number"}),(0,aI.jsx)("th",{children:"Hourly Rate"}),(0,aI.jsx)("th",{children:"Role"}),(0,aI.jsx)("th",{children:"Department"}),(0,aI.jsx)("th",{children:"Appointment Type"})]})}),(0,aI.jsx)("tbody",{children:g.map(((g,e)=>(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("td",{children:g.name}),(0,aI.jsx)("td",{children:g.staff_id}),(0,aI.jsx)("td",{children:g.dob||g.date_of_birth}),(0,aI.jsx)("td",{children:g.gender}),(0,aI.jsx)("td",{children:g.phone}),(0,aI.jsx)("td",{children:g.address}),(0,aI.jsx)("td",{children:g.bank}),(0,aI.jsx)("td",{children:g.account_number}),(0,aI.jsx)("td",{children:g.hourly_rate}),(0,aI.jsx)("td",{children:g.role}),(0,aI.jsx)("td",{children:g.department}),(0,aI.jsx)("td",{children:g.appointment_type})]},g.id||g.staff_id||e)))})]})]})},Po=()=>{const[g,e]=(0,I.useState)([]),[t,n]=(0,I.useState)({staffId:"",salaryRate:"",duration:"",hoursWorked:0,totalSalary:0});(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("http://localhost:8000/api/v1/staff"),t=await g.json();e(Array.isArray(t)?t:[])}catch(mi){console.error("Error fetching staff:",mi)}})()}),[]);const C=g=>{const{name:e,value:I}=g.target;n(wg(wg({},t),{},{[e]:I}))};return(0,aI.jsxs)("div",{className:"salary-calculation-container",children:[(0,aI.jsx)("h1",{children:"Salary Calculation"}),(0,aI.jsxs)("form",{className:"salary-calculation-form",children:[(0,aI.jsxs)("label",{children:["Select Staff:",(0,aI.jsxs)("select",{name:"staffId",value:t.staffId,onChange:C,required:!0,children:[(0,aI.jsx)("option",{value:"",children:"-- Select a Staff --"}),g.map((g=>(0,aI.jsx)("option",{value:g.id,children:g.name},g.id)))]})]}),(0,aI.jsxs)("label",{children:["Salary Rate (per hour):",(0,aI.jsx)("input",{type:"number",name:"salaryRate",value:t.salaryRate,onChange:C,required:!0})]}),(0,aI.jsxs)("label",{children:["Duration:",(0,aI.jsx)("input",{type:"text",name:"duration",value:t.duration,onChange:C,required:!0})]}),(0,aI.jsx)("button",{type:"button",onClick:async()=>{try{const g=await fetch("http://localhost:8000/api/v1/hours-worked/".concat(t.staffId,"?duration=").concat(t.duration)),e=await g.json();n(wg(wg({},t),{},{hoursWorked:e.hoursWorked}))}catch(mi){console.error("Error fetching hours worked:",mi)}},className:"fetch-button",children:"Fetch Hours Worked"}),(0,aI.jsxs)("p",{children:["Hours Worked: ",t.hoursWorked]}),(0,aI.jsx)("button",{type:"button",onClick:()=>{const g=t.hoursWorked*parseFloat(t.salaryRate);n(wg(wg({},t),{},{totalSalary:g}))},className:"calculate-button",children:"Calculate Salary"}),(0,aI.jsxs)("p",{children:["Total Salary: ",t.totalSalary]}),(0,aI.jsx)("button",{type:"button",onClick:()=>{var e;const I=new jC;I.text("Salary Calculation",20,20),I.autoTable({head:[["Staff Name","Hours Worked","Salary Rate","Total Salary"]],body:[[(null===(e=g.find((g=>g.id===t.staffId)))||void 0===e?void 0:e.name)||"",t.hoursWorked,t.salaryRate,t.totalSalary]]}),I.save("salary_calculation.pdf")},className:"export-button",children:"Export to PDF"})]})]})},Oo=()=>{const[g,e]=(0,I.useState)([]),[t,n]=(0,I.useState)(""),[C,l]=(0,I.useState)({participation:0,hoursWorked:0,punctuality:0,performanceScore:0});(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("http://localhost:8000/api/v1/staff"),t=await g.json();e(Array.isArray(t)?t:[])}catch(mi){console.error("Error fetching staff:",mi)}})()}),[]);return(0,aI.jsxs)("div",{className:"staff-appraisal-container",children:[(0,aI.jsx)("h1",{children:"Staff Appraisal"}),(0,aI.jsxs)("form",{className:"staff-appraisal-form",children:[(0,aI.jsxs)("label",{children:["Select Staff:",(0,aI.jsxs)("select",{value:t,onChange:g=>n(g.target.value),required:!0,children:[(0,aI.jsx)("option",{value:"",children:"-- Select a Staff --"}),g.map((g=>(0,aI.jsx)("option",{value:g.id,children:g.name},g.id)))]})]}),(0,aI.jsx)("button",{type:"button",onClick:async()=>{try{const g=await fetch("http://localhost:8000/api/v1/appraisal/".concat(t)),e=await g.json();l(e)}catch(mi){console.error("Error fetching appraisal data:",mi)}},className:"fetch-button",children:"Fetch Appraisal Data"}),(0,aI.jsxs)("div",{className:"appraisal-details",children:[(0,aI.jsxs)("p",{children:["Participation: ",C.participation]}),(0,aI.jsxs)("p",{children:["Hours Worked: ",C.hoursWorked]}),(0,aI.jsxs)("p",{children:["Punctuality: ",C.punctuality]}),(0,aI.jsxs)("p",{children:["Performance Score: ",C.performanceScore]})]}),(0,aI.jsx)("button",{type:"button",onClick:()=>{const g=new jC;g.text("Staff Appraisal",20,20),g.autoTable({head:[["Metric","Value"]],body:[["Participation",C.participation],["Hours Worked",C.hoursWorked],["Punctuality",C.punctuality],["Performance Score",C.performanceScore]]}),g.save("staff_appraisal.pdf")},className:"export-button",children:"Export to PDF"})]})]})},qo=()=>{const[g,e]=(0,I.useState)([]),[t,n]=(0,I.useState)({staffId:"",duration:"",hourlyRate:"",hoursWorked:0,totalSalary:0});(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat(lI,"/staff")),t=await g.json();e(Array.isArray(t)?t:[])}catch(mi){console.error("Error fetching staff:",mi)}})()}),[]);const C=g=>{const{name:e,value:I}=g.target;n(wg(wg({},t),{},{[e]:I}))};return(0,aI.jsxs)("div",{className:"salary-console-container",children:[(0,aI.jsx)("h1",{children:"Salary Console"}),(0,aI.jsxs)("form",{className:"salary-console-form",children:[(0,aI.jsxs)("label",{children:["Select Staff:",(0,aI.jsxs)("select",{name:"staffId",value:t.staffId,onChange:C,required:!0,children:[(0,aI.jsx)("option",{value:"",children:"-- Select a Staff --"}),g.map((g=>(0,aI.jsx)("option",{value:g.id,children:g.name},g.id)))]})]}),(0,aI.jsxs)("label",{children:["Duration:",(0,aI.jsx)("input",{type:"text",name:"duration",value:t.duration,onChange:C,required:!0})]}),(0,aI.jsxs)("label",{children:["Hourly Rate (\u20a6):",(0,aI.jsx)("input",{type:"number",name:"hourlyRate",value:t.hourlyRate,onChange:C,required:!0})]}),(0,aI.jsx)("button",{type:"button",onClick:async()=>{try{const g=await fetch("".concat(lI,"/hours-worked/").concat(t.staffId,"?duration=").concat(t.duration)),e=await g.json();n(wg(wg({},t),{},{hoursWorked:e.hoursWorked}))}catch(mi){console.error("Error fetching hours worked:",mi)}},className:"fetch-button",children:"Fetch Hours Worked"}),(0,aI.jsxs)("p",{children:["Hours Worked: ",t.hoursWorked]}),(0,aI.jsx)("button",{type:"button",onClick:()=>{const g=t.hoursWorked*parseFloat(t.hourlyRate);n(wg(wg({},t),{},{totalSalary:g}))},className:"calculate-button",children:"Calculate Salary"}),(0,aI.jsxs)("p",{children:["Total Salary: \u20a6",t.totalSalary]}),(0,aI.jsx)("button",{type:"button",onClick:()=>{var e;const I=new jC;I.text("Payslip",20,20),I.autoTable({head:[["Field","Value"]],body:[["Staff Name",(null===(e=g.find((g=>g.id===t.staffId)))||void 0===e?void 0:e.name)||""],["Duration",t.duration],["Hourly Rate (\u20a6)",t.hourlyRate],["Hours Worked",t.hoursWorked],["Total Salary (\u20a6)",t.totalSalary]]}),I.save("payslip.pdf")},className:"generate-button",children:"Generate Payslip"})]})]})},_o=()=>{const[g,e]=(0,I.useState)([]);return(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat(lI,"/salary-records")),t=await g.json();e(Array.isArray(t)?t:[])}catch(mi){console.error("Error fetching salary records:",mi)}})()}),[]),(0,aI.jsxs)("div",{className:"salary-records-container",children:[(0,aI.jsx)("h1",{children:"Salary Records"}),(0,aI.jsxs)("table",{className:"salary-records-table",children:[(0,aI.jsx)("thead",{children:(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("th",{children:"Staff ID"}),(0,aI.jsx)("th",{children:"Name"}),(0,aI.jsx)("th",{children:"Month"}),(0,aI.jsx)("th",{children:"Hours Worked"}),(0,aI.jsx)("th",{children:"Hourly Rate"}),(0,aI.jsx)("th",{children:"Total Salary"})]})}),(0,aI.jsx)("tbody",{children:g.map(((g,e)=>(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("td",{children:g.staffId}),(0,aI.jsx)("td",{children:g.name}),(0,aI.jsx)("td",{children:g.month}),(0,aI.jsx)("td",{children:g.hoursWorked}),(0,aI.jsx)("td",{children:g.hourlyRate}),(0,aI.jsx)("td",{children:g.totalSalary})]},e)))})]})]})},$o=()=>{const[g,e]=(0,I.useState)(null),[t,n]=(0,I.useState)(null);return(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat(lI,"/salary-report"));if(!g.ok)throw new Error("Failed to fetch salary report");const t=await g.json();e(t)}catch(jn){n(jn.message)}})()}),[]),t?(0,aI.jsxs)("div",{className:"error",children:["Error: ",t]}):g?(0,aI.jsxs)("div",{className:"salary-report-container",children:[(0,aI.jsx)("h1",{children:"Salary Report"}),(0,aI.jsxs)("table",{className:"salary-report-table",children:[(0,aI.jsx)("thead",{children:(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("th",{children:"Total Salary"}),(0,aI.jsx)("th",{children:"Total Bonus"}),(0,aI.jsx)("th",{children:"Total Deductions"}),(0,aI.jsx)("th",{children:"Total Net Salary"})]})}),(0,aI.jsx)("tbody",{children:(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("td",{children:g.total_salary}),(0,aI.jsx)("td",{children:g.total_bonus}),(0,aI.jsx)("td",{children:g.total_deductions}),(0,aI.jsx)("td",{children:g.total_net_salary})]})})]})]}):(0,aI.jsx)("div",{children:"Loading..."})},gi=()=>{const g=eg();return(0,aI.jsxs)("div",{className:"reports-analysis-container",children:[(0,aI.jsx)("h1",{children:"Reports & Analysis"}),(0,aI.jsxs)("div",{className:"reports-buttons",children:[(0,aI.jsx)("button",{onClick:()=>{console.log("Navigating to Customers Performance"),g("/customers-performance")},className:"reports-button",children:"Customers Performance"}),(0,aI.jsx)("button",{onClick:()=>{console.log("Navigating to Staff Performance"),g("/staff-performance")},className:"reports-button",children:"Staff Performance"})]})]})},ei=()=>{const[g,e]=(0,I.useState)([]),[t,n]=(0,I.useState)(null);return(0,I.useEffect)((()=>{(async()=>{try{console.log("Fetching customers performance data...");const g=await fetch("".concat(lI,"/customer-performance/"));if(console.log("Response status:",g.status),!g.ok)throw new Error("Failed to fetch customers performance");const t=await g.json();console.log("Fetched data:",t),e(t)}catch(jn){console.error("Error fetching customers performance:",jn),n(jn.message)}})()}),[]),t?(0,aI.jsxs)("div",{className:"error",children:["Error: ",t]}):(0,aI.jsxs)("div",{className:"customers-performance-container",children:[(0,aI.jsx)("h1",{children:"Customers Performance"}),(0,aI.jsxs)("table",{className:"customers-performance-table",children:[(0,aI.jsx)("thead",{children:(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("th",{children:"Customer Name"}),(0,aI.jsx)("th",{children:"Transactions"}),(0,aI.jsx)("th",{children:"Percentage Contribution"})]})}),(0,aI.jsx)("tbody",{children:g.map((g=>(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("td",{children:g.name}),(0,aI.jsx)("td",{children:g.transactions}),(0,aI.jsxs)("td",{children:[g.percentage_contribution,"%"]})]},g.id)))})]})]})},ti=()=>{const[g,e]=(0,I.useState)([]),[t,n]=(0,I.useState)(null);return(0,I.useEffect)((()=>{(async()=>{try{console.log("Fetching staff performance data...");const g=await fetch("".concat(lI,"/staff-performance"));if(console.log("Response status:",g.status),!g.ok)throw new Error("Failed to fetch staff performance");const t=await g.json();console.log("Fetched data:",t),e(t)}catch(jn){console.error("Error fetching staff performance:",jn),n(jn.message)}})()}),[]),t?(0,aI.jsxs)("div",{className:"error",children:["Error: ",t]}):(0,aI.jsxs)("div",{className:"staff-performance-container",children:[(0,aI.jsx)("h1",{children:"Staff Performance"}),(0,aI.jsxs)("table",{className:"staff-performance-table",children:[(0,aI.jsx)("thead",{children:(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("th",{children:"Staff Name"}),(0,aI.jsx)("th",{children:"Attendance Records"}),(0,aI.jsx)("th",{children:"Production Participation"})]})}),(0,aI.jsx)("tbody",{children:g.map((g=>(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("td",{children:g.name}),(0,aI.jsx)("td",{children:g.attendance_records}),(0,aI.jsx)("td",{children:g.production_participation})]},g.id)))})]})]})},Ii=()=>{const[g,e]=(0,I.useState)({appName:"",theme:""}),[t,n]=(0,I.useState)(""),[C,l]=(0,I.useState)(null),[a,o]=(0,I.useState)("");(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("http://localhost:8000/api/v1/settings"),t=await g.json();e(t)}catch(mi){console.error("Error fetching settings:",mi)}})()}),[]);return(0,aI.jsxs)("div",{className:"settings-container",children:[(0,aI.jsx)("h1",{children:"Settings"}),(0,aI.jsxs)("div",{className:"settings-buttons",children:[(0,aI.jsx)("button",{onClick:()=>alert("Change Background Image"),children:"Change Background Image"}),(0,aI.jsx)("button",{onClick:()=>alert("Select Fonts"),children:"Select Fonts"}),(0,aI.jsx)("button",{onClick:()=>alert("Themes"),children:"Themes"}),(0,aI.jsxs)("div",{children:[(0,aI.jsx)("label",{htmlFor:"page-select",children:"Select Page:"}),(0,aI.jsxs)("select",{id:"page-select",value:t,onChange:g=>{n(g.target.value)},children:[(0,aI.jsx)("option",{value:"",children:"--Select a Page--"}),[{path:"/dashboard",name:"Dashboard"},{path:"/registration",name:"Registration"},{path:"/inventory",name:"Inventory"},{path:"/payroll",name:"Payroll"},{path:"/attendance",name:"Attendance"},{path:"/factory-inventory",name:"Factory Inventory"},{path:"/login",name:"Login"},{path:"/stock-intake",name:"Stock Intake"},{path:"/stock-level",name:"Stock Level"},{path:"/grant-access",name:"Grant Access"},{path:"/timed-attendance",name:"Timed Attendance"},{path:"/attendance-record",name:"Attendance Record"},{path:"/attendance-analysis",name:"Attendance Analysis"},{path:"/product-stock-intake",name:"Product Stock Intake"},{path:"/product-stock-level",name:"Product Stock Level"},{path:"/generate-invoice",name:"Generate Invoice"},{path:"/sales-summary",name:"Sales Summary"},{path:"/customer-performance",name:"Customer Performance"},{path:"/sales-inventory",name:"Sales Inventory"},{path:"/database-table",name:"Database Table"},{path:"/register-customer",name:"Register Customer"}].map((g=>(0,aI.jsx)("option",{value:g.path,children:g.name},g.path)))]})]}),(0,aI.jsxs)("div",{children:[(0,aI.jsx)("label",{htmlFor:"image-upload",children:"Upload Background Image:"}),(0,aI.jsx)("input",{type:"file",id:"image-upload",accept:"image/*",onChange:g=>{const e=g.target.files[0];if(e){const g=new FileReader;g.onload=()=>{l(g.result),alert("Background image for ".concat(t," updated successfully!"))},g.readAsDataURL(e)}},disabled:!t})]}),(0,aI.jsxs)("div",{children:[(0,aI.jsx)("label",{htmlFor:"font-select",children:"Select Font:"}),(0,aI.jsxs)("select",{id:"font-select",value:a,onChange:g=>{const e=g.target.value;o(e),document.body.style.fontFamily=e,alert("Font changed to ".concat(e," successfully!"))},children:[(0,aI.jsx)("option",{value:"",children:"--Select a Font--"}),(0,aI.jsx)("option",{value:"Arial, sans-serif",children:"Arial"}),(0,aI.jsx)("option",{value:"'Courier New', monospace",children:"Courier New"}),(0,aI.jsx)("option",{value:"'Georgia', serif",children:"Georgia"}),(0,aI.jsx)("option",{value:"'Times New Roman', serif",children:"Times New Roman"}),(0,aI.jsx)("option",{value:"'Verdana', sans-serif",children:"Verdana"})]})]})]})]})},ni=()=>{const[g,e]=(0,I.useState)([]),[t,n]=(0,I.useState)("");(0,I.useEffect)((()=>{CI.get("/api/users/pending").then((g=>e(g.data))).catch((g=>n("Failed to fetch users.")))}),[]);return(0,aI.jsxs)("div",{className:"approve-user-container",children:[(0,aI.jsx)("h1",{children:"Approve Users"}),t&&(0,aI.jsx)("p",{className:"error-message",children:t}),(0,aI.jsx)("ul",{children:g.map((t=>(0,aI.jsxs)("li",{className:"user-item",children:[(0,aI.jsxs)("span",{children:[t.username," (",t.role,")"]}),(0,aI.jsx)("button",{onClick:()=>{return I=t.id,void CI.post("/api/approve-user/".concat(I)).then((()=>{e(g.filter((g=>g.id!==I)))})).catch((()=>n("Failed to approve user.")));var I},className:"approve-button",children:"Approve"})]},t.id)))})]})},Ci=()=>(0,aI.jsxs)("div",{className:"admin-dashboard-container",children:[(0,aI.jsxs)("header",{className:"admin-dashboard-header",children:[(0,aI.jsx)("h1",{children:"Admin Dashboard"}),(0,aI.jsx)("nav",{children:(0,aI.jsxs)("ul",{className:"admin-dashboard-nav",children:[(0,aI.jsx)("li",{children:(0,aI.jsx)(Vg,{to:"/admin/users",children:"Manage Users"})}),(0,aI.jsx)("li",{children:(0,aI.jsx)(Vg,{to:"/admin/customers",children:"Customers"})}),(0,aI.jsx)("li",{children:(0,aI.jsx)(Vg,{to:"/admin/suppliers",children:"Suppliers"})}),(0,aI.jsx)("li",{children:(0,aI.jsx)(Vg,{to:"/admin/inventory",children:"Inventory"})}),(0,aI.jsx)("li",{children:(0,aI.jsx)(Vg,{to:"/admin/reports",children:"Reports"})}),(0,aI.jsx)("li",{children:(0,aI.jsx)(Vg,{to:"/admin/settings",children:"Settings"})})]})})]}),(0,aI.jsx)("main",{className:"admin-dashboard-main",children:(0,aI.jsxs)("section",{className:"admin-dashboard-welcome",children:[(0,aI.jsx)("h2",{children:"Welcome, Admin!"}),(0,aI.jsx)("p",{children:"Select a section from the navigation above to manage the system."})]})})]}),li=g=>{let{title:e,children:t}=g;return(0,aI.jsxs)("section",{className:"admin-section",children:[(0,aI.jsx)("h2",{children:e}),(0,aI.jsx)("div",{className:"admin-section-content",children:t})]})},ai=()=>{const[g,e]=(0,I.useState)([]),[t,n]=(0,I.useState)(!0),[C,l]=(0,I.useState)("");return(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat("https://astrobsm-oracle-backend.onrender.com/api/v1","/customers"));if(!g.ok)throw new Error("Failed to fetch customers");const t=await g.json();e(t)}catch(jn){l(jn.message)}finally{n(!1)}})()}),[]),(0,aI.jsx)(li,{title:"Customers",children:(0,aI.jsxs)("div",{className:"admin-customers-list",children:[t&&(0,aI.jsx)("p",{children:"Loading..."}),C&&(0,aI.jsx)("p",{className:"error",children:C}),!t&&!C&&0===g.length&&(0,aI.jsx)("p",{children:"No customers found."}),!t&&!C&&g.length>0&&(0,aI.jsxs)("table",{className:"admin-customers-table",children:[(0,aI.jsx)("thead",{children:(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("th",{children:"Name"}),(0,aI.jsx)("th",{children:"Customer ID"}),(0,aI.jsx)("th",{children:"Phone"}),(0,aI.jsx)("th",{children:"Address"})]})}),(0,aI.jsx)("tbody",{children:g.map((g=>(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("td",{children:g.name}),(0,aI.jsx)("td",{children:g.customer_id}),(0,aI.jsx)("td",{children:g.phone_number}),(0,aI.jsx)("td",{children:g.address})]},g.id)))})]})]})})},oi=()=>{const[g,e]=(0,I.useState)([]),[t,n]=(0,I.useState)(!0),[C,l]=(0,I.useState)("");return(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat("https://astrobsm-oracle-backend.onrender.com/api/v1","/suppliers"));if(!g.ok)throw new Error("Failed to fetch suppliers");const t=await g.json();e(t)}catch(jn){l(jn.message)}finally{n(!1)}})()}),[]),(0,aI.jsx)(li,{title:"Suppliers",children:(0,aI.jsxs)("div",{className:"admin-suppliers-list",children:[t&&(0,aI.jsx)("p",{children:"Loading..."}),C&&(0,aI.jsx)("p",{className:"error",children:C}),!t&&!C&&0===g.length&&(0,aI.jsx)("p",{children:"No suppliers found."}),!t&&!C&&g.length>0&&(0,aI.jsxs)("table",{className:"admin-suppliers-table",children:[(0,aI.jsx)("thead",{children:(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("th",{children:"Name"}),(0,aI.jsx)("th",{children:"Supplier ID"}),(0,aI.jsx)("th",{children:"Phone"}),(0,aI.jsx)("th",{children:"Address"})]})}),(0,aI.jsx)("tbody",{children:g.map((g=>(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("td",{children:g.name}),(0,aI.jsx)("td",{children:g.supplier_id}),(0,aI.jsx)("td",{children:g.phone_number}),(0,aI.jsx)("td",{children:g.address})]},g.id)))})]})]})})},ii=()=>{const[g,e]=(0,I.useState)([]),[t,n]=(0,I.useState)(!0),[C,l]=(0,I.useState)("");return(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat(lI,"/staff"));if(!g.ok)throw new Error("Failed to fetch users");const t=await g.json();e(t)}catch(jn){l(jn.message)}finally{n(!1)}})()}),[]),(0,aI.jsx)(li,{title:"Users",children:(0,aI.jsxs)("div",{className:"admin-users-list",children:[t&&(0,aI.jsx)("p",{children:"Loading..."}),C&&(0,aI.jsx)("p",{className:"error",children:C}),!t&&!C&&0===g.length&&(0,aI.jsx)("p",{children:"No users found."}),!t&&!C&&g.length>0&&(0,aI.jsxs)("table",{className:"admin-users-table",children:[(0,aI.jsx)("thead",{children:(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("th",{children:"Name"}),(0,aI.jsx)("th",{children:"Username"}),(0,aI.jsx)("th",{children:"Role"}),(0,aI.jsx)("th",{children:"Status"})]})}),(0,aI.jsx)("tbody",{children:g.map((g=>(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("td",{children:g.name||g.full_name||"-"}),(0,aI.jsx)("td",{children:g.username}),(0,aI.jsx)("td",{children:g.role}),(0,aI.jsx)("td",{children:g.status||"-"})]},g.id)))})]})]})})},ri=()=>{const[g,e]=(0,I.useState)([]),[t,n]=(0,I.useState)(!0),[C,l]=(0,I.useState)("");return(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat("https://astrobsm-oracle-backend.onrender.com/api/v1","/inventory/stock-level"));if(!g.ok)throw new Error("Failed to fetch inventory");const t=await g.json();e(t)}catch(jn){l(jn.message)}finally{n(!1)}})()}),[]),(0,aI.jsx)(li,{title:"Inventory",children:(0,aI.jsxs)("div",{className:"admin-inventory-list",children:[t&&(0,aI.jsx)("p",{children:"Loading..."}),C&&(0,aI.jsx)("p",{className:"error",children:C}),!t&&!C&&0===g.length&&(0,aI.jsx)("p",{children:"No inventory records found."}),!t&&!C&&g.length>0&&(0,aI.jsxs)("table",{className:"admin-inventory-table",children:[(0,aI.jsx)("thead",{children:(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("th",{children:"Product"}),(0,aI.jsx)("th",{children:"SKU"}),(0,aI.jsx)("th",{children:"Stock Level"}),(0,aI.jsx)("th",{children:"Unit"})]})}),(0,aI.jsx)("tbody",{children:g.map((g=>(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("td",{children:g.product_name||g.name}),(0,aI.jsx)("td",{children:g.sku||"-"}),(0,aI.jsx)("td",{children:g.stock_level}),(0,aI.jsx)("td",{children:g.unit||"-"})]},g.id||g.sku)))})]})]})})},ci=()=>{const[g,e]=(0,I.useState)([]),[t,n]=(0,I.useState)(!0),[C,l]=(0,I.useState)("");return(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat("https://astrobsm-oracle-backend.onrender.com/api/v1","/reports"));if(!g.ok)throw new Error("Failed to fetch reports");const t=await g.json();e(t)}catch(jn){l(jn.message)}finally{n(!1)}})()}),[]),(0,aI.jsx)(li,{title:"Reports",children:(0,aI.jsxs)("div",{className:"admin-reports-list",children:[t&&(0,aI.jsx)("p",{children:"Loading..."}),C&&(0,aI.jsx)("p",{className:"error",children:C}),!t&&!C&&0===g.length&&(0,aI.jsx)("p",{children:"No reports found."}),!t&&!C&&g.length>0&&(0,aI.jsxs)("table",{className:"admin-reports-table",children:[(0,aI.jsx)("thead",{children:(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("th",{children:"Report Name"}),(0,aI.jsx)("th",{children:"Date"}),(0,aI.jsx)("th",{children:"Type"}),(0,aI.jsx)("th",{children:"Status"})]})}),(0,aI.jsx)("tbody",{children:g.map((g=>(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("td",{children:g.name||g.report_name}),(0,aI.jsx)("td",{children:g.date||"-"}),(0,aI.jsx)("td",{children:g.type||"-"}),(0,aI.jsx)("td",{children:g.status||"-"})]},g.id)))})]})]})})},si=()=>{const[g,e]=(0,I.useState)(null),[t,n]=(0,I.useState)(!0),[C,l]=(0,I.useState)("");return(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat("https://astrobsm-oracle-backend.onrender.com/api/v1","/settings"));if(!g.ok)throw new Error("Failed to fetch settings");const t=await g.json();e(t)}catch(jn){l(jn.message)}finally{n(!1)}})()}),[]),(0,aI.jsx)(li,{title:"Settings",children:(0,aI.jsxs)("div",{className:"admin-settings-container",children:[t&&(0,aI.jsx)("p",{children:"Loading..."}),C&&(0,aI.jsx)("p",{className:"error",children:C}),!t&&!C&&g&&(0,aI.jsx)("div",{className:"admin-settings-list",children:Object.entries(g).map((g=>{let[e,t]=g;return(0,aI.jsxs)("div",{className:"admin-settings-item",children:[(0,aI.jsx)("span",{className:"admin-settings-key",children:e}),(0,aI.jsx)("span",{className:"admin-settings-value",children:String(t)})]},e)}))}),!t&&!C&&!g&&(0,aI.jsx)("p",{children:"No settings found."})]})})},Ai=()=>{const[g,e]=(0,I.useState)([]),[t,n]=(0,I.useState)(!0),[C,l]=(0,I.useState)(""),[a,o]=(0,I.useState)(""),i=(0,I.useRef)(null);(0,I.useEffect)((()=>{(async()=>{try{const g=await fetch("".concat(lI,"/auth/pending-users"));if(!g.ok)throw new Error("Failed to fetch pending users");const t=await g.json();e(t)}catch(jn){l(jn.message)}finally{n(!1)}})()}),[]);const r=function(g){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";i.current&&(i.current.textContent=g,i.current.className="success"===e?"success":"error",i.current.style.display="block",setTimeout((()=>{i.current&&(i.current.style.display="none")}),3e3))};return(0,aI.jsxs)("div",{className:"admin-approvals-container",children:[(0,aI.jsx)("h2",{children:"Pending User Approvals"}),(0,aI.jsx)("div",{ref:i,style:{display:"none",marginBottom:"16px",padding:"10px",borderRadius:"4px",fontWeight:"bold"}}),t&&(0,aI.jsx)("p",{children:"Loading..."}),C&&(0,aI.jsx)("p",{className:"error",children:C}),a&&(0,aI.jsx)("p",{className:"success",children:a}),!t&&0===g.length&&(0,aI.jsx)("p",{children:"No pending users."}),!t&&g.length>0&&(0,aI.jsxs)("table",{className:"approvals-table",children:[(0,aI.jsx)("thead",{children:(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("th",{children:"Full Name"}),(0,aI.jsx)("th",{children:"Email"}),(0,aI.jsx)("th",{children:"Phone"}),(0,aI.jsx)("th",{children:"Role"}),(0,aI.jsx)("th",{children:"Status"}),(0,aI.jsx)("th",{children:"Action"})]})}),(0,aI.jsx)("tbody",{children:g.map((t=>(0,aI.jsxs)("tr",{children:[(0,aI.jsx)("td",{children:t.full_name||"-"}),(0,aI.jsx)("td",{children:t.username||t.email||"-"}),(0,aI.jsx)("td",{children:t.phone||"-"}),(0,aI.jsx)("td",{children:t.role}),(0,aI.jsx)("td",{children:t.status}),(0,aI.jsx)("td",{children:(0,aI.jsx)("button",{onClick:()=>(async t=>{l(""),o("");try{if(!(await fetch("".concat(lI,"/auth/approve-user/").concat(t),{method:"POST"})).ok)throw new Error("Failed to approve user");o("User approved successfully!"),r("User approved successfully!","success"),e(g.filter((g=>g.id!==t)))}catch(jn){l(jn.message),r(jn.message,"error")}})(t.id),children:"Approve"})})]},t.id)))})]})]})},di=()=>{const[g,e]=(0,I.useState)(!1),[t,n]=(0,I.useState)(!0),C=eg();return(0,I.useEffect)((()=>{localStorage.getItem("token")?e(!0):(e(!1),C("/login")),n(!1)}),[C]),g||t?(console.log("Rendering Routes with current location:",window.location.pathname),(0,aI.jsxs)("div",{className:"app-container",children:[(0,aI.jsx)(iI,{}),(0,aI.jsx)("div",{className:"page-container",id:"main-content",children:(0,aI.jsxs)(bg,{children:[(0,aI.jsx)(mg,{path:"/",element:(0,aI.jsx)(tn,{})}),(0,aI.jsx)(mg,{path:"/dashboard",element:(0,aI.jsx)(Ci,{})}),(0,aI.jsx)(mg,{path:"/registration",element:(0,aI.jsx)(qI,{})}),(0,aI.jsx)(mg,{path:"/inventory",element:(0,aI.jsx)(_I,{})}),(0,aI.jsx)(mg,{path:"/payroll",element:(0,aI.jsx)($I,{})}),(0,aI.jsx)(mg,{path:"/attendance",element:(0,aI.jsx)(gn,{})}),(0,aI.jsx)(mg,{path:"/factory-inventory",element:(0,aI.jsx)(en,{})}),(0,aI.jsx)(mg,{path:"/login",element:(0,aI.jsx)(tn,{})}),(0,aI.jsx)(mg,{path:"/stock-intake",element:(0,aI.jsx)(In,{})}),(0,aI.jsx)(mg,{path:"/stock-level",element:(0,aI.jsx)(nn,{})}),(0,aI.jsx)(mg,{path:"/grant-access",element:(0,aI.jsx)(Cn,{})}),(0,aI.jsx)(mg,{path:"/timed-attendance",element:(0,aI.jsx)(on,{})}),(0,aI.jsx)(mg,{path:"/attendance-record",element:(0,aI.jsx)(rn,{})}),(0,aI.jsx)(mg,{path:"/attendance-analysis",element:(0,aI.jsx)(cn,{})}),(0,aI.jsx)(mg,{path:"/product-stock-intake",element:(0,aI.jsx)(An,{})}),(0,aI.jsx)(mg,{path:"/product-stock-level",element:(0,aI.jsx)(dn,{})}),(0,aI.jsx)(mg,{path:"/generate-invoice",element:(0,aI.jsx)(So,{})}),(0,aI.jsx)(mg,{path:"/sales-summary",element:(0,aI.jsx)(fo,{})}),(0,aI.jsx)(mg,{path:"/customer-performance",element:(0,aI.jsx)(Wo,{})}),(0,aI.jsx)(mg,{path:"/sales-inventory",element:(0,aI.jsx)(Vo,{})}),(0,aI.jsx)(mg,{path:"/database-table",element:(0,aI.jsx)(vo,{})}),(0,aI.jsx)(mg,{path:"/register-customer",element:(0,aI.jsx)(qI,{})}),(0,aI.jsx)(mg,{path:"/production-inventory",element:(0,aI.jsx)(Ro,{})}),(0,aI.jsx)(mg,{path:"/raw-material-stock-intake",element:(0,aI.jsx)(ko,{})}),(0,aI.jsx)(mg,{path:"/raw-material-stock-level",element:(0,aI.jsx)(Jo,{})}),(0,aI.jsx)(mg,{path:"/register-production-requirement",element:(0,aI.jsx)(Ho,{})}),(0,aI.jsx)(mg,{path:"/production-console",element:(0,aI.jsx)(Ko,{})}),(0,aI.jsx)(mg,{path:"/production-output",element:(0,aI.jsx)(Lo,{})}),(0,aI.jsx)(mg,{path:"/production-analysis",element:(0,aI.jsx)(zo,{})}),(0,aI.jsx)(mg,{path:"/factory-inventory/device-intake",element:(0,aI.jsx)(Eo,{})}),(0,aI.jsx)(mg,{path:"/factory-inventory/device-list",element:(0,aI.jsx)(Mo,{})}),(0,aI.jsx)(mg,{path:"/factory-inventory/device-maintenance-log",element:(0,aI.jsx)(Uo,{})}),(0,aI.jsx)(mg,{path:"/factory-inventory/device-fault-reporting",element:(0,aI.jsx)(jo,{})}),(0,aI.jsx)(mg,{path:"/device-list",element:(0,aI.jsx)(Qo,{})}),(0,aI.jsx)(mg,{path:"/device-maintenance-log",element:(0,aI.jsx)(Uo,{})}),(0,aI.jsx)(mg,{path:"/device-fault-reporting",element:(0,aI.jsx)(jo,{})}),(0,aI.jsx)(mg,{path:"/staff-management",element:(0,aI.jsx)(Do,{})}),(0,aI.jsx)(mg,{path:"/staff-list",element:(0,aI.jsx)(To,{})}),(0,aI.jsx)(mg,{path:"/salary-calculation",element:(0,aI.jsx)(Po,{})}),(0,aI.jsx)(mg,{path:"/staff-appraisal",element:(0,aI.jsx)(Oo,{})}),(0,aI.jsx)(mg,{path:"/salary-console",element:(0,aI.jsx)(qo,{})}),(0,aI.jsx)(mg,{path:"/salary-records",element:(0,aI.jsx)(_o,{})}),(0,aI.jsx)(mg,{path:"/salary-report",element:(0,aI.jsx)($o,{})}),(0,aI.jsx)(mg,{path:"/reports-analysis",element:(0,aI.jsx)(gi,{})}),(0,aI.jsx)(mg,{path:"/customers-performance",element:(0,aI.jsx)(ei,{})}),(0,aI.jsx)(mg,{path:"/staff-performance",element:(0,aI.jsx)(ti,{})}),(0,aI.jsx)(mg,{path:"/settings",element:(0,aI.jsx)(Ii,{})}),(0,aI.jsx)(mg,{path:"/approve-users",element:(0,aI.jsx)(ni,{})}),(0,aI.jsx)(mg,{path:"/admin/customers",element:(0,aI.jsx)(ai,{})}),(0,aI.jsx)(mg,{path:"/admin/suppliers",element:(0,aI.jsx)(oi,{})}),(0,aI.jsx)(mg,{path:"/admin/users",element:(0,aI.jsx)(ii,{})}),(0,aI.jsx)(mg,{path:"/admin/inventory",element:(0,aI.jsx)(ri,{})}),(0,aI.jsx)(mg,{path:"/admin/reports",element:(0,aI.jsx)(ci,{})}),(0,aI.jsx)(mg,{path:"/admin/settings",element:(0,aI.jsx)(si,{})}),(0,aI.jsx)(mg,{path:"/admin/user-approvals",element:(0,aI.jsx)(Ai,{})}),(0,aI.jsx)(mg,{path:"/admin-dashboard",element:(0,aI.jsx)(Ci,{})}),(0,aI.jsx)(mg,{path:"*",element:(0,aI.jsxs)("div",{children:["Route not found: ",window.location.pathname]})})]})})]})):(0,aI.jsx)(oI,{})};C.createRoot(document.getElementById("root")).render((0,aI.jsx)(I.StrictMode,{children:(0,aI.jsx)(Sg,{children:(0,aI.jsx)(di,{})})})),"serviceWorker"in navigator&&window.addEventListener("load",(()=>{navigator.serviceWorker.register("/sw.js").then((g=>{console.log("Service Worker registered with scope:",g.scope)})).catch((g=>{console.error("Service Worker registration failed:",g)}))}))})()})();
//# sourceMappingURL=main.14952625.js.map